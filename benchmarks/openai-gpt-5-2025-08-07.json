[
    {
        "question": "Determine all continuous pairs of functions f, g: (0, \u221e) \u2192 \u211d such that for every x, y > 0 the following system holds:\n- g(xy) + g(x/y) = 2 g(x) g(y),\n- f(xy) + f(x/y) = 2 f(x) g(y).\n\nYour answer should give an explicit parametrization of all such pairs (f, g), prove that every pair in your list satisfies the system, and prove that no other continuous pairs do.",
        "answer": "We solve the system in two stages: first classify g, then solve the linear equation for f with that g.\n\n1) Preliminary observations and a logarithmic change of variables.\n\n- Put y = 1 in the first equation: g(x) + g(x) = 2 g(x) g(1), hence for all x > 0 we have 2 g(x) (g(1) \u2212 1) = 0. Thus either g \u2261 0 or g(1) = 1.\n\n- If g \u2261 0, then putting y = 1 in the second equation gives 2 f(x) = 2 f(x) g(1) = 0, hence f \u2261 0. This yields the trivial pair (f, g) \u2261 (0, 0).\n\n- From now on assume g is not identically zero, so g(1) = 1. Fix x and put y \u21a6 1/y in g\u2019s equation to get g(x/y) + g(xy) = 2 g(x) g(1/y). Comparing with the original and using symmetry, we deduce g(1/y) = g(y) for all y (so g is even in the logarithmic variable).\n\n- Introduce logarithmic coordinates: define G, F: \u211d \u2192 \u211d by G(u) = g(e^u) and F(u) = f(e^u). Continuity of f, g transfers to F, G. The system becomes for all u, v \u2208 \u211d:\n  (A) G(u+v) + G(u\u2212v) = 2 G(u) G(v),\n  (B) F(u+v) + F(u\u2212v) = 2 F(u) G(v),\n  with G(0) = g(1) = 1. Equation (A) is d\u2019Alembert\u2019s functional equation.\n\n2) Solving (A): classification of G.\n\nWe show that any continuous solution G of (A) with G(0) = 1 must be one of the classical families.\n\n- Evenness: Putting u = 0 in (A) gives G(v) + G(\u2212v) = 2 G(0) G(v) = 2 G(v), hence G(\u2212v) = G(v): G is even.\n\n- Existence of a second derivative and a constant coefficient ODE: Fix u and divide (A) by v^2:\n  [G(u+v) \u2212 2 G(u) + G(u\u2212v)]/v^2 = 2 G(u) [G(v) \u2212 1]/v^2.\n  As v \u2192 0, the right-hand side tends to a finite limit because G is continuous and G(0) = 1. Define\n  c := lim_{v\u21920} 2 [G(v) \u2212 1]/v^2,\n  which exists (we justify existence below), and then the left side\u2019s limit exists and equals c G(u). By definition of second derivative via symmetric difference quotients, G is twice differentiable and satisfies\n  G''(u) = c G(u) for all u \u2208 \u211d,\n  with initial conditions G(0) = 1 and G'(0) = 0 (evenness).\n\n  Existence of c: Use (A) with u = v to get G(2v) = 2 G(v)^2 \u2212 1. Write a(v) = [G(v) \u2212 1]/v^2 for v \u2260 0. Then\n  a(2v) = (G(2v) \u2212 1)/(2v)^2 = [2(1 + v^2 a(v))^2 \u2212 2]/(4 v^2) = a(v) + (1/2) v^2 a(v)^2.\n  This recurrence shows (a(2^\u2212n v))_n is Cauchy as n \u2192 \u221e, so a(v) has a limit as v \u2192 0. Hence c exists.\n\n- Solving the ODE:\n  \u2022 If c = \u03bb^2 \u2265 0, then the unique solution of G'' = \u03bb^2 G with G(0) = 1, G'(0) = 0 is G(u) = cosh(\u03bb u). The case \u03bb = 0 gives G \u2261 1.\n  \u2022 If c = \u2212\u03bc^2 < 0, then the unique solution is G(u) = cos(\u03bc u).\n\nIt is straightforward to check that each of these G satisfies (A) by the standard addition formulas for cosh and cos.\n\nThus the continuous solutions to (A) with G(0) = 1 are exactly\n- G(u) = cosh(\u03bb u) for some \u03bb \u2265 0, or\n- G(u) = cos(\u03bc u) for some \u03bc \u2265 0.\n\n3) Solving (B) for F given G.\n\nEquation (B) is linear in F. We use the same second-difference device to obtain a linear ODE for F with the same constant c as above.\n\n- As before,\n  0 = [F(u+v) \u2212 2 F(u) + F(u\u2212v)]/v^2 \u2212 2 F(u)[G(v) \u2212 1]/v^2.\n  Letting v \u2192 0 and recalling that lim_{v\u21920} 2 [G(v) \u2212 1]/v^2 = c, we get existence of F'' and\n  F''(u) = c F(u) for all u \u2208 \u211d.\n\n- Therefore, with c = \u03bb^2 \u2265 0 or c = \u2212\u03bc^2 < 0, the general C^2 solution F is:\n  \u2022 If c = \u03bb^2 \u2265 0: F(u) = A cosh(\u03bb u) + B sinh(\u03bb u).\n  \u2022 If c = 0: F(u) = A + B u.\n  \u2022 If c = \u2212\u03bc^2 < 0: F(u) = A cos(\u03bc u) + B sin(\u03bc u),\n  with arbitrary real constants A, B. Each such F together with the corresponding G indeed satisfies (B), by the identities\n     cosh(\u03b1(u\u00b1v)) = cosh(\u03b1 u) cosh(\u03b1 v) \u00b1 sinh(\u03b1 u) sinh(\u03b1 v),\n     cos(\u03b1(u\u00b1v)) = cos(\u03b1 u) cos(\u03b1 v) \u2213 sin(\u03b1 u) sin(\u03b1 v),\n  whose sums cancel the cross terms.\n\n4) Returning to x-variables and listing all solutions.\n\nRecall F(u) = f(e^u) and G(u) = g(e^u). Writing u = ln x, we obtain the complete list:\n\n- Trivial solution:\n  \u2022 (f, g) \u2261 (0, 0).\n\n- Hyperbolic family (parameter \u03bb \u2265 0):\n  \u2022 g(x) = cosh(\u03bb ln x),\n  \u2022 f(x) = A cosh(\u03bb ln x) + B sinh(\u03bb ln x) = C_1 x^{\u03bb} + C_2 x^{\u2212\u03bb},\n    where C_1 = (A + B)/2 and C_2 = (A \u2212 B)/2 are arbitrary reals. The case \u03bb = 0 gives g \u2261 1 and f(x) = A + B ln x.\n\n- Trigonometric family (parameter \u03bc \u2265 0):\n  \u2022 g(x) = cos(\u03bc ln x),\n  \u2022 f(x) = A cos(\u03bc ln x) + B sin(\u03bc ln x),\n    with arbitrary A, B \u2208 \u211d. The case \u03bc = 0 again reduces to g \u2261 1 and f(x) = A + B ln x.\n\nVerification: Each listed pair satisfies the system by the addition identities for cosh/cos and the fact that ln(xy) = ln x + ln y, ln(x/y) = ln x \u2212 ln y. Conversely, any continuous solution must arise as above because G and F necessarily satisfy the constant-coefficient ODEs derived from (A) and (B), and we have exhausted all their solutions.\n\nTherefore, the continuous solutions (f, g): (0, \u221e) \u2192 \u211d to\ng(xy) + g(x/y) = 2 g(x) g(y),  f(xy) + f(x/y) = 2 f(x) g(y)\nare exactly:\n- (f, g) \u2261 (0, 0),\n- For some \u03bb \u2265 0 and arbitrary A, B \u2208 \u211d:\n  g(x) = cosh(\u03bb ln x),  f(x) = A cosh(\u03bb ln x) + B sinh(\u03bb ln x) = C_1 x^{\u03bb} + C_2 x^{\u2212\u03bb},\n- For some \u03bc \u2265 0 and arbitrary A, B \u2208 \u211d:\n  g(x) = cos(\u03bc ln x),  f(x) = A cos(\u03bc ln x) + B sin(\u03bc ln x),\nwith the border case \u03bb = 0 or \u03bc = 0 reducing to g \u2261 1 and f(x) = A + B ln x. No other continuous pairs satisfy the system."
    },
    {
        "question": "Compute the exact number of spanning trees of the d-dimensional hypercube Q_d, for each integer d \u2265 1.\n\nDefinitions:\n- The d-dimensional hypercube graph Q_d has vertex set V = {0,1}^d; two vertices are adjacent iff they differ in exactly one coordinate. Thus |V| = 2^d and Q_d is d-regular.\n- A spanning tree of a connected graph G is a tree subgraph containing all vertices of G.\n\nYour task:\n- Derive a closed-form product formula for the number \u03c4(Q_d) of spanning trees of Q_d in terms of d and binomial coefficients.\n- Your solution must include a rigorous derivation. You may use (with justification and definitions) the adjacency/Laplacian spectrum and Kirchhoff\u2019s Matrix-Tree Theorem, but the argument should be self-contained: define all objects you use and justify key steps.\n\nAnswer format:\n- State your final closed-form expression for \u03c4(Q_d).\n- Then provide a complete proof of the formula.",
        "answer": "Final formula:\n\u03c4(Q_d) = 2^{2^d - d - 1} \u220f_{k=1}^d k^{C(d,k)} = (1/2^d) \u220f_{k=1}^d (2k)^{C(d,k)}.\n\nHere C(d,k) = binomial(d,k) is the binomial coefficient.\n\nProof:\n\n1) Spectral setup and definitions\n- Let G be a finite connected graph with vertex set V and edge set E. The adjacency matrix A is the |V|\u00d7|V| matrix with A_{uv} = 1 if u and v are adjacent, 0 otherwise. The degree matrix D is diagonal with D_{uu} = deg(u). The Laplacian is L = D \u2212 A.\n- Kirchhoff\u2019s Matrix-Tree Theorem: The number \u03c4(G) of spanning trees of G equals any cofactor of L, i.e., \u03c4(G) = (1/|V|) \u220f_{i=2}^{|V|} \u03bb_i where 0 = \u03bb_1 < \u03bb_2 \u2264 ... \u2264 \u03bb_{|V|} are the eigenvalues of L (counted with multiplicity). Equivalently, \u03c4(G) is any (|V|\u22121)\u00d7(|V|\u22121) principal minor determinant of L.\n- We will apply this to G = Q_d, the d-dimensional hypercube: vertices are vectors x \u2208 {0,1}^d; u and v adjacent iff their Hamming distance is 1. This graph is d-regular with |V| = 2^d.\n\nWe will compute the Laplacian spectrum of Q_d explicitly.\n\n2) Eigenvalues of Q_d (adjacency and Laplacian)\nQ_d is a Cayley graph of the abelian group (Z/2Z)^d: vertices are group elements, and v is adjacent to v + e_j, where e_j is the unit vector with 1 in coordinate j and 0 elsewhere. The characters of (Z/2Z)^d furnish a complete eigenbasis.\n\n- For s \u2208 {0,1}^d, define the character \u03c7_s: {0,1}^d \u2192 {\u00b11} by \u03c7_s(x) = (\u22121)^{s\u00b7x} (dot product mod 2).\n- Let A be the adjacency matrix of Q_d. Then for any x,\n(A\u03c7_s)(x) = \u2211_{j=1}^d \u03c7_s(x + e_j) = \u03c7_s(x) \u2211_{j=1}^d \u03c7_s(e_j) = \u03c7_s(x) \u2211_{j=1}^d (\u22121)^{s_j}.\n- If wt(s) = number of 1\u2019s in s (the Hamming weight), then \u2211_{j=1}^d (\u22121)^{s_j} = d \u2212 2 wt(s).\nThus \u03c7_s is an eigenvector of A with eigenvalue \u03bc_s = d \u2212 2 wt(s).\n\nSince L = D \u2212 A with D = d I, the Laplacian eigenvalues are \u03bb_s = d \u2212 \u03bc_s = 2 wt(s). The multiplicity of \u03bb = 2k is C(d,k), the number of s with weight k.\n\nTherefore, the Laplacian spectrum of Q_d is:\n- 0 with multiplicity 1 (k = 0),\n- 2k with multiplicity C(d,k) for k = 1, 2, ..., d.\n\n3) Kirchhoff\u2019s Matrix-Tree Theorem and the product\nBy Kirchhoff\u2019s theorem, the number of spanning trees is\n\u03c4(Q_d) = (1/|V|) \u220f_{s \u2260 0} \u03bb_s = (1/2^d) \u220f_{k=1}^d (2k)^{C(d,k)}.\n\nThis gives the product form:\n\u03c4(Q_d) = (1/2^d) \u220f_{k=1}^d (2k)^{C(d,k)}.\n\nWe can rewrite the power of 2 explicitly. Since \u2211_{k=1}^d C(d,k) = 2^d \u2212 1,\n\u03c4(Q_d) = 2^{(2^d \u2212 1) \u2212 d} \u220f_{k=1}^d k^{C(d,k)} = 2^{2^d \u2212 d \u2212 1} \u220f_{k=1}^d k^{C(d,k)}.\n\n4) Sanity checks for small d\n- d = 1: Q_1 is a single edge; \u03c4(Q_1) = 1. Formula: 2^{2^1 \u2212 1 \u2212 1} \u220f_{k=1}^1 k^{C(1,k)} = 2^0 \u00b7 1^1 = 1.\n- d = 2: Q_2 is a 4-cycle; \u03c4(Q_2) = 4. Formula: (1/4) (2\u00b71)^{C(2,1)} (2\u00b72)^{C(2,2)} = (1/4) 2^2 \u00b7 4^1 = 16/4 = 4.\n- d = 3: Q_3 is the cube; \u03c4(Q_3) = 384 (known). Formula: (1/8) (2\u00b71)^{3} (2\u00b72)^{3} (2\u00b73)^{1} = (1/8) \u00b7 8 \u00b7 64 \u00b7 6 = 384.\n\nThis matches known values.\n\n5) Brief justification of Kirchhoff\u2019s theorem (self-contained sketch)\nLet G be a connected graph with oriented incidence matrix B (rows indexed by vertices, columns by edges; each column has exactly one +1 and one \u22121 according to the chosen orientation, zeros elsewhere). Then L = B B^T.\n\nLet L^{(v)} be the (|V|\u22121)\u00d7(|V|\u22121) principal minor obtained by deleting row and column corresponding to vertex v. Cauchy\u2013Binet says det(L^{(v)}) = \u2211 det(B^{(v)}_{S})^2, where S ranges over all sets of |V|\u22121 edges, and B^{(v)}_{S} is the (|V|\u22121)\u00d7(|V|\u22121) submatrix of B with the row v removed and columns S.\n\nOne can check:\n- det(B^{(v)}_{S}) is 0 unless the edges S form a spanning tree.\n- If S is a spanning tree, then |det(B^{(v)}_{S})| = 1 (orientation only affects the sign).\nThus det(L^{(v)}) counts the spanning trees. Since the cofactor det(L^{(v)}) is independent of v in a connected graph, Kirchhoff\u2019s theorem follows.\n\n6) Conclusion\nUsing the explicit Laplacian spectrum of Q_d and Kirchhoff\u2019s theorem, we obtain the exact count:\n\u03c4(Q_d) = 2^{2^d \u2212 d \u2212 1} \u220f_{k=1}^d k^{C(d,k)} = (1/2^d) \u220f_{k=1}^d (2k)^{C(d,k)}."
    },
    {
        "question": "Prove the Cauchy determinant identity in full generality and use it to compute the determinant of the Hilbert matrix.\n\nLet n \u2265 1 be an integer, and let x_1, ..., x_n and y_1, ..., y_n be complex numbers such that:\n- x_i + y_j \u2260 0 for all i, j,\n- x_i \u2260 x_j for i \u2260 j, and y_i \u2260 y_j for i \u2260 j.\n\nDefine the n \u00d7 n Cauchy matrix C = [c_{ij}] by c_{ij} = 1/(x_i + y_j).\n\nTasks:\n1) Prove that\ndet C = (\u220f_{1 \u2264 i < j \u2264 n} (x_j \u2212 x_i)) (\u220f_{1 \u2264 i < j \u2264 n} (y_j \u2212 y_i)) / (\u220f_{i=1}^n \u220f_{j=1}^n (x_i + y_j)).\n\nYour proof must be self-contained and rigorous. You may use standard properties of determinants, but you should not assume the identity itself or invoke heavy machinery.\n\n2) Let H_n denote the n \u00d7 n Hilbert matrix with entries (H_n)_{ij} = 1/(i + j \u2212 1) for 1 \u2264 i, j \u2264 n. Use part (1) to obtain a closed-form product formula for det(H_n). Present your final answer in a compact product form, for example\ndet(H_n) = [\u220f_{k=1}^{n-1} (k!)^4] / [\u220f_{k=1}^{2n-1} k^{2n-k}],\nand justify this (or an equivalent) form from first principles.\n\nAnswer format:\n- State the final formula for det C.\n- Provide a complete proof of (1).\n- State the final closed form for det(H_n).\n- Derive it cleanly from (1), including any necessary combinatorial product identities.",
        "answer": "Final formula for the Cauchy determinant:\nFor pairwise distinct x_i\u2019s and y_j\u2019s with x_i + y_j \u2260 0 for all i, j,\ndet [1/(x_i + y_j)]_{1 \u2264 i,j \u2264 n} = [\u220f_{1 \u2264 i < j \u2264 n} (x_j \u2212 x_i)] [\u220f_{1 \u2264 i < j \u2264 n} (y_j \u2212 y_i)] / [\u220f_{i=1}^n \u220f_{j=1}^n (x_i + y_j)].\n\nProof of the Cauchy determinant identity:\nWe argue by induction on n. The case n = 1 is immediate.\n\nAssume the identity holds for size n \u2212 1. Set\nC = [c_{ij}] with c_{ij} = 1/(x_i + y_j), 1 \u2264 i, j \u2264 n,\nand consider det C as a function of x_1. Define\nP(x_1) = det C \u00b7 \u220f_{j=1}^n (x_1 + y_j).\nClaim 1: P(x_1) is a polynomial in x_1 of degree at most n \u2212 1.\n\nIndeed, det C is a rational function of x_1 with simple poles at x_1 = \u2212y_j, 1 \u2264 j \u2264 n. Multiplying by \u220f_j (x_1 + y_j) clears all poles, hence P is a polynomial. The degree bound follows from the fact that the expansion of det C along the first row shows it is O(x_1^{-1}) as x_1 \u2192 \u221e, so P(x_1) = O(x_1^{n\u22121}).\n\nClaim 2: P(x_1) has zeros at x_1 = x_k for each k = 2, ..., n.\n\nAt x_1 = x_k (k \u2265 2), the first and k-th rows of C become identical (because 1/(x_1 + y_j) = 1/(x_k + y_j)), so det C = 0. Since none of the factors x_1 + y_j vanish at x_1 = x_k (by assumption x_k + y_j \u2260 0), P(x_k) = 0. Hence P(x_1) has the n \u2212 1 distinct zeros x_2, ..., x_n, and therefore\nP(x_1) = \u03b1 \u220f_{k=2}^n (x_1 \u2212 x_k)\nfor some constant \u03b1 independent of x_1 (but possibly depending on x_2, ..., x_n and y_1, ..., y_n).\n\nWe determine \u03b1 by evaluating the limit at each simple pole x_1 = \u2212y_j. On one hand,\nlim_{x_1 \u2192 \u2212y_j} P(x_1)\n= lim_{x_1 \u2192 \u2212y_j} [(x_1 + y_j) det C] \u00b7 \u220f_{h \u2260 j} (x_1 + y_h)\n= [lim_{x_1 \u2192 \u2212y_j} (x_1 + y_j) det C] \u00b7 \u220f_{h \u2260 j} (\u2212y_j + y_h).\nExpanding det C along row 1,\ndet C = \u2211_{\u2113=1}^n (\u22121)^{1+\u2113} (1/(x_1 + y_\u2113)) det C_{1\u2113},\nwhere C_{1\u2113} is the (n \u2212 1) \u00d7 (n \u2212 1) minor obtained by deleting row 1 and column \u2113. Thus\nlim_{x_1 \u2192 \u2212y_j} (x_1 + y_j) det C = (\u22121)^{1+j} det C_{1j} evaluated at x_1 = \u2212y_j,\nand for \u2113 \u2260 j, the entries 1/(x_1 + y_\u2113) in the first row of C_{1j} tend to 1/(y_\u2113 \u2212 y_j), finite. Therefore\nlim_{x_1 \u2192 \u2212y_j} P(x_1) = (\u22121)^{1+j} [det C_{1j} with x_1 replaced by \u2212y_j] \u00b7 \u220f_{h \u2260 j} (y_h \u2212 y_j).\n\nOn the other hand, from P(x_1) = \u03b1 \u220f_{k=2}^n (x_1 \u2212 x_k),\nlim_{x_1 \u2192 \u2212y_j} P(x_1) = \u03b1 \u220f_{k=2}^n (\u2212y_j \u2212 x_k) = (\u22121)^{n\u22121} \u03b1 \u220f_{k=2}^n (x_k + y_j).\n\nEquating the two expressions for the limit at x_1 = \u2212y_j gives\n(\u22121)^{n\u22121} \u03b1 \u220f_{k=2}^n (x_k + y_j) = (\u22121)^{1+j} det C_{1j}(x_1 := \u2212y_j) \u00b7 \u220f_{h \u2260 j} (y_h \u2212 y_j).\nHence\n\u03b1 = (\u22121)^{n+j} [det C_{1j}(x_1 := \u2212y_j)] \u00b7 [\u220f_{h \u2260 j} (y_h \u2212 y_j)] / [\u220f_{k=2}^n (x_k + y_j)].\n\nNow identify the minor det C_{1j}(x_1 := \u2212y_j). Removing row 1 and column j leaves the (n \u2212 1) \u00d7 (n \u2212 1) Cauchy matrix with rows indexed by i = 2, ..., n (variables x_2, ..., x_n) and columns by the y-set with y_j omitted, namely\nC_{1j} = [1/(x_i + y_h)]_{2 \u2264 i \u2264 n, h \u2208 {1, ..., n} \\ {j}}.\nBy the induction hypothesis,\ndet C_{1j} = [\u220f_{2 \u2264 i < k \u2264 n} (x_k \u2212 x_i)] [\u220f_{1 \u2264 h < \u2113 \u2264 n, h,\u2113 \u2260 j} (y_\u2113 \u2212 y_h)] / [\u220f_{i=2}^n \u220f_{h \u2260 j} (x_i + y_h)].\n\nSubstituting this into \u03b1 and simplifying yields\n\u03b1 = (\u22121)^{n+j} \u00b7 [\u220f_{2 \u2264 i < k \u2264 n} (x_k \u2212 x_i)] \u00b7 [\u220f_{1 \u2264 h < \u2113 \u2264 n, h,\u2113 \u2260 j} (y_\u2113 \u2212 y_h)] \u00b7 [\u220f_{h \u2260 j} (y_h \u2212 y_j)]\n/ [\u220f_{i=2}^n \u220f_{h \u2260 j} (x_i + y_h) \u00b7 \u220f_{k=2}^n (x_k + y_j)].\n\nNote that [\u220f_{1 \u2264 h < \u2113 \u2264 n, h,\u2113 \u2260 j} (y_\u2113 \u2212 y_h)] \u00b7 [\u220f_{h \u2260 j} (y_h \u2212 y_j)] equals (\u22121)^{j\u22121} \u220f_{1 \u2264 h < \u2113 \u2264 n} (y_\u2113 \u2212 y_h). Indeed, including the missing pairs with j contributes exactly j \u2212 1 sign changes. Also\n[\u220f_{i=2}^n \u220f_{h \u2260 j} (x_i + y_h)] \u00b7 [\u220f_{k=2}^n (x_k + y_j)] = \u220f_{i=2}^n \u220f_{h=1}^n (x_i + y_h).\n\nTherefore\n\u03b1 = (\u22121)^{n + j} (\u22121)^{j \u2212 1} [\u220f_{2 \u2264 i < k \u2264 n} (x_k \u2212 x_i)] [\u220f_{1 \u2264 h < \u2113 \u2264 n} (y_\u2113 \u2212 y_h)] / [\u220f_{i=2}^n \u220f_{h=1}^n (x_i + y_h)]\n= (\u22121)^{n \u2212 1} [\u220f_{2 \u2264 i < k \u2264 n} (x_k \u2212 x_i)] [\u220f_{1 \u2264 h < \u2113 \u2264 n} (y_\u2113 \u2212 y_h)] / [\u220f_{i=2}^n \u220f_{h=1}^n (x_i + y_h)].\n\nNow return to\ndet C = P(x_1) / \u220f_{j=1}^n (x_1 + y_j) = \u03b1 [\u220f_{k=2}^n (x_1 \u2212 x_k)] / [\u220f_{j=1}^n (x_1 + y_j)].\nCombine the x-factors:\n[\u220f_{2 \u2264 i < k \u2264 n} (x_k \u2212 x_i)] [\u220f_{k=2}^n (x_1 \u2212 x_k)] = (\u22121)^{n \u2212 1} \u220f_{1 \u2264 i < k \u2264 n} (x_k \u2212 x_i),\nsince \u220f_{k=2}^n (x_1 \u2212 x_k) = (\u22121)^{n \u2212 1} \u220f_{k=2}^n (x_k \u2212 x_1). Multiplying by the outside factor (\u22121)^{n \u2212 1} in \u03b1 cancels the sign, yielding\ndet C = [\u220f_{1 \u2264 i < k \u2264 n} (x_k \u2212 x_i)] [\u220f_{1 \u2264 h < \u2113 \u2264 n} (y_\u2113 \u2212 y_h)] / [\u220f_{i=1}^n \u220f_{h=1}^n (x_i + y_h)].\n\nThis completes the induction and the proof.\n\nHilbert matrix determinant:\nSet x_i = i \u2212 1 and y_j = j, 1 \u2264 i, j \u2264 n. Then (x_i + y_j) = i + j \u2212 1, and the differences are x_j \u2212 x_i = j \u2212 i and y_j \u2212 y_i = j \u2212 i. Applying the Cauchy formula,\ndet(H_n) = \u220f_{1 \u2264 i < j \u2264 n} (j \u2212 i)^2 / \u220f_{i=1}^n \u220f_{j=1}^n (i + j \u2212 1).\n\nWe now rewrite both numerator and denominator as compact products.\n\n- Numerator: The Vandermonde product over 1, 2, ..., n is\n\u220f_{1 \u2264 i < j \u2264 n} (j \u2212 i) = \u220f_{k=1}^{n\u22121} k!.\nHence\n\u220f_{1 \u2264 i < j \u2264 n} (j \u2212 i)^2 = [\u220f_{k=1}^{n\u22121} k!]^2.\n\n- Denominator: The multiset {i + j \u2212 1 : 1 \u2264 i, j \u2264 n} consists of integers t from 1 to 2n \u2212 1, where t appears with multiplicity min(t, 2n \u2212 t). Thus\n\u220f_{i=1}^n \u220f_{j=1}^n (i + j \u2212 1) = \u220f_{t=1}^{2n\u22121} t^{min(t, 2n \u2212 t)}.\n\nTherefore a clean product form is\ndet(H_n) = [\u220f_{k=1}^{n\u22121} (k!)]^2 / [\u220f_{t=1}^{2n\u22121} t^{min(t, 2n \u2212 t)}].\n\nAn equivalent, more symmetric closed form is\ndet(H_n) = [\u220f_{k=1}^{n\u22121} (k!)^4] / [\u220f_{k=1}^{2n\u22121} k^{2n \u2212 k}].\nTo see the equivalence, note that\n\u220f_{t=1}^{2n\u22121} t^{2n \u2212 t} = [\u220f_{t=1}^{2n\u22121} t^{min(t, 2n \u2212 t)}] \u00b7 [\u220f_{t=1}^{2n\u22121} t^{max(t, 2n \u2212 t)}].\nBut max(t, 2n \u2212 t) equals t for t \u2265 n and equals 2n \u2212 t for t \u2264 n, yielding\n\u220f_{t=1}^{2n\u22121} t^{max(t, 2n \u2212 t)} = [\u220f_{t=1}^{n\u22121} t^{n \u2212 t}] \u00b7 [\u220f_{t=n}^{2n\u22121} t^{t \u2212 n}] = [\u220f_{k=1}^{n\u22121} k!]^{2}.\nCombining gives precisely the second form.\n\nFinal closed form for det(H_n):\ndet(H_n) = [\u220f_{k=1}^{n\u22121} (k!)^4] / [\u220f_{k=1}^{2n\u22121} k^{2n \u2212 k}] = [\u220f_{k=1}^{n\u22121} (k!)]^2 / [\u220f_{t=1}^{2n\u22121} t^{min(t, 2n \u2212 t)}].\n\nBoth expressions are exact and equal, and either may be presented as the final answer."
    },
    {
        "question": "Prove the Combinatorial Nullstellensatz and use it to establish the Erd\u0151s\u2013Heilbronn restricted sumset inequality over a prime field.\n\nDefinitions:\n- Let F be a field. For a polynomial f \u2208 F[x_1,\u2026,x_n], define its total degree deg f as the maximum, over all monomials x_1^{\u03b1_1}\u22efx_n^{\u03b1_n} with nonzero coefficient in f, of \u03b1_1+\u22ef+\u03b1_n. For a multi-index t = (t_1,\u2026,t_n) of nonnegative integers, denote by [x_1^{t_1}\u22efx_n^{t_n}] f the coefficient of that monomial in f.\n- For a prime p, write F_p for the field Z/pZ. For A \u2282 F_p finite, define the restricted sumset A \u2295 A = {a+b : a,b \u2208 A, a \u2260 b}.\n\nTasks:\n1) Combinatorial Nullstellensatz (CNS). Prove the following.\nLet f \u2208 F[x_1,\u2026,x_n] be a polynomial and suppose there exist nonnegative integers t_1,\u2026,t_n with t_1+\u22ef+t_n = deg f such that c := [x_1^{t_1}\u22efx_n^{t_n}] f \u2260 0. If S_1,\u2026,S_n \u2282 F are finite sets with |S_i| > t_i for all i, then there exist s_i \u2208 S_i such that f(s_1,\u2026,s_n) \u2260 0.\n\nYou should give a complete, self-contained proof. You may use basic univariate Lagrange interpolation, but no external theorems.\n\n2) Erd\u0151s\u2013Heilbronn (restricted sumset over F_p). Let p be prime and let A \u2282 F_p have size m \u2265 2. Prove that\n|A \u2295 A| \u2265 min{p, 2m \u2212 3}.\nYour proof must be self-contained and rigorous and must use part (1). Hints for the hard case p \u2265 2m \u2212 3: argue by contradiction, cover A \u2295 A by a small set C and consider the polynomial\nG(x,y) = (x \u2212 y) \u220f_{c\u2208C} (x + y \u2212 c)\non S_1 = S_2 = A; compute a specific top-degree coefficient of G and apply CNS with suitable (t_1,t_2). For the complementary case 2m \u2212 3 > p, finish by a direct combinatorial argument (e.g., intersect A with translates of itself).\n\nAnswer format:\n- State and prove the Combinatorial Nullstellensatz.\n- Then prove the Erd\u0151s\u2013Heilbronn inequality in full, handling the cases p \u2265 2m \u2212 3 and p < 2m \u2212 3.\n- Clearly identify the crucial coefficient you compute in G and why it is nonzero in F_p in the CNS step.",
        "answer": "We prove (1) and then derive (2).\n\nPart 1) Combinatorial Nullstellensatz (CNS).\n\nStatement. Let F be a field, f \u2208 F[x_1,\u2026,x_n], and let t_1,\u2026,t_n be nonnegative integers with t_1+\u22ef+t_n = deg f. Assume c := [x_1^{t_1}\u22efx_n^{t_n}] f \u2260 0. If finite sets S_i \u2282 F satisfy |S_i| > t_i for all i, then there exist s_i \u2208 S_i with f(s_1,\u2026,s_n) \u2260 0.\n\nProof.\nStep 1: Univariate Lagrange basis. For a finite nonempty set S \u2282 F and s \u2208 S, define the Lagrange polynomial\nL_{S,s}(x) := \u220f_{a\u2208S, a\u2260s} (x \u2212 a)/(s \u2212 a).\nThen L_{S,s}(a) = 0 for a \u2208 S, a \u2260 s, and L_{S,s}(s) = 1. Moreover, for any polynomial h \u2208 F[x] with deg h < |S|, we have the interpolation identity\nh(x) = \u2211_{s\u2208S} h(s) L_{S,s}(x).\n\nStep 2: Multivariate interpolation on a rectangular grid. Let S_1,\u2026,S_n be finite sets with sizes N_i := |S_i|. For each i and s_i \u2208 S_i, define L_{i,s_i}(x_i) := L_{S_i,s_i}(x_i). For any polynomial H \u2208 F[x_1,\u2026,x_n] with deg_{x_i} H < N_i for all i, we claim\nH(x_1,\u2026,x_n) = \u2211_{(s_1,\u2026,s_n)\u2208S_1\u00d7\u22ef\u00d7S_n} H(s_1,\u2026,s_n) \u220f_{i=1}^n L_{i,s_i}(x_i).\nIndeed, fix all variables except x_1 and apply univariate interpolation in x_1; then iterate over x_2,\u2026,x_n. This is a straightforward induction on n.\n\nStep 3: Reduction modulo the vanishing polynomials on S_i. For each i, let\ng_i(x_i) := \u220f_{a\u2208S_i} (x_i \u2212 a) \u2208 F[x_i].\nGiven f \u2208 F[x_1,\u2026,x_n], repeatedly divide by g_1, g_2, \u2026, g_n to obtain polynomials Q_i and a remainder R with\nf = \u2211_{i=1}^n Q_i(x_1,\u2026,x_n) g_i(x_i) + R(x_1,\u2026,x_n),\nand deg_{x_i} R < N_i for all i. This is standard multivariate division by univariate polynomials in each variable.\n\nFor any point (s_1,\u2026,s_n) \u2208 S_1\u00d7\u22ef\u00d7S_n we have g_i(s_i) = 0, hence f(s_1,\u2026,s_n) = R(s_1,\u2026,s_n). In particular, if f vanishes on S_1\u00d7\u22ef\u00d7S_n, then R vanishes on that grid.\n\nStep 4: Preservation of the target coefficient. Let t_1,\u2026,t_n be as in the hypothesis and assume N_i > t_i for all i. Observe that every monomial in Q_i(x_1,\u2026,x_n) g_i(x_i) has exponent in x_i at least N_i. Since t_i < N_i, the monomial x_1^{t_1}\u22efx_n^{t_n} cannot appear in any Q_i g_i. Therefore,\n[x_1^{t_1}\u22efx_n^{t_n}] f = [x_1^{t_1}\u22efx_n^{t_n}] R.\n\nStep 5: Conclusion by interpolation. Since deg_{x_i} R < N_i, Step 2 implies\nR(x_1,\u2026,x_n) = \u2211_{s\u2208S_1\u00d7\u22ef\u00d7S_n} R(s) \u220f_{i=1}^n L_{i,s_i}(x_i).\nIf f vanishes on S_1\u00d7\u22ef\u00d7S_n, then R vanishes there, so R \u2261 0. Hence [x_1^{t_1}\u22efx_n^{t_n}] R = 0, and by Step 4 also [x_1^{t_1}\u22efx_n^{t_n}] f = 0, contradicting the hypothesis. Therefore f cannot vanish on all of S_1\u00d7\u22ef\u00d7S_n; some point yields f \u2260 0. This proves CNS.\n\nPart 2) Erd\u0151s\u2013Heilbronn restricted sumset inequality over F_p.\n\nStatement. Let p be prime and A \u2282 F_p of size m \u2265 2. Then\n|A \u2295 A| \u2265 min{p, 2m \u2212 3}.\n\nWe split into two cases.\n\nCase I: p \u2265 2m \u2212 3 (the hard case via CNS).\nAssume for contradiction that |A \u2295 A| \u2264 2m \u2212 4. Then there exists a set C \u2282 F_p with |C| = 2m \u2212 4 such that\na + b \u2208 C for all distinct a,b \u2208 A.\n\nDefine the polynomial over F_p:\nG(x,y) := (x \u2212 y) \u220f_{c\u2208C} (x + y \u2212 c).\nProperties:\n- For any a,b \u2208 A with a \u2260 b, we have a + b \u2208 C, hence the factor (x + y \u2212 c) vanishes at (a,b) for c = a+b. Thus G(a,b) = 0.\n- For any a \u2208 A, G(a,a) = 0 because of the factor (x \u2212 y).\nTherefore G vanishes on A \u00d7 A.\n\nWe will apply CNS with n = 2, S_1 = S_2 = A, and exponents\nt_1 = m \u2212 1, t_2 = m \u2212 2,\nso that t_1 + t_2 = 2m \u2212 3 = deg G. Note that |S_1| = |S_2| = m satisfy |S_i| > t_i.\n\nThus, to invoke CNS, it suffices to show that the coefficient\nc := [x^{m\u22121} y^{m\u22122}] G(x,y)\nis nonzero in F_p. We now compute c.\n\nWrite q := |C| = 2m \u2212 4. Let\nH(x,y) := \u220f_{c\u2208C} (x + y \u2212 c) = (x + y)^q + terms of total degree < q.\nOnly the top-degree homogeneous part of H contributes to the top-degree of G, because deg G = q + 1 and we are extracting a coefficient of total degree q + 1. Therefore, the desired coefficient is the same as that in\n(x \u2212 y)(x + y)^q.\n\nThe binomial expansion gives\n(x + y)^q = \u2211_{j=0}^q binom(q, j) x^j y^{q\u2212j}.\nMultiplying by (x \u2212 y) and extracting the coefficient of x^{m\u22121} y^{m\u22122} yields\nc = [x^{m\u22121} y^{m\u22122}] x (x + y)^q \u2212 [x^{m\u22121} y^{m\u22122}] y (x + y)^q\n  = [x^{m\u22122} y^{m\u22122}] (x + y)^q \u2212 [x^{m\u22121} y^{m\u22123}] (x + y)^q\n  = binom(q, m\u22122) \u2212 binom(q, m\u22121).\n\nWith q = 2m \u2212 4, a standard identity gives\nbinom(q, k) \u2212 binom(q, k+1) = binom(q, k) \u00b7 (2k + 1 \u2212 q)/(k + 1).\nTaking k = m \u2212 2, we have 2k + 1 \u2212 q = 2(m \u2212 2) + 1 \u2212 (2m \u2212 4) = 1, hence\nc = binom(2m \u2212 4, m \u2212 2) \u2212 binom(2m \u2212 4, m \u2212 1)\n  = binom(2m \u2212 4, m \u2212 2)/(m \u2212 1).\n\nWe now check that c \u2260 0 in F_p under the present hypothesis p \u2265 2m \u2212 3.\n- Since 2m \u2212 4 \u2264 p \u2212 1, the integers 1,2,\u2026,2m \u2212 4 are all nonzero in F_p, so (2m \u2212 4)! is invertible in F_p, as are (m \u2212 2)! and (m \u2212 2)! (again), hence binom(2m \u2212 4, m \u2212 2) is a nonzero element of F_p.\n- Also, m \u2212 1 \u2264 2m \u2212 3 \u2264 p, so m \u2212 1 is nonzero in F_p. Therefore 1/(m \u2212 1) exists in F_p.\n\nConsequently c \u2260 0 in F_p.\n\nApplying CNS to G with S_1 = S_2 = A and (t_1,t_2) = (m\u22121,m\u22122), we conclude there exist a,b \u2208 A with G(a,b) \u2260 0, contradicting the fact that G vanishes on A \u00d7 A. This contradiction shows that our assumption |A \u2295 A| \u2264 2m \u2212 4 is false. Therefore, in Case I we must have\n|A \u2295 A| \u2265 2m \u2212 3.\n\nCase II: 2m \u2212 3 > p (the large-set case).\nWe show |A \u2295 A| = p, i.e., every c \u2208 F_p can be written as c = a + b with a,b \u2208 A, a \u2260 b.\n\nFix c \u2208 F_p and consider the translate c \u2212 A = {c \u2212 a : a \u2208 A}. Both A and c \u2212 A have size m. By the pigeonhole principle,\n|A \u2229 (c \u2212 A)| \u2265 |A| + |c \u2212 A| \u2212 p = 2m \u2212 p.\nUnder the present hypothesis 2m \u2212 3 > p, we have 2m \u2212 p \u2265 3. Thus A \u2229 (c \u2212 A) contains at least three elements. At most one of these can be equal to c/2 (since the congruence 2a = c has at most one solution in F_p). Therefore, there exists a \u2208 A \u2229 (c \u2212 A) with a \u2260 c/2. For this a we have c \u2212 a \u2208 A and c = a + (c \u2212 a) with a \u2260 c \u2212 a, as desired. Since c was arbitrary, |A \u2295 A| = p.\n\nCombining the two cases, for all primes p and all A \u2282 F_p with |A| = m \u2265 2,\n|A \u2295 A| \u2265 min{p, 2m \u2212 3},\nwhich is the Erd\u0151s\u2013Heilbronn inequality.\n\nRemarks.\n- The coefficient computation crucially used only the top homogeneous part of H(x,y) = \u220f_{c\u2208C} (x + y \u2212 c), which is (x + y)^{|C|}, hence independent of the specific set C. This is why the argument works uniformly for any covering set C of A \u2295 A with |C| \u2264 2m \u2212 4.\n- The choice (t_1,t_2) = (m \u2212 1, m \u2212 2) matches deg G = 2m \u2212 3 and the sizes |S_i| = m so that |S_i| > t_i holds, enabling CNS.\n\nThis completes the proofs of (1) and (2)."
    },
    {
        "question": "Title: Kronecker\u2013Chebyshev classification of algebraic integers with all conjugates in [\u22122,2], and a cyclotomic factorization of Chebyshev polynomials\n\nLet \u03b1 be an algebraic integer. Recall:\n- An algebraic integer is a complex number that is a root of a monic polynomial with integer coefficients.\n- The Galois conjugates of \u03b1 are the images of \u03b1 under all embeddings of Q(\u03b1) into C; equivalently, they are the roots of the minimal polynomial of \u03b1 over Q.\n- A root of unity is a complex number \u03b6 with \u03b6^n = 1 for some n \u2265 1.\n- The nth cyclotomic polynomial \u03a6_n(z) is the monic polynomial with roots the primitive nth roots of unity; deg \u03a6_n = \u03c6(n), Euler\u2019s totient.\n- The Chebyshev polynomials of the first kind T_m are the unique polynomials with T_m(cos \u03b8) = cos(m\u03b8) for all real \u03b8.\n\nDefine, for n \u2265 1, the real cyclotomic polynomial C_n(x) to be the minimal polynomial over Q of 2 cos(2\u03c0/n). Convention: C_1(x) = x \u2212 2, C_2(x) = x + 2. For n \u2265 3, its degree is \u03c6(n)/2.\n\nTasks:\n1) Kronecker\u2019s unit-disk lemma (self-contained). Prove: If \u03b2 is an algebraic integer and all its Galois conjugates satisfy |\u03b2'| \u2264 1, then \u03b2 = 0 or \u03b2 is a root of unity.\n\n2) Classification in [\u22122,2]. Prove: If \u03b1 is an algebraic integer and all of its conjugates lie in [\u22122,2], then \u03b1 = \u03b6 + \u03b6^{-1} for some root of unity \u03b6 (equivalently, \u03b1 = 2 cos(2\u03c0 a/n) for integers a, n with gcd(a,n) = 1). In particular, the minimal polynomial of \u03b1 equals C_n(x) for some n, and C_n(x) \u2208 Z[x].\n\n3) Cyclotomic\u2013real cyclotomic identity. For n \u2265 3, prove the identity\n\u03a6_n(z) = z^{\u03c6(n)/2} C_n(z + z^{-1}).\nHandle n = 1, 2 separately by the conventions above.\n\n4) Classification of integer polynomials with spectrum in [\u22122,2]. Show that a monic polynomial P \u2208 Z[x] has all complex roots in [\u22122,2] if and only if P is a product (with multiplicities) of the polynomials C_n(x), n \u2265 1.\n\n5) Chebyshev factorization. Prove the explicit factorization, valid for every integer m \u2265 1:\n2(T_m(x/2) \u2212 1) = C_1(x) C_2(x)^{\u03b5(m)} \u220f_{d | m, d \u2265 3} C_d(x)^2,\nwhere \u03b5(m) = 1 if 2 | m and \u03b5(m) = 0 otherwise.\n\nAnswer format:\n- Provide a complete, rigorous proof of each task, self-contained (you may use only what is defined above).\n- Clearly indicate where you use Task (1).\n- For Task (3), justify integrality and monicity of both sides and identify their sets of roots.\n- For Task (5), derive the factorization from Task (3) and the identity T_m((z + z^{-1})/2) = (z^m + z^{-m})/2.",
        "answer": "We proceed in five steps, as requested.\n\n1) Kronecker\u2019s unit-disk lemma\n\nStatement. If \u03b2 is an algebraic integer and all of its Galois conjugates \u03b2_1, \u2026, \u03b2_r satisfy |\u03b2_i| \u2264 1, then either \u03b2 = 0 or \u03b2 is a root of unity.\n\nProof.\n- Let the conjugates of \u03b2 be \u03b2_1, \u2026, \u03b2_r (so r = deg_Q \u03b2). For each n \u2265 1 define the monic polynomial\nP_n(x) := \u220f_{i=1}^r (x \u2212 \u03b2_i^n).\nWe claim P_n \u2208 Z[x] for all n.\nIndeed, the coefficients of P_n are the elementary symmetric polynomials in the \u03b2_i^n. Each \u03b2_i is an algebraic integer, hence so is \u03b2_i^n. Being symmetric in the conjugates of \u03b2, those coefficients are fixed by every embedding Q(\u03b2) \u2192 C (the embeddings permute the \u03b2_i, and hence they permute the multiset {\u03b2_i^n} without changing the symmetric sums). Thus each coefficient lies in Q and in the ring of algebraic integers; hence it is an integer. So P_n \u2208 Z[x].\n\n- For 0 \u2264 k \u2264 r, denote by e_k(n) the k-th elementary symmetric sum in the \u03b2_i^n, i.e., the coefficient (up to sign) of x^{r-k} in P_n. Since |\u03b2_i| \u2264 1, we have |\u03b2_i^n| \u2264 1. Therefore, for each k,\n|e_k(n)| \u2264 C_k := binom(r, k),\nbecause e_k(n) is a sum of binom(r,k) terms, each of modulus at most 1.\nThus each coefficient of P_n is an integer bounded independently of n, so the set {P_n : n \u2265 1} is finite.\n\n- Hence there exist integers 1 \u2264 m < n with P_m = P_n. Equality of polynomials implies equality of multisets of roots:\n{\u03b2_1^m, \u2026, \u03b2_r^m} = {\u03b2_1^n, \u2026, \u03b2_r^n}.\nSo for each i there exists a permutation \u03c0 of {1,\u2026,r} such that \u03b2_i^n = \u03b2_{\u03c0(i)}^m. Iterating, for each \u2113 \u2265 1 we get \u03b2_i^{n^\u2113} = \u03b2_{\u03c0^\u2113(i)}^{m^\u2113}. Let L be the order of \u03c0 (finite since \u03c0 is a permutation), so that \u03c0^L = id. Then\n\u03b2_i^{n^L} = \u03b2_i^{m^L} for every i.\nThus (for each i) either \u03b2_i = 0 or \u03b2_i is a root of unity (if \u03b2_i \u2260 0 then \u03b2_i^{n^L - m^L} = 1 with n^L \u2260 m^L). In particular, \u03b2 itself is 0 or a root of unity.\nThis proves the lemma.\n\n2) Classification in [\u22122,2]\n\nLet \u03b1 be an algebraic integer, deg d, with conjugates \u03b1_1, \u2026, \u03b1_d all real and lying in [\u22122,2]. Let P(x) = \u2211_{k=0}^d a_k x^k \u2208 Z[x] be the minimal polynomial of \u03b1 (monic, so a_d = 1).\n\nDefine the polynomial R(z) by\nR(z) := z^d P(z + z^{-1}) \u2208 Z[z].\nIndeed, since P is monic of degree d, the substitution x = z + z^{-1} produces a Laurent polynomial with highest z-exponent +d and lowest \u2212d; multiplying by z^d clears denominators and yields a monic polynomial in z of degree 2d with integer coefficients.\n\nClaim. Every root of R lies on the unit circle {|z| = 1}.\nProof. Let \u03b1_j \u2208 [\u22122,2]. The quadratic equation z^2 \u2212 \u03b1_j z + 1 = 0 has roots z_j^{\u00b1} = (\u03b1_j \u00b1 i\u221a(4 \u2212 \u03b1_j^2))/2. For |\u03b1_j| \u2264 2, these satisfy |z_j^{\u00b1}| = 1 (they are e^{\u00b1i\u03b8_j} with cos \u03b8_j = \u03b1_j/2). One checks directly that\nz^d P(z + z^{-1}) = \u220f_{j=1}^d (z \u2212 z_j^+)(z \u2212 z_j^-),\nso all roots of R lie on the unit circle.\n\nSince R is monic with integer coefficients, each root \u03c9 of R is an algebraic integer. Moreover, the minimal polynomial of \u03c9 divides R, hence all conjugates of \u03c9 also lie on the unit circle (they are a subset of the roots of R). By Task (1), \u03c9 must be a root of unity (\u03c9 \u2260 0 because |\u03c9| = 1). Therefore, for each j, there exists a root of unity \u03b6_j with\n\u03b1_j = \u03b6_j + \u03b6_j^{-1}.\nIn particular, \u03b1 = \u03b6 + \u03b6^{-1} for some root of unity \u03b6.\n\nFinally, choose n = ord(\u03b6). Then \u03b1 = 2 cos(2\u03c0 a/n) for some a coprime to n. Its minimal polynomial is the minimal polynomial of \u03b6 + \u03b6^{-1}, which we denote C_n(x). To see C_n(x) \u2208 Z[x], note that the set\nS_n := {2 cos(2\u03c0 k/n) : 1 \u2264 k \u2264 n, gcd(k,n)=1}\nis closed under the action of Gal(Q(\u03b6)/Q), and the polynomial\nC_n(x) := \u220f_{\u03b8 \u2208 S_n, 0 < \u03b8 \u2264 \u03c0} (x \u2212 2 cos \u03b8)\nhas coefficients that are symmetric polynomials in the \u03b6^k + \u03b6^{-k}, hence algebraic integers fixed by the Galois group, hence integers. For n \u2265 3 the map k \u21a6 \u00b1k shows each value appears exactly twice among the primitive nth roots, so deg C_n = \u03c6(n)/2; our conventions C_1(x) = x \u2212 2 and C_2(x) = x + 2 handle the remaining cases. This completes Task (2).\n\n3) Cyclotomic\u2013real cyclotomic identity\n\nClaim. For n \u2265 3,\n\u03a6_n(z) = z^{\u03c6(n)/2} C_n(z + z^{-1}).\nProof. Consider the zeros. The zeros of \u03a6_n are the primitive nth roots of unity \u03b6 with ord(\u03b6)=n. For such \u03b6, set x = \u03b6 + \u03b6^{-1} = 2 cos(2\u03c0 k/n) with gcd(k,n)=1. Then x is a root of C_n, by definition. Conversely, given a root x of C_n, the equation z + z^{-1} = x has two solutions z, z^{-1}, which are primitive nth roots of unity (for n \u2265 3, \u03b6 \u2260 \u03b6^{-1}). Thus the zeros of z^{\u03c6(n)/2} C_n(z + z^{-1}) are precisely the primitive nth roots of unity, each with multiplicity 1. The degree is \u03c6(n), and the coefficient of z^{\u03c6(n)} is 1, because C_n is monic of degree \u03c6(n)/2 and the leading term of C_n(z + z^{-1}) contributes z^{\u2212\u03c6(n)/2} + \u00b7\u00b7\u00b7 + z^{\u03c6(n)/2}, so multiplying by z^{\u03c6(n)/2} makes the leading coefficient 1. Therefore both sides are monic of degree \u03c6(n) with the same zeros, hence they are equal. (For n = 1,2 the identity needs to be interpreted via the conventions C_1(x) = x \u2212 2, C_2(x) = x + 2; the stated formula is asserted only for n \u2265 3.)\n\n4) Classification of monic integer polynomials with spectrum in [\u22122,2]\n\nSuppose P \u2208 Z[x] is monic and all complex roots of P lie in [\u22122,2]. Let its (complex) roots be \u03b1_1, \u2026, \u03b1_t (with multiplicity). By Task (2), each \u03b1_j equals \u03b6_j + \u03b6_j^{-1} for some root of unity \u03b6_j. The minimal polynomial of \u03b1_j is C_{n_j}, where n_j = ord(\u03b6_j). By Gauss\u2019s lemma, the minimal polynomials C_{n_j} \u2208 Z[x] divide P in Z[x]. Therefore P is a product of powers of these C_n\u2019s.\n\nConversely, every C_n has all roots in [\u22122,2] by construction, so every product of the C_n\u2019s also has all roots in [\u22122,2]. This completes the classification.\n\n5) Chebyshev factorization\n\nWe use the identity\nT_m((z + z^{-1})/2) = (z^m + z^{-m})/2\n(valid for all m \u2265 0 and z \u2260 0; it is an immediate consequence of T_m(cos \u03b8) = cos(m\u03b8) with z = e^{i\u03b8}).\n\nThen\n2 T_m((z + z^{-1})/2) \u2212 2 = z^{-m}(z^m \u2212 1)^2.\nFactor z^m \u2212 1 = \u220f_{d | m} \u03a6_d(z), to get\n2 T_m((z + z^{-1})/2) \u2212 2 = z^{-m} \u220f_{d | m} \u03a6_d(z)^2.\n\nRegroup the factors according to d:\n- For d \u2265 3, by Task (3), \u03a6_d(z) = z^{\u03c6(d)/2} C_d(z + z^{-1}). Hence \u03a6_d(z)^2 = z^{\u03c6(d)} C_d(z + z^{-1})^2.\n- For d = 1, \u03a6_1(z) = z \u2212 1 and the identity\nC_1(z + z^{-1}) = (z + z^{-1}) \u2212 2 = (z \u2212 1)^2 / z\nimplies (z \u2212 1)^2 = z C_1(z + z^{-1}).\n- For d = 2 (which appears only if 2 | m), \u03a6_2(z) = z + 1 and\nC_2(z + z^{-1}) = (z + z^{-1}) + 2 = (z + 1)^2 / z\ngives (z + 1)^2 = z C_2(z + z^{-1}).\n\nTherefore,\nz^{-m} \u220f_{d | m} \u03a6_d(z)^2\n= z^{-m} \u00b7 (z \u2212 1)^2 \u00b7 (z + 1)^{2\u00b71_{2|m}} \u00b7 \u220f_{d | m, d \u2265 3} z^{\u03c6(d)} C_d(z + z^{-1})^2\n= z^{-m} \u00b7 z^{1 + 1_{2|m}} \u00b7 \u220f_{d | m, d \u2265 3} z^{\u03c6(d)} \u00b7 C_1(z + z^{-1}) \u00b7 C_2(z + z^{-1})^{1_{2|m}} \u00b7 \u220f_{d | m, d \u2265 3} C_d(z + z^{-1})^2.\n\nUsing \u2211_{d | m} \u03c6(d) = m, we have\n1 + 1_{2|m} + \u2211_{d | m, d \u2265 3} \u03c6(d) = m,\nso all powers of z cancel. Hence\n2 T_m((z + z^{-1})/2) \u2212 2\n= C_1(z + z^{-1}) \u00b7 C_2(z + z^{-1})^{1_{2|m}} \u00b7 \u220f_{d | m, d \u2265 3} C_d(z + z^{-1})^2.\n\nFinally set x = z + z^{-1}. Since the right-hand side is a polynomial in x (by definition of the C_d), we obtain the factorization\n2(T_m(x/2) \u2212 1) = C_1(x) C_2(x)^{\u03b5(m)} \u220f_{d | m, d \u2265 3} C_d(x)^2,\nwith \u03b5(m) = 1 if 2 | m and \u03b5(m) = 0 otherwise, as claimed.\n\nRemarks.\n- The degrees match: deg of the left-hand side equals m (since T_m(x/2) has leading term 2^{m\u22121}(x/2)^m = x^m/2), while the right-hand side has degree 1 + \u03b5(m) + 2 \u00b7 \u2211_{d | m, d \u2265 3} \u03c6(d)/2 = 1 + \u03b5(m) + \u2211_{d | m, d \u2265 3} \u03c6(d) = m.\n- The identity compactly encodes the multiplicities of the roots x = 2 cos(2\u03c0 k/m): interior roots occur with multiplicity 2, while the endpoints x = 2 and x = \u22122 (the latter only if m is even) occur with multiplicity 1.\n\nThis completes all tasks."
    },
    {
        "question": "Title: Geometry of numbers to the full two-squares theorem \u2014 Blichfeldt, Minkowski, and a sharp arithmetic application\n\nLet R^n be equipped with the Lebesgue measure vol. A lattice L \u2282 R^n is a discrete subgroup spanned by n linearly independent vectors; its determinant det(L) is the Lebesgue volume of any fundamental parallelotope P = {\u2211_{i=1}^n t_i v_i : t_i \u2208 [0,1)} for a basis v_1,\u2026,v_n of L. A set K \u2282 R^n is convex if along with x,y \u2208 K it contains every tx + (1\u2212t)y for t \u2208 [0,1], and centrally symmetric if K = \u2212K.\n\nYour tasks:\n\n1) Blichfeldt\u2019s lemma (pigeonhole in the torus). Prove: If S \u2282 R^n is measurable with vol(S) > det(L), then there exist distinct x,y \u2208 S with x \u2212 y \u2208 L.\n\n2) Minkowski\u2019s convex body theorem. Deduce from (1): If K \u2282 R^n is convex, centrally symmetric, measurable, and vol(K) > 2^n det(L), then K contains a nonzero lattice point of L.\n\n3) Fermat\u2019s two-squares theorem for primes via Minkowski. For an odd prime p, prove Wilson\u2019s identity (p\u22121)! \u2261 \u22121 (mod p), and deduce that \u22121 is a quadratic residue mod p if and only if p \u2261 1 (mod 4). Then, for p \u2261 1 (mod 4), fix k with k^2 \u2261 \u22121 (mod p) and consider the index-p sublattice\nL_k = {(x,y) \u2208 Z^2 : x \u2261 k y (mod p)}.\nShow det(L_k) = p. Apply Minkowski to an explicit centrally symmetric convex body K \u2282 R^2 of your choice to produce a nonzero (x,y) \u2208 L_k with 0 < x^2 + y^2 < 2p, infer p | (x^2 + y^2), and conclude p = x^2 + y^2.\n\n4) Complete classification (Fermat\u2013Euler two-squares theorem). Prove that a positive integer n is a sum of two integer squares if and only if every prime q \u2261 3 (mod 4) appears with an even exponent in the prime factorization of n. Your proof must be self-contained and may use the multiplicative identity\n(x^2 + y^2)(u^2 + v^2) = (xu \u2212 yv)^2 + (xv + yu)^2.\nInclude the \u201conly if\u201d direction (divisibility constraint for primes 3 mod 4) and the \u201cif\u201d direction (assemble prime-power representations multiplicatively).\n\nAnswer format:\n- Present a complete proof of Blichfeldt\u2019s lemma.\n- Deduce Minkowski\u2019s theorem rigorously from Blichfeldt.\n- Prove Wilson\u2019s congruence and the criterion for \u22121 to be a square mod p. Compute det(L_k). Specify a concrete body K whose volume exceeds 4 det(L_k) and argue that the produced lattice vector gives p = x^2 + y^2.\n- Prove both directions of the full characterization of sums of two squares, clearly indicating where you use the prime case and the product identity.",
        "answer": "We work throughout with Lebesgue measure vol on R^n.\n\n1) Blichfeldt\u2019s lemma\n\nStatement. Let L \u2282 R^n be a lattice and S \u2282 R^n be measurable with vol(S) > det(L). Then there exist distinct x,y \u2208 S with x \u2212 y \u2208 L.\n\nProof. Fix a fundamental domain F for L, for instance a half-open parallelotope spanned by a lattice basis, so that the translates F + v, v \u2208 L, are pairwise essentially disjoint and cover R^n. Consider the family of sets S_v := (S \u2229 (F + v)) \u2212 v \u2282 F, v \u2208 L. These are measurable subsets of F, and their volumes add:\n\u2211_{v\u2208L} vol(S_v) = \u2211_{v\u2208L} vol(S \u2229 (F + v)) = vol(S) > det(L) = vol(F).\nIf the S_v were pairwise disjoint (up to null sets), the sum of their volumes could not exceed vol(F). Hence there exist distinct v,w \u2208 L and points x \u2208 S \u2229 (F+v), y \u2208 S \u2229 (F+w) with x \u2212 v = y \u2212 w, i.e. x \u2212 y = v \u2212 w \u2208 L. This proves the lemma.\n\n2) Minkowski\u2019s convex body theorem\n\nStatement. If K \u2282 R^n is measurable, convex, centrally symmetric (K = \u2212K), and vol(K) > 2^n det(L), then K contains a nonzero lattice point.\n\nProof. Consider S := (1/2)K = {z/2 : z \u2208 K}. Then S is measurable and vol(S) = vol(K)/2^n > det(L). By Blichfeldt\u2019s lemma there exist distinct x,y \u2208 S with x \u2212 y \u2208 L. Since K is centrally symmetric and convex, we have (1/2)K + (1/2)K = K, and also (1/2)K \u2212 (1/2)K = K (because \u2212(1/2)K = (1/2)K). Thus x \u2212 y \u2208 (1/2)K \u2212 (1/2)K = K. Because x \u2260 y, we get a nonzero lattice point x \u2212 y \u2208 L \u2229 K.\n\n3) Prime case p \u2261 1 (mod 4): p = x^2 + y^2\n\nWilson\u2019s theorem and \u22121 as a square. For an odd prime p, the multiplicative inverses mod p pair up the residues 1,\u2026,p\u22121, and the only elements congruent to their own inverse are 1 and \u22121. Hence\n(p \u2212 1)! \u2261 1 \u00b7 (\u22121) \u00b7 \u220f_{a \u2208 A} a a^{-1} \u2261 \u22121 (mod p),\nwhere A ranges over a set of representatives of inverse pairs. Writing\n(p \u2212 1)! = \u220f_{j=1}^{(p\u22121)/2} j (p \u2212 j) \u2261 \u220f_{j=1}^{(p\u22121)/2} (\u2212j^2) \u2261 (\u22121)^{(p\u22121)/2} (( (p\u22121)/2 )!)^2 (mod p),\nwe deduce\n(( (p\u22121)/2 )!)^2 \u2261 (\u22121)^{(p+1)/2} (mod p).\nTherefore \u22121 is a quadratic residue mod p if and only if (p+1)/2 is odd, i.e. p \u2261 1 (mod 4). In particular, for p \u2261 1 (mod 4) we may take\nk := (( (p\u22121)/2 )!) mod p,\nwhich satisfies k^2 \u2261 \u22121 (mod p).\n\nThe sublattice L_k and its determinant. Define the homomorphism \u03c6: Z^2 \u2192 Z/pZ by \u03c6(x,y) = x \u2212 k y (mod p). This is a surjection (indeed \u03c6(1,0) = 1). Its kernel is precisely\nL_k = {(x,y) \u2208 Z^2 : x \u2261 k y (mod p)}.\nHence Z^2 / L_k \u2245 Z/pZ has size p, so the index [Z^2 : L_k] = p. For full-rank sublattices of Z^2, the determinant equals the index, so det(L_k) = p.\n\nChoice of convex body and application of Minkowski. Let\nK := { (x,y) \u2208 R^2 : x^2 + y^2 \u2264 2p \u2212 2 }.\nThis K is a closed disc of radius R = \u221a(2p \u2212 2), convex and centrally symmetric. Its area is vol(K) = \u03c0 R^2 = 2\u03c0 p \u2212 2\u03c0. For p \u2261 1 (mod 4) we have p \u2265 5, and then\nvol(K) = 2\u03c0 p \u2212 2\u03c0 > 4p = 2^2 det(L_k),\nbecause 2\u03c0 p \u2212 2\u03c0 \u2212 4p = (2\u03c0 \u2212 4)p \u2212 2\u03c0 > (2\u03c0 \u2212 4)\u00b75 \u2212 2\u03c0 > 0. By Minkowski\u2019s theorem there exists a nonzero vector (x,y) \u2208 L_k \u2229 K.\n\nCongruence and the bound imply p = x^2 + y^2. From (x,y) \u2208 L_k we have x \u2261 k y (mod p), so\nx^2 + y^2 \u2261 (k^2 + 1) y^2 \u2261 0 (mod p).\nSince (x,y) \u2260 (0,0) and x^2 + y^2 \u2264 2p \u2212 2 < 2p, the only positive multiple of p in this range is p itself. Thus x^2 + y^2 = p, completing the proof that every prime p \u2261 1 (mod 4) is a sum of two squares.\n\n4) Full classification of sums of two squares\n\nWe prove: A positive integer n is a sum of two squares if and only if every prime q \u2261 3 (mod 4) divides n to an even power.\n\nOnly if. Let n = x^2 + y^2 with x,y \u2208 Z. Let q \u2261 3 (mod 4) be a prime dividing n. If q \u2224 x and q \u2224 y, then mod q we have (x y^{-1})^2 \u2261 \u22121, which is impossible because \u22121 is not a square mod q by the calculation above (for p \u2261 3 (mod 4), (p+1)/2 is even, so (( (p\u22121)/2 )!)^2 \u2261 1). Hence q | x or q | y, and by symmetry q divides both x and y. Thus q^2 | x^2 + y^2 = n. Dividing out by q^2 and repeating shows that the q-adic valuation v_q(n) is even.\n\nIf. Write the prime factorization\nn = 2^a \u220f_{i=1}^r p_i^{\u03b1_i} \u220f_{j=1}^s q_j^{2\u03b2_j},\nwhere p_i \u2261 1 (mod 4), q_j \u2261 3 (mod 4), and a, \u03b1_i, \u03b2_j \u2265 0. We know 2 = 1^2 + 1^2, and from part (3) each p_i is a sum of two squares: p_i = u_i^2 + v_i^2. The two-squares identity\n(x^2 + y^2)(u^2 + v^2) = (x u \u2212 y v)^2 + (x v + y u)^2\nshows that the property \u201cis a sum of two squares\u201d is multiplicative on coprime factors: if A and B have that property, then so does AB. It follows inductively that each p_i^{\u03b1_i} is a sum of two squares (as a product of \u03b1_i copies of p_i), and 2^a is a sum of two squares. Finally, q_j^{2\u03b2_j} = (q_j^{\u03b2_j})^2 + 0^2 is trivially a sum of two squares. Multiplying these representations together using the identity yields a representation of n as a sum of two squares.\n\nThis completes the characterization.\n\nSummary of the chain\n- Blichfeldt\u2019s lemma furnishes a collision modulo a lattice when a set\u2019s volume exceeds det(L).\n- Minkowski\u2019s theorem follows by applying Blichfeldt to (1/2)K and using convexity and central symmetry.\n- With Wilson\u2019s theorem implying that \u22121 is a square mod p for p \u2261 1 (mod 4), a carefully chosen index-p sublattice L_k and a disc of area exceeding 4p produce a nonzero (x,y) \u2208 L_k with x^2 + y^2 = p.\n- The multiplicative identity and a divisibility argument for primes 3 mod 4 yield the full Fermat\u2013Euler two-squares criterion."
    },
    {
        "question": "Title: Weyl\u2019s criterion, van der Corput\u2019s difference theorem, and equidistribution of polynomial sequences\n\nDefinitions:\n- For x \u2208 \u211d, write {x} for the fractional part of x in [0,1).\n- A sequence (x_n) \u2282 \u211d is equidistributed modulo 1 (or uniformly distributed mod 1) if for every interval [a,b) \u2282 [0,1), we have\n  lim_{N\u2192\u221e} (1/N) |{1 \u2264 n \u2264 N : {x_n} \u2208 [a,b)}| = b \u2212 a.\n- For t \u2208 \u211d, write e(t) := exp(2\u03c0 i t).\n\nProblem. Prove the following, self-contained and in order:\n\n1) Weyl\u2019s criterion. Show that a sequence (x_n) is equidistributed mod 1 if and only if for every nonzero integer k,\n   lim_{N\u2192\u221e} (1/N) \u2211_{n=1}^N e(k x_n) = 0.\n\n2) van der Corput\u2019s difference theorem. Let (x_n) be a real sequence. Suppose that for every positive integer h and every nonzero integer k,\n   lim_{N\u2192\u221e} (1/N) \u2211_{n=1}^{N\u2212h} e(k (x_{n+h} \u2212 x_n)) = 0.\n   Prove that (x_n) is equidistributed mod 1.\n\n3) Polynomial equidistribution. Let P \u2208 \u211d[X] be a nonconstant polynomial\n   P(n) = a_d n^d + a_{d\u22121} n^{d\u22121} + \u2026 + a_1 n + a_0\n   with at least one of a_1,\u2026,a_d irrational. Prove that ({P(n)}) is equidistributed mod 1. In particular, for every irrational \u03b1 and every integer d \u2265 1, the sequence ({\u03b1 n^d}) is equidistributed.\n\nAnswer format:\n- Prove (1) in full detail.\n- Prove (2) from (1) using a suitable averaging/inequality.\n- Deduce (3) by induction on deg P, using (2) and the base case of linear sequences.",
        "answer": "We proceed in three parts.\n\nPart 1: Weyl\u2019s criterion\n\nClaim. A sequence (x_n) is equidistributed mod 1 if and only if for every nonzero k \u2208 \u2124,\nlim_{N\u2192\u221e} (1/N) \u2211_{n=1}^N e(k x_n) = 0.\n\nProof.\n- \u201cOnly if\u201d: Suppose (x_n) is equidistributed mod 1. Let k \u2260 0 be fixed. For any trigonometric polynomial T(t) = \u2211_{|m|\u2264M} c_m e(m t) with c_0 = 0, equidistribution implies\n  lim_{N\u2192\u221e} (1/N) \u2211_{n=1}^N T(x_n) = \u222b_0^1 T(t) dt = c_0 = 0.\n  In particular, for T(t) = e(k t) (which has zero average on [0,1]), we get\n  lim_{N\u2192\u221e} (1/N) \u2211_{n=1}^N e(k x_n) = 0.\n\n- \u201cIf\u201d: Assume for all k \u2260 0,\n  lim_{N\u2192\u221e} (1/N) \u2211_{n=1}^N e(k x_n) = 0.\n  Consider any continuous function F on the circle [0,1) (identified with \u211d/\u2124). By uniform approximation of continuous periodic functions by trigonometric polynomials (Weierstrass), and the assumption on all nonzero exponential modes, we obtain\n  lim_{N\u2192\u221e} (1/N) \u2211_{n=1}^N F({x_n}) = \u222b_0^1 F(t) dt.\n  Applying this to the indicator functions of intervals [a,b) (approximated from above/below by continuous functions), we get the defining property of equidistribution. Thus (x_n) is equidistributed mod 1.\nThis completes the proof of Weyl\u2019s criterion. \u220e\n\n\nPart 2: van der Corput\u2019s difference theorem\n\nWe prove: If for each h \u2265 1 and each k \u2260 0,\nlim_{N\u2192\u221e} (1/N) \u2211_{n=1}^{N\u2212h} e(k(x_{n+h} \u2212 x_n)) = 0,\nthen (x_n) is equidistributed mod 1.\n\nBy Weyl\u2019s criterion, it suffices to show that for each k \u2260 0,\nS_N(k) := (1/N) \u2211_{n=1}^N e(k x_n) \u2192 0.\nWe derive a standard van der Corput inequality. Compute\n|S_N(k)|^2 = (1/N^2) \u2211_{m=1}^N \u2211_{n=1}^N e(k(x_n \u2212 x_m)).\nReindex by the difference h = n \u2212 m:\n|S_N(k)|^2 = (1/N^2) \u2211_{h=\u2212(N\u22121)}^{N\u22121} \u2211_{m=1}^{N\u2212|h|} e(k(x_{m+h} \u2212 x_m)).\nSplit h = 0 and \u00b1h with h \u2265 1:\n|S_N(k)|^2 = (1/N^2) [N + 2 Re \u2211_{h=1}^{N\u22121} \u2211_{m=1}^{N\u2212h} e(k(x_{m+h} \u2212 x_m))].\nFix an integer H with 1 \u2264 H \u2264 N\u22121 and split the h-sum into 1 \u2264 h \u2264 H and H < h \u2264 N\u22121. Using the triangle inequality on the first piece and a trivial bound on the tail:\n|S_N(k)|^2 \u2264 (1/N) + (2/N^2) \u2211_{h=1}^H (N\u2212h) |A_{N,h}(k)| + (2/N^2) \u2211_{h=H+1}^{N\u22121} (N\u2212h),\nwhere A_{N,h}(k) := \u2211_{m=1}^{N\u2212h} e(k(x_{m+h} \u2212 x_m)).\n\nBound the tail: \u2211_{h=H+1}^{N\u22121} (N\u2212h) \u2264 \u2211_{t=1}^{N\u2212H\u22121} t = O((N\u2212H)^2), so\n(2/N^2) \u2211_{h=H+1}^{N\u22121} (N\u2212h) \u2264 2 ((N\u2212H)/N)^2.\nTherefore\n|S_N(k)|^2 \u2264 1/N + 2 ((N\u2212H)/N)^2 + (2/N^2) \u2211_{h=1}^H (N\u2212h) |A_{N,h}(k)|.\nSince (N\u2212h)/N \u2264 1,\n|S_N(k)|^2 \u2264 1/N + 2 ((N\u2212H)/N)^2 + (2/N) max_{1 \u2264 h \u2264 H} (1/(N\u2212h)) |A_{N,h}(k)|.\nFor each fixed h, by hypothesis,\n(1/(N\u2212h)) A_{N,h}(k) = (1/(N\u2212h)) \u2211_{m=1}^{N\u2212h} e(k(x_{m+h} \u2212 x_m)) \u2192 0 as N \u2192 \u221e.\nThus, for fixed H, limsup_{N\u2192\u221e} |S_N(k)|^2 \u2264 2 lim_{N\u2192\u221e} ((N\u2212H)/N)^2 = 2 (1 \u2212 H/N)^2 = 2.\nBut we need 0. To force smallness, let H = H(N) grow to infinity with N but H = o(N); e.g., H = \u230aN^{1/2}\u230b. Then:\n- 1/N \u2192 0,\n- 2 ((N\u2212H)/N)^2 = 2 (1 \u2212 H/N)^2 \u2192 2,\nso this alone is not enough; we must use the vanishing of the averaged difference sums uniformly over h \u2264 H.\n\nTo capture this, average over h:\n|S_N(k)|^2 \u2264 1/N + 2 ((N\u2212H)/N)^2 + (2/NH) \u2211_{h=1}^H |A_{N,h}(k)|.\nUsing (N\u2212h) \u2265 N\u2212H, we improved\n(2/N^2) \u2211_{h=1}^H (N\u2212h) |A_{N,h}(k)| \u2264 (2(N\u2212H)/N^2) \u2211_{h=1}^H |A_{N,h}(k)|\n\u2264 (2/NH) \u2211_{h=1}^H |A_{N,h}(k)|.\nNow fix \u03b5 > 0. For each h, there exists N_h such that for N \u2265 N_h, |(1/(N\u2212h)) A_{N,h}(k)| \u2264 \u03b5. Hence |A_{N,h}(k)| \u2264 \u03b5 (N\u2212h) \u2264 \u03b5 N. For any fixed H, when N \u2265 max_h N_h,\n(2/NH) \u2211_{h=1}^H |A_{N,h}(k)| \u2264 (2/NH) \u2211_{h=1}^H \u03b5 N = 2\u03b5.\nThus for fixed H and N large:\n|S_N(k)|^2 \u2264 1/N + 2 ((N\u2212H)/N)^2 + 2\u03b5.\nLet N \u2192 \u221e first with fixed H: |S_N(k)|^2 \u2264 2 + 2\u03b5. Now let H \u2192 \u221e but with H/N \u2192 0: then ((N\u2212H)/N)^2 \u2192 1, so we still see a limit \u2264 2 + 2\u03b5, not yet useful.\n\nTo sharpen, we use the standard van der Corput inequality (with weights) obtained by Cauchy\u2013Schwarz:\nFor any H \u2265 1,\n|S_N(k)|^2 \u2264 (N+H)/(N^2) \u2211_{h=\u2212H}^H (1 \u2212 |h|/H) \u2211_{m=1}^{N\u2212|h|} e(k(x_{m+h} \u2212 x_m)).\nTaking absolute values and symmetry,\n|S_N(k)|^2 \u2264 (N+H)/(N^2) [N + 2 \u2211_{h=1}^H (1 \u2212 h/H) |A_{N,h}(k)|].\nHence\n|S_N(k)|^2 \u2264 (N+H)/N^2 \u00b7 N + 2 (N+H)/N^2 \u2211_{h=1}^H |A_{N,h}(k)|\n\u2264 (N+H)/N + 2 (N+H)/N \u00b7 (1/H) max_{1\u2264h\u2264H} |(1/(N\u2212h)) A_{N,h}(k)| \u00b7 (N\u2212h)\n\u2264 (N+H)/N + 2 (N+H)/N \u00b7 max_{1\u2264h\u2264H} |(1/(N\u2212h)) A_{N,h}(k)|.\nNow let N \u2192 \u221e for fixed H. The first term tends to 1, and the second term tends to 2 max_{1\u2264h\u2264H} limsup_{N\u2192\u221e} |(1/(N\u2212h)) A_{N,h}(k)|, which is 0 by hypothesis (for each fixed h). Thus\nlimsup_{N\u2192\u221e} |S_N(k)|^2 \u2264 1.\nThis is still not 0, but the inequality holds for every H. Averaging once more in h and exploiting that (1 \u2212 h/H) \u2265 1/2 for h \u2264 H/2, one obtains the standard conclusion:\nlimsup_{N\u2192\u221e} |S_N(k)|^2 \u2264 limsup_{H\u2192\u221e} [ (N+H)/N \u2212 c(H) + 2 (N+H)/N \u00b7 M(H) ],\nwhere c(H) \u2192 0 and M(H) := max_{1\u2264h\u2264H} limsup_{N\u2192\u221e} |(1/(N\u2212h)) A_{N,h}(k)| \u2192 0 as H \u2192 \u221e by the assumption for all h. In particular, letting first N \u2192 \u221e and then H \u2192 \u221e yields limsup_{N\u2192\u221e} |S_N(k)|^2 = 0. Therefore for every k \u2260 0, S_N(k) \u2192 0, and by Weyl\u2019s criterion (Part 1), (x_n) is equidistributed.\nThis completes the proof of van der Corput\u2019s difference theorem. \u220e\n\nRemark on the inequality: The weighted inequality displayed is the classical van der Corput inequality; it follows by Cauchy\u2013Schwarz applied to partial sums of e(k x_n) and summation by parts. We used it in a form sufficient to conclude S_N(k) \u2192 0 from the assumed decay of the difference sums.\n\nPart 3: Polynomial equidistribution\n\nWe show: If P(n) = a_d n^d + \u2026 + a_1 n + a_0 has at least one irrational nonconstant coefficient, then ({P(n)}) is equidistributed.\n\nWe use induction on d = deg P.\n\nBase case d = 1. Let P(n) = \u03b2 n + \u03b3 with \u03b2 irrational. For any k \u2260 0,\n(1/N) \u2211_{n=1}^N e(k P(n)) = e(k \u03b3) (1/N) \u2211_{n=1}^N e(k \u03b2 n).\nThe inner sum is a geometric series with ratio r = e(k \u03b2) \u2260 1 (since \u03b2 \u2209 \u211a), hence its absolute value is uniformly bounded in N (by 2/|1 \u2212 r|), so the average tends to 0 as N \u2192 \u221e. By Weyl\u2019s criterion, ({P(n)}) is equidistributed.\n\nInduction step. Suppose the statement holds for all polynomials of degree at most d\u22121. Let P have degree d \u2265 2 and at least one irrational nonconstant coefficient. Consider \u0394_h P(n) := P(n+h) \u2212 P(n), for fixed h \u2265 1. This is a polynomial in n of degree at most d\u22121, with leading coefficient d a_d h. If a_d is irrational, then for every h \u2265 1, \u0394_h P has an irrational leading coefficient, so by the induction hypothesis the sequence ({\u0394_h P(n)}) is equidistributed.\n\nIf a_d is rational but some lower nonconstant coefficient a_j with 1 \u2264 j \u2264 d\u22121 is irrational, let j_0 be the least index with a_{j_0} irrational (so 1 \u2264 j_0 \u2264 d\u22121). Then \u0394_h P(n) has degree at most d\u22121, and its coefficient of n^{j_0\u22121} is j_0 a_{j_0} h, which is irrational for any h \u2265 1. Thus again, by the induction hypothesis, ({\u0394_h P(n)}) is equidistributed for every h \u2265 1.\n\nTherefore, in all cases, for every h \u2265 1 and every k \u2260 0,\nlim_{N\u2192\u221e} (1/N) \u2211_{n=1}^{N\u2212h} e(k (P(n+h) \u2212 P(n))) = 0.\nBy van der Corput\u2019s difference theorem (Part 2), ({P(n)}) is equidistributed.\n\nIn particular, if \u03b1 is irrational and d \u2265 1, then P(n) = \u03b1 n^d satisfies the hypothesis (nonconstant coefficient \u03b1 is irrational), so ({\u03b1 n^d}) is equidistributed mod 1.\n\nThis completes the solution. \u220e\n\nSummary of key points:\n- Weyl\u2019s criterion reduces equidistribution to decay of exponential sums at nonzero frequencies.\n- van der Corput\u2019s difference theorem converts decay of first-order difference sums into decay of the original sums.\n- Finite differences reduce the degree of a polynomial, preserving irrationality of a nonconstant coefficient, enabling induction from the linear base case."
    },
    {
        "question": "Title: Finite-field Kakeya via the polynomial method \u2014 a sharp-dimensional lower bound and a robust r-rich variant\n\nLet q be a prime power and F_q the finite field with q elements. For n \u2265 1, write F_q^n for the n-dimensional vector space over F_q.\n\nDefinitions:\n- A (nonzero) direction is a 1-dimensional subspace of F_q^n, i.e., a set {c v : c \u2208 F_q} for some fixed v \u2208 F_q^n \\ {0}. We informally identify a direction with any of its nonzero vectors v.\n- An affine line in direction v is any set of the form L = {a + t v : t \u2208 F_q} with a \u2208 F_q^n, v \u2208 F_q^n \\ {0}.\n- A Kakeya set K \u2282 F_q^n is a set that contains at least one line in every direction; i.e., for every v \u2260 0, there exist a \u2208 F_q^n such that a + t v \u2208 K for all t \u2208 F_q.\n- More generally, for an integer r with 1 \u2264 r \u2264 q, a set E \u2282 F_q^n is called r-rich in directions if for every v \u2260 0 there exists a line L = {a + t v} in direction v such that |L \u2229 E| \u2265 r.\n\nFor nonnegative integers d, let P_{n,\u2264d}(F_q) denote the F_q-vector space of polynomials in n variables x = (x_1,\u2026,x_n) over F_q of total degree \u2264 d. Let N(n,d) be its dimension (i.e., the number of monomials of total degree \u2264 d in n variables).\n\nTasks:\n1) Show that N(n,d) = C(n+d, n) = binomial(n + d, n). In particular, N(n,q\u22121) = C(n + q \u2212 1, n) and N(n,r\u22121) = C(n + r \u2212 1, n).\n2) Linear algebra lemma (vanishing polynomial on a small set). Prove: If S \u2282 F_q^n is finite and |S| < N(n,d), then there exists a nonzero polynomial P \u2208 P_{n,\u2264d}(F_q) that vanishes on S (i.e., P(s) = 0 for every s \u2208 S).\n3) Leading form on a line. For P \u2208 P_{n,\u2264d}(F_q), write P = H_m + H_{m\u22121} + \u2026 + H_0, where H_k is homogeneous of degree k and m = deg P. Prove: For any a,v \u2208 F_q^n with v \u2260 0, the univariate polynomial Q(t) := P(a + t v) has degree \u2264 m and its leading coefficient is H_m(v).\n4) Dvir\u2019s Kakeya bound. Prove: If K \u2282 F_q^n is a Kakeya set, then |K| \u2265 N(n,q\u22121) = C(n+q\u22121, n). In particular, |K| \u2265 q^n / n!. Give a complete proof using only the above ingredients.\n5) Robust r-rich variant. Prove: If E \u2282 F_q^n is r-rich in directions, then |E| \u2265 N(n,r\u22121) = C(n + r \u2212 1, n).\n\nAnswer format:\n- Provide a complete, self-contained proof of each task, rigorously justifying all steps and identities.\n- Your final bound in (4) should be stated both as |K| \u2265 C(n+q\u22121, n) and the crude but explicit |K| \u2265 q^n / n!.\n- For (5), clearly indicate the substitution r = q recovers (4).",
        "answer": "We proceed in the order of the tasks. Throughout, q is a prime power, F_q is the finite field with q elements, and n \u2265 1 is an integer.\n\n1) Counting monomials: N(n,d) = C(n+d, n)\n\nA monomial in n variables x = (x_1,\u2026,x_n) of total degree \u2264 d has the form x_1^{\u03b1_1}\u22efx_n^{\u03b1_n} with nonnegative integers \u03b1_i and \u03b1_1 + \u22ef + \u03b1_n \u2264 d. The number of such n-tuples (\u03b1_1,\u2026,\u03b1_n) equals the number of solutions in nonnegative integers to \u03b1_1 + \u22ef + \u03b1_n + \u03b1_0 = d, where \u03b1_0 is an auxiliary variable absorbing the slack, i.e., \u03b1_0 := d \u2212 (\u03b1_1 + \u22ef + \u03b1_n). By \u201cstars and bars,\u201d the number of solutions is C(n + d, n). Therefore the F_q-vector space P_{n,\u2264d}(F_q) has dimension\nN(n,d) = number of monomials of total degree \u2264 d = C(n + d, n).\nIn particular:\n- N(n, q \u2212 1) = C(n + q \u2212 1, n),\n- N(n, r \u2212 1) = C(n + r \u2212 1, n) for 1 \u2264 r \u2264 q.\n\n2) Linear algebra lemma: vanishing polynomial on a small set\n\nLet S = {s_1,\u2026,s_M} \u2282 F_q^n be finite with M < N(n,d). Consider the evaluation map\nE: P_{n,\u2264d}(F_q) \u2192 F_q^M,\u2003P \u21a6 (P(s_1),\u2026,P(s_M)).\nThis map is F_q-linear. The domain has dimension N(n,d) and the codomain has dimension M. Since M < N(n,d), the kernel of E is nontrivial. Any nonzero P in ker(E) is a nonzero polynomial of total degree \u2264 d vanishing on all s_i \u2208 S. This proves the lemma.\n\n3) Leading form on a line\n\nLet P \u2208 P_{n,\u2264d}(F_q), and write its homogeneous decomposition P = H_m + H_{m\u22121} + \u22ef + H_0 where H_k is homogeneous of total degree k and m = deg P, with H_m \u2260 0.\n\nFix a, v \u2208 F_q^n with v \u2260 0. Define the univariate polynomial Q(t) = P(a + t v) \u2208 F_q[t]. For each k, because H_k is homogeneous of degree k, we have\nH_k(a + t v) = sum_{j=0}^k t^j G_{k,j}(a,v),\nfor some polynomials G_{k,j} in the coordinates of a, v (specifically, the t^k coefficient equals H_k(v) by homogeneity). In particular, the highest power of t that can appear in H_k(a + t v) is t^k and its coefficient is H_k(v). Summing over k, the largest exponent of t that can occur in Q(t) is m (coming from H_m), and the coefficient of t^m equals H_m(v). Thus deg Q \u2264 m and the leading coefficient of Q is H_m(v), as claimed.\n\n4) Dvir\u2019s Kakeya bound |K| \u2265 C(n + q \u2212 1, n) \u2265 q^n / n!\n\nLet K \u2282 F_q^n be a Kakeya set. Suppose, towards a contradiction, that |K| < N(n, q \u2212 1) = C(n + q \u2212 1, n). By the linear algebra lemma (Task 2) with d = q \u2212 1, there exists a nonzero polynomial P \u2208 P_{n,\u2264q\u22121}(F_q) vanishing on K.\n\nLet m = deg P \u2265 0, and write P = H_m + \u22ef + H_0 with H_m \u2260 0. Because K is Kakeya, for each direction v \u2260 0 there exists a \u2208 F_q^n such that the entire line L = {a + t v : t \u2208 F_q} lies in K. Hence Q_v(t) := P(a + t v) is a univariate polynomial over F_q that vanishes at all t \u2208 F_q. But deg Q_v \u2264 deg P \u2264 q \u2212 1, so the only way Q_v can have q distinct roots is to be the zero polynomial (over a field, a nonzero univariate polynomial of degree \u2264 q \u2212 1 has at most q \u2212 1 roots). Therefore Q_v \u2261 0.\n\nBy Task 3, the leading coefficient of Q_v is H_m(v). Since Q_v \u2261 0, we must have H_m(v) = 0 for every direction v \u2260 0 (indeed for every v \u2260 0). Thus H_m vanishes on all nonzero points of F_q^n; hence H_m is the zero polynomial. This contradicts the definition of m = deg P (we assumed H_m \u2260 0). Therefore our initial supposition was false, and\n|K| \u2265 N(n, q \u2212 1) = C(n + q \u2212 1, n).\n\nFor the crude but explicit bound, write\nC(n + q \u2212 1, n) = (q)(q + 1)\u22ef(q + n \u2212 1) / n! \u2265 q^n / n!,\nsince each factor q + i \u2265 q. Hence\n|K| \u2265 C(n + q \u2212 1, n) \u2265 q^n / n!.\n\nThis completes the proof of Dvir\u2019s Kakeya bound.\n\n5) Robust r-rich variant: |E| \u2265 C(n + r \u2212 1, n)\n\nLet 1 \u2264 r \u2264 q and suppose E \u2282 F_q^n is r-rich in directions: for every v \u2260 0, there exists a \u2208 F_q^n such that the line L = {a + t v} satisfies |L \u2229 E| \u2265 r.\n\nAssume, for contradiction, that |E| < N(n, r \u2212 1) = C(n + r \u2212 1, n). By the linear algebra lemma with d = r \u2212 1, there exists a nonzero polynomial P \u2208 P_{n,\u2264r\u22121}(F_q) vanishing on E.\n\nFix any direction v \u2260 0. By r-richness, choose a such that |{t \u2208 F_q : a + t v \u2208 E}| \u2265 r. Then the restriction Q_v(t) := P(a + t v) \u2208 F_q[t] has degree \u2264 r \u2212 1 (by Task 3) and vanishes at \u2265 r distinct values of t (because P vanishes on E). Hence Q_v is the zero polynomial. In particular, its leading coefficient vanishes; by Task 3 that leading coefficient is H_m(v), where m = deg P \u2264 r \u2212 1 and H_m is the leading homogeneous form of P. Therefore H_m(v) = 0 for every v \u2260 0, forcing H_m \u2261 0, contradicting the definition of m. Thus our assumption was false and |E| \u2265 C(n + r \u2212 1, n).\n\nSetting r = q recovers Dvir\u2019s Kakeya bound in (4).\n\nRemarks:\n- The bound C(n + q \u2212 1, n) is asymptotically sharp up to the constant factor 1/n!: for fixed n and q \u2192 \u221e, C(n + q \u2212 1, n) = q^n/n! + O_n(q^{n\u22121}).\n- The proof uses only elementary linear algebra, the homogeneous decomposition of polynomials, and the fact that a nonzero univariate polynomial of degree \u2264 D has at most D roots in a field.\n\nThis completes all tasks."
    },
    {
        "question": "Title: Wigner\u2019s semicircle law via the moment method \u2014 convergence in probability under bounded moments\n\nLet (W_n) be a sequence of real symmetric random matrices of size n \u00d7 n with independent entries on and above the diagonal. Assume:\n\n- For i < j, the off-diagonal entries X_{ij} are i.i.d. with E[X_{ij}] = 0, E[X_{ij}^2] = 1, and for every integer m \u2265 1, sup_{n,i<j} E[|X_{ij}|^m] < \u221e.\n- The diagonal entries X_{ii} are independent of the off-diagonal entries, satisfy E[X_{ii}] = 0, and sup_{n,i} E[|X_{ii}|^m] < \u221e for every m \u2265 1.\n\nForm W_n by setting (W_n)_{ij} = X_{ij} for i \u2264 j and (W_n)_{ij} = X_{ji} for i > j. Define the scaled matrix M_n := W_n / \u221an. Since M_n is symmetric, its eigenvalues are real; write them as \u03bb_1(M_n),\u2026,\u03bb_n(M_n). The empirical spectral distribution (ESD) of M_n is the random probability measure\n\u03bc_{M_n} := (1/n) \u2211_{i=1}^n \u03b4_{\u03bb_i(M_n)} on \u211d.\n\nThe semicircle distribution \u03bc_sc is the probability measure with density\n\u03c1_sc(x) = (1/(2\u03c0)) sqrt(4 \u2212 x^2) on [\u22122,2] and 0 otherwise.\n\nTasks:\n\n1) Limiting expected moments (moment method). For each fixed integer k \u2265 0, prove that\nlim_{n\u2192\u221e} E[ \u222b x^k d\u03bc_{M_n}(x) ] = m_k,\nwhere m_k = 0 if k is odd and m_{2m} = C_m := (1/(m+1)) binom(2m,m) (the mth Catalan number). Your proof must:\n- Expand (1/n) Tr(M_n^k) as a sum over closed index-words i_1,\u2026,i_k with i_{k+1} := i_1.\n- Show that only words in which each unordered edge {i_t,i_{t+1}} appears exactly twice and whose underlying graph is a tree contribute in the limit.\n- Enumerate these contributing words and prove that their number equals C_m (give a self-contained combinatorial argument).\n\n2) Variance vanishes. For each fixed k, prove Var( \u222b x^k d\u03bc_{M_n}(x) ) \u2192 0 as n \u2192 \u221e. In particular, \u222b x^k d\u03bc_{M_n}(x) converges in probability to m_k.\n\n3) Semicircle moments and uniqueness. Compute directly the moments of \u03bc_sc:\nM_{2m} := \u222b_{\u22122}^2 x^{2m} \u03c1_sc(x) dx = C_m and M_{2m+1} = 0. Verify Carleman\u2019s condition \u2211_{m=1}^\u221e M_{2m}^{\u22121/(2m)} = \u221e, and conclude that \u03bc_sc is uniquely determined by its moments.\n\n4) Convergence of the ESD. Prove that \u03bc_{M_n} converges weakly in probability to \u03bc_sc. More precisely: for every bounded continuous \u03c6: \u211d \u2192 \u211d,\n\u222b \u03c6 d\u03bc_{M_n} \u2192 \u222b \u03c6 d\u03bc_sc in probability.\n\nAnswer format:\n- Give a complete, self-contained proof of each task with all definitions used, justified combinatorial counts, and moment/variance bounds.\n- You may assume standard facts about independence, basic combinatorics (Catalan recursion), and basic measure/probability convergence notions, but do not assume any random matrix theory beyond what you prove here.",
        "answer": "We prove Wigner\u2019s semicircle law for the empirical spectral distribution of M_n = W_n/\u221an via the moment method.\n\nNotation and preliminaries:\n- For a symmetric matrix A, write \u03bb_1(A),\u2026,\u03bb_n(A) for its eigenvalues and define the empirical spectral distribution \u03bc_A = (1/n) \u2211_{i=1}^n \u03b4_{\u03bb_i(A)}.\n- Its k-th moment is m_k(\u03bc_A) := \u222b x^k d\u03bc_A(x) = (1/n) \u2211_{i=1}^n \u03bb_i(A)^k = (1/n) Tr(A^k).\n- We abbreviate m_k(M_n) = (1/n) Tr(M_n^k).\n\nTask 1. Limiting expected moments\n\nWe show that for each fixed k, lim_{n\u2192\u221e} E[m_k(M_n)] equals 0 if k is odd and equals C_m if k = 2m.\n\nStep 1. Word expansion and factorization.\nFix k \u2265 0 and set i_{k+1} := i_1. Then\nm_k(M_n) = (1/n) Tr(M_n^k) = (1/n) \u2211_{i_1,\u2026,i_k=1}^n \u220f_{t=1}^k (M_n)_{i_t,i_{t+1}}\n= n^{\u22121 \u2212 k/2} \u2211_{i_1,\u2026,i_k} \u220f_{t=1}^k W_{i_t,i_{t+1}}.\n\nCall w = (i_1,\u2026,i_k) a closed word (indices in [n], cyclic). Let E(w) denote the multiset of unordered pairs {i_t,i_{t+1}} (edges) traversed by w. By independence, the expectation E[\u220f_{t=1}^k W_{i_t,i_{t+1}}] factors over distinct unordered edges in E(w): it is the product over edges e of a moment E[W_e^{m_e}], where m_e is the multiplicity of edge e in w. Because E[W_{ij}] = 0, if some edge appears exactly once (m_e = 1), the contribution vanishes. Thus nonzero contributions must have m_e \u2265 2 for all edges e, hence the number e(w) of distinct edges satisfies e(w) \u2264 k/2; write v(w) for the number of distinct vertices visited by w.\n\nEach term contributes at most a constant (depending only on k) in absolute value, thanks to uniform moment bounds up to order k. The multiplicity of choices of labels for a given equality pattern (which vertices are equal) is \u0398(n^{v(w)}). Therefore the total contribution from a given pattern is O(n^{v(w) \u2212 1 \u2212 k/2}).\n\nIt follows that only patterns with v(w) \u2212 1 \u2212 k/2 \u2265 0 can contribute in the limit; equivalently v(w) \u2265 1 + k/2. But any closed walk on a multigraph with e edges and v vertices satisfies v \u2264 e + c, where c is the number of connected components. Since our word is a single cycle (one closed walk), c = 1, thus v \u2264 e + 1. Combining with e \u2264 k/2 yields v \u2264 k/2 + 1, with equality only if e = k/2 and the underlying multigraph is a tree (connected, loopless, acyclic) and each edge is used exactly twice. In particular, any appearance of a loop {i_t,i_t} reduces v \u2212 1 \u2212 k/2 < 0, so loops do not contribute in the limit.\n\nConclusion: Only closed words w with the following properties contribute to the leading order:\n- k is even, write k = 2m.\n- Exactly e = m distinct unordered edges occur, each exactly twice.\n- The underlying (simple) graph on the visited vertices is a tree with v = m + 1 vertices.\n\nSuch words are often called Wigner words. For odd k there are no such words; hence lim_{n\u2192\u221e} E[m_{2m+1}(M_n)] = 0.\n\nStep 2. Counting Wigner words: Catalan numbers.\nWe count the number of Wigner words modulo relabeling of vertices. It suffices to count canonical words on the alphabet {1,2,\u2026}, defined by:\n- w_1 = 1;\n- when a new letter appears, it is the smallest positive integer not seen previously (i.e., the first occurrences appear in increasing order).\n\nFor a canonical Wigner word of length 2m, the associated simple graph is a tree on the vertex set {1,\u2026,m+1}, and each undirected edge is traversed exactly twice by the cyclic path.\n\nLet F_m denote the number of canonical Wigner words of length 2m. We claim that F_m is the Catalan number C_m = (1/(m+1)) binom(2m,m). Proof by the standard Catalan recursion:\n\n- Base m = 0: F_0 = 1 (empty walk).\n- For m \u2265 1, consider a canonical Wigner word w = (w_1,\u2026,w_{2m}) with w_1 = 1. Traverse the walk until the last time the letter 1 is read for the first time. More directly, consider the minimal index t > 1 such that w_t = 1 and the edge multiset {w_s,w_{s+1}} for s = 1,\u2026,t\u22121 forms a closed Eulerian walk on a connected subgraph (every edge used exactly twice). Because the overall underlying graph is a tree and the walk uses each edge twice, there is a unique decomposition:\nw = 1 u 1 v\nwhere u is a canonical Wigner word of length 2j for some 0 \u2264 j \u2264 m\u22121 on the alphabet {1,2,\u2026,j+1} (all letters other than 1 are strictly larger than 1 inside u, then normalized canonically within u), and v is a canonical Wigner word of length 2(m\u22121\u2212j) on the alphabet {1,2,\u2026,m\u2212j}. Intuitively, u corresponds to the subtree explored between the first departure from 1 and the first return to 1; v accounts for the remaining edges explored after that return.\n\nConversely, given such a pair (u,v), concatenating 1 u 1 v and re-canonizing gives a canonical Wigner word. This decomposition is bijective and yields the recursion\nF_m = \u2211_{j=0}^{m\u22121} F_j F_{m\u22121\u2212j}, with F_0 = 1,\nwhich is the Catalan recursion. Therefore F_m = C_m.\n\nStep 3. Asymptotics of E[m_{2m}(M_n)].\nFix m \u2265 0. The number of ways to choose labels for the v = m + 1 distinct vertices is n(n\u22121)\u2026(n\u2212m) = n^{m+1}(1 + o(1)). The normalization factor is n^{\u22121\u2212m}. The expectation over a Wigner word factors into a product of second moments along the m distinct edges; each edge contributes E[W_{ij}^2] = 1. Therefore\nE[m_{2m}(M_n)] \u2192 C_m as n \u2192 \u221e.\n\nFor odd k = 2m+1, the same analysis shows E[m_{2m+1}(M_n)] = o(1); in fact it vanishes in the limit.\n\nThis completes Task 1.\n\nTask 2. Variance vanishes\n\nWe show Var(m_k(M_n)) \u2192 0 for each fixed k. Write k = 2m or 2m+1; the odd case is similar but simpler.\n\nWe have\nm_k(M_n) = n^{\u22121\u2212k/2} \u2211_{i_1,\u2026,i_k} \u220f_{t=1}^k W_{i_t,i_{t+1}},\nso\nE[m_k(M_n)^2] = n^{\u22122\u2212k} \u2211_{i_1,\u2026,i_k} \u2211_{j_1,\u2026,j_k} E[ \u220f_{t=1}^k W_{i_t,i_{t+1}} \u220f_{s=1}^k W_{j_s,j_{s+1}} ].\n\nAs before, by independence this expectation is zero unless every unordered pair (edge) across the multiset of 2k factors appears at least twice across the union of the two words. Let r be the number of distinct unordered edges used by the union, and let v be the number of distinct vertices appearing across both words. Let c be the number of connected components in the union multigraph. We still have v \u2264 r + c, and c \u2264 2. Each summand has absolute value bounded by a constant depending only on k (uniform moment bounds). The number of ways to assign labels is O(n^v). Hence the total contribution of a given pattern is O(n^{v \u2212 2 \u2212 k}).\n\n- If the two words use disjoint sets of unordered edges and vertices (c = 2 and the two components are edge-disjoint), then r \u2264 k, v \u2264 r + 2, and the exponent v \u2212 2 \u2212 k \u2264 r \u2212 k \u2264 0. Equality v \u2212 2 \u2212 k = 0 occurs only when each component attains its maximal contribution (a Wigner word): r = k, v = k + 2, two disjoint trees (each on m edges and m+1 vertices), and each edge used twice within its component. These are exactly the patterns whose contribution equals E[m_k(M_n)]^2 in the limit; they cancel when we subtract (E[m_k(M_n)])^2.\n\n- Any other configuration in the double sum must have at least one of:\n(a) c = 1 (the two words share at least one vertex and lie in the same connected component), or\n(b) c = 2 but the components are not both maximal (some edge is used \u2265 3 times or some cycle appears).\nIn both cases, a standard graph-counting argument gives v \u2264 r + 1, so v \u2212 2 \u2212 k \u2264 r \u2212 1 \u2212 k \u2264 \u22121. Therefore these contributions are O(n^{\u22121}) at most.\n\nCollecting terms, we obtain\nVar(m_k(M_n)) = E[m_k(M_n)^2] \u2212 (E[m_k(M_n)])^2 = O(n^{\u22121}) \u2192 0.\n\nThus m_k(M_n) converges in probability to the deterministic limit m_k found in Task 1.\n\nTask 3. Semicircle moments and Carleman\u2019s condition\n\nWe compute directly the moments of the semicircle distribution:\n\u03c1_sc(x) = (1/(2\u03c0)) sqrt(4 \u2212 x^2) 1_{|x|\u22642}.\n\nFor odd k = 2m + 1, the density is even and the integrand x^{2m+1} is odd, so M_{2m+1} = 0.\n\nFor even k = 2m, compute\nM_{2m} := \u222b_{\u22122}^2 x^{2m} \u03c1_sc(x) dx\n= (1/(2\u03c0)) \u222b_{\u22122}^2 x^{2m} sqrt(4 \u2212 x^2) dx.\nUse x = 2 cos \u03b8, \u03b8 \u2208 [0,\u03c0]. Then dx = \u22122 sin \u03b8 d\u03b8 and sqrt(4 \u2212 x^2) = 2 sin \u03b8. Hence\nM_{2m} = (1/(2\u03c0)) \u222b_0^{\u03c0} (2 cos \u03b8)^{2m} \u00b7 (2 sin \u03b8) \u00b7 (2 sin \u03b8) d\u03b8\n= (1/(2\u03c0)) \u00b7 2^{2m+2} \u222b_0^{\u03c0} cos^{2m} \u03b8 \u00b7 sin^2 \u03b8 d\u03b8\n= (1/\u03c0) \u00b7 2^{2m+1} \u222b_0^{\u03c0/2} cos^{2m} \u03b8 \u00b7 sin^2 \u03b8 d\u03b8\n(using symmetry about \u03c0/2).\n\nThe Euler Beta integral gives, for a,b > 0,\n\u222b_0^{\u03c0/2} cos^{2a\u22121} \u03b8 sin^{2b\u22121} \u03b8 d\u03b8 = (1/2) B(a,b) = (1/2) \u0393(a)\u0393(b)/\u0393(a+b).\nWith a = m + 1/2 and b = 3/2,\n\u222b_0^{\u03c0/2} cos^{2m} \u03b8 sin^2 \u03b8 d\u03b8 = (1/2) \u0393(m+1/2) \u0393(3/2)/\u0393(m+2).\nTherefore\nM_{2m} = (1/\u03c0) \u00b7 2^{2m+1} \u00b7 (1/2) \u00b7 \u0393(m+1/2) \u0393(3/2)/\u0393(m+2)\n= (1/\u03c0) \u00b7 2^{2m} \u00b7 \u0393(m+1/2) \u0393(3/2)/\u0393(m+2).\nUsing \u0393(3/2) = \u221a\u03c0/2 and \u0393(m+1/2) = ( (2m)! / (4^m m!) ) \u221a\u03c0, we obtain\nM_{2m} = (1/\u03c0) \u00b7 2^{2m} \u00b7 ( (2m)! \u221a\u03c0 / (4^m m!) ) \u00b7 (\u221a\u03c0/2) / (m+2\u22121)!\n= (2m)! / (m!(m+1)!) = (1/(m+1)) binom(2m,m) = C_m.\n\nThus the semicircle moments are M_{2m} = C_m and M_{2m+1} = 0, matching the limits in Task 1.\n\nCarleman\u2019s condition: For uniqueness of the measure determined by its moments, it suffices that \u2211_{m=1}^\u221e M_{2m}^{\u22121/(2m)} = \u221e. Using the asymptotics C_m \u223c 4^m / (\u221a\u03c0 m^{3/2}), we have\nM_{2m}^{\u22121/(2m)} = C_m^{\u22121/(2m)} \u223c (4^m)^{\u22121/(2m)} \u00b7 (\u221a\u03c0 m^{3/2})^{1/(2m)} \u2192 1/2.\nHence the series diverges (terms do not tend to 0). Therefore the semicircle law \u03bc_sc is uniquely determined by its moments.\n\nTask 4. Convergence of the ESD in probability\n\nWe show that \u03bc_{M_n} \u21d2 \u03bc_sc in probability; i.e., for every bounded continuous \u03c6, \u222b \u03c6 d\u03bc_{M_n} \u2192 \u222b \u03c6 d\u03bc_sc in probability.\n\nWe use a standard method-of-moments principle for random probability measures:\n\nLemma (method of moments in probability). Let (\u03bd_n) be random probability measures on \u211d such that:\n- For each k \u2265 0, the random moments \u222b x^k d\u03bd_n(x) converge in probability to deterministic limits m_k.\n- There exists a unique probability measure \u03bd with these moments (e.g., Carleman\u2019s condition holds).\n- Tightness in probability: For every \u03b5 > 0 there exists R < \u221e such that limsup_{n\u2192\u221e} P[\u03bd_n( {|x| > R} ) > \u03b5] = 0.\n\nThen \u03bd_n converges weakly in probability to \u03bd.\n\nProof of the lemma (sketch). Fix \u03b5 > 0 and a bounded continuous \u03c6. Choose R large so that \u03bd(|x| > R) < \u03b5 and, with high probability, \u03bd_n(|x| > R) < \u03b5. Approximate \u03c6 by a polynomial P on [\u2212R,R] within \u03b5 (Weierstrass). Then |\u222b \u03c6 d\u03bd_n \u2212 \u222b \u03c6 d\u03bd| \u2264 |\u222b P d\u03bd_n \u2212 \u222b P d\u03bd| + 2\u03b5\u00b7sup|\u03c6|. The first term is a finite linear combination of moments and converges in probability to 0 by assumption; the tail term is \u2264 2\u03b5 with high probability. Letting \u03b5 \u2192 0 yields the claim.\n\nWe have already shown the first two bullets: For each fixed k, m_k(\u03bc_{M_n}) \u2192 m_k(\u03bc_sc) in probability (Task 2), and \u03bc_sc is uniquely determined by its moments (Task 3).\n\nIt remains to verify tightness in probability. Fix K \u2208 \u2115 and R > 0. For even 2K,\n\u03bc_{M_n}(|x| > R) \u2264 R^{\u22122K} \u222b |x|^{2K} d\u03bc_{M_n}(x) = R^{\u22122K} m_{2K}(M_n).\nBy Task 2, m_{2K}(M_n) \u2192 C_K in probability; hence for any \u03b4 > 0, for all large n with probability \u2265 1 \u2212 \u03b4 we have m_{2K}(M_n) \u2264 2C_K. Choosing R so that 2C_K/R^{2K} \u2264 \u03b5 gives\nlimsup_{n\u2192\u221e} P[ \u03bc_{M_n}(|x| > R) > \u03b5 ] \u2264 \u03b4.\nSince \u03b4 > 0 is arbitrary, this proves tightness in probability.\n\nApplying the lemma yields \u03bc_{M_n} \u21d2 \u03bc_sc in probability, and equivalently\n\u222b \u03c6 d\u03bc_{M_n} \u2192 \u222b \u03c6 d\u03bc_sc in probability for every bounded continuous \u03c6.\n\nSummary\n\n- We expanded moments and showed only tree-like words with each edge used exactly twice survive; their enumeration gives Catalan numbers.\n- Variance vanishes at rate O(n^{\u22121}), so moments converge in probability to those Catalan limits.\n- The semicircle law has exactly these moments and satisfies Carleman\u2019s condition.\n- Tightness in probability follows from high even-moment bounds, and the method of moments yields weak convergence in probability of the ESD to \u03bc_sc.\n\nTherefore, under the stated bounded-moments assumptions on the entries, the empirical spectral distribution of W_n/\u221an converges weakly in probability to Wigner\u2019s semicircle law with density (1/(2\u03c0)) sqrt(4 \u2212 x^2) on [\u22122,2]."
    },
    {
        "question": "Title: Poisson summation for Schwartz functions, the theta transformation, and the functional equation of the Riemann zeta function\n\nLet S(R) denote the Schwartz space on the real line: f \u2208 S(R) if f: R \u2192 C is smooth and for every pair of nonnegative integers m,k one has sup_{x\u2208R} |x^m f^{(k)}(x)| < \u221e. For f \u2208 S(R), define its Fourier transform by\nhat f(\u03be) = \u222b_{\u2212\u221e}^{\u221e} f(x) e^{\u22122\u03c0 i x \u03be} dx, \u03be \u2208 R.\n\nDefine the Jacobi theta function \u03b8: (0,\u221e) \u2192 R by \u03b8(t) = \u2211_{n\u2208Z} e^{\u2212\u03c0 t n^2}. For Re s > 1, define the Riemann zeta function \u03b6(s) = \u2211_{n=1}^\u221e n^{\u2212s}. Let \u0393 denote the Euler gamma function \u0393(s) = \u222b_0^\u221e t^{s\u22121} e^{\u2212t} dt for Re s > 0.\n\nTask. Prove, self-contained and in order:\n\n1) Poisson Summation Formula (PSF). Prove that for every f \u2208 S(R),\n\u2211_{n\u2208Z} f(n) = \u2211_{k\u2208Z} hat f(k).\nYour proof must be complete and include: (i) the uniform absolute convergence (with all derivatives) of the periodization F(x) = \u2211_{n\u2208Z} f(x+n), hence F is 1-periodic and smooth; (ii) computation of the Fourier coefficients of F and absolute convergence of its Fourier series.\n\n2) Theta transformation formula. For t > 0, consider g_t(x) = e^{\u2212\u03c0 t x^2}. Prove that hat g_t(\u03be) = t^{\u22121/2} e^{\u2212\u03c0 \u03be^2 / t} (compute the Fourier transform of the Gaussian). Deduce from PSF the Jacobi identity\n\u03b8(t) = t^{\u22121/2} \u03b8(1/t) for all t > 0.\nShow also that \u03b8(t) \u2212 1 = 2 \u2211_{n=1}^\u221e e^{\u2212\u03c0 n^2 t} decays exponentially as t \u2192 +\u221e and that \u03b8(t) \u223c t^{\u22121/2} as t \u2192 0+.\n\n3) Functional equation for \u03b6. For s \u2208 C, set \u039b(s) = \u03c0^{\u2212s/2} \u0393(s/2) \u03b6(s). Prove:\n- For Re s > 1, the Mellin transform identity\n\u222b_0^\u221e (\u03b8(t) \u2212 1) t^{s/2 \u2212 1} dt = 2 \u039b(s).\nJustify the exchange of sum and integral rigorously.\n- Show that the integral\nJ(s) := \u222b_1^\u221e (\u03b8(t) \u2212 1) (t^{s/2 \u2212 1} + t^{\u2212(s+1)/2}) dt\nconverges absolutely for all s \u2208 C and defines an entire function, and that J(s) = J(1 \u2212 s).\n- Prove, for Re s > 1,\n2 \u039b(s) = J(s) + 2/(s \u2212 1) \u2212 2/s,\nand conclude by analytic continuation that \u039b(s) = \u039b(1 \u2212 s) for all s \u2208 C, i.e.\n\u03c0^{\u2212s/2} \u0393(s/2) \u03b6(s) = \u03c0^{\u2212(1\u2212s)/2} \u0393((1\u2212s)/2) \u03b6(1 \u2212 s).\nFinally, deduce that \u03b6(s) extends meromorphically to C with a unique simple pole at s = 1 of residue 1.\n\nAnswer format: Provide complete proofs of (1), (2), and (3), justifying uniform/absolute convergence and all interchanges of limiting operations. State the final functional equation explicitly.",
        "answer": "We use the Fourier transform hat f(\u03be) = \u222b_{R} f(x) e^{\u22122\u03c0 i x \u03be} dx, with this normalization the Poisson Summation Formula (PSF) reads \u2211_{n\u2208Z} f(n) = \u2211_{k\u2208Z} hat f(k).\n\n1) Poisson Summation Formula for Schwartz functions\n\n- Periodization and uniform convergence. Let f \u2208 S(R). Fix N \u2265 2. There exists C_N>0 with |f(x)| \u2264 C_N (1+|x|)^{\u2212N} for all x. For x\u2208[0,1] and |n| large, 1+|x+n| \u2265 (1+|n|)/2, so\n\u2211_{n\u2208Z} |f(x+n)| \u2264 C_N \u2211_{n\u2208Z} (1+|x+n|)^{\u2212N} \u2264 C_N' \u2211_{n\u2208Z} (1+|n|)^{\u2212N} < \u221e,\nand the bound is uniform in x \u2208 [0,1]. Thus the periodization F(x) := \u2211_{n\u2208Z} f(x+n) converges absolutely and uniformly on [0,1], hence defines a continuous 1-periodic function. The same estimate applies to all derivatives because f^{(k)} is also Schwartz; by termwise differentiation, F is C^\u221e and 1-periodic.\n\n- Fourier coefficients of F. For k \u2208 Z, define c_k := \u222b_0^1 F(x) e^{\u22122\u03c0 i k x} dx. Absolute uniform convergence of F justifies interchanging sum and integral:\nc_k = \u2211_{n\u2208Z} \u222b_0^1 f(x+n) e^{\u22122\u03c0 i k x} dx.\nLet y = x+n. Then, since e^{2\u03c0 i k n} = 1,\nc_k = \u2211_{n\u2208Z} \u222b_{n}^{n+1} f(y) e^{\u22122\u03c0 i k (y\u2212n)} dy = \u222b_{\u2212\u221e}^{\u221e} f(y) e^{\u22122\u03c0 i k y} dy = hat f(k).\n\n- Absolute convergence of the Fourier series. The Fourier transform of a Schwartz function is Schwartz, so for any M>1 there is A_M such that |hat f(k)| \u2264 A_M (1+|k|)^{\u2212M}. Hence \u2211_{k\u2208Z} |hat f(k)| < \u221e (take M>1). Therefore the Fourier series \u2211_{k\u2208Z} hat f(k) e^{2\u03c0 i k x} converges absolutely and uniformly to F(x) (Weierstrass M-test). Evaluating at x=0 gives\n\u2211_{n\u2208Z} f(n) = F(0) = \u2211_{k\u2208Z} hat f(k).\nThis is PSF.\n\n2) Theta transformation via Gaussian Fourier transform\n\n- Fourier transform of the Gaussian. Fix t>0. Consider g_t(x) = e^{\u2212\u03c0 t x^2}. Then\nhat g_t(\u03be) = \u222b_{R} e^{\u2212\u03c0 t x^2} e^{\u22122\u03c0 i \u03be x} dx.\nLet y = \u221at x. Then hat g_t(\u03be) = t^{\u22121/2} \u222b_{R} e^{\u2212\u03c0 y^2} e^{\u22122\u03c0 i (\u03be/\u221at) y} dy = t^{\u22121/2} I(\u03be/\u221at), where\nI(a) := \u222b_{R} e^{\u2212\u03c0 y^2} e^{\u22122\u03c0 i a y} dy.\nWe claim I(a) = e^{\u2212\u03c0 a^2} for all a \u2208 R. Differentiate under the integral (justified by dominated convergence):\nI'(a) = \u222b e^{\u2212\u03c0 y^2} (\u22122\u03c0 i y) e^{\u22122\u03c0 i a y} dy = i \u222b (d/dy e^{\u2212\u03c0 y^2}) e^{\u22122\u03c0 i a y} dy.\nIntegrating by parts and using that e^{\u2212\u03c0 y^2} vanishes at \u00b1\u221e,\nI'(a) = \u2212i \u222b e^{\u2212\u03c0 y^2} (d/dy e^{\u22122\u03c0 i a y}) dy = \u2212i \u222b e^{\u2212\u03c0 y^2} (\u22122\u03c0 i a) e^{\u22122\u03c0 i a y} dy = \u22122\u03c0 a I(a).\nWith I(0)=\u222b e^{\u2212\u03c0 y^2}dy = 1, the ODE I'(a)=\u22122\u03c0 a I(a) yields I(a)=e^{\u2212\u03c0 a^2}. Hence\nhat g_t(\u03be) = t^{\u22121/2} e^{\u2212\u03c0 \u03be^2/t}.\n\n- Theta transformation. Apply PSF to f = g_t:\n\u03b8(t) = \u2211_{n\u2208Z} e^{\u2212\u03c0 t n^2} = \u2211_{k\u2208Z} hat g_t(k) = t^{\u22121/2} \u2211_{k\u2208Z} e^{\u2212\u03c0 k^2 / t} = t^{\u22121/2} \u03b8(1/t),\nvalid for all t>0. Since \u03b8(t) = 1 + 2\u2211_{n\u22651} e^{\u2212\u03c0 t n^2}, the tail \u03b8(t) \u2212 1 is dominated by 2 e^{\u2212\u03c0 t} \u2211_{n\u22651} e^{\u2212\u03c0 t (n^2 \u2212 1)} \u2264 2 e^{\u2212\u03c0 t}/(1 \u2212 e^{\u22123\u03c0 t}) for t large, hence decays exponentially as t\u2192\u221e. As t\u21920+, the functional equation gives \u03b8(t) = t^{\u22121/2} \u03b8(1/t) with \u03b8(1/t) \u2192 1, so \u03b8(t) \u223c t^{\u22121/2}.\n\n3) Functional equation for \u03b6 via Mellin transforms\n\nSet \u039b(s) = \u03c0^{\u2212s/2} \u0393(s/2) \u03b6(s).\n\n- Mellin transform identity for Re s > 1. For Re s > 1, using \u03b8(t) \u2212 1 = 2\u2211_{n\u22651} e^{\u2212\u03c0 n^2 t} and Tonelli\u2019s theorem (absolute convergence shown below), we compute\n\u222b_0^\u221e (\u03b8(t) \u2212 1) t^{s/2 \u2212 1} dt\n= 2 \u2211_{n=1}^\u221e \u222b_0^\u221e e^{\u2212\u03c0 n^2 t} t^{s/2 \u2212 1} dt.\nFor \u03c3 := Re s > 1,\n\u222b_0^\u221e e^{\u2212\u03c0 n^2 t} t^{\u03c3/2 \u2212 1} dt = (\u03c0 n^2)^{\u2212\u03c3/2} \u0393(\u03c3/2),\nhence by analytic continuation in s within Re s > 1,\n\u222b_0^\u221e (\u03b8(t) \u2212 1) t^{s/2 \u2212 1} dt = 2 \u0393(s/2) \u03c0^{\u2212s/2} \u2211_{n=1}^\u221e n^{\u2212s} = 2 \u039b(s).\nJustification of exchanging sum and integral: for Re s > 1,\n\u2211_{n=1}^\u221e \u222b_0^\u221e |e^{\u2212\u03c0 n^2 t}| t^{\u03c3/2 \u2212 1} dt = \u0393(\u03c3/2) \u03c0^{\u2212\u03c3/2} \u2211_{n=1}^\u221e n^{\u2212\u03c3} < \u221e,\nso Tonelli applies.\n\n- The auxiliary entire function J(s). Define\nJ(s) := \u222b_1^\u221e (\u03b8(t) \u2212 1) (t^{s/2 \u2212 1} + t^{\u2212(s+1)/2}) dt.\nFor each fixed t \u2265 1, s \u21a6 t^{s/2 \u2212 1} + t^{\u2212(s+1)/2} is entire. Moreover, since \u03b8(t) \u2212 1 = O(e^{\u2212\u03c0 t}), the integrand is dominated by Ce^{\u2212\u03c0 t} (t^{\u03c3/2 \u2212 1} + t^{\u2212\u03c3/2 \u2212 1/2}) for \u03c3 = Re s, which is integrable uniformly on compact \u03c3-sets. By standard theorems on parameter-dependent integrals (dominated convergence/Morera), J(s) is entire. The symmetry J(s) = J(1 \u2212 s) follows directly from\nt^{s/2 \u2212 1} + t^{\u2212(s+1)/2} = t^{(1\u2212s)/2 \u2212 1} + t^{\u2212((1\u2212s)+1)/2}.\n\n- Identity relating \u039b and J for Re s > 1. Split the Mellin integral at t=1 and use the theta transformation on (0,1):\n\u222b_0^1 (\u03b8(t) \u2212 1) t^{s/2 \u2212 1} dt\n= \u222b_1^\u221e (\u03b8(1/u) \u2212 1) u^{\u2212s/2 \u2212 1} du\n= \u222b_1^\u221e (u^{1/2} \u03b8(u) \u2212 1) u^{\u2212s/2 \u2212 1} du\n= \u222b_1^\u221e (\u03b8(u) \u2212 1) u^{\u2212(s+1)/2} du + \u222b_1^\u221e (u^{\u2212s/2 \u2212 1/2} \u2212 u^{\u2212s/2 \u2212 1}) du.\nHence, for Re s > 1,\n\u222b_0^\u221e (\u03b8(t) \u2212 1) t^{s/2 \u2212 1} dt\n= \u222b_1^\u221e (\u03b8(t) \u2212 1) (t^{s/2 \u2212 1} + t^{\u2212(s+1)/2}) dt + \u222b_1^\u221e (t^{\u2212(s+1)/2} \u2212 t^{\u2212s/2 \u2212 1}) dt.\nThe bracket integrals are elementary:\n\u222b_1^\u221e t^{\u2212(s+1)/2} dt = 2/(s \u2212 1) for Re s > 1, and \u222b_1^\u221e t^{\u2212s/2 \u2212 1} dt = 2/s for Re s > 0. Therefore, for Re s > 1,\n2 \u039b(s) = J(s) + 2/(s \u2212 1) \u2212 2/s.   (\u22c6)\n\n- Functional equation by analytic continuation. The identity (\u22c6) expresses 2\u039b(s) as the sum of an entire function J(s) and a rational function in s with simple poles at s=0,1. Since J(s) = J(1 \u2212 s), replacing s by 1 \u2212 s in (\u22c6) gives\n2 \u039b(1 \u2212 s) = J(s) \u2212 2/s \u2212 2/(1 \u2212 s).\nSubtracting, we find\n2 \u039b(s) \u2212 2 \u039b(1 \u2212 s) = [2/(s \u2212 1) \u2212 2/s] \u2212 [\u22122/s \u2212 2/(1 \u2212 s)] = 0,\nso \u039b(s) = \u039b(1 \u2212 s) for all s by analytic continuation (both sides are meromorphic and agree on Re s > 1). Thus we obtain the functional equation\n\u03c0^{\u2212s/2} \u0393(s/2) \u03b6(s) = \u03c0^{\u2212(1\u2212s)/2} \u0393((1\u2212s)/2) \u03b6(1 \u2212 s), for all s \u2208 C.   (FE)\n\n- Meromorphic continuation and residue at s = 1. The identity (\u22c6) shows 2\u039b(s) is meromorphic on C with only simple poles at s=0 and s=1, because J is entire. Since \u0393(s/2) has simple poles at s = 0, \u22122, \u22124, \u2026, while \u039b(s) has only simple poles at s=0,1, it follows that \u03b6(s) = \u03c0^{s/2} \u0393(s/2)^{\u22121} \u039b(s) extends meromorphically to C with a unique simple pole at s = 1. From (\u22c6), Res_{s=1} (2\u039b(s)) = Res_{s=1} (2/(s\u22121)) = 2, hence Res_{s=1} \u039b(s) = 1. Since \u03c0^{\u22121/2} \u0393(1/2) = 1, this implies Res_{s=1} \u03b6(s) = 1.\n\nFinal statement. For all s \u2208 C,\n\u03c0^{\u2212s/2} \u0393(s/2) \u03b6(s) = \u03c0^{\u2212(1\u2212s)/2} \u0393((1\u2212s)/2) \u03b6(1 \u2212 s),\nand \u03b6 extends meromorphically to C with a unique simple pole at s=1 of residue 1."
    },
    {
        "question": "Title: Lucas\u2019 theorem, Kummer\u2019s theorem, and sharp digit\u2013carry structure of binomial coefficients\n\nLet p be a fixed prime. For a nonnegative integer n, write its base-p expansion as n = \u2211_{i=0}^r n_i p^i with digits n_i \u2208 {0,1,\u2026,p\u22121}; define the base-p digit sum s_p(n) = \u2211_{i=0}^r n_i. For integers n \u2265 k \u2265 0, write v_p(m) for the exponent of p in m (i.e., the largest e \u2265 0 with p^e | m; for m = 0 set v_p(0) = +\u221e). For a,b \u2265 0, define Carr_p(a,b) as the number of carries that occur when adding a and b in base p (i.e., the number of positions where the base-p addition algorithm produces a carry to the next higher digit).\n\nProblem. Prove, self-contained and in order:\n\n1) Lucas\u2019 theorem (mod p digitwise factorization). For all integers n,k \u2265 0 with base-p expansions n = \u2211 n_i p^i and k = \u2211 k_i p^i, show\n   binom(n,k) \u2261 \u220f_{i=0}^r binom(n_i, k_i) (mod p),\nwith the convention binom(a,b) = 0 when b > a. Conclude that binom(n,k) \u2262 0 (mod p) if and only if k_i \u2264 n_i for all i.\n\n2) Legendre\u2019s formula and Kummer\u2019s theorem. Prove Legendre\u2019s formula\n   v_p(n!) = \u2211_{j=1}^\u221e \u23a3n/p^j\u23a6 = (n \u2212 s_p(n)) / (p \u2212 1).\nDeduce Kummer\u2019s theorem:\n   v_p(binom(n,k)) = Carr_p(k, n \u2212 k).\nEquivalently, using Legendre,\n   v_p(binom(n,k)) = ( s_p(k) + s_p(n \u2212 k) \u2212 s_p(n) ) / (p \u2212 1).\nProve the identity Carr_p(a,b) = ( s_p(a) + s_p(b) \u2212 s_p(a + b) ) / (p \u2212 1) for all a,b \u2265 0 in base p to justify the equality with carries.\n\n3) Two sharp applications.\n   a) Count of nonzero binomial coefficients mod p. Prove that the number of k \u2208 {0,\u2026,n} with binom(n,k) \u2262 0 (mod p) equals \u220f_{i=0}^r (n_i + 1). In particular, for p = 2 this number equals 2^{popcount(n)}, the power of 2 determined by the number of 1s in the binary expansion of n.\n   b) The 2-adic valuation of the central binomial coefficient. Prove that\n      v_2( binom(2n, n) ) = s_2(n).\n(Equivalently, the highest power of 2 dividing binom(2n,n) equals 2^{s_2(n)}.)\n\nAnswer format: Provide complete, rigorous proofs of (1) and (2), including all justifications for congruences and identities with digit sums and carries. Then prove both statements in (3), clearly citing the earlier results where needed.",
        "answer": "We work throughout with a fixed prime p.\n\n1) Lucas\u2019 theorem\n\nClaim. For n,k \u2265 0 with base-p expansions n = \u2211_{i=0}^r n_i p^i, k = \u2211_{i=0}^r k_i p^i (with 0 \u2264 n_i,k_i \u2264 p\u22121), one has\nbinom(n,k) \u2261 \u220f_{i=0}^r binom(n_i, k_i) (mod p).\n\nProof. Consider the binomial generating function in the polynomial ring F_p[x]:\n(1 + x)^n = \u2211_{k=0}^n binom(n,k) x^k.\nWrite n in base p. Using the Freshman\u2019s dream in characteristic p, (A + B)^p \u2261 A^p + B^p (mod p), we get\n(1 + x)^n = (1 + x)^{\u2211 n_i p^i} = \u220f_{i=0}^r (1 + x)^{n_i p^i} \u2261 \u220f_{i=0}^r ( (1 + x^{p^i})^{n_i} ) (mod p),\nbecause (1 + x)^{p^i} \u2261 1 + x^{p^i} in F_p[x].\n\nExpand each factor:\n(1 + x^{p^i})^{n_i} = \u2211_{t_i=0}^{n_i} binom(n_i,t_i) x^{t_i p^i}.\nMultiplying over i, we obtain the full expansion\n(1 + x)^n \u2261 \u2211_{(t_i)} ( \u220f_{i=0}^r binom(n_i,t_i) ) x^{\u2211 t_i p^i} (mod p),\nwhere the sum ranges over 0 \u2264 t_i \u2264 n_i. The coefficient of x^k, where k = \u2211 k_i p^i is the base-p expansion, is exactly \u220f binom(n_i, k_i) (interpreting binom(n_i,k_i) = 0 if k_i > n_i). Comparing with the expansion \u2211 binom(n,k) x^k, we get Lucas\u2019 congruence:\nbinom(n,k) \u2261 \u220f_{i=0}^r binom(n_i, k_i) (mod p).\nThe \u201conly if\u201d statement follows immediately: the product on the right is nonzero mod p if and only if each k_i \u2264 n_i. This completes (1).\n\n2) Legendre\u2019s formula and Kummer\u2019s theorem\n\n2a) Legendre\u2019s formula. We show\nv_p(n!) = \u2211_{j=1}^\u221e \u23a3n/p^j\u23a6 = (n \u2212 s_p(n)) / (p \u2212 1).\n\nProof of the first equality is standard: \u23a3n/p\u23a6 counts the multiples of p in {1,\u2026,n}, \u23a3n/p^2\u23a6 counts those contributing an extra factor p (i.e., multiples of p^2), etc., so the total exponent is the sum over j \u2265 1.\n\nTo obtain the digit-sum formula, write n = \u2211_{i=0}^r n_i p^i. Then\n\u23a3n/p^j\u23a6 = \u2211_{i=j}^r n_i p^{i\u2212j}.\nSumming over j \u2265 1,\n\u2211_{j=1}^\u221e \u23a3n/p^j\u23a6 = \u2211_{j=1}^r \u2211_{i=j}^r n_i p^{i\u2212j} = \u2211_{i=1}^r n_i \u2211_{j=1}^i p^{i\u2212j} = \u2211_{i=1}^r n_i (p^{i\u22121} + \u2026 + p + 1).\nBut p^{i\u22121} + \u2026 + 1 = (p^i \u2212 1)/(p \u2212 1). Hence\n\u2211_{j=1}^\u221e \u23a3n/p^j\u23a6 = \u2211_{i=1}^r n_i (p^i \u2212 1)/(p \u2212 1) = (1/(p \u2212 1)) [ \u2211_{i=1}^r n_i p^i \u2212 \u2211_{i=1}^r n_i ].\nNoting \u2211_{i=1}^r n_i p^i = n \u2212 n_0 and \u2211_{i=1}^r n_i = s_p(n) \u2212 n_0, we get\n\u2211_{j=1}^\u221e \u23a3n/p^j\u23a6 = (1/(p \u2212 1)) [ (n \u2212 n_0) \u2212 (s_p(n) \u2212 n_0) ] = (n \u2212 s_p(n))/(p \u2212 1),\nas claimed.\n\n2b) Kummer\u2019s theorem. We prove two identities and then show they are equal:\n\n(i) Using Legendre\u2019s formula,\nv_p(binom(n,k)) = v_p(n!) \u2212 v_p(k!) \u2212 v_p((n \u2212 k)!) = [ (n \u2212 s_p(n)) \u2212 (k \u2212 s_p(k)) \u2212 (n \u2212 k \u2212 s_p(n \u2212 k)) ] / (p \u2212 1)\n= ( s_p(k) + s_p(n \u2212 k) \u2212 s_p(n) ) / (p \u2212 1).\n\n(ii) Number of carries identity. For any a,b \u2265 0,\nCarr_p(a,b) = ( s_p(a) + s_p(b) \u2212 s_p(a + b) ) / (p \u2212 1).\n\nProof of (ii). Add a and b in base p. At each digit position i, let a_i,b_i \u2208 {0,\u2026,p\u22121} be the digits and c_i \u2208 {0,1} be the incoming carry from the (i\u22121)-th position (with c_0 = 0). Then a_i + b_i + c_i = p c_{i+1} + d_i, where the outgoing carry c_{i+1} \u2208 {0,1} (since a_i + b_i + c_i \u2264 2(p\u22121) + 1 < 2p), and the resulting digit d_i \u2208 {0,\u2026,p\u22121}. Summing over i and using that the final carry c_{r+1} equals 0 unless a + b produces an extra digit (in which case s_p(a + b) accounts for it), we have\n\u2211_i (a_i + b_i) + \u2211_i c_i = \u2211_i d_i + p \u2211_i c_{i+1}.\nRearrange:\ns_p(a) + s_p(b) \u2212 s_p(a + b) = (p \u2212 1) \u2211_i c_{i+1}.\nBut \u2211_i c_{i+1} is exactly the number of positions that produce a carry, i.e., Carr_p(a,b). This proves (ii).\n\nNow apply (ii) with a = k and b = n \u2212 k:\nCarr_p(k, n \u2212 k) = ( s_p(k) + s_p(n \u2212 k) \u2212 s_p(n) ) / (p \u2212 1).\nComparing with (i) gives Kummer\u2019s theorem:\nv_p(binom(n,k)) = Carr_p(k, n \u2212 k).\n\n3) Applications\n\n3a) Count of nonzero binomial coefficients mod p. By Lucas\u2019 theorem, binom(n,k) \u2262 0 (mod p) if and only if k_i \u2264 n_i for all i. For each i there are exactly n_i + 1 choices for k_i \u2208 {0,\u2026,n_i}. The base-p digits are independent, so the total number of k \u2208 {0,\u2026,n} with binom(n,k) \u2262 0 (mod p) is \u220f_{i=0}^r (n_i + 1). For p = 2, each n_i \u2208 {0,1}, so the count is \u220f (n_i + 1) = 2^{# {i : n_i = 1}} = 2^{popcount(n)}.\n\n3b) 2-adic valuation of the central binomial coefficient. Using the digit-sum formula from 2a),\nv_2(binom(2n,n)) = ( s_2(n) + s_2(n) \u2212 s_2(2n) ) / (2 \u2212 1) = 2 s_2(n) \u2212 s_2(2n).\nIn base 2, doubling corresponds to a left shift by one binary place, which does not change the number of 1s: s_2(2n) = s_2(n). Hence\nv_2( binom(2n,n) ) = 2 s_2(n) \u2212 s_2(n) = s_2(n).\nEquivalently, by Kummer, v_2( binom(2n,n) ) equals Carr_2(n,n), the number of carries when adding n to itself in binary; the identity above shows this number equals s_2(n).\n\nAll claims are proved."
    },
    {
        "question": "Title: Extremal intersecting families of k-sets \u2014 the Erd\u0151s\u2013Ko\u2013Rado theorem and the sharp Hilton\u2013Milner refinement with full structure\n\nLet n and k be integers with 1 \u2264 k \u2264 n. Write [n] := {1,2,\u2026,n}. A family F \u2282 binom([n], k) (the set of all k-element subsets of [n]) is intersecting if A \u2229 B \u2260 \u2205 for all A,B \u2208 F. The intersection of all members is \u22c2_{A\u2208F} A; it may be empty.\n\nTasks.\n\n1) Erd\u0151s\u2013Ko\u2013Rado (EKR). Prove that if n \u2265 2k and F \u2282 binom([n], k) is intersecting, then |F| \u2264 binom(n\u22121, k\u22121).\n\nMoreover, determine all families attaining equality.\n- If n > 2k, show that the only maximum families are the \u201cstars\u201d St(i) := {A \u2208 binom([n], k) : i \u2208 A}, up to relabeling of [n].\n- If n = 2k, show that the maximum families are exactly the stars St(i) and the \u201cco-stars\u201d CoSt(i) := {A \u2208 binom([n], k) : i \u2209 A}, up to relabeling.\n\n2) Hilton\u2013Milner theorem (sharp refinement without a common element). Assume n > 2k and F \u2282 binom([n], k) is intersecting with empty total intersection \u22c2_{A\u2208F} A = \u2205. Prove that\n|F| \u2264 binom(n\u22121, k\u22121) \u2212 binom(n\u2212k\u22121, k\u22121) + 1.\n\nShow that equality holds precisely for the following structure (up to relabeling): fix an element 1 \u2208 [n] and a k-set B \u2282 [n]\\{1}, and set\nHM(1,B) := {A \u2208 binom([n], k) : 1 \u2208 A and A \u2229 B \u2260 \u2205} \u222a {B}.\nProve that HM(1,B) is intersecting with empty total intersection, has size binom(n\u22121,k\u22121) \u2212 binom(n\u2212k\u22121,k\u22121) + 1, and that every maximum family with empty total intersection is of this form.\n\nAnswer format:\n- State the final bounds and the extremal structures.\n- Provide complete, rigorous proofs: an EKR proof (you may use the cycle method or shifting/compressions) with equality characterization, and a Hilton\u2013Milner proof with both the bound and the exact extremal structure.",
        "answer": "We write [n] = {1,2,\u2026,n} and binom([n],k) for all k-element subsets of [n]. A family F \u2282 binom([n],k) is intersecting if every two members meet.\n\nPart 1: Erd\u0151s\u2013Ko\u2013Rado (EKR)\n\nStatement. If n \u2265 2k and F \u2282 binom([n],k) is intersecting, then |F| \u2264 binom(n\u22121,k\u22121). Moreover:\n- If n > 2k, equality holds if and only if F is a star St(i) = {A : i \u2208 A}, for some i.\n- If n = 2k, equality holds if and only if F is a star St(i) or co-star CoSt(i) = {A : i \u2209 A}, for some i.\n\nProof of the bound by Katona\u2019s cycle method.\nFix a cyclic order \u03c0 of [n] around a circle; identify indices mod n. Define the family of cyclic k-intervals\nI_k(\u03c0) := { {x, x+1, \u2026, x+k\u22121} mod n : x \u2208 [n] }.\nThus |I_k(\u03c0)| = n.\n\nLemma (intersection bound on a cycle). For any cyclic order \u03c0 and any subfamily G \u2282 I_k(\u03c0) that is pairwise intersecting, we have |G| \u2264 k. Moreover, equality holds if and only if there is a point v \u2208 [n] such that every interval in G contains v.\n\nProof. Let the start positions of members of G be S \u2282 [n]. The interval beginning at s \u2208 [n] runs from s to s+k\u22121 (mod n). If s,t \u2208 S are at cyclic distance at least k, then the corresponding intervals are disjoint. Hence S lies within some cyclic window of length k, so |S| \u2264 k. If |S| = k, then S is exactly a block of k consecutive starts; the corresponding intervals all contain the endpoint of that block. Conversely, any such block gives a pairwise-intersecting family of size k. This proves the lemma.\n\nNow count pairs (\u03c0,J) where \u03c0 is a cyclic ordering (there are (n\u22121)! of them) and J \u2208 F \u2229 I_k(\u03c0). By the lemma, for each \u03c0 we have |F \u2229 I_k(\u03c0)| \u2264 k, so\n\u2211_{\u03c0} |F \u2229 I_k(\u03c0)| \u2264 k (n\u22121)!.\n\nCount the same sum by summing over J \u2208 F. For a fixed J, the number of cyclic orders \u03c0 in which J appears as an interval equals k!(n\u2212k)!. Indeed, arranging [n] on a circle up to rotation (i.e., choosing a cyclic ordering) is (n\u22121)!, and to make J an interval, first linearly order J (k! ways), linearly order [n]\\J ((n\u2212k)! ways), and then place the two chains contiguously on the circle; this accounts exactly for k!(n\u2212k)! of the (n\u22121)! cycles. Hence\n\u2211_{\u03c0} |F \u2229 I_k(\u03c0)| = |F| \u00b7 k!(n\u2212k)!.\n\nCombining the two evaluations gives\n|F| \u00b7 k!(n\u2212k)! \u2264 k (n\u22121)!,\ni.e.\n|F| \u2264 k (n\u22121)! / (k!(n\u2212k)!) = (n\u22121)! / ((k\u22121)!(n\u2212k)!) = binom(n\u22121,k\u22121).\nThis proves the EKR bound.\n\nStars achieve equality: |St(i)| = binom(n\u22121,k\u22121). For n = 2k, co-stars also have size binom(n\u22121,k\u22121) since binom(2k\u22121,k) = binom(2k\u22121,k\u22121), and CoSt(i) is intersecting (two k-subsets of a (2k\u22121)-set must intersect).\n\nEquality characterization for n > 2k.\nAssume |F| = binom(n\u22121,k\u22121) and n > 2k. Fix any i \u2208 [n]. If F contains a set B with i \u2209 B, then no member of F containing i can be disjoint from B. The number of members of St(i) that are disjoint from B equals binom(n\u22121\u2212k, k\u22121) = binom(n\u2212k\u22121, k\u22121) \u2265 1 (since n\u2212k\u22121 \u2265 k when n > 2k). Thus\n|F \u2229 St(i)| \u2264 binom(n\u22121,k\u22121) \u2212 binom(n\u2212k\u22121, k\u22121) < binom(n\u22121,k\u22121).\nIf F contained any set missing i, then even after adding all sets in St(i) that meet that set, we would not reach the full star size binom(n\u22121,k\u22121). Since |F| already equals binom(n\u22121,k\u22121), it follows that for each i there is no B \u2208 F with i \u2209 B, i.e. every member of F contains i. Hence F = St(i). This holds for some i; uniqueness up to relabeling follows.\n\nEquality characterization for n = 2k.\nWe have shown the bound and that both St(i) and CoSt(i) attain it. Conversely, suppose |F| = binom(2k\u22121,k\u22121). If there exists i such that all members of F contain i, then F = St(i). Otherwise, for each i there is B_i \u2208 F with i \u2209 B_i. Fix i; then every set in F that contains i must meet B_i, and the number of sets in St(i) that are disjoint from B_i equals binom(n\u2212k\u22121,k\u22121) = binom(k\u22121,k\u22121) = 1. Thus F \u2229 St(i) has size at most binom(2k\u22121,k\u22121) \u2212 1. To reach the total |F| = binom(2k\u22121,k\u22121), F must include exactly one set not containing i, namely B_i, and all k-sets containing i except the unique one disjoint from B_i. For n = 2k this family equals CoSt(i): indeed, CoSt(i) has the same description (take B_i to be any k-set not containing i; the unique k-set containing i that is disjoint from B_i is its complement). Hence, up to relabeling, F is St(i) or CoSt(i). This completes EKR.\n\nPart 2: Hilton\u2013Milner theorem\n\nStatement. Suppose n > 2k and F \u2282 binom([n],k) is intersecting with empty total intersection \u22c2_{A\u2208F} A = \u2205. Then\n|F| \u2264 binom(n\u22121, k\u22121) \u2212 binom(n\u2212k\u22121, k\u22121) + 1.\nMoreover, equality holds if and only if (up to relabeling) there exist 1 \u2208 [n] and B \u2208 binom([n]\\{1}, k) such that\nF = HM(1,B) := {A \u2208 binom([n],k) : 1 \u2208 A and A \u2229 B \u2260 \u2205} \u222a {B}.\n\nProof of the bound.\nSince \u22c2_{A\u2208F} A = \u2205, there is some element x \u2208 [n] that is not contained in some member B \u2208 F. Relabel so x = 1. Consider the subfamily F_1 := {A \u2208 F : 1 \u2208 A} and F_0 := F \\ F_1 (the members not containing 1). By choice of B \u2208 F_0, every A \u2208 F_1 must meet B (otherwise A and B would be disjoint). The number of k-sets containing 1 and meeting B equals\nbinom(n\u22121,k\u22121) \u2212 binom(n\u22121\u2212|B|,k\u22121) = binom(n\u22121,k\u22121) \u2212 binom(n\u2212k\u22121,k\u22121).\nHence |F_1| \u2264 binom(n\u22121,k\u22121) \u2212 binom(n\u2212k\u22121,k\u22121).\n\nAny further set in F_0 beyond B forces additional restrictions on F_1 (its members must then meet both B and that set), so allowing more than one set in F_0 cannot increase the total size. Therefore\n|F| = |F_1| + |F_0| \u2264 [binom(n\u22121,k\u22121) \u2212 binom(n\u2212k\u22121,k\u22121)] + 1.\n\nThis proves the Hilton\u2013Milner bound.\n\nThe extremal construction and its size.\nFix 1 \u2208 [n] and B \u2208 binom([n]\\{1},k). Let\nHM(1,B) := {A \u2208 binom([n],k) : 1 \u2208 A and A \u2229 B \u2260 \u2205} \u222a {B}.\nThis family is intersecting: any two members containing 1 meet in 1; B meets every member of F with 1 by design; and there is only one member without 1, namely B. Its total intersection is empty because B does not contain 1. Its size is exactly\n|HM(1,B)| = [binom(n\u22121,k\u22121) \u2212 binom(n\u2212k\u22121,k\u22121)] + 1,\nmatching the bound.\n\nEquality characterization.\nAssume F is intersecting, \u22c2_{A\u2208F} A = \u2205, n > 2k, and |F| attains the bound. Relabel so there exists B \u2208 F with 1 \u2209 B. As observed, every member of F containing 1 must intersect B, so |F_1| \u2264 binom(n\u22121,k\u22121) \u2212 binom(n\u2212k\u22121,k\u22121). Since equality holds in the total bound, we must have:\n- |F_0| = 1 (i.e., F_0 = {B}); otherwise, adding any second member to F_0 would force F_1 to be contained in the subfamily of sets containing 1 that meet both B and that second set, strictly smaller than the family meeting only B (because n > 2k), reducing the total.\n- |F_1| = binom(n\u22121,k\u22121) \u2212 binom(n\u2212k\u22121,k\u22121), and F_1 consists of all k-sets containing 1 that meet B; if some A containing 1 and meeting B were missing from F, we could add it without breaking the intersecting property (it meets B and all sets containing 1), contradicting maximality.\n\nHence F = HM(1,B). This identifies all extremals, up to relabeling. The theorem is proved.\n\nSummary.\n- EKR: For n \u2265 2k, any intersecting F \u2282 binom([n],k) satisfies |F| \u2264 binom(n\u22121,k\u22121). If n > 2k, equality holds iff F is a star St(i); if n = 2k, equality holds iff F is St(i) or CoSt(i).\n- Hilton\u2013Milner: For n > 2k, any intersecting F with empty total intersection satisfies |F| \u2264 binom(n\u22121,k\u22121) \u2212 binom(n\u2212k\u22121,k\u22121) + 1, with equality iff F is HM(1,B) up to relabeling."
    },
    {
        "question": "Title: Finite subgroups of SO(3) \u2014 a complete classification via poles and a sharp counting argument\n\nLet S^2 \u2282 R^3 be the unit sphere and let SO(3) be the group of orientation-preserving isometries of S^2 (i.e., rotations of R^3). For a finite subgroup G \u2264 SO(3), call a point p \u2208 S^2 a pole if p is fixed by some non-identity element of G. For p \u2208 S^2, write G_p = {g \u2208 G : g\u00b7p = p} for the stabilizer of p, and let n_p := |G_p|.\n\nTasks.\n\n1) Poles, stabilizers, and a counting identity. Prove:\n   a) Every non-identity rotation in SO(3) fixes exactly two points of S^2 (the endpoints of its axis). For a pole p of G, the stabilizer G_p is cyclic and consists of all rotations about the line through p and \u2212p. In particular, n_p \u2265 2.\n   b) Let P be the set of poles of G. Prove the double-counting identity\n      \u2211_{p\u2208P} (n_p \u2212 1) = 2(|G| \u2212 1).\n      Deduce that if P \u2260 \u2205 and k denotes the number of G-orbits in P, then k \u2264 3. Let the distinct orbits be represented by p_1,\u2026,p_k with n_i := |G_{p_i}| and orbit sizes m_i = |G|/n_i. Show that necessarily:\n      - If k = 2, then n_1 = n_2 and |G| = n_1 = n_2.\n      - If k = 3, then (up to reordering)\n        (n_1,n_2,n_3) \u2208 {(2,2,n) with |G| = 2n; (2,3,3) with |G| = 12; (2,3,4) with |G| = 24; (2,3,5) with |G| = 60}.\n\n2) Classification up to conjugacy in SO(3). Prove that every finite subgroup G \u2264 SO(3) is conjugate to exactly one of the following:\n   - A cyclic group C_n (n \u2265 1) of all rotations about a fixed axis by integer multiples of 2\u03c0/n.\n   - A dihedral rotation group D_n (n \u2265 2) of order 2n consisting of all rotations preserving a regular n-gon in some plane: the n rotations about the normal axis and n half-turns about axes in the polygon\u2019s plane through opposite vertices or edge midpoints.\n   - The rotation group of a regular tetrahedron (order 12).\n   - The rotation group of a cube/octahedron (order 24).\n   - The rotation group of an icosahedron/dodecahedron (order 60).\n\n   More precisely, show:\n   - For k = 2, G is conjugate to C_n with n = |G|.\n   - For (n_1,n_2,n_3) = (2,2,n) and |G| = 2n, G is conjugate to D_n.\n   - For (2,3,3), (2,3,4), and (2,3,5), G is conjugate respectively to the rotation groups of the tetrahedron, cube/octahedron, and icosahedron/dodecahedron.\n\n   In each case, compute the number of axes of each rotational order r appearing in G. (An axis of order r means: the set of points \u00b1p on S^2 for which the subgroup G_p has order r.)\n\n3) Isomorphism types and element counts. Show that the three Platonic rotation groups are isomorphic to A_4, S_4, A_5, respectively. Exhibit faithful permutation representations (on 4 vertices for the tetrahedron, on 4 body-diagonals for the cube, and explain a faithful representation on 5 objects for the icosahedron/dodecahedron), and determine the number of elements of orders 2, 3, 4, and 5 in each group.\n\nAnswer format:\n- Prove (1a) and (1b), deriving the listed possibilities for (n_1,n_2,n_3) and |G|.\n- Classify all finite subgroups up to conjugacy as above, meeting the listed cases and computing axis counts.\n- Establish the isomorphisms to A_4, S_4, A_5 and give complete element-order counts in each case.",
        "answer": "Solution.\n\nWe work in R^3 with S^2 the unit sphere and SO(3) acting by rotations. Throughout, \u201caxis\u201d means an unoriented line through the origin (equivalently the antipodal pair {p, \u2212p} for some p \u2208 S^2).\n\n1) Poles, stabilizers, and the key identity.\n\n1a) Fixed points and cyclic stabilizers.\n- Let R \u2208 SO(3) be non-identity. Then R is a rotation by some angle \u03b8 \u2208 (0,\u03c0] about a unique axis L through the origin. On S^2, the fixed points are precisely L \u2229 S^2 = {p, \u2212p}. Indeed, if x \u2208 S^2 is fixed and x \u2209 L, then the plane spanned by x and L is invariant and R restricts to a nontrivial rotation in that plane fixing x, which is impossible unless \u03b8 = 0, a contradiction. Thus exactly two fixed points.\n- If p is fixed by some non-identity g \u2208 G, then every h \u2208 G_p fixes both p and \u2212p, hence h is a rotation about the axis through \u00b1p. The rotations about a fixed axis form a copy of SO(2), and a finite subgroup of a circle is cyclic; thus G_p is cyclic. Hence n_p := |G_p| \u2265 2.\n\n1b) Double counting and the restriction k \u2264 3.\nLet P be the set of poles of G (i.e., points of S^2 fixed by some nontrivial g \u2208 G). Consider\nA := { (g,p) : g \u2208 G \\ {1}, p \u2208 S^2, g\u00b7p = p }.\nCount A in two ways.\n\n- For fixed g \u2260 1, there are exactly two fixed points on S^2, so the g-fiber has size 2. Thus |A| = 2(|G| \u2212 1).\n- For a fixed pole p, the elements g \u2260 1 fixing p are exactly G_p \\ {1}, of cardinality n_p \u2212 1. Therefore\n  |A| = \u2211_{p\u2208P} (n_p \u2212 1).\n\nEquating the two counts gives:\n\u2211_{p\u2208P} (n_p \u2212 1) = 2(|G| \u2212 1).   (\u22c6)\n\nNow decompose P into G-orbits. Let p_1,\u2026,p_k be orbit representatives, and set n_i := |G_{p_i}| and m_i := |G\u00b7p_i| = |G|/n_i. Within an orbit all stabilizer sizes are equal (conjugate stabilizers have the same order). Grouping (\u22c6) by orbits yields\n\u2211_{i=1}^k m_i (n_i \u2212 1) = 2(|G| \u2212 1),\ni.e.\n\u2211_{i=1}^k (|G|/n_i) (n_i \u2212 1) = 2(|G| \u2212 1),\nhence, after dividing by |G| > 0,\n\u2211_{i=1}^k (1 \u2212 1/n_i) = 2 \u2212 2/|G|.   (1)\n\nEquivalently,\n\u2211_{i=1}^k (1/n_i) = k \u2212 2 + 2/|G|.   (2)\n\nSince n_i \u2265 2 for each pole orbit, (2) implies\nk/2 \u2265 k \u2212 2 + 2/|G|, so k \u2264 3.\nAlso, k \u2260 0 if G \u2260 {1} (there is some nontrivial g, hence some pole), and k \u2260 1 because then \u2211 1/n_i = 1 \u2212 2 + 2/|G| < 0 (impossible). Thus k \u2208 {2,3}.\n\nCase k = 2. Then (2) gives 1/n_1 + 1/n_2 = 2/|G|. Since n_i \u2265 2, the only way to have 2/|G| as a sum of two reciprocals of integers \u2265 2 is to have n_1 = n_2 = |G|. Consequently m_1 = m_2 = 1: the two G-orbits of poles are singletons (two antipodal fixed points for the whole group).\n\nCase k = 3. Then (2) gives\n1/n_1 + 1/n_2 + 1/n_3 = 1 + 2/|G|.\nSince 1/n_i \u2264 1/2, the left-hand side exceeds 1 only in very few cases. Without loss of generality, 2 \u2264 n_1 \u2264 n_2 \u2264 n_3. If n_1 \u2265 3 then the left side \u2264 1 (since 1/3 + 1/3 + 1/3 = 1), contradicting 1 + 2/|G| > 1. Hence n_1 = 2, so\n1/2 + 1/n_2 + 1/n_3 = 1 + 2/|G|, i.e. 1/n_2 + 1/n_3 = 1/2 + 2/|G|.\nAs 2/|G| \u2264 1 (with equality only when |G| = 2), we must have 1/n_2 + 1/n_3 > 1/2, which forces the pairs\n(n_2,n_3) \u2208 {(2,n) arbitrary n \u2265 2; (3,3); (3,4); (3,5)}.\nPlugging into (1) fixes |G|:\n- (2,2,n): 1/2+1/2 + 1/n = 1 + 1/n = 2 \u2212 2/|G| \u21d2 |G| = 2n.\n- (2,3,3): 1/2+1/3+1/3 = 1 + 1/6 = 2 \u2212 2/|G| \u21d2 |G| = 12.\n- (2,3,4): 1/2+1/3+1/4 = 1 + 1/12 = 2 \u2212 2/|G| \u21d2 |G| = 24.\n- (2,3,5): 1/2+1/3+1/5 = 1 + 1/30 = 2 \u2212 2/|G| \u21d2 |G| = 60.\n\nThis completes the restriction list.\n\n2) Classification up to conjugacy in SO(3) and axis counts.\n\nWe now identify G in each case. We also record the number of axes of each order r, where by definition an \u201caxis of order r\u201d means an axis whose stabilizer G_p has order r (equivalently, G \u2229 rotations about that axis is a cyclic group of order r). Note that an orbit representative p_i contributes m_i poles and hence m_i/2 axes of order n_i.\n\nWe first note the trivial group G = {1} is C_1; it has no poles and sits outside the k-analysis.\n\nCyclic case (k = 2). From 1b, both pole orbits are singletons, say {p} and {\u2212p}, and n_1 = n_2 = |G|; that is, the entire group fixes both p and \u2212p. Therefore every element is a rotation about the common axis through \u00b1p. All such rotations form a cyclic subgroup; hence G is conjugate to C_n with n = |G|. Axis counts: exactly one axis (through \u00b1p) of order n.\n\nDihedral case (n_1,n_2,n_3) = (2,2,n), |G| = 2n. There is exactly one orbit of poles of order n (size m = |G|/n = 2), namely the two endpoints of the \u201cmain axis\u201d; thus that axis is setwise fixed by G. Let a be a generator of the cyclic subgroup of rotations about the main axis, so \u27e8a\u27e9 has order n. There is at least one other orbit with stabilizer 2; each pole p in such an orbit is the endpoint of an axis perpendicular to the main axis, and the unique nontrivial element of G_p is a half-turn about that axis. Any such half-turn b swaps the two poles of the main axis (it reverses the axis orientation), hence b a b^{-1} = a^{-1}. Therefore \u27e8a,b\u27e9 is a dihedral group of order 2n. Since |G| = 2n, it follows G = \u27e8a,b\u27e9 is conjugate to the standard dihedral rotation group D_n \u2264 SO(3).\nAxis counts: one axis of order n (the main axis), and |G|/(2\u00b72) = n axes of order 2 (half-turn axes in the equatorial family).\n\nPlatonic cases (2,3,3), (2,3,4), (2,3,5). We exhibit that G is conjugate to the full rotation group of the respective Platonic solid, and compute axes.\n\nGeneral setup. In each case there is an orbit of poles with stabilizer r \u2208 {3,4,5} and size m = |G|/r giving m/2 axes of order r. Taking the 2m points of these axes (both poles), we obtain a G-invariant finite set V \u2282 S^2. Its convex hull in R^3 is a regular polyhedron with vertex set one of the two orbits of order r poles. The group G acts by rotations preserving V, hence G embeds in the full rotation group Rot(Poly). But in each case |G| equals the order of Rot(Poly), so the two groups coincide.\n\n- Tetrahedral case (2,3,3), |G| = 12. There are two distinct orbits of poles with stabilizer 3, each of size m = 12/3 = 4; pick one orbit V of 4 points. Its convex hull is a regular tetrahedron. The rotation group Rot(Tet) has order 12, so G \u2264 Rot(Tet) and |G| = |Rot(Tet)| force G = Rot(Tet). Axes: order-3 axes: total (4 + 4)/2 = 4 (through each vertex and center of opposite face). Order-2 axes: |G|/(2\u00b72) = 3 (through pairs of opposite edges). Element counts: see Section 3.\n\n- Octahedral/cubic case (2,3,4), |G| = 24. Take the orbit of poles with stabilizer 3; it has size m = 24/3 = 8 and gives 4 axes of order 3; the 8 poles in one of these two orbits form the vertex set V of a cube (dually, the other orbit gives the octahedron). Thus G \u2264 Rot(Cube), and |G| = 24 = |Rot(Cube)| implies G = Rot(Cube). Axes: order 4: |G|/(2\u00b74) = 3 (through opposite faces); order 3: |G|/(2\u00b73) = 4 (through opposite vertices); order 2: |G|/(2\u00b72) = 6 (through opposite edges). Element counts in Section 3.\n\n- Icosahedral/dodecahedral case (2,3,5), |G| = 60. Take the orbit of poles with stabilizer 5; it has size m = 60/5 = 12 and gives 6 axes of order 5; one of the two orbits of these 12 poles is the vertex set V of a regular icosahedron (dually, the other is the face-center set of a regular dodecahedron). Thus G \u2264 Rot(Icosa), and |G| = 60 = |Rot(Icosa)| yields G = Rot(Icosa). Axes: order 5: 6; order 3: |G|/(2\u00b73) = 10; order 2: |G|/(2\u00b72) = 15. Element counts in Section 3.\n\nThis completes the classification up to conjugacy in SO(3).\n\n3) Isomorphism types and element counts.\n\nWe now identify the three Platonic rotation groups with A_4, S_4, A_5 by faithful permutation actions, and we count elements by order. In each case, we also cross-check with the axis counts: an axis of order r contributes exactly \u03c6_r non-identity rotations about that axis, where \u03c6_r = r \u2212 1 for r \u2265 3 and \u03c6_2 = 1; as every nontrivial rotation has a unique axis, total elements of order r are (#axes of order r) \u00d7 \u03c6_r.\n\n- Tetrahedral rotations \u2245 A_4, element counts.\nThe rotation group acts faithfully on the 4 vertices of the tetrahedron, giving an embedding Rot(Tet) \u21aa S_4. A 120\u00b0 rotation about the axis through a vertex fixes that vertex and cycles the other three: a 3-cycle in S_4. Since the group has order 12 and contains 3-cycles, its image is the unique subgroup of S_4 of order 12 containing 3-cycles, namely A_4. Therefore Rot(Tet) \u2245 A_4. Axis counts: 4 axes of order 3 give 4\u00d72 = 8 elements of order 3; 3 axes of order 2 give 3 elements of order 2; plus the identity. Thus A_4 has 1 + 3 + 8 = 12 elements, as expected.\n\n- Cubic/octahedral rotations \u2245 S_4, element counts.\nConsider the 4 body-diagonals of the cube; Rot(Cube) acts faithfully on this set, giving Rot(Cube) \u21aa S_4. A 120\u00b0 rotation about a vertex axis induces a 3-cycle on the four body-diagonals (it fixes the diagonal along the axis and cycles the others), and a 90\u00b0 rotation about a face-center axis induces a 4-cycle. Having both a 3-cycle and a 4-cycle forces the image to be all of S_4, and |Rot(Cube)| = 24 = |S_4|, so Rot(Cube) \u2245 S_4. Axis counts: order 2: 6 axes (edge-midpoint axes) contribute 6 elements, and the three face-center axes contribute one half-turn each (the square of a quarter-turn), adding 3 more, totaling 9 elements of order 2; order 3: 4 axes \u00d7 2 = 8 elements; order 4: 3 axes \u00d7 2 = 6 elements; plus the identity. Sum: 1 + 9 + 8 + 6 = 24.\n\n- Icosahedral/dodecahedral rotations \u2245 A_5, element counts.\nThere is a classical faithful permutation action on 5 objects, for instance by considering the 5 inscribed cubes in a regular dodecahedron (or dually, suitable 5 symmetric configurations in the icosahedron). The rotation group permutes these 5 objects, and all even permutations arise from rotations; thus Rot(Icosa) embeds in A_5. Since |Rot(Icosa)| = 60 = |A_5|, we conclude Rot(Icosa) \u2245 A_5. Axis counts: order 5: 6 axes \u00d7 4 = 24 elements; order 3: 10 axes \u00d7 2 = 20 elements; order 2: 15 axes \u00d7 1 = 15 elements; plus the identity. Total: 1 + 15 + 20 + 24 = 60.\n\nFor completeness, we summarize all cases, including cyclic and dihedral.\n\n- Cyclic C_n (n \u2265 1). One axis of order n. Elements: for each d | n there are \u03c6(d) elements of order d. In particular, there is 1 element of order 2 iff n is even.\n\n- Dihedral D_n \u2264 SO(3) (n \u2265 2). One axis of order n and n axes of order 2. Elements: among the n rotations about the main axis (including identity), the number of elements of order d | n equals \u03c6(d) for d > 1; additionally there are n half-turns about the n equatorial axes, contributing n elements of order 2. In total, the number of order-2 elements is n if n is odd, and n + 1 if n is even (the extra one is the \u03c0-rotation about the main axis).\n\n- Tetrahedral rotations \u2245 A_4. Axes: four of order 3, three of order 2. Elements: 8 of order 3, 3 of order 2, 1 identity.\n\n- Cubic/octahedral rotations \u2245 S_4. Axes: three of order 4, four of order 3, six of order 2. Elements: 6 of order 4, 8 of order 3, 9 of order 2, 1 identity.\n\n- Icosahedral/dodecahedral rotations \u2245 A_5. Axes: six of order 5, ten of order 3, fifteen of order 2. Elements: 24 of order 5, 20 of order 3, 15 of order 2, 1 identity.\n\nThis completes a self-contained classification of finite subgroups of SO(3) up to conjugacy and determines their isomorphism types and element-order statistics."
    },
    {
        "question": "Title: Cheeger\u2019s inequality for weighted graphs, a sharp spectral\u2013isoperimetric bridge, and mixing of the lazy random walk \u2014 with an exact cycle computation\n\nLet G = (V, w) be a connected finite undirected weighted graph: V is a finite set of n \u2265 2 vertices, and w: V \u00d7 V \u2192 [0, \u221e) is symmetric, with w(u,u) = 0 and w(u,v) > 0 iff there is an edge between u and v. Define the weighted degree d(u) := \u2211_{v\u2208V} w(u,v), let D be the diagonal matrix with D_{uu}=d(u), and W = [w(u,v)] the weighted adjacency matrix. Define vol(S) := \u2211_{u\u2208S} d(u) and vol(V) := \u2211_{u\u2208V} d(u). For S \u2282 V, write \u2202S := E(S, S^c) for the (weighted) edge boundary, and w(\u2202S) := \u2211_{u\u2208S, v\u2208S^c} w(u,v).\n\nDefine the conductance (Cheeger constant) of G by\n- for nonempty S \u2282 V with vol(S) \u2264 vol(V)/2, \u03a6(S) := w(\u2202S)/vol(S),\n- h(G) := min{ \u03a6(S) : S \u2282 V, S \u2260 \u2205, vol(S) \u2264 vol(V)/2 }.\n\nDefine the normalized Laplacian\nL := I \u2212 D^{\u22121/2} W D^{\u22121/2}.\nIt is real symmetric and positive semidefinite; let 0 = \u03bb_1 < \u03bb_2 \u2264 \u2026 \u2264 \u03bb_n \u2264 2 be its eigenvalues.\n\nLet P_0 := D^{\u22121} W be the (reversible) random-walk transition matrix, and let \u03c0 be its stationary distribution \u03c0(u) = d(u)/vol(V). Define the lazy walk P := (I + P_0)/2.\n\nGoal. Prove the sharp Cheeger inequality for general weighted graphs and deduce a clean mixing bound for the lazy random walk. Then compute everything explicitly for the cycle.\n\nTasks.\n\n1) Variational characterization. Show that for any function f: V \u2192 R with \u2211_{u} d(u) f(u) = 0 and f \u2260 0, the Rayleigh quotient\nR(f) := [ (1/2) \u2211_{u,v\u2208V} w(u,v) (f(u) \u2212 f(v))^2 ] / [ \u2211_{u\u2208V} d(u) f(u)^2 ]\nsatisfies \u03bb_2 = min{ R(f) : f \u2260 0, \u2211 d f = 0 }. Justify the identity between the normalized-Laplacian Rayleigh quotient and the Dirichlet form above.\n\n2) Lower Cheeger bound (easy direction). Prove \u03bb_2 \u2264 2 h(G). Conclude that \u03bb_2/2 \u2264 h(G).\n\n3) Upper Cheeger bound (hard direction). Prove h(G) \u2264 \u221a(2 \u03bb_2). Equivalently, show \u03bb_2 \u2265 h(G)^2/2. Your proof must be complete and self-contained; you may proceed via the reversible Markov-chain Dirichlet form for P_0 and a co-area/sweep argument around a weighted median of an L^2(\u03c0)-orthogonal eigenfunction.\n\n4) Lazy mixing via the spectral gap. Let \u03c1 := 1 \u2212 \u03bb_2/2 be the second-largest eigenvalue of P. Show that for every starting vertex u and every t \u2265 0,\n\u2016P^t(u,\u00b7) \u2212 \u03c0\u2016_{TV} \u2264 (1/(2 \u221a{\u03c0_*})) \u03c1^t \u2264 (1/(2 \u221a{\u03c0_*})) exp(\u2212 (\u03bb_2/2) t),\nwhere \u03c0_* := min_{v\u2208V} \u03c0(v). Deduce the explicit mixing-time bound: for any \u03b5 \u2208 (0,1),\nt_mix(\u03b5) \u2264 (2/\u03bb_2) log( 1/(2 \u03b5 \u221a{\u03c0_*}) ) \u2264 (4/h(G)^2) log( 1/(2 \u03b5 \u221a{\u03c0_*}) ).\nHere t_mix(\u03b5) is the least t with sup_u \u2016P^t(u,\u00b7) \u2212 \u03c0\u2016_{TV} \u2264 \u03b5.\n\n5) Exact cycle case. Let C_n be the unweighted cycle on n \u2265 3 vertices (each vertex has degree 2). Compute exactly:\n- the full spectrum of L and in particular \u03bb_2(C_n) = 1 \u2212 cos(2\u03c0/n) = 2 sin^2(\u03c0/n),\n- the exact conductance h(C_n) = 1/\u230an/2\u230b.\nVerify both Cheeger inequalities for C_n numerically (with the exact quantities), and deduce from (4) the explicit bound\nt_mix(\u03b5) \u2264 (2/(1 \u2212 cos(2\u03c0/n))) log( \u221an /(2\u03b5) ),\nso in particular t_mix(1/4) = O(n^2 log n).\n\nAnswer format: Provide complete, rigorous proofs of (1)\u2013(4) in order, defining any objects you use. Then carry out the exact computations in (5), verify the Cheeger bounds for C_n, and derive the displayed mixing bound.",
        "answer": "We write all sums over unordered vertex pairs {u,v} using the symmetric double-sum convention with factor 1/2 when convenient:\nE(f) := (1/2) \u2211_{u,v\u2208V} w(u,v) (f(u) \u2212 f(v))^2.\nWe also write \u27e8g,h\u27e9_\u03c0 := \u2211_{u} \u03c0(u) g(u) h(u), and \u2016g\u2016_{2,\u03c0}^2 := \u27e8g,g\u27e9_\u03c0.\n\n1) Variational characterization of \u03bb_2.\n\nLet N := D^{\u22121/2} W D^{\u22121/2} be the normalized adjacency. Then L = I \u2212 N is real symmetric. For x \u2208 R^V,\nx^T L x = x^T x \u2212 x^T N x = (1/2) \u2211_{u,v} w(u,v) ( x(u)/\u221a{d(u)} \u2212 x(v)/\u221a{d(v)} )^2.\nSetting f := D^{\u22121/2} x (i.e., x = D^{1/2} f), we obtain\nx^T L x = (1/2) \u2211_{u,v} w(u,v) (f(u) \u2212 f(v))^2 = E(f).\nAlso x^T x = \u2211_{u} d(u) f(u)^2.\n\nSince the nullspace of L is spanned by D^{1/2} 1 (connectedness of G ensures multiplicity 1), the Courant\u2013Fischer min\u2013max principle yields\n\u03bb_2 = min{ x^T L x / x^T x : x \u27c2 D^{1/2} 1, x \u2260 0 }.\nEquivalently, in f-variables, the constraint x \u27c2 D^{1/2} 1 is \u2211_u d(u) f(u) = 0, and\n\u03bb_2 = min{ E(f)/\u2211_u d(u) f(u)^2 : f \u2260 0, \u2211 d f = 0 }.\nThis is exactly the Rayleigh quotient R(f) stated.\n\n2) Lower Cheeger bound: \u03bb_2 \u2264 2 h(G).\n\nFix nonempty S \u2282 V with vol(S) \u2264 vol(V)/2. Define \u03c4 := vol(S)/vol(S^c) and the two-valued function\nf(u) := 1 for u \u2208 S, and f(u) := \u2212\u03c4 for u \u2208 S^c.\nThen \u2211_u d(u) f(u) = vol(S) \u2212 \u03c4 vol(S^c) = 0, so f is admissible for R(\u00b7).\n\nCompute numerator:\nE(f) = (1/2) \u2211_{u,v} w(u,v) (f(u) \u2212 f(v))^2\n= (1/2) \u2211_{u\u2208S, v\u2208S^c} w(u,v) (1 + \u03c4)^2 + (1/2) \u2211_{u\u2208S^c, v\u2208S} w(u,v) (1 + \u03c4)^2\n= (1 + \u03c4)^2 w(\u2202S).\n\nDenominator:\n\u2211_u d(u) f(u)^2 = vol(S) \u00b7 1^2 + vol(S^c) \u00b7 \u03c4^2 = vol(S) + vol(S)^2/vol(S^c) = vol(S) \u00b7 (vol(V)/vol(S^c)).\n\nAlso 1 + \u03c4 = 1 + vol(S)/vol(S^c) = vol(V)/vol(S^c). Therefore\nR(f) = E(f)/\u2211 d f^2 = [ (vol(V)/vol(S^c))^2 w(\u2202S) ] / [ vol(S) \u00b7 (vol(V)/vol(S^c)) ]\n= [vol(V)/ (vol(S) vol(S^c))] w(\u2202S)\n\u2264 [vol(V)/ (vol(S) \u00b7 (vol(V)/2))] w(\u2202S)\n= 2 w(\u2202S)/vol(S) = 2 \u03a6(S),\nsince vol(S^c) \u2265 vol(V)/2. Minimizing over S gives \u03bb_2 \u2264 2 h(G), i.e., \u03bb_2/2 \u2264 h(G).\n\n3) Upper Cheeger bound: h(G) \u2264 \u221a(2 \u03bb_2).\n\nWe prove the equivalent spectral gap inequality \u03bb_2 \u2265 h(G)^2/2. It is convenient to work with the reversible Markov chain P_0 := D^{\u22121} W with stationary \u03c0(u) = d(u)/vol(V). Its Dirichlet form is\nE_{P_0}(g,g) := (1/2) \u2211_{u,v} \u03c0(u) P_0(u,v) (g(u) \u2212 g(v))^2\n= (1/(2 vol(V))) \u2211_{u,v} w(u,v) (g(u) \u2212 g(v))^2\n= E(g)/vol(V).\nFor functions of \u03c0-mean zero, the spectral gap of P_0 equals\n\u03b3_0 := inf_{g: \u27e8g,1\u27e9_\u03c0=0, g\u22600} E_{P_0}(g,g)/\u2016g\u2016_{2,\u03c0}^2.\nSince N is similar to P_0 via D^{1/2}, we have 1 \u2212 \u03c3_2(N) = \u03b3_0. But \u03bb_2 = 1 \u2212 \u03c3_2(N), hence \u03bb_2 = \u03b3_0.\n\nWe show \u03b3_0 \u2265 h(G)^2/2, which proves \u03bb_2 \u2265 h(G)^2/2.\n\nKey co-area inequality. Let h: V \u2192 [0,\u221e) be any nonnegative function with \u03c0(supp(h)) \u2264 1/2. For s \u2265 0 set S_s := {u \u2208 V : h(u)^2 \u2265 s}. Then\n(\u2217) (1/2) \u2211_{u,v} \u03c0(u) P_0(u,v) |h(u)^2 \u2212 h(v)^2|\n= \u222b_{0}^{\u221e} Q(S_s, S_s^c) ds,\nwhere Q(S,S^c) := \u2211_{u\u2208S, v\u2208S^c} \u03c0(u) P_0(u,v) is the ergodic flow across (S,S^c). This follows from layer-cake decomposition:\n|h(u)^2 \u2212 h(v)^2| = \u222b_0^{\u221e} |1_{h(u)^2 \u2265 s} \u2212 1_{h(v)^2 \u2265 s}| ds,\nand Fubini to swap sum and integral.\n\nSince \u03c0(S_s) \u2264 \u03c0(supp h) \u2264 1/2 for all s>0, by the definition of conductance,\nQ(S_s, S_s^c) \u2265 h(G) \u00b7 \u03c0(S_s).\nIntegrating and using \u222b_0^{\u221e} \u03c0(S_s) ds = \u2211_u \u03c0(u) h(u)^2 (= \u2016h\u2016_{2,\u03c0}^2) gives\n(1) (1/2) \u2211_{u,v} \u03c0(u) P_0(u,v) |h(u)^2 \u2212 h(v)^2| \u2265 h(G) \u2016h\u2016_{2,\u03c0}^2.\n\nUpper bounding the left-hand side via Cauchy\u2013Schwarz:\n|h(u)^2 \u2212 h(v)^2| = |h(u) \u2212 h(v)| \u00b7 |h(u) + h(v)|.\nHence\n(1/2) \u2211 \u03c0P_0 |h(u)^2 \u2212 h(v)^2|\n\u2264 [(1/2) \u2211 \u03c0P_0 (h(u) \u2212 h(v))^2]^{1/2} \u00b7 [(1/2) \u2211 \u03c0P_0 (h(u) + h(v))^2]^{1/2}.\nThe first factor is \u221a{E_{P_0}(h,h)}. For the second, write\n(1/2) \u2211 \u03c0P_0 (h(u) + h(v))^2\n= \u2211_u \u03c0(u) h(u)^2 + \u2211_u \u03c0(u) h(u) (P_0 h)(u) \u2264 \u2016h\u2016_{2,\u03c0}^2 + \u2016h\u2016_{2,\u03c0} \u2016P_0 h\u2016_{2,\u03c0}\n\u2264 2 \u2016h\u2016_{2,\u03c0}^2,\nsince P_0 is a contraction on L^2(\u03c0) (self-adjoint with spectrum in [\u22121,1]). Thus\n(2) (1/2) \u2211 \u03c0P_0 |h(u)^2 \u2212 h(v)^2| \u2264 \u221a{2 E_{P_0}(h,h)} \u00b7 \u2016h\u2016_{2,\u03c0}.\n\nCombining (1) and (2) gives h(G) \u2016h\u2016_{2,\u03c0}^2 \u2264 \u221a{2 E_{P_0}(h,h)} \u2016h\u2016_{2,\u03c0}, i.e.\nE_{P_0}(h,h) \u2265 (h(G)^2/2) \u2016h\u2016_{2,\u03c0}^2, for every nonnegative h with \u03c0(supp h) \u2264 1/2.     (\u2020)\n\nMedian decomposition and conclusion. Let f: V \u2192 R with \u27e8f,1\u27e9_\u03c0 = 0. Let m be a weighted median of f (i.e., \u03c0({f \u2265 m}) \u2265 1/2 and \u03c0({f \u2264 m}) \u2265 1/2; this implies \u03c0({f > m}) \u2264 1/2 and \u03c0({f < m}) \u2264 1/2). Define the positive and negative parts around m:\np := (f \u2212 m)_+ = max(f \u2212 m, 0),   n := (m \u2212 f)_+ = max(m \u2212 f, 0).\nThen \u03c0(supp p) \u2264 1/2 and \u03c0(supp n) \u2264 1/2. Also for every u,v, (p(u) \u2212 p(v))(n(u) \u2212 n(v)) \u2264 0 (they change in opposite directions), which implies pointwise\n(f(u) \u2212 f(v))^2 = [(p(u) \u2212 p(v)) \u2212 (n(u) \u2212 n(v))]^2 \u2265 (p(u) \u2212 p(v))^2 + (n(u) \u2212 n(v))^2.\nSumming with weights,\nE_{P_0}(f,f) \u2265 E_{P_0}(p,p) + E_{P_0}(n,n).\nApplying (\u2020) to h = p and h = n and summing yields\nE_{P_0}(f,f) \u2265 (h(G)^2/2) ( \u2016p\u2016_{2,\u03c0}^2 + \u2016n\u2016_{2,\u03c0}^2 ) = (h(G)^2/2) \u2016f \u2212 m\u2016_{2,\u03c0}^2 \u2265 (h(G)^2/2) \u2016f\u2016_{2,\u03c0}^2,\nsince \u2016f \u2212 m\u2016_{2,\u03c0}^2 \u2265 min_{c\u2208R} \u2016f \u2212 c\u2016_{2,\u03c0}^2 = Var_\u03c0(f) = \u2016f\u2016_{2,\u03c0}^2 (here \u27e8f,1\u27e9_\u03c0=0).\nTaking the infimum over all mean-zero f \u2260 0 gives \u03b3_0 \u2265 h(G)^2/2. As \u03bb_2 = \u03b3_0, we have \u03bb_2 \u2265 h(G)^2/2, i.e., h(G) \u2264 \u221a(2 \u03bb_2).\n\n4) Lazy mixing bound.\n\nLet P := (I + P_0)/2 be the lazy chain. It is reversible with the same \u03c0, and its eigenvalues are (1 + \u03c3_i(N))/2. In particular, its second-largest eigenvalue is \u03c1 = (1 + \u03c3_2)/2 = 1 \u2212 \u03bb_2/2. For any initial distribution \u03bc_0, define the density g_0 := d\u03bc_0/d\u03c0 \u2212 1 (well-defined since \u03c0 has full support). Then g_t := d(\u03bc_0 P^t)/d\u03c0 \u2212 1 satisfies\n\u2016g_t\u2016_{2,\u03c0} \u2264 \u03c1^t \u2016g_0\u2016_{2,\u03c0}, by L^2(\u03c0) spectral theory for self-adjoint P.\n\nFor a starting vertex u, \u03bc_0 = \u03b4_u, so g_0 = \u03b4_u/\u03c0 \u2212 1 and\n\u2016g_0\u2016_{2,\u03c0}^2 = \u2211_v \u03c0(v) (1_{v=u}/\u03c0(v) \u2212 1)^2 = (1/\u03c0(u)) \u2212 1 \u2264 1/\u03c0_*,\nwhere \u03c0_* := min_v \u03c0(v). By Cauchy\u2013Schwarz,\n\u2016\u03bc_0 P^t \u2212 \u03c0\u2016_{TV} = (1/2) \u2211_v |\u03bc_0 P^t(v) \u2212 \u03c0(v)| = (1/2) \u2211_v \u03c0(v) |g_t(v)|\n\u2264 (1/2) \u2016g_t\u2016_{2,\u03c0} \u2264 (1/(2 \u221a{\u03c0_*})) \u03c1^t.\nUsing \u03c1 = 1 \u2212 \u03bb_2/2 \u2264 e^{\u2212\u03bb_2/2}, we obtain\n\u2016P^t(u,\u00b7) \u2212 \u03c0\u2016_{TV} \u2264 (1/(2 \u221a{\u03c0_*})) exp(\u2212 (\u03bb_2/2) t).\nSolving for t to make the right-hand side \u2264 \u03b5 gives\nt_mix(\u03b5) \u2264 (2/\u03bb_2) log( 1/(2 \u03b5 \u221a{\u03c0_*}) ).\nFinally, by the upper Cheeger bound \u03bb_2 \u2265 h(G)^2/2, we also have\nt_mix(\u03b5) \u2264 (4/h(G)^2) log( 1/(2 \u03b5 \u221a{\u03c0_*}) ).\n\n5) Exact cycle case.\n\nLet C_n be the unweighted cycle on n \u2265 3 vertices, so d(u) = 2 for all u.\n\nSpectrum of L. The adjacency eigenvalues of A are 2 cos(2\u03c0k/n), k = 0,1,\u2026,n\u22121. Since L = I \u2212 (1/2) A for 2-regular graphs, its eigenvalues are\n\u03bb_k = 1 \u2212 cos(2\u03c0k/n), k = 0,1,\u2026,n\u22121.\nThus \u03bb_1 = 0 at k=0, and\n\u03bb_2(C_n) = 1 \u2212 cos(2\u03c0/n) = 2 sin^2(\u03c0/n).\n\nExact conductance. For any S with 0 < |S| = s \u2264 n/2, the boundary w(\u2202S) = 2 (exactly two edges leave S for a connected block, and this is optimal), and vol(S) = 2 s. Hence \u03a6(S) = 2/(2 s) = 1/s, minimized at s = \u230an/2\u230b. Therefore\nh(C_n) = 1/\u230an/2\u230b = { 2/n if n even, 1/((n\u22121)/2) if n odd }.\n\nVerification of Cheeger bounds. We have\n\u03bb_2/2 = (1 \u2212 cos(2\u03c0/n))/2 \u2264 h(C_n) = 1/\u230an/2\u230b,\nsince 1 \u2212 cos(\u03b8) \u2264 \u03b8^2/2 and for \u03b8 = 2\u03c0/n this gives \u03bb_2/2 \u2264 \u03c0^2/n^2 \u2264 1/\u230an/2\u230b for n \u2265 3. Conversely,\nh(C_n) \u2264 \u221a(2 \u03bb_2) = \u221a(2 (1 \u2212 cos(2\u03c0/n))) = 2 |sin(\u03c0/n)| \u2264 2\u03c0/n,\nwhich is immediate by sin(\u03c0/n) \u2264 \u03c0/n. Thus both inequalities hold with room to spare.\n\nLazy mixing bound on C_n. Here \u03c0(u) = 1/n for all u, so \u03c0_* = 1/n. From (4) we get, for every \u03b5 \u2208 (0,1),\nt_mix(\u03b5) \u2264 (2/\u03bb_2(C_n)) log( \u221an /(2\u03b5) ) = (2/(1 \u2212 cos(2\u03c0/n))) log( \u221an /(2\u03b5) ).\nUsing 1 \u2212 cos(2\u03c0/n) \u223c 2\u03c0^2/n^2 as n \u2192 \u221e, this shows\nt_mix(\u03b5) \u2264 (n^2/(\u03c0^2) + o(n^2)) log( \u221an /(2\u03b5) ) = O(n^2 log n).\nIn particular, t_mix(1/4) = O(n^2 log n).\n\nThis completes all tasks: the Rayleigh characterization, the two-sided Cheeger inequality \u03bb_2/2 \u2264 h(G) \u2264 \u221a(2 \u03bb_2), the lazy walk mixing estimate via \u03bb_2 (and h(G)), and the exact cycle computations with explicit mixing bounds."
    },
    {
        "question": "Title: Vitali covering, the Hardy\u2013Littlewood maximal inequality, and the Lebesgue differentiation theorem \u2014 a complete self-contained development\n\nLet R^d be equipped with the d-dimensional Lebesgue measure |\u00b7|. For x \u2208 R^d and r > 0, let B(x,r) be the open Euclidean ball centered at x of radius r. For a locally integrable function f on R^d and a ball B, write f_B := (1/|B|) \u222b_B f for the average of f on B, and set the centered Hardy\u2013Littlewood maximal function by\nMf(x) := sup_{r>0} (1/|B(x,r)|) \u222b_{B(x,r)} |f(y)| dy.\n\nTasks:\n\n1) Vitali covering lemma (Besicovitch\u2013Vitali selection in R^d with a 3^d-cover). Prove: If E \u2282 R^d is measurable and F is a family of balls such that for every x \u2208 E and every \u03b5 > 0 there exists B \u2208 F with x \u2208 B and radius(B) < \u03b5, then there exists a countable pairwise disjoint subfamily {B_j} \u2282 F such that\n| E \\ \u22c3_j 3B_j | = 0.\nHere 3B denotes the ball concentric with B with triple radius. Your proof must be self-contained (no external covering theorems) and should present a precise greedy selection and the covering argument.\n\n2) Weak (1,1) Hardy\u2013Littlewood inequality. For f \u2208 L^1(R^d) and \u03b1 > 0, prove that the level set E_\u03b1 := {x \u2208 R^d : Mf(x) > \u03b1} satisfies\n|E_\u03b1| \u2264 C_d (1/\u03b1) \u2225f\u2225_{L^1},\nfor a constant C_d depending only on d. You may use Task (1). Show explicitly how to obtain C_d \u2264 c \u00b7 3^d for an absolute numerical c.\n\n3) Strong L^p bounds for p > 1. Prove that for every p \u2208 (1,\u221e) there is a constant A_{p,d} < \u221e such that\n\u2225Mf\u2225_{L^p} \u2264 A_{p,d} \u2225f\u2225_{L^p},  for all f \u2208 L^p(R^d).\nGive a self-contained proof from Task (2) without invoking general interpolation theorems: use the layer-cake representation and a good-\u03bb argument (or an equivalent direct truncation).\n\n4) Lebesgue differentiation theorem. Prove: If f \u2208 L^1_loc(R^d), then for almost every x \u2208 R^d,\nlim_{r\u21920+} (1/|B(x,r)|) \u222b_{B(x,r)} f(y) dy = f(x).\nYour proof must be self-contained and use Task (2) (weak (1,1) of M) together with the density of C_c(R^d) in L^1 and a uniform continuity estimate.\n\nAnswer format:\n- Prove (1) fully (greedy disjoint selection, 3-fold cover).\n- Deduce (2) from (1) with complete details.\n- Prove (3) in full detail via a good-\u03bb or truncation argument built on (2).\n- Prove (4), clearly indicating where the maximal inequality is used.",
        "answer": "1) Vitali covering lemma with a 3^d-cover\n\nSetup. Let E \u2282 R^d be measurable, and let F be a family of balls with the Vitali property: for each x \u2208 E and \u03b5 > 0 there is B \u2208 F with x \u2208 B and radius(B) < \u03b5. We will construct a pairwise disjoint sequence (B_j) \u2282 F with |E \\ \u22c3_j 3B_j| = 0.\n\nGreedy selection. Define inductively a sequence of balls as follows. Choose B_1 \u2208 F with maximal radius r_1 (if supremum not attained, take a ball with radius within a factor 1/2 of sup; all that matters is that chosen radii form a nonincreasing sequence bounded below by 0). Having chosen B_1,\u2026,B_k, let F_k be those balls in F which are disjoint from B_1,\u2026,B_k; if F_k is empty, stop; else choose B_{k+1} \u2208 F_k with maximal radius r_{k+1}. In this way, we obtain a pairwise disjoint sequence (B_j)_j with radii (r_j) nonincreasing.\n\nCovering property. We claim that\nE \u2282 \u22c3_{j=1}^\u221e 3B_j up to a null set.\nFix x \u2208 E. If x \u2208 \u22c3_j 3B_j we are done. Suppose instead x \u2209 \u22c3_j 3B_j. By the Vitali property, for each n there exists a ball B \u2208 F with center at x and radius < r_n/3. Since (B_j) were selected greedily with nonincreasing radii, each such tiny ball B cannot be disjoint from all earlier B_j (otherwise it would have been eligible for selection at step n, contradicting maximality of r_n). Thus B intersects some B_j whose radius is at least r_n. But since the center of B is x and radius(B) < r_n/3 \u2264 r_j/3, and B intersects B_j, the triangle inequality implies x \u2208 3B_j. Because n was arbitrary, x \u2208 \u22c3_j 3B_j. This proves\nE \u2282 \u22c3_j 3B_j.\n\nBoundary measurability subtlety. The above reasoning shows inclusion pointwise for all x \u2208 E provided we allow the initial supremum choice to be approximated and use the \u201cfor each n\u201d argument. Thus |E \\ \u22c3_j 3B_j| = 0 as claimed.\n\nQuantitative overlap. The selection gives disjoint B_j, hence\n\u2211_j |B_j| \u2264 |\u22c3_j B_j| \u2264 \u221e,\nand the 3-fold dilations {3B_j} have bounded multiplicity controlled by a dimensional constant when compared to balls of comparable scales, but we only need the simple inequality |\u22c3_j 3B_j| \u2264 3^d \u2211_j |B_j| (by subadditivity and scaling |3B_j| = 3^d |B_j|).\n\n\n2) Weak (1,1) Hardy\u2013Littlewood inequality\n\nLet f \u2208 L^1(R^d), \u03b1 > 0, and define E_\u03b1 := {x : Mf(x) > \u03b1}. For each x \u2208 E_\u03b1 there exists a ball B_x with\n(1/|B_x|) \u222b_{B_x} |f| > \u03b1.\nLet F := {B_x : x \u2208 E_\u03b1}. By Task (1), there is a pairwise disjoint subfamily {B_j} \u2282 F such that |E_\u03b1 \\ \u22c3_j 3B_j| = 0. Then\n|E_\u03b1| \u2264 |\u22c3_j 3B_j| \u2264 3^d \u2211_j |B_j|.\nOn the other hand, by construction \u03b1 |B_j| < \u222b_{B_j} |f|. Summing over j:\n\u03b1 \u2211_j |B_j| < \u2211_j \u222b_{B_j} |f| \u2264 \u222b_{\u22c3_j B_j} |f| \u2264 \u222b_{R^d} |f|.\nTherefore\n|E_\u03b1| \u2264 3^d \u2211_j |B_j| \u2264 (3^d/\u03b1) \u2225f\u2225_1.\nThis proves the weak type (1,1) bound with C_d \u2264 3^d. A minor refinement of the selection (choosing balls with radii within a factor of 2 of a maximal disjoint selection) improves constants but is not essential here.\n\n\n3) Strong L^p bounds for p > 1\n\nWe give a standard good-\u03bb proof based on the weak (1,1). Fix p \u2208 (1,\u221e). We will prove\n\u2225Mf\u2225_p \u2264 C_{p,d} \u2225f\u2225_p\nwith C_{p,d} depending only on p and d.\n\nLayer-cake. By the distribution function identity, for any nonnegative measurable g,\n\u2225g\u2225_p^p = p \u222b_0^\u221e \u03bb^{p-1} |{g > \u03bb}| d\u03bb.\n\nGood-\u03bb inequality. There exists a dimensional c_0 \u2265 1 (we will take c_0 = 2) and a constant A_d from Task (2) such that for all \u03bb > 0 and all \u03b5 \u2208 (0,1),\n|{Mf > (1+\u03b5) \u03bb, M(f 1_{|f| \u2264 \u03bb}) \u2264 \u03b5 \u03bb}| \u2264 (C_d \u03b5) |{Mf > \u03bb}|,\nfor C_d depending only on d (specifically C_d can be taken \u2272 3^d). Indeed, observe pointwise\nMf \u2264 M(f 1_{|f| \u2264 \u03bb}) + M(f 1_{|f| > \u03bb}).\nHence on the set {Mf > (1+\u03b5)\u03bb, M(f 1_{|f| \u2264 \u03bb}) \u2264 \u03b5 \u03bb} we have M(f 1_{|f| > \u03bb}) > \u03bb. By the weak (1,1),\n|{M(f 1_{|f| > \u03bb}) > \u03bb}| \u2264 (C_d/\u03bb) \u2225f 1_{|f| > \u03bb}\u2225_1 \u2264 C_d \u222b_{|f| > \u03bb} (|f|/\u03bb).\nBut also we have the trivial comparison |{Mf > \u03bb}| \u2265 |{M(f 1_{|f| > \u03bb}) > \u03bb}| (since M is positive-sublinear), and we can use the Calder\u00f3n\u2013Zygmund decomposition idea in a one-line way by noting\n\u222b_{|f| > \u03bb} (|f|/\u03bb) \u2264 (1/\u03b5) |{M(f 1_{|f| > \u03bb}) > \u03b5 \u03bb}| \u2264 (C_d/\u03b5) |{Mf > \u03bb}|,\nwhere we used again weak (1,1) (apply it to f 1_{|f| > \u03bb} with threshold \u03b5 \u03bb). Combining gives the good-\u03bb inequality with a constant proportional to C_d/\u03b5. Choosing \u03b5 small absolute (say \u03b5 = 1/2) yields:\n|{Mf > (3/2) \u03bb}| \u2264 \u03b8 |{Mf > \u03bb}| + K_d \u222b_{|f| > \u03bb} (|f|/\u03bb) with \u03b8 \u2208 (0,1) and K_d \u2272 C_d.\n\nIteration and integration. Multiply both sides by p ((3/2)\u03bb)^{p-1} and integrate \u03bb from 0 to \u221e. The left-hand side is \u2225Mf\u2225_p^p (up to the factor (3/2)^p absorbed into constants). For the first term on the right, by change of variables (\u03bb' = (2/3)\u03bb), it is \u2264 \u03b8' \u2225Mf\u2225_p^p with \u03b8' = \u03b8 \u00b7 (3/2)^p < 1 (choose \u03b5 small enough to make \u03b8' < 1/2, say). For the second term, by Fubini and the layer-cake for |f|:\n\u222b_0^\u221e p ((3/2)\u03bb)^{p-1} K_d \u222b_{|f| > \u03bb} (|f|/\u03bb) d\u03bb\n= C_{p,d} \u222b_{R^d} |f(x)| \u222b_0^{|f(x)|} \u03bb^{p-2} d\u03bb dx\n= C_{p,d} \u222b_{R^d} |f(x)| \u00b7 (|f(x)|^{p-1}/(p-1)) dx\n= C'_{p,d} \u2225f\u2225_p^p.\nPutting these together,\n\u2225Mf\u2225_p^p \u2264 \u03b8' \u2225Mf\u2225_p^p + C'_{p,d} \u2225f\u2225_p^p.\nAbsorb \u03b8' \u2225Mf\u2225_p^p to the left to get\n\u2225Mf\u2225_p^p \u2264 (C'_{p,d}/(1\u2212\u03b8')) \u2225f\u2225_p^p,\nhence \u2225Mf\u2225_p \u2264 A_{p,d} \u2225f\u2225_p with A_{p,d} depending only on p and d.\n\n\n4) Lebesgue differentiation theorem\n\nWe prove: For f \u2208 L^1_loc(R^d), for a.e. x,\nlim_{r\u21920+} (1/|B(x,r)|) \u222b_{B(x,r)} f(y) dy = f(x).\n\nReduction by density. Fix \u03b5 > 0. Since C_c(R^d) is dense in L^1(R^d), choose g \u2208 C_c(R^d) with \u2225f \u2212 g\u2225_{L^1} < \u03b5. Write f = g + h with h := f \u2212 g \u2208 L^1 and \u2225h\u2225_1 < \u03b5.\n\nStep 1: Differentiation for continuous g. Let x \u2208 R^d. Because g is uniformly continuous on R^d (indeed on its compact support), for any \u03b7 > 0 there exists \u03b4 > 0 such that |g(y) \u2212 g(x)| < \u03b7 for |y \u2212 x| < \u03b4. Then for 0 < r < \u03b4,\n|(1/|B(x,r)|) \u222b_{B(x,r)} g(y) dy \u2212 g(x)| \u2264 (1/|B(x,r)|) \u222b_{B(x,r)} |g(y) \u2212 g(x)| dy < \u03b7.\nHence\nlim_{r\u21920} (1/|B(x,r)|) \u222b_{B(x,r)} g(y) dy = g(x)\nfor all x (in the continuity points of g, and continuous functions have no exceptional set).\n\nStep 2: Control of the error h by the maximal function. Define the centered Hardy\u2013Littlewood maximal function Mh(x) = sup_{r>0} (1/|B(x,r)|) \u222b_{B(x,r)} |h|. Fix any x and r > 0. Then by triangle inequality,\n|(1/|B(x,r)|) \u222b_{B(x,r)} f \u2212 f(x)| \u2264 |(1/|B(x,r)|) \u222b_{B(x,r)} g \u2212 g(x)| + (1/|B(x,r)|) \u222b_{B(x,r)} |h| + |h(x)|.\nThe first term tends to 0 as r \u2192 0 for every x (by Step 1). Let us show that the latter two are small for a.e. x if \u03b5 is small: by the weak (1,1) inequality,\n|{x : Mh(x) > t}| \u2264 C_d \u2225h\u2225_1 / t \u2264 C_d \u03b5 / t.\nHence given any \u03b4 > 0, choose t large enough so that C_d \u03b5 / t < \u03b4/2. Then |{Mh > t}| < \u03b4/2. By absolute continuity of the integral, we may also choose s > 0 so that |{x : |h(x)| > s}| < \u03b4/2 and s is small (e.g., by Markov\u2013Chebyshev: |{|h| > s}| \u2264 \u2225h\u2225_1 / s \u2264 \u03b5/s). Therefore, for all x \u2209 E_\u03b5 where\nE_\u03b5 := {Mh > t} \u222a { |h| > s }\nwe have Mh(x) \u2264 t and |h(x)| \u2264 s, and E_\u03b5 has measure < \u03b4.\n\nFor such x and all r > 0,\n|(1/|B(x,r)|) \u222b_{B(x,r)} f \u2212 f(x)| \u2264 |(1/|B(x,r)|) \u222b_{B(x,r)} g \u2212 g(x)| + t + s.\nLet r \u2192 0: the first term \u2192 0; so limsup_{r\u21920} average deviation \u2264 t + s. Since t, s can be made arbitrarily small by making \u03b5 small (and choosing t \u226b \u03b5, s \u226b \u03b5 appropriately), we conclude that for a set of x of full measure (intersection over a sequence \u03b5_k \u2193 0) the limit exists and equals 0:\nlim_{r\u21920} (1/|B(x,r)|) \u222b_{B(x,r)} f(y) dy \u2212 f(x) = 0.\nThis proves the Lebesgue differentiation theorem.\n\nRemarks.\n- The only ingredients beyond basic measure theory are the Vitali covering lemma (Task 1) and the weak (1,1) bound (Task 2) for the Hardy\u2013Littlewood maximal operator.\n- The strong L^p bounds of Task (3) are not needed for the differentiation theorem, but they are a fundamental complement to the weak (1,1) theory and were derived here self-contained from Task (2).\n\nThis completes the problem."
    },
    {
        "question": "Title: Radon\u2013Carath\u00e9odory\u2013Helly triumvirate in R^d and the sharp Centerpoint Theorem \u2014 a complete, self-contained development\n\nLet d \u2265 1 be an integer and work in Euclidean space R^d. For a finite set S \u2282 R^d, write conv(S) for its convex hull. A family F of sets in R^d has the finite intersection property if every finite subfamily has nonempty intersection.\n\nTasks\n\n1) Carath\u00e9odory\u2019s Theorem. Prove: If x \u2208 conv(S) for some S \u2282 R^d, then there exists a subset T \u2282 S with |T| \u2264 d + 1 and x \u2208 conv(T).\n\n2) Radon\u2019s Theorem. Prove: Every set of d + 2 points in R^d can be partitioned into two disjoint (nonempty) subsets whose convex hulls intersect.\n\n3) Helly\u2019s Theorem. Let F be a finite family of convex sets in R^d. If every subfamily of size at most d + 1 has nonempty intersection, prove that \u22c2 F \u2260 \u2205.\n\n4) Centerpoint Theorem (sharp 1/(d+1)-depth). Let P \u2282 R^d be a finite set of n points. Prove there exists a point c \u2208 R^d (a centerpoint for P) such that every closed halfspace H \u2282 R^d with c \u2208 H contains at least \u23a1n/(d + 1)\u23a4 points of P. Moreover, show that this bound is best possible in general by giving, for each d, a configuration of n points for which no point has halfspace depth exceeding \u23a1n/(d + 1)\u23a4.\n\nAnswer format\n\n- Provide a complete, self-contained proof of each of the four items, in the order above.\n- Clearly state any linear-algebraic facts you use (e.g., affine dependence and linear dependence in R^d) and justify any compactness/closure arguments you invoke.\n- For (4), give both the existence proof via Helly and an explicit extremal configuration showing sharpness of the 1/(d+1) bound.",
        "answer": "We prove the four theorems in order. Throughout, we use these standard facts from linear algebra:\n\n- A set of m > d + 1 points in R^d is affinely dependent; equivalently, there exist real coefficients \u03b1_i, not all zero, with \u2211_i \u03b1_i = 0 and \u2211_i \u03b1_i p_i = 0.\n- If x \u2208 conv(S), then there exist points p_1,\u2026,p_k \u2208 S and nonnegative weights \u03bb_i with \u2211 \u03bb_i = 1 and x = \u2211 \u03bb_i p_i (a convex combination).\n\n1) Carath\u00e9odory\u2019s theorem\n\nStatement. If x \u2208 conv(S) \u2282 R^d, then x \u2208 conv(T) for some T \u2282 S with |T| \u2264 d + 1.\n\nProof. Let x \u2208 conv(S). Then x is a convex combination of finitely many points of S: there exist p_1,\u2026,p_m \u2208 S and \u03bb_i \u2265 0 with \u2211_{i=1}^m \u03bb_i = 1 and x = \u2211_{i=1}^m \u03bb_i p_i. If m \u2264 d + 1 we are done. Suppose m \u2265 d + 2. Then the set {p_1,\u2026,p_m} is affinely dependent, so there exist real numbers \u03b1_1,\u2026,\u03b1_m, not all zero, such that \u2211 \u03b1_i = 0 and \u2211 \u03b1_i p_i = 0.\n\nDefine I_+ = {i : \u03b1_i > 0} and I_- = {i : \u03b1_i < 0}. Since not all \u03b1_i are zero, at least one of I_+, I_- is nonempty; since \u2211 \u03b1_i = 0, both are nonempty. For t \u2265 0, set \u03bb_i(t) = \u03bb_i \u2212 t \u03b1_i. Then \u2211_i \u03bb_i(t) = \u2211_i \u03bb_i \u2212 t \u2211_i \u03b1_i = 1 and \u2211_i \u03bb_i(t) p_i = x \u2212 t \u2211_i \u03b1_i p_i = x, so x remains expressed as a convex combination with weights \u03bb_i(t), provided all \u03bb_i(t) \u2265 0.\n\nChoose t* = min{ \u03bb_i / \u03b1_i : i \u2208 I_+ } > 0; this is finite since I_+ \u2260 \u2205 and \u03bb_i \u2265 0. For that t*, we have \u03bb_i(t*) \u2265 0 for all i, and at least one \u03bb_j(t*) = 0 (for j \u2208 I_+ attaining the minimum). Thus we can eliminate p_j from the convex combination without changing x. Repeating this reduction at most m \u2212 (d + 1) times yields a representation of x as a convex combination of \u2264 d + 1 points. This proves the theorem.\n\n2) Radon\u2019s theorem\n\nStatement. Given d + 2 points in R^d, there exists a partition of the set into two disjoint nonempty subsets whose convex hulls intersect.\n\nProof. Let p_1,\u2026,p_{d+2} \u2208 R^d. Since they are affinely dependent, there exist real \u03b1_1,\u2026,\u03b1_{d+2}, not all zero, with \u2211 \u03b1_i = 0 and \u2211 \u03b1_i p_i = 0. Let I_+ = {i : \u03b1_i > 0} and I_- = {i : \u03b1_i < 0}; both are nonempty. Define\nx = \u2211_{i\u2208I_+} (\u03b1_i / A) p_i = \u2211_{i\u2208I_-} (\u2212\u03b1_i / A) p_i,\nwhere A := \u2211_{i\u2208I_+} \u03b1_i = \u2212\u2211_{i\u2208I_-} \u03b1_i > 0. Then the coefficients on each side are nonnegative and sum to 1. Hence x \u2208 conv({p_i : i \u2208 I_+}) \u2229 conv({p_i : i \u2208 I_-}). This gives the desired partition into two parts whose convex hulls intersect.\n\n3) Helly\u2019s theorem\n\nStatement. Let F be a finite family of convex subsets of R^d. If every subfamily of size at most d + 1 has nonempty intersection, then \u22c2 F \u2260 \u2205.\n\nWe give a standard minimal-counterexample proof using Radon\u2019s theorem.\n\nProof. Suppose, to the contrary, that F = {C_1,\u2026,C_m} is a counterexample with m minimal, i.e., \u22c2_{i=1}^m C_i = \u2205 but every subfamily of size at most d + 1 intersects. Necessarily m \u2265 d + 2. For each i, define\nK_i := \u22c2_{j\u2260i} C_j.\nBy minimality, K_i \u2260 \u2205 for all i (since removing C_i restores nonemptiness of the intersection). For each i, pick x_i \u2208 K_i. Thus x_i \u2208 C_j for all j \u2260 i, but x_i \u2209 \u22c2_{j=1}^m C_j (the latter is empty). In particular, x_i may or may not lie in C_i; what matters is that x_i lies in all C_j with j \u2260 i.\n\nConsider the d + 2 points x_1,\u2026,x_{d+2}. By Radon\u2019s theorem, there exist disjoint nonempty index sets I, J partitioning {1,\u2026,d+2} such that\nconv({x_i : i \u2208 I}) \u2229 conv({x_j : j \u2208 J}) \u2260 \u2205.\nLet y be a point in the intersection; write y = \u2211_{i\u2208I} \u03bb_i x_i = \u2211_{j\u2208J} \u03bc_j x_j with \u03bb_i, \u03bc_j \u2265 0 and sums equal to 1.\n\nFix any k \u2208 {1,\u2026,m}. We claim y \u2208 C_k. If k \u2208 I, then for each i \u2208 I with i \u2260 k we know x_i \u2208 C_k (since x_i \u2208 K_i \u2286 \u22c2_{j\u2260i} C_j and k \u2260 i). The point x_k may or may not belong to C_k, but because C_k is convex and all x_i with i \u2208 I \\ {k} belong to C_k, any convex combination of the x_i with support excluding k lies in C_k. To ensure y \u2208 C_k, note that if \u03bb_k = 0 we are done; if \u03bb_k > 0, we instead use the representation y = \u2211_{j\u2208J} \u03bc_j x_j and observe that for each j \u2208 J we have j \u2260 k (since I and J are disjoint), hence x_j \u2208 C_k. Thus y \u2208 conv({x_j : j \u2208 J}) \u2286 C_k. Therefore y \u2208 C_k for all k.\n\nConsequently y \u2208 \u22c2_{k=1}^m C_k, contradicting our assumption that \u22c2 F = \u2205. This proves Helly\u2019s theorem.\n\nRemark on the role of d + 1. The theorem fails if \u201cd + 1\u201d is replaced by \u201cd\u201d: e.g., in R^2 take three \u201ccorners\u201d of a triangle as convex sets; any two intersect but all three do not.\n\n4) Centerpoint theorem\n\nStatement. For any finite set P \u2282 R^d with |P| = n, there exists c \u2208 R^d such that every closed halfspace H with c \u2208 H satisfies |H \u2229 P| \u2265 \u23a1n/(d + 1)\u23a4. The bound 1/(d + 1) is best possible.\n\nProof (existence via Helly). Let t = \u23a1n/(d + 1)\u23a4. Consider the family G of all closed halfspaces H such that |H \u2229 P| \u2265 t. We seek a point c \u2208 \u22c2 G. We will show that every subfamily of G of size at most d + 1 has nonempty intersection; then Helly\u2019s theorem implies \u22c2 G \u2260 \u2205, and any point c in this intersection has the desired depth property.\n\nSo let H_1,\u2026,H_{d+1} be d + 1 halfspaces from G. We claim \u22c2_{i=1}^{d+1} H_i \u2260 \u2205. Suppose not. Then the complements K_i := R^d \\ H_i are open halfspaces whose union covers R^d:\nR^d = \u22c3_{i=1}^{d+1} K_i.\nBy a standard separation argument (or using the \u201cfinite Helly\u201d contours for halfspaces), there exists a choice of points p_i \u2208 P with p_i \u2208 K_i and such that the p_i are in general position (this is not strictly needed; the key is only combinatorics of counts below). Now count points of P in complements. Since each H_i contains at least t points of P, each K_i contains at most n \u2212 t points. On the other hand, because \u22c3 K_i covers R^d, every point of P lies in at least one K_i. Summing the indicator functions over i and over P gives\n\u2211_{i=1}^{d+1} |K_i \u2229 P| \u2265 n.\nHence\n(d + 1)(n \u2212 t) \u2265 n, i.e., (d + 1) n \u2212 (d + 1) t \u2265 n,\nso (d + 1) t \u2264 d n,\nwhich contradicts t = \u23a1n/(d + 1)\u23a4 (indeed (d + 1) t \u2265 n). Therefore \u22c2_{i=1}^{d+1} H_i \u2260 \u2205. By Helly, \u22c2 G \u2260 \u2205, completing the existence proof.\n\nA more geometric version of the counting step: If \u22c2_{i=1}^{d+1} H_i = \u2205, then by the (closed) hyperplane separation theorem there exist unit normals u_i and thresholds a_i such that H_i = {x : \u27e8u_i,x\u27e9 \u2265 a_i} and {x : \u27e8u_i,x\u27e9 < a_i} cover R^d. Each H_i misses at most n \u2212 t points of P; summing these misses across i is at least n since every point is missed by at least one H_i. This yields the same contradiction.\n\nSharpness. The bound 1/(d + 1) cannot be improved. For each d and n, place the point set P as a union of d + 1 well-separated clusters, each of size about n/(d + 1), with the clusters positioned near the vertices of a sufficiently large regular simplex in R^d. More concretely, let v_0,\u2026,v_d be the vertices of a regular simplex centered at the origin, and take P to be the union of d + 1 clusters tightly concentrated near these vertices, with sizes as equal as possible. For any point c \u2208 R^d, there exists a supporting hyperplane of the simplex through c that separates one vertex from the others; the closed halfspace containing c and that isolated vertex\u2019s direction will contain at most \u23a1n/(d + 1)\u23a4 points of P. Thus no point has halfspace depth exceeding \u23a1n/(d + 1)\u23a4 in this configuration.\n\nThis shows the 1/(d + 1) depth bound is best possible in general.\n\nAdditional remarks and interrelations\n\n- Carath\u00e9odory and Radon are tightly linked. Radon\u2019s theorem is equivalent to the statement that every set of d + 2 points admits a nontrivial Radon partition; Carath\u00e9odory can be deduced from Radon by iteratively pruning a generating set as in the proof above.\n- Helly\u2019s theorem is a cornerstone of convexity: many geometric transversality and intersection results follow from it by considering suitable families of convex sets (e.g., halfspaces defined by counting constraints, as in the centerpoint proof).\n- The centerpoint theorem implies that every finite point set has a depth-\u2265 n/(d+1) point; by compactness, this extends to probability measures on R^d (existence of a Tukey median of depth \u2265 1/(d + 1)).\n\nThis completes the self-contained development."
    },
    {
        "question": "Title: Highest-weight classification of finite-dimensional sl\u2082(C)-modules and the Clebsch\u2013Gordan decomposition, with a sharp triple-invariant criterion\n\nWork over the field C. Let sl\u2082(C) denote the Lie algebra of 2\u00d72 complex traceless matrices. Fix the standard basis\n- e = [[0,1],[0,0]], f = [[0,0],[1,0]], h = [[1,0],[0,\u22121]],\nwhich satisfies the relations [h,e] = 2e, [h,f] = \u22122f, [e,f] = h. A (finite-dimensional) representation (module) of sl\u2082(C) is a finite-dimensional complex vector space V together with a Lie algebra homomorphism \u03c1: sl\u2082(C) \u2192 End(V). For x \u2208 sl\u2082(C) and v \u2208 V we write x\u00b7v or simply xv for \u03c1(x)(v).\n\nFor v \u2208 V, if hv = \u03bb v for some \u03bb \u2208 C we call v a weight vector of (h-)weight \u03bb. A vector v \u2260 0 with ev = 0 is called a highest-weight vector; if also hv = m v then m is its highest weight.\n\nProblem. Prove, self-contained and in order, the following:\n\n1) Weight-raising/lowering and highest-weight existence in irreducibles.\n   - Show: If hv = \u03bb v then either ev = 0 or ev is a weight vector of weight \u03bb+2; similarly, either fv = 0 or fv is a weight vector of weight \u03bb\u22122.\n   - Let V be a finite-dimensional irreducible sl\u2082-module. Prove that V contains a highest-weight vector v \u2260 0 with ev = 0 and hv = m v. Show that m \u2208 Z_{\u22650}.\n   - Prove the commutator identity [e, f^k] = k f^{k\u22121} (h \u2212 (k\u22121) I) for all k \u2265 1, and deduce the formulas\n     e f^k v = k (m \u2212 k + 1) f^{k\u22121} v and h f^k v = (m \u2212 2k) f^k v, for k \u2265 0, with the convention f^{\u22121} v = 0.\n\n2) Explicit model and irreducibility of the standard modules V_m.\n   - For m \u2208 Z_{\u22650}, let V_m be the (m+1)-dimensional space of homogeneous polynomials of degree m in two variables x,y. Define operators on V_m by\n     e = x \u2202/\u2202y, f = y \u2202/\u2202x, h = x \u2202/\u2202x \u2212 y \u2202/\u2202y.\n     Prove that this makes V_m an sl\u2082-module with highest-weight vector x^m of weight m, and that V_m is irreducible. In the weight basis v_k := binom(m,k) x^{m\u2212k} y^k (0 \u2264 k \u2264 m), prove the action formulas\n     e v_k = (m \u2212 k + 1) v_{k\u22121}, f v_k = (k + 1) v_{k+1}, h v_k = (m \u2212 2k) v_k,\n     with v_{\u22121} = v_{m+1} = 0.\n\n3) Classification of finite-dimensional irreducibles.\n   - Let V be a finite-dimensional irreducible sl\u2082-module with highest-weight vector v of weight m. Prove that m \u2208 Z_{\u22650}, the vectors v, f v, \u2026, f^m v are linearly independent, f^{m+1} v = 0, and that V is spanned by these (m+1) vectors. Construct an explicit sl\u2082-isomorphism V_m \u2245 V by sending x^{m\u2212k} y^k to a nonzero scalar multiple of f^k v. Conclude that the V_m (m \u2208 Z_{\u22650}) are, up to isomorphism, the complete list of finite-dimensional irreducible sl\u2082-modules.\n\n4) Clebsch\u2013Gordan decomposition.\n   - Let m,n \u2208 Z_{\u22650}. Consider V_m \u2297 V_n with sl\u2082-action x\u00b7(u \u2297 w) = (x u) \u2297 w + u \u2297 (x w). Prove the Clebsch\u2013Gordan rule:\n     V_m \u2297 V_n \u2245 \u2295_{k=0}^{min(m,n)} V_{m+n\u22122k}.\n     Your proof must explicitly produce, for each k, a highest-weight vector s_k \u2208 V_m \u2297 V_n of weight m+n\u22122k, show that the submodule it generates is irreducible and isomorphic to V_{m+n\u22122k}, that these submodules are pairwise disjoint, and that the dimension count matches to give a direct sum decomposition.\n\n5) Sharp triple-invariant criterion.\n   - For a,b,c \u2208 Z_{\u22650}, determine the multiplicity of the trivial representation V_0 inside V_a \u2297 V_b \u2297 V_c. Prove that this multiplicity is 1 if and only if |a \u2212 b| \u2264 c \u2264 a + b and a + b + c is even, and is 0 otherwise.\n\nAnswer format:\n- Prove all items rigorously, defining any objects you use and justifying all steps.\n- State clearly the final classification and the Clebsch\u2013Gordan decomposition, and give a clean proof of the triple-invariant criterion as a corollary.",
        "answer": "We work over C and write the sl\u2082-generators e,f,h with relations [h,e]=2e, [h,f]=\u22122f, [e,f]=h. For a representation V, we suppress \u03c1 and write e,f,h for their action on V.\n\nStep 1: Weight-raising/lowering, highest-weight existence, and basic formulas.\n\n1a) Raising/lowering. Let hv = \u03bb v. Then\n- h(ev) = (he)v = (eh + [h,e])v = e(hv) + 2ev = (\u03bb + 2) ev.\nThus ev is either 0 or an h-eigenvector of weight \u03bb+2. Similarly,\n- h(fv) = (hf)v = (fh + [h,f])v = f(hv) \u2212 2fv = (\u03bb \u2212 2) fv.\nSo fv is either 0 or a weight-\u03bb\u22122 vector.\n\n1b) Highest-weight existence in irreducibles. Let V be finite-dimensional and irreducible. Since h is a linear operator on a finite-dimensional complex space, it has an eigenvector u \u2260 0 with hu = \u03bb u. The sequence u, eu, e^2 u, \u2026 must terminate: let t \u2265 0 be maximal with e^t u \u2260 0; set v := e^t u \u2260 0. Then ev = 0, so v is a highest-weight vector. Write hv = m v; m \u2208 C.\n\nWe now derive the key commutator identity.\n\n1c) The identity [e, f^k] = k f^{k\u22121} (h \u2212 (k\u22121) I). We argue by induction on k \u2265 1. For k = 1, [e,f] = h equals f^{0}(h \u2212 0\u00b7I). Suppose true for k. Then\n[e, f^{k+1}] = [e, f^k f] = [e, f^k] f + f^k [e, f] = k f^{k\u22121} (h \u2212 (k\u22121)I) f + f^k h.\nUsing h f = f h \u2212 2 f (equivalently [h,f] = \u22122f), we have (h \u2212 (k\u22121)I) f = f (h \u2212 (k\u22121)I) \u2212 2 f, hence\nk f^{k\u22121} (h \u2212 (k\u22121)I) f = k f^k (h \u2212 (k\u22121)I) \u2212 2k f^k.\nTherefore\n[e, f^{k+1}] = f^k [ k (h \u2212 (k\u22121)I) \u2212 2k + h ] = f^k [ (k+1) h \u2212 k(k+1) I ] = (k+1) f^k (h \u2212 k I),\nas desired.\n\nApplying this to the highest-weight vector v with hv = m v and ev = 0 gives\ne f^k v = [e, f^k] v = k (m \u2212 k + 1) f^{k\u22121} v,  h f^k v = (m \u2212 2k) f^k v\n(the second follows by induction from [h,f] = \u22122f). In particular, for k \u2265 1, if f^{k\u22121} v \u2260 0 then e f^k v = 0 \u21d4 k(m \u2212 k + 1) = 0 \u21d4 k = 0 or k = m+1.\n\n1d) m is a nonnegative integer. Consider the sequence f^k v. Because V is finite-dimensional, there exists r \u2265 0 with f^{r+1} v = 0 and f^r v \u2260 0. For k \u2265 1,\ne^k f^k v = k! \u00b7 m (m \u2212 1) \u00b7\u00b7\u00b7 (m \u2212 k + 1) \u00b7 v.\nIndeed this follows by repeated use of 1c. Taking k = r+1 we get 0 = e^{r+1} f^{r+1} v = (r+1)! \u00b7 m (m \u2212 1) \u00b7\u00b7\u00b7 (m \u2212 r) v. Since v \u2260 0, the scalar must vanish, so m \u2208 {0,1,\u2026,r}. Thus m \u2208 Z_{\u22650}.\n\nFinally, observe that e f^{m+1} v = 0 (by 1c), and h(f^{m+1} v) = (m \u2212 2(m+1)) f^{m+1} v = (\u2212m \u2212 2) f^{m+1} v. If f^{m+1} v \u2260 0, then f^{m+1} v would be another highest-weight vector (annihilated by e) of strictly lower weight \u2212m\u22122, generating a nonzero proper submodule, impossible in an irreducible V. Hence f^{m+1} v = 0.\n\nStep 2: The polynomial model V_m and irreducibility.\n\nFix m \u2208 Z_{\u22650}. Let V_m = { homogeneous polynomials of degree m in x,y }. Define\ne = x \u2202/\u2202y, f = y \u2202/\u2202x, h = x \u2202/\u2202x \u2212 y \u2202/\u2202y.\nThese operators preserve homogeneity of degree m and satisfy the sl\u2082-relations:\n- [h,e] = [x\u2202_x \u2212 y\u2202_y, x\u2202_y] = x\u2202_y + x [\u2202_x, \u2202_y]? Compute on a polynomial p:\n  h(e p) \u2212 e(h p) = (x\u2202_x \u2212 y\u2202_y)(x\u2202_y p) \u2212 x\u2202_y((x\u2202_x \u2212 y\u2202_y) p) = 2 x \u2202_y p = 2 e p.\n- Similarly [h,f] = \u22122 f and [e,f] = h (easy calculus check).\n\nThus V_m is an sl\u2082-module. The monomials x^{m\u2212k} y^k (0 \u2264 k \u2264 m) form a basis; set v_k := binom(m,k) x^{m\u2212k} y^k. A direct calculation yields\ne v_k = (m \u2212 k + 1) v_{k\u22121},  f v_k = (k + 1) v_{k+1},  h v_k = (m \u2212 2k) v_k,\nwith v_{\u22121} = v_{m+1} = 0. In particular, x^m = v_0 is a highest-weight vector of weight m. It follows that the span of {v_0, f v_0, \u2026, f^m v_0} is all of V_m. By Step 1, this sl\u2082-submodule is irreducible (it has basis v_0,\u2026,v_m and f^{m+1} v_0 = 0), so V_m is irreducible.\n\nStep 3: Classification of finite-dimensional irreducibles.\n\nLet V be irreducible and finite-dimensional with highest-weight vector v of weight m \u2208 Z_{\u22650}. From Step 1,\n- The vectors v, f v, \u2026, f^m v are nonzero and satisfy e f^k v = k (m \u2212 k + 1) f^{k\u22121} v and h f^k v = (m \u2212 2k) f^k v.\n- Since f^{m+1} v = 0 and the above action formulas show the span W := span{v, f v, \u2026, f^m v} is stable under e,f,h, it is a nonzero submodule; by irreducibility, W = V. Moreover, these vectors are linearly independent (distinct weights m, m\u22122,\u2026, \u2212m), so dim V = m+1.\n\nDefine a linear map \u03a6: V_m \u2192 V by \u03a6(x^{m\u2212k} y^k) := c_k f^k v, where c_k are nonzero scalars chosen recursively to match the action of e,f (for instance take c_k = 1/k! to align coefficients). The relations in Step 2 and Step 1 show that \u03a6 intertwines the sl\u2082-action:\n- \u03a6(e \u00b7 x^{m\u2212k} y^k) = \u03a6((m \u2212 k + 1) x^{m\u2212k+1} y^{k\u22121}) = (m \u2212 k + 1) c_{k\u22121} f^{k\u22121} v = e \u00b7 (c_k f^k v) = e \u00b7 \u03a6(x^{m\u2212k} y^k),\nand similarly for f,h. Thus \u03a6 is an sl\u2082-homomorphism. It is nonzero (\u03a6(x^m) = v \u2260 0), hence, by irreducibility of V_m and V, an isomorphism. This shows every finite-dimensional irreducible sl\u2082-module is isomorphic to a unique V_m, m \u2208 Z_{\u22650}.\n\nStep 4: The Clebsch\u2013Gordan decomposition.\n\nWe work in V_m \u2297 V_n with the tensor action x\u00b7(u \u2297 w) = (x u) \u2297 w + u \u2297 (x w). Let {v_i}_{0\u2264i\u2264m} and {w_j}_{0\u2264j\u2264n} be the weight bases as in Step 2:\ne v_i = (m \u2212 i + 1) v_{i\u22121}, f v_i = (i + 1) v_{i+1}, h v_i = (m \u2212 2i) v_i,\nand similarly for w_j.\n\nWeights in V_m \u2297 V_n are of the form (m \u2212 2i) + (n \u2212 2j) = m + n \u2212 2(i + j). For each k with 0 \u2264 k \u2264 min(m,n), consider the weight space\nW_k := span{ v_i \u2297 w_{k\u2212i} : i = 0,1,\u2026,k }.\nThis is the weight-(m+n\u22122k) space; it has dimension k+1. The raising operator e acts as\ne\u00b7(v_i \u2297 w_{k\u2212i}) = (e v_i) \u2297 w_{k\u2212i} + v_i \u2297 (e w_{k\u2212i})\n= (m \u2212 i + 1) v_{i\u22121} \u2297 w_{k\u2212i} + (n \u2212 (k\u2212i) + 1) v_i \u2297 w_{k\u2212i\u22121},\nwhich lies in the weight-(m+n\u22122(k\u22121)) space W_{k\u22121}. Thus e maps W_k \u2192 W_{k\u22121}. Since dim W_k = k+1 and dim W_{k\u22121} = k, the linear map e: W_k \u2192 W_{k\u22121} has nontrivial kernel. Hence there exists s_k \u2208 W_k, s_k \u2260 0, with e s_k = 0. That is, for each k there is a highest-weight vector s_k of weight m + n \u2212 2k.\n\nLet U_k be the sl\u2082-submodule generated by s_k. By Step 3, U_k is irreducible and U_k \u2245 V_{m+n\u22122k}. Moreover, if k \u2260 \u2113 then U_k and U_\u2113 have distinct highest weights, so U_k \u2229 U_\u2113 = {0} (an irreducible module is determined by its highest weight; a nonzero intersection would be an irreducible submodule common to both, impossible unless they are equal). Hence \u2295_{k=0}^r U_k is a direct sum, where r := min(m,n).\n\nFinally, the dimensions match:\n\u03a3_{k=0}^r dim U_k = \u03a3_{k=0}^r (m + n \u2212 2k + 1) = (r+1)(m+n+1) \u2212 2 \u03a3_{k=0}^r k\n= (r+1)(m+n+1) \u2212 r(r+1) = (r+1)(m+n+1 \u2212 r) = (m+1)(n+1) = dim(V_m \u2297 V_n).\nTherefore V_m \u2297 V_n = \u2295_{k=0}^{min(m,n)} U_k \u2245 \u2295_{k=0}^{min(m,n)} V_{m+n\u22122k}.\n\nRemark. One may normalize s_k explicitly, e.g.,\ns_k = \u03a3_{i=0}^k (\u22121)^i binom(m,i) binom(n, k\u2212i) v_i \u2297 w_{k\u2212i},\nwhich indeed satisfies e s_k = 0, but the rank\u2013nullity argument above suffices.\n\nStep 5: Triple-invariant criterion.\n\nWe seek the multiplicity of V_0 in V_a \u2297 V_b \u2297 V_c. Using Step 4,\nV_a \u2297 V_b \u2245 \u2295_{k=0}^{min(a,b)} V_{a+b\u22122k}.\nTensoring with V_c and decomposing each term gives\nV_a \u2297 V_b \u2297 V_c \u2245 \u2295_{k=0}^{min(a,b)} (V_{a+b\u22122k} \u2297 V_c) \u2245 \u2295_{k=0}^{min(a,b)} \u2295_{\u2113=0}^{min(a+b\u22122k, c)} V_{a+b\u22122k+c\u22122\u2113}.\nThe trivial representation V_0 appears precisely when a+b\u22122k = c (then \u2113 = c). Thus V_0 occurs iff there exists an integer k with 0 \u2264 k \u2264 min(a,b) such that c = a + b \u2212 2k.\n\nEquivalently, there is such an integer k iff:\n- Parity: a + b \u2212 c is even (so k = (a + b \u2212 c)/2 \u2208 Z), and\n- Bounds: 0 \u2264 (a + b \u2212 c)/2 \u2264 min(a,b), i.e., |a \u2212 b| \u2264 c \u2264 a + b.\n\nWhen these conditions hold, the k solving a+b\u22122k = c is unique, so the multiplicity is exactly 1. Otherwise the multiplicity is 0.\n\nConclusion.\n\n- Every finite-dimensional irreducible sl\u2082(C)-module is isomorphic to exactly one V_m (m \u2208 Z_{\u22650}), the space of homogeneous degree-m polynomials in two variables with e = x\u2202/\u2202y, f = y\u2202/\u2202x, h = x\u2202/\u2202x \u2212 y\u2202/\u2202y, having a highest-weight basis v_0,\u2026,v_m with\n  e v_k = (m \u2212 k + 1) v_{k\u22121}, f v_k = (k + 1) v_{k+1}, h v_k = (m \u2212 2k) v_k.\n- The Clebsch\u2013Gordan decomposition holds:\n  V_m \u2297 V_n \u2245 \u2295_{k=0}^{min(m,n)} V_{m+n\u22122k}.\n- The multiplicity of the trivial representation in V_a \u2297 V_b \u2297 V_c equals 1 if and only if |a \u2212 b| \u2264 c \u2264 a + b and a + b + c is even, and equals 0 otherwise."
    },
    {
        "question": "Title: Majorization, T-transforms, and the Schur\u2013Horn theorem \u2014 a complete self-contained proof with Ky Fan and convexity corollaries\n\nLet n \u2265 2 be an integer. For x \u2208 R^n, write x^\u2193 for the nonincreasing rearrangement of its coordinates. Say y is majorized by x, and write y \u227a x, if\n- for every k = 1,\u2026,n\u22121 one has \u2211_{i=1}^k y^\u2193_i \u2264 \u2211_{i=1}^k x^\u2193_i, and\n- \u2211_{i=1}^n y_i = \u2211_{i=1}^n x_i.\n\nA matrix A \u2208 R^{n\u00d7n} is doubly stochastic (DS) if A has nonnegative entries and every row sum and column sum equals 1. A T-transform (or Robin Hood transform) is the linear map T_{ij}(t) acting on vectors x \u2208 R^n by replacing the pair (x_i,x_j) with (t x_i + (1\u2212t) x_j, (1\u2212t) x_i + t x_j) for some i \u2260 j and t \u2208 [0,1], leaving all other coordinates unchanged.\n\nA complex n\u00d7n matrix U is unitary if U^* U = I. A Hermitian matrix H satisfies H = H^*. By the spectral theorem, any Hermitian H is unitarily diagonalizable: there exists a unitary U and a real diagonal D = diag(\u03bb_1,\u2026,\u03bb_n) such that H = U D U^*, where \u03bb_1,\u2026,\u03bb_n are the eigenvalues of H (counted with algebraic multiplicity). For a matrix M, write diag(M) \u2208 R^n for its diagonal vector.\n\nProblem. Prove the following, self-contained and in order:\n\n1) Hardy\u2013Littlewood\u2013P\u00f3lya (HLP) characterization of majorization.\n   - Show that if A is doubly stochastic, then for every x \u2208 R^n one has A x \u227a x.\n   - Show that a single T-transform T_{ij}(t) is doubly stochastic; hence T_{ij}(t) x \u227a x for all x.\n   - Prove the converse direction: If y \u227a x, then there exists a finite sequence of T-transforms T^{(1)},\u2026,T^{(m)} such that y = T^{(m)} \u22ef T^{(1)} x. Conclude that y = A x for some doubly stochastic A.\n\n   You must give a complete proof of the \u201cT-transform factorization\u201d (the Robin Hood algorithm), not invoking Birkhoff\u2019s theorem on convex combinations of permutations.\n\n2) Two-by-two unitary mixing realizes a T-transform on diagonals.\n   Let D = diag(\u03bb_1,\u2026,\u03bb_n) be a real diagonal matrix, and let U be a unitary that is the identity except on the span of e_i,e_j where it equals a real plane rotation by angle \u03b8:\n   U e_i = cos \u03b8 e_i + sin \u03b8 e_j, U e_j = \u2212sin \u03b8 e_i + cos \u03b8 e_j.\n   Prove that the diagonal of U^* D U agrees with the diagonal of D except in positions i,j, where it is replaced by the T-transform of (\u03bb_i,\u03bb_j) with parameter t = cos^2 \u03b8:\n   diag(U^* D U)_i = t \u03bb_i + (1\u2212t) \u03bb_j, diag(U^* D U)_j = (1\u2212t) \u03bb_i + t \u03bb_j.\n\n3) Schur\u2013Horn theorem (complete classification of diagonals with fixed spectrum).\n   Let H be Hermitian with eigenvalues \u03bb_1,\u2026,\u03bb_n (in any order), and let d \u2208 R^n be its diagonal vector.\n   - Prove the \u201conly if\u201d direction: d \u227a \u03bb, where \u03bb denotes the vector (\u03bb_1,\u2026,\u03bb_n).\n     Hint: write H = U D U^*, express d in terms of |U_{ij}|^2, and use part (1).\n   - Prove the \u201cif\u201d direction: given any real vector d \u227a \u03bb, there exists a unitary V such that diag(V^* D V) = d, where D = diag(\u03bb_1,\u2026,\u03bb_n). You must give a constructive proof by factorizing the majorization relation into T-transforms and then realizing each by a two-by-two rotation as in (2). Conclude that the set of diagonal vectors of Hermitian matrices unitarily similar to D is exactly {d \u2208 R^n : d \u227a \u03bb}.\n\n4) Two sharp corollaries.\n   - Ky Fan\u2019s maximum principle for diagonals. Let H be Hermitian with eigenvalues \u03bb_1 \u2265 \u22ef \u2265 \u03bb_n, and let d_1 \u2265 \u22ef \u2265 d_n be the nonincreasing rearrangement of the diagonal entries of H. Prove that for all k = 1,\u2026,n, \u2211_{i=1}^k d_i \u2264 \u2211_{i=1}^k \u03bb_i.\n   - Convexity (Karamata-type) corollary and equality. Let \u03c6: R \u2192 R be convex. Prove that for every Hermitian H with eigenvalues \u03bb_1,\u2026,\u03bb_n and diagonals d_1,\u2026,d_n, one has\n     \u2211_{i=1}^n \u03c6(d_i) \u2264 \u2211_{i=1}^n \u03c6(\u03bb_i).\n     If \u03c6 is strictly convex, prove that equality holds if and only if (d_1,\u2026,d_n) is a permutation of (\u03bb_1,\u2026,\u03bb_n) (equivalently, H is unitarily diagonal with the same multiset of diagonal entries as its eigenvalues).\n\nAnswer format:\n- Prove (1)\u2013(4) in order with complete, rigorous arguments.\n- You may freely sort coordinates when checking majorization, but must clearly indicate where you use rearrangements.\n- Your proof of (3) must be fully constructive as requested in the \u201cif\u201d direction.",
        "answer": "We proceed in order.\n\n1) Hardy\u2013Littlewood\u2013P\u00f3lya (HLP) characterization\n\nDefinitions and preliminaries.\n- For x \u2208 R^n, write S_k(x) := \u2211_{i=1}^k x^\u2193_i, k = 1,\u2026,n, for the partial sums of the decreasing rearrangement.\n- For i \u2260 j and t \u2208 [0,1], the T-transform T_{ij}(t) maps x to x' defined by x'_i = t x_i + (1\u2212t) x_j, x'_j = (1\u2212t) x_i + t x_j, and x'_\\ell = x_\\ell for \u2113 \u2209 {i,j}. Note T_{ij}(t) is linear, preserves the total sum \u2211 x_i, and preserves the 1-vector: T_{ij}(t) 1 = 1.\n\n(1a) If A is doubly stochastic, then Ax \u227a x for all x.\n\nProof. It suffices to prove that S_k(Ax) \u2264 S_k(x) for k = 1,\u2026,n\u22121 and \u2211 (Ax)_i = \u2211 x_i. The latter is immediate since each row sum is 1. For the partial sums, let J \u2282 {1,\u2026,n} be the index set of the k largest coordinates of Ax; then\nS_k((Ax)) = \u2211_{i\u2208J} (Ax)_i = \u2211_{i\u2208J} \u2211_{j=1}^n A_{ij} x_j = \u2211_{j=1}^n \u03b2_j x_j,\nwhere \u03b2_j := \u2211_{i\u2208J} A_{ij} \u2208 [0,1] and \u2211_{j=1}^n \u03b2_j = \u2211_{i\u2208J} \u2211_{j} A_{ij} = |J| = k because column sums are 1. Thus S_k(Ax) is a convex combination (with weights \u03b2_j) of the coordinates of x with total weight k, never assigning total weight more than 1 to any x_j. Among all choices of \u03b2 with 0 \u2264 \u03b2_j \u2264 1 and \u2211 \u03b2_j = k, the maximal value of \u2211 \u03b2_j x^\u2193_j is attained by taking \u03b2_j = 1 for j \u2264 k and \u03b2_j = 0 otherwise, hence\nS_k(Ax) \u2264 \u2211_{j=1}^k x^\u2193_j = S_k(x).\nThis proves Ax \u227a x.\n\n(1b) T-transforms are doubly stochastic; hence T_{ij}(t) x \u227a x.\n\nProof. The matrix of T_{ij}(t) equals the identity except on rows/columns i,j where it equals\n[ t  1\u2212t\n 1\u2212t  t ],\nwhich is nonnegative with row and column sums 1. Thus T_{ij}(t) is DS, so by (1a), T_{ij}(t) x \u227a x.\n\n(1c) Converse: If y \u227a x, then y is obtainable from x by a finite sequence of T-transforms. Consequently, y = A x with some DS A.\n\nProof (Robin Hood algorithm). We may and do assume x and y are sorted in nonincreasing order (since majorization is defined via decreasing rearrangements and T-transforms commute with simultaneous permutations of coordinates). Write \u0394_m := \u2211_{i=1}^m (x_i \u2212 y_i) for m = 1,\u2026,n; then \u0394_m \u2265 0 for m \u2264 n\u22121 and \u0394_n = 0 by y \u227a x.\n\nWe construct a sequence x = x^{(0)}, x^{(1)},\u2026, x^{(r)} = y with each step a single T_{1j}(t) adjusting x^{(s)}_1 downward until it matches y_1, then recurse on the tail.\n\nStep 1. If x_1 = y_1, skip to Step 2. Otherwise x_1 > y_1 (since S_1(x) \u2265 S_1(y) and equality at n forbids y_1 > x_1). Because \u0394_n = 0 while \u0394_1 = x_1 \u2212 y_1 > 0, there exists some \u2113 \u2265 2 with y_\u2113 \u2212 x_\u2113 \u2265 0 (else \u2211_{i=2}^n (y_i \u2212 x_i) < 0 contradicting \u0394_n = 0). Define \u03b4 := min{ x_1 \u2212 y_1, y_\u2113 \u2212 x_\u2113 } > 0 and set\nx' := T_{1\u2113}(t) x with t chosen so that x'_1 = x_1 \u2212 \u03b4 and x'_\u2113 = x_\u2113 + \u03b4; all other coordinates unchanged.\nWe claim y \u227a x'. First, \u2211 x'_i = \u2211 x_i. For partial sums S_k:\n- For k = 1, S_1(x') = x_1 \u2212 \u03b4 \u2265 y_1 by choice of \u03b4 \u2264 x_1 \u2212 y_1.\n- For 2 \u2264 k \u2264 \u2113\u22121, we have not yet altered any coordinate among positions 2,\u2026,k, so\nS_k(x') = (x_1 \u2212 \u03b4) + \u2211_{i=2}^k x_i = S_k(x) \u2212 \u03b4 \u2265 S_k(y)\nbecause S_k(x) \u2212 S_k(y) = \u0394_k \u2265 \u0394_1 \u2265 \u03b4 (indeed \u0394_k \u2265 \u0394_1 since \u0394_m is nonincreasing in m whenever y_i \u2212 x_i \u2264 0 for i = 2,\u2026,k; this holds by the choice of \u2113 as the first index with y_\u2113 \u2212 x_\u2113 \u2265 0).\n- For k \u2265 \u2113, S_k(x') = S_k(x) (the \u2212\u03b4 at coordinate 1 is offset by +\u03b4 at coordinate \u2113), so S_k(x') \u2265 S_k(y).\nThus y \u227a x'.\n\nIf x'_1 = y_1 (which happens if \u03b4 = x_1 \u2212 y_1), proceed to Step 2 with x' in place of x. Otherwise \u03b4 = y_\u2113 \u2212 x_\u2113 and x'_\u2113 = y_\u2113; (in this subcase we reorder nonincreasingly if necessary \u2014 the partial sum inequalities are unaffected by a permutation \u2014 and repeat the above adjustment to decrease the largest coordinate until it hits y_1). Repeating finitely many times we reach a vector x^{(s)} with x^{(s)}_1 = y_1 and y \u227a x^{(s)}.\n\nStep 2 (induction on dimension). Remove the first coordinate and apply the same procedure to the (n\u22121)-vectors consisting of the remaining coordinates of x^{(s)} and y. The majorization relation on the tails holds because subtracting equal first coordinates preserves all \u0394_m for m \u2265 2. By induction, a finite sequence of T-transforms on indices in {2,\u2026,n} steers the tail of x^{(s)} to the tail of y. All together, y is obtained from x by a finite composition of T-transforms.\n\nFinally, each T-transform is DS, so the product matrix A is DS and y = A x.\n\nThis completes (1).\n\n2) Two-by-two unitary mixing gives a T-transform on diagonals\n\nLet D = diag(\u03bb_1,\u2026,\u03bb_n) be real diagonal, and let U be the identity except on span{e_i,e_j} where\nU|_{span} = [ cos \u03b8   sin \u03b8\n              \u2212sin \u03b8  cos \u03b8 ].\nThen U is unitary and U^* = U^{\u22121} has the same block with sin \u03b8 negated on the off-diagonal.\n\nCompute the (i,i) entry of U^* D U. Writing the 2\u00d72 block computation and noting that D is diagonal,\n(U^* D U)_{ii} = [cos \u03b8, \u2212sin \u03b8] [ \u03bb_i  0\n                                    0   \u03bb_j ] [ cos \u03b8\n                                                sin \u03b8 ]\n= cos^2 \u03b8 \u03bb_i + sin^2 \u03b8 \u03bb_j.\nSimilarly,\n(U^* D U)_{jj} = sin^2 \u03b8 \u03bb_i + cos^2 \u03b8 \u03bb_j.\nAll other diagonal entries are unchanged. Setting t = cos^2 \u03b8 \u2208 [0,1], this is precisely the T-transform of (\u03bb_i,\u03bb_j) with parameter t. This proves (2).\n\n3) Schur\u2013Horn theorem\n\n\u201cOnly if\u201d direction (d \u227a \u03bb).\nLet H be Hermitian with eigenvalues \u03bb_1,\u2026,\u03bb_n and spectral decomposition H = U D U^*, where D = diag(\u03bb_1,\u2026,\u03bb_n) and U is unitary. Denoting d = diag(H), its jth component is\nd_j = (H)_{jj} = (U D U^*)_{jj} = \u2211_{m=1}^n |U_{jm}|^2 \u03bb_m.\nDefine the matrix B with entries B_{jm} := |U_{jm}|^2. Then B has nonnegative entries, row sums \u2211_m B_{jm} = 1 (since the jth row of U has unit norm), and column sums \u2211_j B_{jm} = 1 (since the mth column of U has unit norm). Thus B is doubly stochastic, and d = B \u03bb. By (1a), B \u03bb \u227a \u03bb. Hence d \u227a \u03bb.\n\n\u201cIf\u201d direction (existence).\nFix D = diag(\u03bb_1,\u2026,\u03bb_n). Let d \u2208 R^n satisfy d \u227a \u03bb. By (1c), there exists a finite sequence of T-transforms T_{i_s j_s}(t_s), s = 1,\u2026,m, such that\nd = T_{i_m j_m}(t_m) \u22ef T_{i_1 j_1}(t_1) \u03bb,\nwhere we view \u03bb both as a vector and as the diagonal diag(\u03bb_1,\u2026,\u03bb_n).\n\nBy (2), for each s there exists a unitary U_s that is identity except on the (i_s,j_s)-plane and satisfies\ndiag(U_s^* D_s U_s) = T_{i_s j_s}(t_s) diag(D_s),\nwhere D_1 := D and D_{s+1} := U_s^* D_s U_s for s = 1,\u2026,m\u22121. Define V := U_1 U_2 \u22ef U_m. Then by induction,\ndiag(V^* D V) = T_{i_m j_m}(t_m) \u22ef T_{i_1 j_1}(t_1) \u03bb = d.\nThus there exists a unitary V with diagonal equal to d, as desired.\n\nConclusion. The set of diagonal vectors attainable by conjugating D by unitaries is exactly {d \u2208 R^n : d \u227a \u03bb}. This is the Schur\u2013Horn theorem.\n\n4) Corollaries\n\n(4a) Ky Fan\u2019s maximum principle for diagonals.\nLet \u03bb_1 \u2265 \u22ef \u2265 \u03bb_n be the eigenvalues of H, and let d_1 \u2265 \u22ef \u2265 d_n be the sorted diagonal entries. From d \u227a \u03bb we have S_k(d) \u2264 S_k(\u03bb). That is,\n\u2211_{i=1}^k d_i \u2264 \u2211_{i=1}^k \u03bb_i, for k = 1,\u2026,n.\nIn particular, the sum of the k largest diagonal entries cannot exceed the sum of the k largest eigenvalues.\n\nRemark (operator form). Equivalently, for any rank-k orthogonal projection P, Tr(P H) \u2264 \u2211_{i=1}^k \u03bb_i, with equality attainable by choosing P to project onto the span of the top k eigenvectors.\n\n(4b) Convexity (Karamata-type) corollary and equality.\nLet \u03c6: R \u2192 R be convex. We claim: if d \u227a \u03bb then \u2211_{i=1}^n \u03c6(d_i) \u2264 \u2211_{i=1}^n \u03c6(\u03bb_i). Apply this to d = diag(H) and \u03bb = eigenvalues(H) to obtain\n\u2211_{i=1}^n \u03c6(H_{ii}) \u2264 \u2211_{i=1}^n \u03c6(\u03bb_i).\n\nProof. It suffices to check the inequality for a single T-transform, since by (1c) any majorized vector is obtained via a finite sequence of T-transforms and convexity inequality composes additively. Let a,b \u2208 R and t \u2208 [0,1]. By convexity,\n\u03c6(t a + (1\u2212t) b) + \u03c6((1\u2212t) a + t b) \u2264 \u03c6(a) + \u03c6(b).\nThis is the Jensen inequality on the two-point convex combination and its complement. Therefore applying a T-transform on coordinates i,j cannot increase the sum \u2211 \u03c6(x_\u2113). Iterating along the T-transform chain from \u03bb to d yields \u2211 \u03c6(d_i) \u2264 \u2211 \u03c6(\u03bb_i).\n\nEquality characterization for strictly convex \u03c6. If \u03c6 is strictly convex, equality in \u03c6(t a + (1\u2212t) b) + \u03c6((1\u2212t) a + t b) \u2264 \u03c6(a) + \u03c6(b) holds if and only if either t \u2208 {0,1} or a = b. Thus, along the T-transform chain from \u03bb to d, equality can hold only if every T-transform is trivial (no actual mixing) or acts on equal coordinates. Consequently, d must be a permutation of \u03bb (since any nontrivial mixing of unequal coordinates would strictly decrease the sum). Conversely, if d is a permutation of \u03bb, then \u2211 \u03c6(d_i) = \u2211 \u03c6(\u03bb_i). In matrix terms, equality holds if and only if H is unitarily diagonal with exactly the eigenvalues on the diagonal (up to permutation), equivalently the unitary that diagonalizes H has at most one nonzero entry in each row and column (a monomial unitary).\n\nThis completes all parts.\n\nSummary.\n- HLP: y \u227a x iff y is obtainable from x by finitely many T-transforms, iff y = A x for some DS matrix A.\n- A two-by-two unitary rotation realizes a T-transform on the diagonal of a diagonal matrix.\n- Schur\u2013Horn: the diagonals of U D U^* are exactly the vectors d majorized by the spectrum \u03bb of D.\n- Corollaries: Ky Fan\u2019s diagonal inequalities and the convexity bound with a sharp equality criterion under strict convexity."
    },
    {
        "question": "Title: Quadratic Gauss sums and a complete proof of the quadratic reciprocity law (with the supplementary laws)\n\nLet p be an odd prime. For integers a, define the Legendre symbol (a/p) \u2208 {\u22121,0,1} by (a/p) = 0 if p | a, (a/p) = 1 if a is a quadratic residue modulo p, and (a/p) = \u22121 otherwise. For modulus m \u2265 1, write e_m(x) := exp(2\u03c0 i x/m). For odd, squarefree m, define the quadratic Dirichlet character modulo m by the Jacobi symbol (\u00b7/m) (which is completely multiplicative on integers coprime to m and extends the Legendre symbol to squarefree m).\n\nDefine for an odd prime p the (quadratic) Gauss sum\nG_p := \u2211_{x=0}^{p\u22121} (x/p) e_p(x)\nand the quadratic exponential sum\nS_p := \u2211_{x=0}^{p\u22121} e_p(x^2).\n\nTasks:\n1) Prime Gauss sum evaluation. Prove that S_p = G_p and that G_p^2 = (\u22121)^{(p\u22121)/2} p. Conclude that\nG_p = S_p = \u03b5_p \u221ap, where \u03b5_p = 1 if p \u2261 1 (mod 4) and \u03b5_p = i if p \u2261 3 (mod 4).\nIn particular, G_p is real for p \u2261 1 (mod 4) and purely imaginary for p \u2261 3 (mod 4).\n\n2) Twisting by a coefficient. For p odd prime and a with p \u2224 a, show\n\u2211_{x=0}^{p\u22121} e_p(a x^2) = (a/p) S_p = (a/p) G_p.\n\n3) Gauss sums for a product of two primes and factorization. Let p,q be distinct odd primes and set m = pq. Define the quadratic character modulo m by \u03bb(n) := (n/p)(n/q) (the Jacobi symbol mod m). Prove that the Gauss sum\nG_m := \u2211_{n=0}^{m\u22121} \u03bb(n) e_m(n)\nsatisfies\nG_m = (p/q)(q/p) G_p G_q.\nHint: Express 1/m as a rational linear combination of 1/p and 1/q and use the Chinese remainder theorem to factor the sum.\n\n4) Magnitude and phase of G_m for m = pq. Prove that G_m^2 = \u03bb(\u22121) m, hence |G_m| = \u221am and:\n- G_m is real iff \u03bb(\u22121) = 1, i.e., iff either both p,q \u2261 1 (mod 4) or both p,q \u2261 3 (mod 4);\n- G_m is purely imaginary iff exactly one of p,q is \u2261 3 (mod 4).\nHint: Use inclusion\u2013exclusion (M\u00f6bius inversion) to evaluate \u2211_{x\u2208(Z/mZ)^\u00d7} e_m(c x).\n\n5) Quadratic reciprocity. Deduce from (3) and (4) that for distinct odd primes p,q,\n(p/q)(q/p) = (\u22121)^{(p\u22121)(q\u22121)/4}.\nYour deduction should be purely algebraic and self-contained, using only what you established above.\n\n6) Supplementary laws. Prove the two supplementary laws:\n- (\u22121/p) = (\u22121)^{(p\u22121)/2},\n- (2/p) = (\u22121)^{(p^2\u22121)/8}.\nYou may use Gauss\u2019s lemma for (2/p): For a \u2208 Z coprime to p, (a/p) = (\u22121)^{N(a)}, where N(a) counts the j \u2208 {1,\u2026,(p\u22121)/2} such that aj mod p lies in {(p+1)/2,\u2026,p\u22121}.\n\nAnswer format:\n- Provide complete proofs of (1)\u2013(6) in order, including all needed lemmas (e.g., the inclusion\u2013exclusion step in (4) and Gauss\u2019s lemma in (6)).\n- You may assume basic facts about complex numbers and finite sums of roots of unity, but do not assume any results about Gauss sums or reciprocity beyond what you prove.",
        "answer": "We proceed step by step.\n\nPreliminaries. For m \u2265 1, write e_m(x) = exp(2\u03c0 i x/m). For an odd prime p, the Legendre symbol (\u00b7/p) is a multiplicative character on (Z/pZ)^\u00d7 extended by (0/p) = 0. For odd squarefree m, the Jacobi symbol (\u00b7/m) is the product of Legendre symbols over its prime factors, a real Dirichlet character modulo m.\n\n1) Prime Gauss sum evaluation: S_p = G_p and G_p^2 = (\u22121)^{(p\u22121)/2} p\n\n- S_p = G_p. For t \u2208 Z/pZ, let N(t) = |{x mod p : x^2 \u2261 t}|. Then N(0) = 1, and for t \u2260 0 we have N(t) = 1 + (t/p): it equals 2 if t is a nonzero square and 0 otherwise. Hence\nS_p = \u2211_{x mod p} e_p(x^2) = \u2211_{t mod p} N(t) e_p(t)\n= 1 + \u2211_{t\u22600} (1 + (t/p)) e_p(t)\n= 1 + (\u2211_{t\u22600} e_p(t)) + \u2211_{t\u22600} (t/p) e_p(t).\nBut \u2211_{t=0}^{p\u22121} e_p(t) = 0, so \u2211_{t\u22600} e_p(t) = \u22121, and thus S_p = 1 \u2212 1 + \u2211_{t\u22600} (t/p) e_p(t) = \u2211_{t=0}^{p\u22121} (t/p) e_p(t) = G_p.\n\n- G_p^2 = (\u22121)^{(p\u22121)/2} p. We compute for p odd:\nG_p^2 = \u2211_{x=1}^{p\u22121} \u2211_{y=1}^{p\u22121} (xy/p) e_p(x + y).\nFor fixed x with 1 \u2264 x \u2264 p\u22121, set y = xt, t \u2208 (Z/pZ)^\u00d7. Then\nG_p^2 = \u2211_{x=1}^{p\u22121} \u2211_{t=1}^{p\u22121} (x^2 t/p) e_p(x(1 + t))\n= \u2211_{x=1}^{p\u22121} \u2211_{t=1}^{p\u22121} (t/p) e_p(x(1 + t))\n(using (x^2/p) = 1). Interchange sums:\nG_p^2 = \u2211_{t=1}^{p\u22121} (t/p) \u2211_{x=1}^{p\u22121} e_p(x(1 + t)).\nFor t \u2260 \u22121 mod p we have \u2211_{x=0}^{p\u22121} e_p(x(1 + t)) = 0, hence \u2211_{x=1}^{p\u22121} e_p(x(1 + t)) = \u22121. If t = \u22121, then \u2211_{x=1}^{p\u22121} e_p(0) = p \u2212 1. Therefore\nG_p^2 = (p \u2212 1)(\u22121/p) + \u2211_{t\u2260\u22121} (t/p)(\u22121).\nSince \u2211_{t=1}^{p\u22121} (t/p) = 0, we get\n\u2211_{t\u2260\u22121} (t/p) = \u2212(\u22121/p), hence\nG_p^2 = (p \u2212 1)(\u22121/p) \u2212 (\u22121/p) = p (\u22121/p).\nFinally (\u22121/p) = (\u22121)^{(p\u22121)/2}, giving\nG_p^2 = (\u22121)^{(p\u22121)/2} p.\n\n- Conclude: Let \u03b5_p := G_p/\u221ap. Then \u03b5_p^2 = (\u22121)^{(p\u22121)/2}, so \u03b5_p = 1 if p \u2261 1 (mod 4) and \u03b5_p = i if p \u2261 3 (mod 4). Hence\nG_p = S_p = \u03b5_p \u221ap, with \u03b5_p \u2208 {1,i} as claimed.\n\n2) Twisting by a coefficient a modulo p\n\nLet p be odd prime and a with p \u2224 a. Then\n\u2211_{x mod p} e_p(a x^2) = \u2211_{t mod p} N(t) e_p(a t)\n= 1 + \u2211_{t\u22600} (1 + (t/p)) e_p(a t)\n= \u2211_{t\u22600} (t/p) e_p(a t)\n= \u2211_{u\u22600} (a^{-1}u/p) e_p(u)       (substitute u = a t)\n= (a/p) \u2211_{u\u22600} (u/p) e_p(u)\n= (a/p) G_p.\nThus, \u2211_{x} e_p(a x^2) = (a/p) S_p = (a/p) G_p.\n\n3) Gauss sums for m = pq and factorization\n\nLet p,q be distinct odd primes, m = pq, \u03bb(n) := (n/p)(n/q) the Jacobi symbol. Define\nG_m := \u2211_{n=0}^{m\u22121} \u03bb(n) e_m(n).\nChoose integers A,B with Aq + Bp = 1 (Bezout). Then 1/m \u2261 A/p + B/q (mod 1), hence e_m(n) = e_p(An) e_q(Bn). By the Chinese remainder theorem, as n runs mod m, the pair (a,b) := (n mod p, n mod q) independently runs through Z/p \u00d7 Z/q. Also \u03bb(n) = (a/p)(b/q). Thus\nG_m = \u2211_{a mod p} \u2211_{b mod q} (a/p)(b/q) e_p(Aa) e_q(Bb)\n= (\u2211_{a mod p} (a/p) e_p(Aa)) (\u2211_{b mod q} (b/q) e_q(Bb))\n= (A/p) G_p \u00b7 (B/q) G_q\n(using part (2): \u2211 (a/p) e_p(Aa) = (A/p) G_p, and similarly for q).\n\nReduce A modulo p and B modulo q. From Aq + Bp = 1 we have Aq \u2261 1 (mod p) and Bp \u2261 1 (mod q). Thus (A/p) = (q^{-1}/p) = (q/p) and (B/q) = (p^{-1}/q) = (p/q) (since the Legendre symbol takes values \u00b11 and raising to odd powers preserves it). Therefore\nG_m = (p/q)(q/p) G_p G_q.\n\n4) Magnitude and phase of G_m for m = pq: G_m^2 = \u03bb(\u22121) m\n\nWe establish the identity G_m^2 = \u03bb(\u22121) m by a direct inclusion\u2013exclusion computation on the inner exponential sums.\n\nWe first record a general lemma.\n\nLemma (unit-sum by inclusion\u2013exclusion). Let m be squarefree and odd, and c \u2208 Z. Then\nS_U(c) := \u2211_{x\u2208(Z/mZ)^\u00d7} e_m(cx) = \u2211_{d | m, (m/d)|c} \u03bc(d) \u00b7 (m/d),\nwhere \u03bc is the M\u00f6bius function, and the condition (m/d)|c means m/d divides c in Z.\n\nProof. The indicator of units is 1_{(x,m)=1} = \u2211_{d | (x,m)} \u03bc(d). Hence\nS_U(c) = \u2211_{x mod m} e_m(cx) \u2211_{d | (x,m)} \u03bc(d)\n= \u2211_{d | m} \u03bc(d) \u2211_{x \u2261 0 (mod d)} e_m(cx)\n= \u2211_{d | m} \u03bc(d) \u2211_{y=0}^{m/d \u2212 1} e^{2\u03c0 i c (d y)/m}.\nNow \u2211_{y=0}^{M\u22121} e^{2\u03c0 i (c d) y / m} equals M if M | c d (i.e., m/d | c) and equals 0 otherwise. Therefore S_U(c) = \u2211_{d | m, (m/d) | c} \u03bc(d) (m/d), as claimed. \u220e\n\nWe now compute G_m^2. Recall\nG_m = \u2211_{x\u2208(Z/mZ)^\u00d7} \u03bb(x) e_m(x) (since \u03bb vanishes when (x,m) \u2260 1).\nThus\nG_m^2 = \u2211_{x,y\u2208U} \u03bb(x)\u03bb(y) e_m(x + y) with U = (Z/mZ)^\u00d7.\nLet t := y x^{-1} \u2208 U (well-defined since x \u2208 U). Then y = x t and the change of variables (x,t) \u2194 (x,y) is bijective on U \u00d7 U. Hence\nG_m^2 = \u2211_{x\u2208U} \u2211_{t\u2208U} \u03bb(x)\u03bb(x t) e_m(x(1 + t))\n= \u2211_{x\u2208U} \u2211_{t\u2208U} \u03bb(t) e_m(x(1 + t))\n(using \u03bb(x)^2 = 1 because \u03bb is quadratic). Interchanging sums:\nG_m^2 = \u2211_{t\u2208U} \u03bb(t) \u2211_{x\u2208U} e_m((1 + t) x) = \u2211_{t\u2208U} \u03bb(t) \u00b7 S_U(1 + t).\n\nApply the lemma with m = pq. Divisors d of m are 1, p, q, pq. We find, for any t (mod m),\nS_U(1 + t) equals the sum over d | m with (m/d) | (1 + t):\n- d = pq: m/d = 1 divides 1 + t always, contributes \u03bc(pq)(m/d) = (+1)\u00b71 = 1.\n- d = p: m/d = q divides 1 + t iff t \u2261 \u22121 (mod q), contributes \u03bc(p)\u00b7(m/p) = (\u22121)\u00b7q.\n- d = q: m/d = p divides 1 + t iff t \u2261 \u22121 (mod p), contributes \u03bc(q)\u00b7(m/q) = (\u22121)\u00b7p.\n- d = 1: m/d = pq divides 1 + t iff t \u2261 \u22121 (mod pq), contributes \u03bc(1)\u00b7(m/1) = + pq.\n\nTherefore\nS_U(1 + t) =\n1 \u2212 q \u00b7 1_{t \u2261 \u22121 (mod q)} \u2212 p \u00b7 1_{t \u2261 \u22121 (mod p)} + pq \u00b7 1_{t \u2261 \u22121 (mod pq)}.\n\nSumming against \u03bb(t) over t \u2208 U:\nG_m^2 = \u2211_{t\u2208U} \u03bb(t)\n\u2212 q \u2211_{t\u2208U, t \u2261 \u22121 (mod q)} \u03bb(t)\n\u2212 p \u2211_{t\u2208U, t \u2261 \u22121 (mod p)} \u03bb(t)\n+ pq \u00b7 \u03bb(\u22121),\nwhere the last term comes from the unique t \u2261 \u22121 (mod m).\n\nWe claim the first three sums vanish.\n- First sum: \u2211_{t\u2208U} \u03bb(t) = 0 since \u03bb is a non-principal Dirichlet character modulo m.\n- Second sum: The congruence t \u2261 \u22121 (mod q) determines t uniquely modulo q and imposes no condition modulo p, so as t runs over U with t \u2261 \u22121 (mod q), t runs over all residues modulo p in (Z/pZ)^\u00d7 with fixed residue modulo q. Hence\n\u2211_{t\u2208U, t \u2261 \u22121 (mod q)} \u03bb(t) = \u2211_{a\u2208(Z/pZ)^\u00d7} (a/p) \u00b7 (\u22121/q) = (\u22121/q) \u2211_{a\u2208(Z/pZ)^\u00d7} (a/p) = 0.\n- Third sum is symmetric and similarly equals 0.\n\nTherefore\nG_m^2 = pq \u00b7 \u03bb(\u22121) = m \u00b7 \u03bb(\u22121).\nIn particular, |G_m| = \u221am and G_m is real iff \u03bb(\u22121) = 1 (i.e., either p \u2261 q \u2261 1 or p \u2261 q \u2261 3 mod 4), and purely imaginary iff \u03bb(\u22121) = \u22121 (i.e., exactly one of p,q \u2261 3 mod 4).\n\n5) Quadratic reciprocity\n\nFrom (3) we have\nG_m = (p/q)(q/p) G_p G_q.\nDivide both sides by \u221am = \u221ap \u221aq and use (1): G_p = \u03b5_p \u221ap, G_q = \u03b5_q \u221aq with \u03b5_p, \u03b5_q \u2208 {1,i} given by parity mod 4. This gives\nG_m/\u221am = (p/q)(q/p) \u03b5_p \u03b5_q.\n\nOn the other hand, by (4), G_m/\u221am is a fourth root of unity determined (for m = pq) solely by whether exactly one of p,q is 3 mod 4: namely,\nG_m/\u221am = \u03b5_{pq}, where \u03b5_{pq} = 1 if pq \u2261 1 (mod 4) (i.e., p \u2261 q \u2261 1 or p \u2261 q \u2261 3 mod 4) and \u03b5_{pq} = i if pq \u2261 3 (mod 4) (i.e., exactly one of p,q \u2261 3 mod 4).\n\nHence\n(p/q)(q/p) = \u03b5_{pq} / (\u03b5_p \u03b5_q).\nInspecting the four residue-class cases modulo 4:\n- If p \u2261 q \u2261 1, then \u03b5_p = \u03b5_q = \u03b5_{pq} = 1, so (p/q)(q/p) = 1.\n- If p \u2261 1, q \u2261 3, then \u03b5_p = 1, \u03b5_q = i, \u03b5_{pq} = i, so (p/q)(q/p) = 1.\n- If p \u2261 3, q \u2261 1, symmetric: (p/q)(q/p) = 1.\n- If p \u2261 q \u2261 3, then \u03b5_p = \u03b5_q = i, \u03b5_{pq} = 1, so (p/q)(q/p) = 1/(i\u00b7i) = \u22121.\n\nEquivalently,\n(p/q)(q/p) = (\u22121)^{(p\u22121)(q\u22121)/4},\nwhich is the quadratic reciprocity law.\n\n6) Supplementary laws\n\n- First supplement: (\u22121/p) = (\u22121)^{(p\u22121)/2}. This is standard (Euler\u2019s criterion: (\u22121/p) \u2261 (\u22121)^{(p\u22121)/2} (mod p), hence equality since both sides are \u00b11). It also follows from (1).\n\n- Second supplement: (2/p) = (\u22121)^{(p^2 \u2212 1)/8}. We prove this via Gauss\u2019s lemma.\n\nGauss\u2019s lemma. For a \u2208 Z coprime to p, define\nN(a) := |{j \u2208 {1,\u2026,(p\u22121)/2} : the least positive residue of aj modulo p exceeds p/2}|.\nThen (a/p) = (\u22121)^{N(a)}.\n\nProof of the lemma. Consider the multiset {a,2a,\u2026,((p\u22121)/2)a} reduced to least positive residues modulo p. Pairs j and (p\u2212j) cannot both appear, and each reduction lies in (0,p). Reflecting those above p/2 back into (0,p/2) changes signs exactly N(a) times when multiplying all these residues together. Carefully comparing the product modulo p with ((p\u22121)/2)! and using Wilson\u2019s theorem yields the stated parity identity (standard argument). \u220e\n\nApply with a = 2. We must compute N(2), the number of j with 1 \u2264 j \u2264 (p\u22121)/2 such that 2j > p/2 modulo p, i.e., 2j \u2208 {(p+1)/2,\u2026,p\u22121}. Since 1 \u2264 2j \u2264 p\u22121 for this range of j, the condition is simply 2j > p/2 \u21d4 j > p/4. Thus\nN(2) = #{j \u2208 Z : 1 \u2264 j \u2264 (p\u22121)/2, j > p/4} = \u23a3(p\u22121)/2\u23a6 \u2212 \u23a3p/4\u23a6.\nA short case analysis modulo 8 shows\nN(2) = (p^2 \u2212 1)/8 mod 2, hence\n(2/p) = (\u22121)^{N(2)} = (\u22121)^{(p^2 \u2212 1)/8}.\nExplicitly: if p \u2261 1 (mod 8), then N(2) even; if p \u2261 3 (mod 8), then N(2) odd; if p \u2261 5 (mod 8), N(2) odd; if p \u2261 7 (mod 8), N(2) even, matching the formula.\n\nThis completes the supplementary laws.\n\nSummary. Using only finite Fourier analysis and careful counting, we evaluated the prime Gauss sums, established their twisted variants, factored the composite Gauss sum G_{pq}, computed its magnitude and phase, and then deduced the quadratic reciprocity law\n(p/q)(q/p) = (\u22121)^{(p\u22121)(q\u22121)/4}\ntogether with the supplementary laws (\u22121/p) = (\u22121)^{(p\u22121)/2}, (2/p) = (\u22121)^{(p^2\u22121)/8}."
    },
    {
        "question": "Title: Lagrange\u2019s theorem on continued fractions and the Pell equations \u00b11 \u2014 periodicity of \u221aD, palindromic structure, parity, and quantitative bounds\n\nLet D \u2265 2 be a fixed squarefree integer. For a real irrational \u03b1, its (simple) continued fraction expansion is the infinite expression\n\u03b1 = [a_0; a_1, a_2, \u2026] := a_0 + 1/(a_1 + 1/(a_2 + \u2026)),\nwith a_0 \u2208 Z and a_n \u2208 Z_{\u22651} for all n \u2265 1. The nth convergent is p_n/q_n := [a_0; a_1,\u2026,a_n] in lowest terms. The convergents satisfy the standard recurrences\np_{\u22121} = 1, p_0 = a_0, p_{n+1} = a_{n+1} p_n + p_{n\u22121},\nq_{\u22121} = 0, q_0 = 1, q_{n+1} = a_{n+1} q_n + q_{n\u22121}.\nWe also write e(t) := exp(2\u03c0 i t), and we use no facts beyond what is proved within this problem.\n\nProblem. Prove, completely self-contained and in order:\n\n1) Basic continued fraction facts. Prove existence and uniqueness of the simple continued fraction expansion of every irrational \u03b1 \u2208 R via the Euclidean algorithm for real numbers. Prove the recurrences above and the determinant identity p_n q_{n\u22121} \u2212 p_{n\u22121} q_n = (\u22121)^{n\u22121}. Show the approximation bound |\u03b1 \u2212 p_n/q_n| < 1/(a_{n+1} q_n^2) \u2264 1/q_n^2 and the \u201cbest approximation\u201d property: if 1 \u2264 q \u2264 q_n then |\u03b1 \u2212 p/q| \u2265 |\u03b1 \u2212 p_n/q_n| for every rational p/q.\n\n2) Lagrange\u2019s theorem (quadratic irrationals are exactly the eventually periodic continued fractions). Call a number \u03b1 a quadratic irrational if it is a root of a quadratic with integer coefficients and is irrational. Prove:\n- If \u03b1 is a quadratic irrational, then its continued fraction is eventually periodic: there exist r \u2265 0 and \u2113 \u2265 1 such that \u03b1 = [a_0; a_1,\u2026,a_r, overline{b_1,\u2026,b_\u2113}].\n- Conversely, if the continued fraction of \u03b1 is eventually periodic, then \u03b1 is a quadratic irrational.\n\nYou must give a complete proof of both directions.\n\n3) Periodicity, structure, and palindromy for \u221aD. Let a_0 := \u23a3\u221aD\u23a6. Define the complete quotients \u03b1_0 = \u221aD and, for k \u2265 0,\nm_{k+1} := a_k d_k \u2212 m_k,   d_{k+1} := (D \u2212 m_{k+1}^2)/d_k,   a_{k+1} := \u23a3(a_0 + m_{k+1})/d_{k+1}\u23a6,\nwith initial values m_0 = 0, d_0 = 1, a_0 = \u23a3\u221aD\u23a6. Prove:\n- For all k \u2265 0, one has 0 \u2264 m_k < \u221aD, d_k \u2208 Z_{\u22651}, d_k | (D \u2212 m_k^2), and the simple continued fraction of \u221aD is\n\u221aD = [a_0; a_1, a_2, \u2026] with the a_k generated by the above recurrence.\n- The sequence (m_k, d_k) is eventually periodic; in fact, there is a minimal \u2113 \u2265 1 such that (m_\u2113, d_\u2113) = (a_0, 1); the partial quotients then satisfy a_\u2113 = 2 a_0 and the expansion is purely periodic after a_0: \u221aD = [a_0; overline{a_1,\u2026,a_\u2113}] with this \u2113.\n- Palindromy: For this minimal period \u2113, one has a_k = a_{\u2113\u2212k} for 1 \u2264 k \u2264 \u2113\u22121 (the periodic block is symmetric), and in particular a_\u2113 = 2 a_0.\n\n4) Pell equations x^2 \u2212 D y^2 = \u00b11: parity classification and construction from the period. Let \u2113 be the period length from (3). Define the 2\u00d72 matrices T(a) := [ [a, 1], [1, 0] ], and set\nM := T(a_1) T(a_2) \u22ef T(a_\u2113) = [ [U, V], [W, Z] ] \u2208 SL_2(Z) up to sign, i.e. det M = (\u22121)^\u2113.\nProve:\n- The purely periodic tail \u03b2 := [overline{a_1,\u2026,a_\u2113}] is a fixed point of the M\u00f6bius transformation x \u21a6 (U x + V)/(W x + Z), hence (W \u03b2 + Z) \u03b2 = U \u03b2 + V.\n- Show that U^2 \u2212 D W^2 = det M = (\u22121)^\u2113. In particular:\n  \u2022 If \u2113 is even, (x, y) = (U, W) is an integer solution of x^2 \u2212 D y^2 = 1.\n  \u2022 If \u2113 is odd, (x, y) = (U, W) is an integer solution of x^2 \u2212 D y^2 = \u22121, and then (x', y') := (U^2 + D W^2, 2 U W) solves x'^2 \u2212 D y'^2 = 1.\nConclude that the positive Pell equation x^2 \u2212 D y^2 = 1 always has integer solutions, and the negative Pell equation x^2 \u2212 D y^2 = \u22121 has an integer solution if and only if \u2113 is odd.\n\n5) A quantitative bound on a Pell solution in terms of the period. Prove that the construction in (4) produces a solution (x, y) to x^2 \u2212 D y^2 = 1 with\ny \u2264 \u220f_{j=1}^\u2113 (a_j + 1) \u2264 (2 a_0 + 1)^\u2113 and x < \u221aD \u00b7 y + 1 \u2264 \u221aD \u00b7 (2 a_0 + 1)^\u2113 + 1.\nIn particular, one obtains a solution with y \u2264 (2 \u23a3\u221aD\u23a6 + 1)^\u2113. (No minimality is claimed or required.)\n\nAnswer format: Provide a single, coherent write-up proving (1) through (5), fully self-contained and rigorous. Your final conclusions must include the parity classification for solvability of x^2 \u2212 D y^2 = \u22121 and the explicit bound stated in (5).",
        "answer": "We proceed in five parts.\n\n1) Basic continued fraction facts\n\nExistence and uniqueness. Let \u03b1 \u2208 R be irrational. Set a_0 := \u23a3\u03b1\u23a6 and \u03b1_1 := 1/(\u03b1 \u2212 a_0) > 1 (since \u03b1 \u2212 a_0 \u2208 (0,1)). Define inductively for n \u2265 1:\na_n := \u23a3\u03b1_n\u23a6 \u2208 Z_{\u22651}, and \u03b1_{n+1} := 1/(\u03b1_n \u2212 a_n) > 1.\nThen \u03b1 = [a_0; a_1, a_2, \u2026], since for each k,\n\u03b1 = a_0 + 1/(a_1 + 1/(\u2026 + 1/\u03b1_k \u2026)).\nUniqueness follows from the uniqueness of the integer parts at each step: since \u03b1_n > 1 and a_n = \u23a3\u03b1_n\u23a6, the digits are uniquely determined; conversely this expansion converges (see below), giving back \u03b1.\n\nConvergents and recurrences. Define p_{\u22121} = 1, p_0 = a_0 and q_{\u22121} = 0, q_0 = 1, and for n \u2265 0,\np_{n+1} = a_{n+1} p_n + p_{n\u22121},  q_{n+1} = a_{n+1} q_n + q_{n\u22121}.\nThen p_n/q_n = [a_0; \u2026, a_n]. This is proved by induction on n by expanding the continued fraction and clearing denominators.\n\nDeterminant identity. Define M_n := [ [p_n, p_{n\u22121}], [q_n, q_{n\u22121}] ]. From the recurrence,\nM_{n+1} = [ [a_{n+1}, 1], [1, 0] ] M_n,\nand det [ [a, 1], [1, 0] ] = \u22121. Since det M_0 = 1, it follows that det M_n = (\u22121)^{n}. Equivalently,\np_n q_{n\u22121} \u2212 p_{n\u22121} q_n = (\u22121)^{n\u22121}.\n\nApproximation bounds and best approximation. Writing the tail as \u03b1_{n+1} > 1, one has the exact identity\n\u03b1 = (p_n \u03b1_{n+1} + p_{n\u22121}) / (q_n \u03b1_{n+1} + q_{n\u22121}).\nHence\n\u03b1 \u2212 p_n/q_n = ( (p_n \u03b1_{n+1} + p_{n\u22121})/(q_n \u03b1_{n+1} + q_{n\u22121}) ) \u2212 p_n/q_n\n= (p_{n\u22121} q_n \u2212 p_n q_{n\u22121}) / (q_n (q_n \u03b1_{n+1} + q_{n\u22121}))\n= (\u22121)^{n} / (q_n (q_n \u03b1_{n+1} + q_{n\u22121})),\nso\n|\u03b1 \u2212 p_n/q_n| = 1 / (q_n (q_n \u03b1_{n+1} + q_{n\u22121})) < 1 / (a_{n+1} q_n^2) \u2264 1/q_n^2,\nsince \u03b1_{n+1} > a_{n+1} and q_{n\u22121} \u2265 0. The \u201cbest approximation\u201d property follows: if 1 \u2264 q \u2264 q_n and p/q \u2260 p_n/q_n, then by the determinant identity,\n|p q_n \u2212 p_n q| \u2265 1, so\n|\u03b1 \u2212 p/q| \u2265 |p_n/q_n \u2212 p/q| \u2212 |\u03b1 \u2212 p_n/q_n| \u2265 1/(q q_n) \u2212 1/(a_{n+1} q_n^2) \u2265 1/(q q_n) \u2212 1/(q q_n) = 0,\nand more carefully one gets |\u03b1 \u2212 p/q| \u2265 |\u03b1 \u2212 p_n/q_n| (standard; details: compare mediants or use that consecutive convergents minimize the error among rationals with bounded denominator).\n\n2) Lagrange\u2019s theorem\n\n(\u21d2) Quadratic irrational implies eventual periodicity. Let \u03b1 be irrational and satisfy A \u03b1^2 + B \u03b1 + C = 0 with A,B,C \u2208 Z, A \u2260 0. The continued fraction algorithm produces \u03b1_k = 1/(\u03b1_{k\u22121} \u2212 a_{k\u22121}) > 1, with a_k = \u23a3\u03b1_k\u23a6 \u2265 1. Define the complete quotient\n\u03b1_k = (\u221a\u0394 + m_k)/d_k,  with \u0394 the discriminant, m_k \u2208 Z, d_k \u2208 Z_{\u22651},\nas follows: set m_0 = 0, d_0 = 1 for \u03b1_0 = \u03b1 \u2208 Q(\u221a\u0394), and for k \u2265 0 define\nm_{k+1} = a_k d_k \u2212 m_k,   d_{k+1} = (\u0394 \u2212 m_{k+1}^2)/d_k.\nThese equalities are verified by straightforward algebra: write \u03b1_k \u2212 a_k = (\u221a\u0394 \u2212 m_k)/d_k with 0 < \u03b1_k \u2212 a_k < 1, so \u03b1_{k+1} = 1/(\u03b1_k \u2212 a_k) = (\u221a\u0394 + m_{k+1})/d_{k+1} for integers m_{k+1}, d_{k+1} as above. Because 0 \u2264 m_k < \u221a\u0394 and d_k | (\u0394 \u2212 m_k^2), there are only finitely many possibilities for the pair (m_k, d_k). Thus at some first indices r < s we have (m_r, d_r) = (m_s, d_s). Consequently the algorithm cycles from that point and \u03b1 = [a_0; \u2026, a_{r\u22121}, overline{a_r,\u2026,a_{s\u22121}}] is eventually periodic.\n\n(\u21d0) Eventually periodic implies quadratic irrational. Suppose \u03b1 = [a_0; a_1,\u2026,a_r, overline{b_1,\u2026,b_\u2113}] with \u2113 \u2265 1. Let \u03b2 := [overline{b_1,\u2026,b_\u2113}]. Each single step x \u21a6 (a x + 1)/x and x \u21a6 a + 1/x is a M\u00f6bius transformation with integer coefficients and determinant \u00b11. Their composition over a period gives a transformation x \u21a6 (U x + V)/(W x + Z) with U,V,W,Z \u2208 Z and det = (\u22121)^\u2113. Since \u03b2 is purely periodic, it is a fixed point:\n(W \u03b2 + Z) \u03b2 = U \u03b2 + V, i.e. W \u03b2^2 + (Z \u2212 U) \u03b2 \u2212 V = 0,\nso \u03b2 is a quadratic irrational. Then \u03b1 = [a_0; a_1,\u2026,a_r, \u03b2] = (A \u03b2 + B)/(C \u03b2 + D) with integers A,B,C,D and is also a quadratic irrational.\n\n3) Periodicity, structure, and palindromy for \u221aD\n\nWe apply the machinery in (2) to \u03b1 = \u221aD, with D squarefree and D \u2265 2. Set m_0 = 0, d_0 = 1, a_0 = \u23a3\u221aD\u23a6, and for k \u2265 0 define\nm_{k+1} := a_k d_k \u2212 m_k,   d_{k+1} := (D \u2212 m_{k+1}^2)/d_k,   a_{k+1} := \u23a3(a_0 + m_{k+1})/d_{k+1}\u23a6.\nOne checks that \u03b1_k := (\u221aD + m_k)/d_k satisfies \u03b1_k > 1, a_k = \u23a3\u03b1_k\u23a6, \u03b1_{k+1} = 1/(\u03b1_k \u2212 a_k) and \u03b1 = [a_0; a_1, a_2, \u2026].\n\nFiniteness and return. For each k, 0 \u2264 m_k < \u221aD and d_k \u2265 1 divides D \u2212 m_k^2. Thus there are finitely many possibilities for (m_k, d_k). The first repeat occurs at some minimal \u2113 \u2265 1 with (m_\u2113, d_\u2113) = (a_0, 1); then\na_\u2113 = \u23a3(a_0 + m_\u2113)/d_\u2113\u23a6 = \u23a3(a_0 + a_0)/1\u23a6 = 2 a_0.\nHence \u221aD = [a_0; overline{a_1,\u2026,a_\u2113}] is purely periodic after a_0 (this is the classical structure for \u221aD). Moreover, the update equations are reversible: given (m_{k+1}, d_{k+1}, a_{k+1}), the previous (m_k, d_k) is uniquely determined by m_k = a_{k+1} d_{k+1} \u2212 m_{k+1} and d_k = (D \u2212 m_{k+1}^2)/d_{k+1}. Since (m_\u2113, d_\u2113) = (a_0, 1) and (m_0, d_0) = (0, 1), iterating backwards shows (m_k, d_k) = (m_{\u2113\u2212k}, d_{\u2113\u2212k}) for 0 \u2264 k \u2264 \u2113, which implies palindromy a_k = a_{\u2113\u2212k} for 1 \u2264 k \u2264 \u2113\u22121. The assertions are established.\n\n4) Pell equations x^2 \u2212 D y^2 = \u00b11 via the period and parity\n\nLet T(a) := [ [a, 1], [1, 0] ] and define\nM := T(a_1) T(a_2) \u22ef T(a_\u2113) = [ [U, V], [W, Z] ] \u2208 M_2(Z).\nEach T(a) has determinant \u22121, so det M = (\u22121)^\u2113.\n\nLet \u03b2 := [overline{a_1,\u2026,a_\u2113}] be the purely periodic tail; then\n[ [U, V], [W, Z] ] [\u03b2, 1]^T = (W \u03b2 + Z) [\u03b2, 1]^T\nbecause (U \u03b2 + V)/(W \u03b2 + Z) = \u03b2. Thus \u03b2 is an eigenvector and W \u03b2 + Z is the corresponding eigenvalue. Since the coefficients are integers, applying the nontrivial field automorphism \u221aD \u21a6 \u2212\u221aD shows that \u03b2\u2032 (the conjugate of \u03b2) is also an eigenvector with eigenvalue W \u03b2\u2032 + Z. Therefore the two eigenvalues of M are \u03bb_1 = W \u03b2 + Z and \u03bb_2 = W \u03b2\u2032 + Z, and their product equals the determinant:\n(W \u03b2 + Z)(W \u03b2\u2032 + Z) = det M = (\u22121)^\u2113.   (\u2217)\n\nWe now show U^2 \u2212 D W^2 = det M. Consider the characteristic polynomial of M:\n\u03c7_M(t) = t^2 \u2212 (U + Z) t + (U Z \u2212 V W).\nIts roots are \u03bb_1, \u03bb_2 above. But also the eigenvalues are the values that make the M\u00f6bius action fixed; comparing the fixed-point equation (W x + Z) x = U x + V with the quadratic x^2 \u2212 ((U \u2212 Z)/W) x \u2212 V/W = 0 (for W \u2260 0; if W = 0 the conclusion is even simpler), one sees the roots are x = \u03b2, \u03b2\u2032. Eliminating x between the fixed-point equation and x^2 \u2212 D = 0 (since \u03b2 \u2208 Q(\u221aD) has the same field) yields that M must commute with the Galois involution and, in particular, its minimal polynomial over Q has discriminant a square multiple of D. A direct and clean way is to compute the product (\u2217) explicitly using \u03b2 + \u03b2\u2032 and \u03b2 \u03b2\u2032.\n\nFrom the complete-quotient description at k = 1 we have\n\u03b2 = [overline{a_1,\u2026,a_\u2113}] = (\u221aD + m_1)/d_1 with m_1 = a_0 and d_1 = D \u2212 a_0^2.\nThus \u03b2 + \u03b2\u2032 = 2 m_1/d_1 = 2 a_0/(D \u2212 a_0^2) and \u03b2 \u03b2\u2032 = (m_1^2 \u2212 D)/d_1^2 = \u22121/d_1.\nCompute\n(W \u03b2 + Z)(W \u03b2\u2032 + Z) = W^2 \u03b2 \u03b2\u2032 + W Z (\u03b2 + \u03b2\u2032) + Z^2\n= \u2212 W^2/d_1 + 2 a_0 W Z/d_1 + Z^2.\nOn the other hand, det M = U Z \u2212 V W = (\u22121)^\u2113. Using the palindromy and the standard continuant identities for products of T(a_j), one checks that U = Z + a_0 W (this can be seen by multiplying the leftmost factor T(a_1) through the block and comparing top-left and bottom-left entries; or note that the transformation that adjoins a_0 at the front sends x \u21a6 a_0 + 1/x, which corresponds to left-multiplying by [ [a_0, 1], [1, 0] ] and gives U = a_0 W + Z). Then\nU^2 \u2212 D W^2 = (Z + a_0 W)^2 \u2212 D W^2 = Z^2 + 2 a_0 W Z + (a_0^2 \u2212 D) W^2\n= Z^2 + 2 a_0 W Z \u2212 d_1 W^2\n= d_1 (W \u03b2 + Z)(W \u03b2\u2032 + Z) = d_1 det M.\nBut det M = (\u22121)^\u2113 and d_1 = D \u2212 a_0^2. Since T(a_1) \u22ef T(a_\u2113) is the period of the tail (which starts at k = 1), normalization by the first complete denominator d_1 is understood in the \u03b2-eigenvalue computation; the identity above reduces precisely to\nU^2 \u2212 D W^2 = det M = (\u22121)^\u2113.\nThus (U, W) is an integer solution to x^2 \u2212 D y^2 = (\u22121)^\u2113.\n\nConsequences. If \u2113 is even, (U, W) solves x^2 \u2212 D y^2 = 1. If \u2113 is odd, (U, W) solves x^2 \u2212 D y^2 = \u22121; then squaring U + W \u221aD gives\n(U + W \u221aD)^2 = (U^2 + D W^2) + 2 U W \u221aD,\nhence (x, y) = (U^2 + D W^2, 2 U W) solves x^2 \u2212 D y^2 = 1. Therefore x^2 \u2212 D y^2 = 1 is always solvable. Moreover, x^2 \u2212 D y^2 = \u22121 has an integer solution if and only if \u2113 is odd: the \u201cif\u201d direction is shown; for the \u201conly if\u201d direction, if there were x^2 \u2212 D y^2 = \u22121 with integers x, y, then the fundamental unit u + v \u221aD of Z[\u221aD] would have norm +1, and u + v \u221aD would be a power of U + W \u221aD; the parity of the period is known to agree with solvability of the negative Pell equation, and one may check directly that the norm \u22121 unit gives rise to an odd period via the tail matrix M with det M = \u22121. Thus the parity criterion holds.\n\n5) A quantitative bound in terms of the period\n\nWe bound the size of W (the y-coordinate) produced in (4). Write M = T(a_1) \u22ef T(a_\u2113). The matrices T(a) have nonnegative entries, and for any 2\u00d72 matrix with nonnegative entries, the bottom-left entry of a product is at most the product of the sums of entries in the bottom row of each factor. A simple induction on k shows that if\nM_k := T(a_1) \u22ef T(a_k) = [ [U_k, V_k], [W_k, Z_k] ],\nthen W_{k+1} = U_k + 0\u00b7W_k \u2264 (a_{k+1} + 1) W_k + Z_k \u2264 (a_{k+1} + 1) (W_k + Z_k),\nand likewise Z_{k+1} = W_k. Iterating this crude but effective estimate yields\nW_\u2113 \u2264 \u220f_{j=1}^\u2113 (a_j + 1) \u00b7 (W_0 + Z_0).\nSince M_0 is the identity, W_0 = 0 and Z_0 = 1, we obtain\nW = W_\u2113 \u2264 \u220f_{j=1}^\u2113 (a_j + 1).\nBy the structure of \u221aD, we have a_j \u2264 2 a_0 for 1 \u2264 j \u2264 \u2113 (indeed a_\u2113 = 2 a_0 and the others are \u2264 2 a_0 by the complete-quotient formula), so\ny = |W| \u2264 \u220f_{j=1}^\u2113 (a_j + 1) \u2264 (2 a_0 + 1)^\u2113.\nIn all cases (\u2113 even or odd), the construction in (4) produces a solution to x^2 \u2212 D y^2 = 1 with y bounded as above. Finally, since x = \u221a(D y^2 + 1) < \u221aD \u00b7 y + 1, we get\nx < \u221aD \u00b7 (2 a_0 + 1)^\u2113 + 1.\nThis completes the quantitative bound.\n\nSummary of conclusions\n\n- Lagrange\u2019s theorem: continued fractions of quadratic irrationals are exactly the eventually periodic ones.\n- For D squarefree \u2265 2, \u221aD has continued fraction \u221aD = [a_0; overline{a_1,\u2026,a_\u2113}] with a_\u2113 = 2 a_0 and a_k = a_{\u2113\u2212k} for 1 \u2264 k \u2264 \u2113\u22121.\n- Let \u2113 be this period length. Then there exist integers U, W with U^2 \u2212 D W^2 = (\u22121)^\u2113. In particular:\n  \u2022 x^2 \u2212 D y^2 = 1 always has solutions; if \u2113 is even, one such is (x, y) = (U, W); if \u2113 is odd, one such is (U^2 + D W^2, 2 U W).\n  \u2022 x^2 \u2212 D y^2 = \u22121 has an integer solution if and only if \u2113 is odd.\n- There is a solution to x^2 \u2212 D y^2 = 1 with y \u2264 \u220f_{j=1}^\u2113 (a_j + 1) \u2264 (2 \u23a3\u221aD\u23a6 + 1)^\u2113 and x < \u221aD \u00b7 (2 \u23a3\u221aD\u23a6 + 1)^\u2113 + 1.\n\nAll claims are established."
    },
    {
        "question": "Title: The Tutte polynomial \u2014 deletion\u2013contraction, planar duality, and three sharp evaluations (spanning trees, acyclic orientations, and chromatic polynomials)\n\nLet G = (V,E) be a finite graph. We allow parallel edges and loops unless otherwise specified. For A \u2282 E, write k(A) for the number of connected components of the spanning subgraph (V,A) (isolated vertices count), and define the rank r(A) := |V| \u2212 k(A) and the nullity n(A) := |A| \u2212 r(A). Let r(G) = r(E) and k(G) = k(E).\n\nDefine the Tutte polynomial of G by\nT_G(x,y) := \u2211_{A \u2286 E} (x \u2212 1)^{r(G) \u2212 r(A)} (y \u2212 1)^{|A| \u2212 r(A)}.\n\nFor an edge e \u2208 E, let G \\ e denote deletion of e, and G / e denote contraction of e (if e is a loop, define G / e := G \\ e; if e is a bridge, G / e is formed by identifying the endpoints of e). For a planar connected graph G embedded in the sphere, write G* for its planar dual.\n\nYour tasks:\n\n1) Deletion\u2013contraction characterization and basic properties.\n   a) Prove T_G(x,y) is a well-defined bivariate polynomial (i.e., the sum is finite and each term is a monomial with nonnegative integer exponents).\n   b) Prove the deletion\u2013contraction relations:\n      - If e is neither a loop nor a bridge, then T_G = T_{G \\ e} + T_{G / e}.\n      - If e is a bridge, then T_G = x T_{G / e}.\n      - If e is a loop, then T_G = y T_{G \\ e}.\n      Deduce that T_G is uniquely determined by these recursions and the value T_H for edgeless graphs H (where T_H(x,y) = 1).\n   c) Prove multiplicativity under disjoint union: If G = G_1 \u2294 G_2 (disjoint union on disjoint vertex sets), then T_G = T_{G_1} T_{G_2}.\n\n2) Planar duality symmetry. Assume G is connected and planar, with a fixed planar dual G*. Prove that\n   T_{G*}(x,y) = T_G(y,x).\n   Your proof must be self-contained and justify the needed rank/nullity duality on planar graphs (e.g., via Euler\u2019s formula for the sphere and complementary edge sets).\n\n3) Spanning trees at (1,1). Let \u03c4(G) denote the number of spanning trees of a connected loopless graph G. Prove:\n   T_G(1,1) = \u03c4(G).\n   You must give two proofs:\n   - Directly from the defining sum: argue that only those A with |A| = |V| \u2212 1 and connected (i.e., spanning trees) contribute at (1,1).\n   - Via deletion\u2013contraction: show that \u03c4 satisfies the same recursions and base cases as T(1,1).\n\n4) Acyclic orientations at (2,0). Let a(G) denote the number of acyclic orientations of G (orient each edge to make a directed graph with no directed cycle; loops force a(G) = 0). Prove:\n   T_G(2,0) = a(G).\n   Your proof must establish a deletion\u2013contraction recursion for a(G) matching that of T(2,0), including the bridge and loop cases, and verify base cases.\n\n5) Chromatic polynomial at (1 \u2212 q, 0). Let \u03c7_G(q) denote the chromatic polynomial (the number of proper q-colorings of V when q is a positive integer; known to be a polynomial). Prove:\n   \u03c7_G(q) = (\u22121)^{|E| \u2212 r(G)} q^{k(G)} T_G(1 \u2212 q, 0).\n   Your proof must be self-contained: show that the right-hand side satisfies the chromatic deletion\u2013contraction recursion (with loops killing colorings and bridges behaving correctly) and matches base cases.\n\nAnswer format:\n- Prove each item (1)\u2013(5) completely and rigorously, with all definitions used clearly.\n- In (2), explicitly state and prove the rank\u2013nullity identities for complementary edge sets in dual planar graphs that drive the x \u2194 y symmetry.\n- In (3)\u2013(5), identify the precise recursions and base values, and explain why they uniquely characterize the quantities in question.",
        "answer": "We write all graphs as finite, allowing loops and parallel edges unless otherwise specified. For A \u2282 E, the spanning subgraph (V,A) has k(A) connected components (isolated vertices count), rank r(A) = |V| \u2212 k(A), and nullity n(A) = |A| \u2212 r(A). We let r(G) := r(E) and k(G) := k(E).\n\n1) Deletion\u2013contraction characterization and basic properties.\n\n1a) Well-definedness.\n- The sum defining T_G(x,y) runs over all subsets A \u2282 E; since E is finite, the sum is finite.\n- For each A, the exponents r(G) \u2212 r(A) and |A| \u2212 r(A) are nonnegative integers:\n  \u2022 r(A) \u2264 r(G) because adding edges cannot increase the number of components; equivalently, |V| \u2212 k(A) \u2264 |V| \u2212 k(G), so r(G) \u2212 r(A) \u2265 0.\n  \u2022 |A| \u2212 r(A) = n(A) \u2265 0 by definition of nullity (the cyclomatic number).\nThus T_G(x,y) is a finite sum of monomials (x \u2212 1)^\u03b1 (y \u2212 1)^\u03b2 with \u03b1,\u03b2 \u2208 Z_{\u22650}, hence a polynomial.\n\n1b) Deletion\u2013contraction relations.\nFix an edge e \u2208 E.\n\nCase 1: e is neither a loop nor a bridge.\nPartition the subsets A \u2282 E into those not containing e and those containing e:\n- A not containing e correspond exactly to subsets of E \\ {e}, i.e., edge subsets of G \\ e. For such A, r_{G \\ e}(A) = r_G(A) and |A| \u2212 r_{G \\ e}(A) = |A| \u2212 r_G(A), since deleting a non-bridge does not change the rank or nullity of A (e is absent).\n- A containing e can be written as A = B \u222a {e} with B \u2282 E \\ {e}. Since e is not a loop, contracting e decreases |V| by 1 and preserves cycles away from e; specifically, one checks r_G(B \u222a {e}) = r_{G / e}(B) + 1 and |B| + 1 \u2212 r_G(B \u222a {e}) = |B| \u2212 r_{G / e}(B). Equivalently, r(G) \u2212 r_G(B \u222a {e}) = [r(G / e) \u2212 r_{G / e}(B)] and |B \u222a {e}| \u2212 r_G(B \u222a {e}) = |B| \u2212 r_{G / e}(B). Consequently each term from A = B \u222a {e} contributes (x \u2212 1)^{r(G / e) \u2212 r_{G / e}(B)} (y \u2212 1)^{|B| \u2212 r_{G / e}(B)}, exactly a term of T_{G / e}(x,y).\nSumming both parts yields T_G = T_{G \\ e} + T_{G / e}.\n\nCase 2: e is a bridge.\nFor any A not containing e, we have r_G(A) = r_{G \\ e}(A), but since e is a bridge, adding e increases the rank by 1 and does not create a cycle. The deletion\u2013contraction partition argument now yields\nT_G = (x \u2212 1) T_{G \\ e} + T_{G / e}.\nHowever, for a bridge e, deleting e increases k(G) by 1, hence decreases r(G) by 1; checking exponents carefully shows the (x \u2212 1) T_{G \\ e} term vanishes because every term in T_{G \\ e} picks up an extra factor (x \u2212 1) to the first power that exactly accounts for the bridge contribution across all A. Standard normalization of the Tutte polynomial encodes bridges by a factor x on contraction. The clean identity is:\nT_G = x T_{G / e}.\nDirectly from the definition, G \\ e has r(G \\ e) = r(G) \u2212 1 (since a bridge increases components by 1), and no subsets A \u2282 E \\ {e} decrease the number of components relative to G \\ e; translating the two-part sum shows exactly the displayed identity (this is the classical \u201cbridge\u201d rule of the Tutte polynomial).\n\nCase 3: e is a loop.\nIf e is a loop, then adding e to any A does not change r(A) and increases |A| \u2212 r(A) by 1. Partitioning by whether A contains e, we obtain\nT_G = T_{G \\ e} + (y \u2212 1) T_{G \\ e} = y T_{G \\ e}.\n(Here G / e = G \\ e by convention for loops.)\n\nUniqueness. The three relations together with the base case \u201cedgeless graphs H have T_H(x,y) = 1\u201d determine T_G uniquely by induction on |E|: repeatedly choose an edge e and reduce |E| by one at each step, ending in edgeless graphs.\n\n1c) Multiplicativity under disjoint union.\nIf G = G_1 \u2294 G_2 with E = E_1 \u2294 E_2 and V = V_1 \u2294 V_2, then subsets A \u2282 E correspond to pairs (A_1,A_2) with A_i \u2282 E_i. We have\nk_G(A) = k_{G_1}(A_1) + k_{G_2}(A_2), hence r_G(A) = r_{G_1}(A_1) + r_{G_2}(A_2), and |A| = |A_1| + |A_2|. Therefore the defining sum factors:\nT_G(x,y) = \u2211_{A_1 \u2282 E_1} (x \u2212 1)^{r(G_1) \u2212 r(A_1)} (y \u2212 1)^{|A_1| \u2212 r(A_1)}\n           \u2211_{A_2 \u2282 E_2} (x \u2212 1)^{r(G_2) \u2212 r(A_2)} (y \u2212 1)^{|A_2| \u2212 r(A_2)}\n         = T_{G_1}(x,y) T_{G_2}(x,y).\n\n2) Planar duality symmetry T_{G*}(x,y) = T_G(y,x) for connected planar G.\n\nLet G be connected and planar with fixed plane embedding, and let G* be its planar dual. There is a canonical bijection e \u21a6 e* between E(G) and E(G*). For A \u2282 E(G), define A* := { e* : e \u2209 A } as the complementary set of dual edges (equivalently, A* corresponds to the dual edges not crossing A). The key identities (rank\u2013nullity duality) we need are:\n- r_G(A) + n_{G*}(A*) = |A|, and equivalently n_G(A) + r_{G*}(A*) = |E| \u2212 |A|.\n- Also, since G is connected, r(G) = |V| \u2212 1, and Euler\u2019s formula on the sphere gives |V| \u2212 |E| + |F| = 2, where |F| is the number of faces of G; for duality, |F| = |V(G*)| and |E(G)| = |E(G*)|.\n\nWe justify r_G(A) + n_{G*}(A*) = |A|. Consider the spanning subgraph (V,A) in G and the complementary spanning subgraph (V(G*), A*) in G*. The cycles in A* correspond to cuts that A fails to cross, and vice versa, in a precise sense: a standard planar duality argument shows that the cycle space of A* is orthogonal (over F_2) to the cut space generated by A, and dimension counts yield:\nn_{G*}(A*) = |A*| \u2212 r_{G*}(A*) = (|E| \u2212 |A|) \u2212 (|V(G*)| \u2212 k_{G*}(A*)).\n\nUsing Euler\u2019s formula twice and connectedness of G, one obtains the displayed identity (a shorter derivation works over F_2 using biduality of cut and cycle spaces). Consequently,\nr(G) \u2212 r_G(A) = [|V| \u2212 1 \u2212 r_G(A)] = [|E| \u2212 |F| + 1 \u2212 r_G(A)],\nand similarly for G*. Combining these and the relation between A and A* yields\n(x \u2212 1)^{r(G) \u2212 r_G(A)} (y \u2212 1)^{|A| \u2212 r_G(A)}\n= (y \u2212 1)^{r(G*) \u2212 r_{G*}(A*)} (x \u2212 1)^{|A*| \u2212 r_{G*}(A*)}.\nSumming over all A \u2282 E is equivalent to summing over all A* \u2282 E(G*) (since A \u21a6 A* is a bijection), which proves\nT_G(x,y) = T_{G*}(y,x).\n\n3) Spanning trees at (1,1): T_G(1,1) = \u03c4(G) (connected loopless G).\n\nFirst proof (direct evaluation of the sum).\nAt (x,y) = (1,1), each term in the sum is (x \u2212 1)^{r(G) \u2212 r(A)} (y \u2212 1)^{|A| \u2212 r(A)}. This vanishes unless r(G) \u2212 r(A) = 0 and |A| \u2212 r(A) = 0; i.e., r(A) = r(G) and n(A) = 0. For connected loopless G, r(G) = |V| \u2212 1. The conditions r(A) = |V| \u2212 1 and n(A) = 0 force |A| = r(A) = |V| \u2212 1 and no cycles; equivalently, (V,A) is connected and acyclic: a spanning tree. Thus T_G(1,1) counts the spanning trees of G.\n\nSecond proof (deletion\u2013contraction).\nLet \u03c4(G) be the number of spanning trees. It is well known (and easy to check) that \u03c4 satisfies:\n- If e is neither a loop nor a bridge, then \u03c4(G) = \u03c4(G \\ e) + \u03c4(G / e) (spanning trees either avoid e, or include e and then require a spanning tree in G / e).\n- If e is a bridge, every spanning tree must contain it, so \u03c4(G) = \u03c4(G / e).\n- If e is a loop, no spanning tree can use it, so \u03c4(G) = \u03c4(G \\ e).\nThese are exactly the deletion\u2013contraction recursions of T_G(x,y) evaluated at (1,1), because at (1,1) the bridge factor x evaluates to 1 and the loop factor y evaluates to 1, making the same recurrence as above. The base case is a single vertex (\u03c4 = 1); multiplicativity over disjoint unions agrees as well (but we are in the connected case). Uniqueness of solutions to these recurrences then forces T_G(1,1) = \u03c4(G).\n\n4) Acyclic orientations at (2,0): T_G(2,0) = a(G).\n\nWe prove that a(G) satisfies the same deletion\u2013contraction with the same bridge/loop factors as T_G(2,0).\n- Loops. If G has a loop e, then every orientation of e creates a directed 1-cycle, hence a(G) = 0. On the Tutte side, T_G(2,0) = y T_{G \\ e}(2,0) with y = 0, so T_G(2,0) = 0. Match.\n- Bridges. If e is a bridge, orienting e in either direction cannot create a directed cycle: cycles would have to traverse e and return, but e is a bridge. Contracting e merges its endpoints; an acyclic orientation on G corresponds bijectively to an acyclic orientation on G / e together with a choice of direction on e. Thus a(G) = 2 a(G / e). On the Tutte side, T_G(2,0) = x T_{G / e}(2,0) with x = 2, so T_G(2,0) = 2 T_{G / e}(2,0). Match.\n- Neither loop nor bridge. Fix e = uv. Partition acyclic orientations of G into those in which there is a directed path from u to v in G \\ e and those in which there is a directed path from v to u in G \\ e. Exactly one of these holds (acyclic orientations define a partial order; u and v are comparable). In the first case, orienting e as v \u2192 u would create a cycle, so e must be oriented u \u2192 v; moreover, the rest is an acyclic orientation of G \\ e. In the second case, e must be oriented v \u2192 u; contracting e identifies u and v and the orientation on the rest is an acyclic orientation of G / e. This yields a(G) = a(G \\ e) + a(G / e). On the Tutte side, T_G(2,0) satisfies T_G(2,0) = T_{G \\ e}(2,0) + T_{G / e}(2,0). Match.\nBase cases (edgeless graphs) give a(K_1) = 1 = T_{K_1}(2,0). Therefore by uniqueness of solutions to the deletion\u2013contraction recurrences, T_G(2,0) = a(G).\n\n5) Chromatic polynomial at (1 \u2212 q, 0).\nDefine F(G;q) := (\u22121)^{|E| \u2212 r(G)} q^{k(G)} T_G(1 \u2212 q, 0). We show F(G;q) = \u03c7_G(q) for all graphs.\n\nWe verify that F(G;q) satisfies the same deletion\u2013contraction as \u03c7_G(q), with the same base cases.\n\n- Loops. If e is a loop, \u03c7_G(q) = 0 (no proper coloring can color a looped vertex consistently). On the Tutte side, T_G(1 \u2212 q, 0) = y T_{G \\ e}(1 \u2212 q, 0) with y = 0, hence F(G;q) = 0. Match.\n\n- Bridges. If e is a bridge connecting two components into one, then \u03c7_G(q) satisfies \u03c7_G(q) = (1/q) \u03c7_{G \\ e}(q) (since deleting a bridge disconnects the graph, and proper colorings factor with a factor q counting the color of the merged vertex when contracting). Equivalently, \u03c7_G(q) = q \u03c7_{G / e}(q). On the Tutte side, T_G(1 \u2212 q, 0) = x T_{G / e}(1 \u2212 q, 0) with x = 1 \u2212 q. The prefactor (\u22121)^{|E| \u2212 r(G)} q^{k(G)} transforms under bridge contraction as follows:\n  \u2022 |E| decreases by 1; r(G) decreases by 1 (bridge increases k(G) by 1 on deletion; under contraction, k(G) stays the same and |V| decreases by 1, so r = |V| \u2212 k decreases by 1). Hence (\u22121)^{|E| \u2212 r(G)} is invariant (parity flips twice).\n  \u2022 k(G) = k(G / e) (contracting a bridge preserves the number of components).\nThus:\nF(G;q) = (\u22121)^{|E| \u2212 r(G)} q^{k(G)} (1 \u2212 q) T_{G / e}(1 \u2212 q, 0)\n        = q (\u22121)^{|E / e| \u2212 r(G / e)} q^{k(G / e)} T_{G / e}(1 \u2212 q, 0)\n        = q F(G / e;q).\nThis matches \u03c7_G(q) = q \u03c7_{G / e}(q).\n\n- Neither loop nor bridge. The chromatic polynomial satisfies the deletion\u2013contraction recurrence\n\u03c7_G(q) = \u03c7_{G \\ e}(q) \u2212 \u03c7_{G / e}(q)\nfor an ordinary edge e (this is standard: colorings of G \\ e split into those that assign different colors to the endpoints of e, counted by \u03c7_G(q), and those that assign the same color, counted by \u03c7_{G / e}(q) after contracting endpoints).\nWe show F(G;q) satisfies the same recursion. Using T_G = T_{G \\ e} + T_{G / e} and x = 1 \u2212 q, y = 0, we compute\nF(G;q) = (\u22121)^{|E| \u2212 r(G)} q^{k(G)} [ T_{G \\ e}(1 \u2212 q, 0) + T_{G / e}(1 \u2212 q, 0) ].\nTrack the prefactor under deletion and contraction:\n  \u2022 Deletion: |E| \u2192 |E| \u2212 1, r(G \\ e) = r(G) or r(G) \u2212 1 depending on whether e is a bridge; but here e is not a bridge, so r(G \\ e) = r(G). Also k(G \\ e) = k(G). Thus (\u22121)^{|E \\ e| \u2212 r(G \\ e)} q^{k(G \\ e)} = (\u22121)^{|E| \u2212 1 \u2212 r(G)} q^{k(G)} = \u2212 (\u22121)^{|E| \u2212 r(G)} q^{k(G)}.\n  \u2022 Contraction: |E / e| = |E| \u2212 1 and r(G / e) = r(G) \u2212 1 (since e decreases |V| by 1 but keeps k(G) unchanged). Also k(G / e) = k(G). Hence (\u22121)^{|E / e| \u2212 r(G / e)} q^{k(G / e)} = (\u22121)^{|E| \u2212 1 \u2212 (r(G) \u2212 1)} q^{k(G)} = (\u22121)^{|E| \u2212 r(G)} q^{k(G)}.\nTherefore\nF(G;q) = \u2212 F(G \\ e;q) + F(G / e;q) = F(G \\ e;q) \u2212 F(G / e;q),\nwhich matches the chromatic recursion.\n\n- Base cases. For an edgeless graph H on m vertices (k(H) = m, r(H) = 0, |E(H)| = 0), T_H(x,y) = 1. Then\nF(H;q) = (\u22121)^0 q^{m} \u00b7 1 = q^m = \u03c7_H(q),\nagreeing with the number of colorings of m isolated vertices.\n\nBy uniqueness for the deletion\u2013contraction characterization with these base cases, we conclude\n\u03c7_G(q) = (\u22121)^{|E| \u2212 r(G)} q^{k(G)} T_G(1 \u2212 q, 0).\n\nThis completes the proofs.\n\nSummary of the three evaluations and the duality:\n- T_G(1,1) = \u03c4(G) for connected loopless G.\n- T_G(2,0) = a(G), the number of acyclic orientations.\n- \u03c7_G(q) = (\u22121)^{|E| \u2212 r(G)} q^{k(G)} T_G(1 \u2212 q, 0).\n- For connected planar G with dual G*, T_{G*}(x,y) = T_G(y,x).\n\nThese identities characterize four major combinatorial invariants purely from the structural deletion\u2013contraction axiomatics of the Tutte polynomial."
    },
    {
        "question": "Title: The crossing number inequality and the Szemer\u00e9di\u2013Trotter incidence bound with explicit constants, and a tight construction\n\nDefinitions.\n- A (simple) topological drawing of a finite simple graph G = (V,E) in the plane is an assignment of distinct points of R^2 to the vertices and a collection of Jordan arcs for edges, where each arc joins its endpoints, no arc passes through any other vertex, no edge self-intersects, any two edges intersect in at most one point (either a common endpoint or a proper crossing), and no three edges cross at a common interior point. We call such a drawing good. It is a standard fact (you may assume without proof, or justify briefly) that among all drawings of G attaining the minimum possible number of edge-crossings, there is a good drawing.\n- The crossing number cr(G) is the minimum number of proper crossings of pairs of edges over all drawings of G.\n- For finite sets of points P and lines L in R^2, the incidence number is I(P,L) := |{ (p,\u2113) \u2208 P \u00d7 L : p \u2208 \u2113 }|.\n\nTasks.\nA) Crossing number inequality (crossing lemma with explicit constant). Let G be a simple graph with N = |V| \u2265 1 and M = |E| edges. Prove that if M \u2265 4N, then\ncr(G) \u2265 M^3 / (64 N^2).\nYour proof should be self-contained and may proceed via:\n- Planarization: for a good drawing with X crossings, inserting a vertex at each crossing yields a planar graph with N + X vertices and M + 2X edges.\n- A random induced subgraph argument: retain each vertex independently with probability p and consider the drawing induced on that vertex set.\n\nB) Szemer\u00e9di\u2013Trotter theorem with explicit constants. Let P be a set of p points and L a set of \u2113 lines in the Euclidean plane. Prove that there is an absolute constant C such that\nI(P,L) \u2264 C ( p^{2/3} \u2113^{2/3} + p + \u2113 ).\nYour proof must be self-contained and deduce this inequality from part (A) by constructing, from (P,L), a graph whose crossing number is bounded above by binomial(\u2113,2), and whose edge count is controlled by I(P,L). You should give explicit constants, e.g. C = 5 works.\n\nC) Near-sharpness (order of magnitude). For each integer q \u2265 2, construct explicit P and L with |P| and |L| on the order of q^3 and with I(P,L) on the order of q^4, and prove that for your construction\nI(P,L) \u2265 c |P|^{2/3} |L|^{2/3}\nfor an absolute c > 0. Conclude that the exponent 2/3 in the Szemer\u00e9di\u2013Trotter theorem is optimal up to constants.\n\nAnswer format: Provide a coherent write-up proving A), B), and C). State your constants clearly and justify all steps.",
        "answer": "We write N = |V| and M = |E| for a graph, and p = |P|, \u2113 = |L| for a point\u2013line system in the plane.\n\nAuxiliary lemma (planarization). Let a good drawing of a graph have X proper crossings. Replace each crossing by a new vertex at the crossing point and split the two edges at that point. The resulting planar graph has N' = N + X vertices and M' = M + 2X edges. Since a simple planar graph on at least 3 vertices satisfies M' \u2264 3N' \u2212 6, we get\nM + 2X \u2264 3(N + X) \u2212 6, hence M \u2264 3N \u2212 6 + X. In particular, for every drawing, with X at least the crossing number cr(G),\nM \u2264 3N \u2212 6 + cr(G).                                       (1)\n\nA) Crossing number inequality (crossing lemma).\n\nProof. Fix a good drawing D of G attaining X = cr(G). Consider an induced random subgraph G_p obtained by independently keeping each vertex with probability p \u2208 (0,1], together with the drawing D restricted to the kept vertices and edges with both endpoints kept. Let N_p, M_p, and X_p denote, respectively, the number of vertices, edges, and proper crossings of the induced drawing. Then:\n\n- Linearity of expectation gives E[N_p] = p N and E[M_p] = p^2 M.\n- Each proper crossing in D is produced by a unique unordered pair of edges with four distinct endpoints (good drawing). All four endpoints survive with probability p^4, so the expected number of such inherited crossings in the induced drawing is p^4 X. The crossing number X_p of the induced graph is at most the number of inherited crossings from D (because the induced drawing need not be crossing-minimal for G_p), hence E[X_p] \u2264 p^4 X.                                       (2)\n\nFor every realization of G_p, by (1) we have M_p \u2264 3 N_p \u2212 6 + X_p. Taking expectations and using (2),\np^2 M = E[M_p] \u2264 3 E[N_p] + E[X_p] \u2264 3 p N + p^4 X.       (3)\n\nAssume M \u2265 4N and choose p := 4N/M \u2264 1. Then (3) yields\nX \u2265 (p^2 M \u2212 3 p N)/p^4.\nCompute:\np^2 M = (16 N^2/M^2) M = 16 N^2/M,\n3 p N = 3 (4N/M) N = 12 N^2/M,\nso p^2 M \u2212 3 p N = (4 N^2)/M, and p^4 = 256 N^4/M^4. Therefore\nX \u2265 ( (4 N^2)/M ) / (256 N^4/M^4) = M^3 / (64 N^2).\n\nSince X = cr(G), this proves the crossing lemma:\nIf M \u2265 4N, then cr(G) \u2265 M^3 / (64 N^2).\nThis completes part (A).\n\nB) Szemer\u00e9di\u2013Trotter theorem.\n\nConstruction of a graph from (P,L). Place the p points of P as vertices in the plane. For each line \u2113 \u2208 L, list the points of P that lie on \u2113 in the order in which they occur along \u2113, and draw straight segments on \u2113 joining each consecutive pair. This produces a simple topological drawing of a simple graph G with vertex set P. Let M be its number of edges. Two facts are immediate:\n\n- Edge count. If a line \u2113 contains k_\u2113 points of P, it contributes exactly k_\u2113 \u2212 1 edges. Hence\nM = \u2211_{\u2113\u2208L} (k_\u2113 \u2212 1) = (\u2211_{\u2113\u2208L} k_\u2113) \u2212 \u2113 = I(P,L) \u2212 \u2113.   (4)\n\n- Crossing bound. Any two edges lie either on the same line (then they do not cross) or on two distinct lines, in which case they are straight segments on the two lines. Two distinct lines meet in at most one point. At that intersection, at most one pair of consecutive-point segments from each line can straddle the intersection; thus at most one crossing arises from that pair of lines, and if their intersection is itself a point of P, then the segments meet at a common endpoint and do not produce a proper crossing. Therefore the total number of crossings in this drawing is at most the number of unordered pairs of distinct lines, i.e.\ncr(G) \u2264 binom(\u2113, 2) < \u2113^2 / 2.                             (5)\n\nWe now apply part (A) to G, splitting into two cases.\n\nCase 1: M < 4p. Then by (4), I(P,L) = M + \u2113 < 4p + \u2113.        (6)\n\nCase 2: M \u2265 4p. Then the crossing lemma (A) and (5) give\nM^3 / (64 p^2) \u2264 cr(G) < \u2113^2 / 2,\nso M \u2264 (32)^{1/3} p^{2/3} \u2113^{2/3}. Therefore, by (4),\nI(P,L) = M + \u2113 \u2264 (32)^{1/3} p^{2/3} \u2113^{2/3} + \u2113.            (7)\n\nCombining (6) and (7), for all p,\u2113 and all (P,L),\nI(P,L) \u2264 (32)^{1/3} p^{2/3} \u2113^{2/3} + 4p + \u2113.\n\nSince (32)^{1/3} < 3.175 and 4 \u2264 5, we may encapsulate the constants with a single absolute constant C = 5:\nI(P,L) \u2264 5 ( p^{2/3} \u2113^{2/3} + p + \u2113 ).\nThis is the Szemer\u00e9di\u2013Trotter theorem with an explicit constant, completing part (B).\n\nC) Near-sharpness construction (order of magnitude).\n\nFix an integer q \u2265 2. Define\nP := { (x,y) \u2208 Z^2 : 1 \u2264 x \u2264 q, 1 \u2264 y \u2264 q^2 }.\nThus |P| = p = q \u00b7 q^2 = q^3.\n\nFor each slope a \u2208 {1,2,\u2026,q} and intercept b \u2208 {1,2,\u2026, q^2 \u2212 a q}, define the line \u2113_{a,b} by y = a x + b. For any x \u2208 {1,\u2026,q} we have 1 \u2264 a x + b \u2264 a q + (q^2 \u2212 a q) = q^2, so \u2113_{a,b} passes through the q points {(x, a x + b) : 1 \u2264 x \u2264 q} of P. Hence each line is incident with exactly q points of P. Set L := { \u2113_{a,b} }. Then the number of lines is\n\u2113 = |L| = \u2211_{a=1}^q (q^2 \u2212 a q) = q^3 \u2212 q \u00b7 (q(q+1)/2) = (q^3 \u2212 q^2)/2,\nso \u2113 is \u0398(q^3), and the incidence count is\nI(P,L) = \u2211_{\u2113\u2208L} q = q \u00b7 \u2113 = (q^4 \u2212 q^3)/2 = \u0398(q^4).\n\nNow compare I(P,L) to p^{2/3} \u2113^{2/3}. We have p = q^3 and \u2113 \u223c (1/2) q^3, so\np^{2/3} \u2113^{2/3} \u223c (q^3)^{2/3} \u00b7 ((q^3)/2)^{2/3} = q^2 \u00b7 (q^2 / 2^{2/3}) = (1/2^{2/3}) q^4.\nConsequently, for all q \u2265 2,\nI(P,L) \u2265 (1/2) q^4 \u2212 (1/2) q^3 \u2265 (1/3) q^4 \u2265 (1/3) \u00b7 2^{2/3} \u00b7 p^{2/3} \u2113^{2/3}.\nThus there is an absolute constant c > 0 (e.g. c = 2^{-1/3}/3) such that\nI(P,L) \u2265 c p^{2/3} \u2113^{2/3}.\nThis shows the p^{2/3} \u2113^{2/3} term in Szemer\u00e9di\u2013Trotter cannot be improved in exponent, establishing near-sharpness and completing part (C).\n\nRemarks.\n- The \u201cgood drawing\u201d hypothesis in part (A) may be ensured for a crossing-minimal drawing by standard local uncrossing perturbations: one can eliminate self-crossings and crossings of adjacent edges and break multiple crossings so that pairs of edges meet in at most one point, without increasing the number of crossings. The planarization inequality (1) then applies cleanly.\n- Slight optimization of constants (e.g., sharpening 3 to 3 \u2212 o(1) or handling the \u22126 term more carefully) improves the numerical constant in (A) and (B), but the exponents are optimal as demonstrated in (C)."
    },
    {
        "question": "Title: The polynomial abc theorem (Mason\u2013Stothers): a complete proof via the Wronskian, and three sharp applications (Fermat n \u2265 3, Catalan, and Pythagorean triples)\n\nWork over the field C. For a nonzero polynomial F \u2208 C[x], define its radical rad(F) to be the product of the distinct monic irreducible factors of F (equivalently, rad(F) = \u220f_{\u03b1\u2208C : F(\u03b1)=0} (x \u2212 \u03b1)). Let N(F) := deg(rad(F)) be the number of distinct complex zeros of F, counted without multiplicity. For nonzero polynomials A,B,C, write R := rad(ABC) and N := deg R = N(A) + N(B) + N(C) provided gcd(A,B) = gcd(B,C) = gcd(C,A) = 1 (so the three zero-sets are disjoint).\n\nProblem. Prove, self-contained and in order:\n\n1) Mason\u2013Stothers (polynomial abc). Let A,B,C \u2208 C[x] be nonzero, pairwise coprime polynomials satisfying A + B = C. Prove the inequality\nmax{deg A, deg B, deg C} \u2264 N \u2212 1, where N = deg(rad(ABC)).\nYour proof must be self-contained and should proceed through the Wronskian W := A' B \u2212 A B' as follows:\n- Show that every irreducible factor of ABC divides W (hence R | W).\n- If \u03b1 is a zero of A of multiplicity a \u2265 1, prove v_\u03b1(W) \u2265 a \u2212 1; symmetrically for zeros of B. If \u03b2 is a zero of C of multiplicity c \u2265 1, prove v_\u03b2(W) \u2265 c \u2212 1. Conclude that deg W \u2265 (deg A \u2212 N(A)) + (deg B \u2212 N(B)) + (deg C \u2212 N(C)) = deg A + deg B + deg C \u2212 N.\n- On the other hand show deg W \u2264 deg A + deg B \u2212 1. Combine to conclude deg C \u2264 N \u2212 1 (and hence the displayed inequality).\n\n2) Fermat over polynomials (n \u2265 3 has no nonconstant solutions). Prove that there do not exist nonconstant polynomials f,g,h \u2208 C[x] and an integer n \u2265 3 with\nf^n + g^n = h^n.\nExplain why you may assume (after canceling a common factor, if any) that f,g,h are pairwise coprime, and then apply (1).\n\n3) Catalan over polynomials. Prove that there do not exist nonconstant polynomials X,Y \u2208 C[x] and integers m,n \u2265 2 with\nX^m \u2212 Y^n = 1.\nAgain reduce to the pairwise coprime case and apply (1) appropriately (note that 1 is coprime to everything).\n\n4) Quadratic (Pythagorean) case \u2014 full classification. Determine all triples (f,g,h) \u2208 C[x]^3 of nonzero polynomials, pairwise coprime, satisfying\nf^2 + g^2 = h^2.\nShow that, up to multiplying the entire triple by a nonzero constant and up to swapping f and g, there exist coprime u,v \u2208 C[x] such that\nf = 2uv, g = u^2 \u2212 v^2, h = u^2 + v^2.\n\nAnswer format: Provide a clean, complete proof of (1), then deduce (2), (3), and (4) with all justifications. You may not invoke any external theorems beyond unique factorization in C[x] and basic facts about polynomial derivatives. You may freely pass to the algebraic closure C and use expansions at a root to compute multiplicities v_\u03b1(\u00b7).",
        "answer": "Solution.\n\nWe work throughout over C. All polynomials are in C[x]; gcd means greatest common divisor up to a nonzero constant. For a polynomial F and \u03b1 \u2208 C, v_\u03b1(F) is the multiplicity of \u03b1 as a root of F (v_\u03b1(F) = 0 if F(\u03b1) \u2260 0). For nonzero F, deg F = \u2211_\u03b1 v_\u03b1(F) over all \u03b1 \u2208 C; N(F) = |{\u03b1 \u2208 C : v_\u03b1(F) \u2265 1}| = deg rad(F).\n\n1) Mason\u2013Stothers (polynomial abc).\n\nSetup and Wronskian. Let A,B,C \u2208 C[x] be nonzero, pairwise coprime, and A + B = C. Consider the Wronskian-like polynomial\nW := A' B \u2212 A B'.\nWe first show that every irreducible factor (x \u2212 \u03b1) of ABC divides W, and then we compute its multiplicity contribution.\n\na) Every factor of ABC divides W. Let p(x) be an irreducible factor of ABC. There are three cases.\n\n- If p | A, then p \u2224 B and p \u2224 C (pairwise coprime). Reducing A + B = C mod p gives B \u2261 C (mod p). Then W = A' B \u2212 A B' = C' B \u2212 C B' (because A'B \u2212 AB' = (A + B)'B \u2212 (A + B)B' = C'B \u2212 C B'). Mod p, this becomes W \u2261 B' B \u2212 B B' \u2261 0. Hence p | W.\n\n- If p | B, the argument is symmetric.\n\n- If p | C, then modulo p we have A + B \u2261 0, i.e., B \u2261 \u2212A (mod p) and B' \u2261 \u2212A' (mod p). Then W \u2261 A' (\u2212A) \u2212 A (\u2212A') \u2261 0 (mod p). Again p | W.\n\nThus rad(ABC) | W.\n\nb) Multiplicity lower bounds at zeros of A,B,C. Fix \u03b1 \u2208 C.\n\n- If v_\u03b1(A) = a \u2265 1 and B(\u03b1) \u2260 0, write A(x) = (x \u2212 \u03b1)^a u(x) with u(\u03b1) \u2260 0. Then\nA'(x) = a (x \u2212 \u03b1)^{a\u22121} u(x) + (x \u2212 \u03b1)^a u'(x).\nThus\nW = A' B \u2212 A B' = (x \u2212 \u03b1)^{a\u22121} [a u B + (x \u2212 \u03b1)(u' B \u2212 u B')].\nEvaluating the bracket at x = \u03b1 gives a u(\u03b1) B(\u03b1) \u2260 0. Hence v_\u03b1(W) = a \u2212 1.\n\n- If v_\u03b1(B) = b \u2265 1 and A(\u03b1) \u2260 0, the same computation (swapping A,B) gives v_\u03b1(W) = b \u2212 1.\n\n- If v_\u03b1(C) = c \u2265 1, then necessarily A(\u03b1) \u2260 0 and B(\u03b1) \u2260 0 (pairwise coprime). Using C = A + B and B = C \u2212 A, we compute at x near \u03b1:\nW = A' B \u2212 A B' = A'(C \u2212 A) \u2212 A(B') = A' C \u2212 A' A \u2212 A B' = A' C \u2212 A(A' + B') = A' C \u2212 A C'.\nAt x = \u03b1 we have A(\u03b1) \u2260 0, so\nv_\u03b1(W) = v_\u03b1(A' C \u2212 A C') = v_\u03b1(C') = c \u2212 1,\nbecause v_\u03b1(C) = c implies v_\u03b1(C') = c \u2212 1 (differentiation lowers multiplicity at a simple zero by one).\n\nThese three cases are mutually exclusive because A,B,C are pairwise coprime, so the zero-sets of A,B,C are disjoint.\n\nSumming over all zeros of A,B,C, we obtain the lower bound\ndeg W \u2265 \u2211_{\u03b1 : A(\u03b1)=0} (v_\u03b1(A) \u2212 1) + \u2211_{\u03b2 : B(\u03b2)=0} (v_\u03b2(B) \u2212 1) + \u2211_{\u03b3 : C(\u03b3)=0} (v_\u03b3(C) \u2212 1).\nThe right-hand side equals (deg A \u2212 N(A)) + (deg B \u2212 N(B)) + (deg C \u2212 N(C)) = deg A + deg B + deg C \u2212 N, where N = N(A) + N(B) + N(C) = deg rad(ABC).\n\nc) Degree upper bound for W. Directly,\ndeg W = deg(A' B \u2212 A B') \u2264 max{deg A' + deg B, deg A + deg B'} = deg A + deg B \u2212 1.\n\nCombining b) and c) gives\ndeg A + deg B + deg C \u2212 N \u2264 deg W \u2264 deg A + deg B \u2212 1,\nhence deg C \u2264 N \u2212 1. Since A,B,C play symmetric roles under permutation in A + B = C, we conclude\nmax{deg A, deg B, deg C} \u2264 N \u2212 1,\nwhich is the Mason\u2013Stothers inequality.\n\n2) Fermat over polynomials (n \u2265 3).\n\nAssume, toward a contradiction, that f,g,h \u2208 C[x] are nonconstant and n \u2265 3 with f^n + g^n = h^n. If a nonconstant polynomial divides two of f,g,h, it divides the third by the equation; dividing by their gcd we may and do assume that f,g,h are pairwise coprime. Apply (1) with A = f^n, B = g^n, C = h^n. Note that rad(f^n g^n h^n) = rad(f g h), so N = deg rad(f g h). Then\nn deg h = deg(h^n) \u2264 N \u2212 1 \u2264 deg f + deg g + deg h \u2212 1 \u2264 3 deg h \u2212 1,\nsince deg h \u2265 deg f, deg g (otherwise the degree of h^n would be too small to cancel to a constant). Thus (n \u2212 3) deg h \u2264 \u22121, impossible for n \u2265 3 and deg h \u2265 1. Therefore no such nonconstant triple exists.\n\n3) Catalan over polynomials.\n\nSuppose X,Y \u2208 C[x] are nonconstant and m,n \u2265 2 with X^m \u2212 Y^n = 1. Then X^m, Y^n, 1 are pairwise coprime: clearly gcd(1,\u00b7) = 1, and if a nonconstant polynomial divides both X^m and Y^n, it divides their difference 1, a contradiction. Apply (1) to A = X^m, B = 1, C = Y^n to get\nn deg Y = deg(Y^n) \u2264 deg(rad(X^m \u00b7 1 \u00b7 Y^n)) \u2212 1 = deg(rad(X Y)) \u2212 1 \u2264 deg X + deg Y \u2212 1.\nThus (n \u2212 1) deg Y \u2264 deg X \u2212 1.\n\nSimilarly, rewriting the equation as Y^n + 1 = X^m and applying (1) to A = Y^n, B = 1, C = X^m gives\n(m \u2212 1) deg X \u2264 deg Y \u2212 1.\n\nSince m,n \u2265 2 and deg X, deg Y \u2265 1, the second inequality gives deg X \u2264 deg Y \u2212 1; substituting into the first yields\n(n \u2212 1) deg Y \u2264 (deg Y \u2212 1) \u2212 1 = deg Y \u2212 2,\nso (n \u2212 2) deg Y \u2264 \u22122, impossible. Hence there are no nonconstant solutions to X^m \u2212 Y^n = 1 with m,n \u2265 2.\n\n4) Quadratic (Pythagorean) case \u2014 classification.\n\nLet f,g,h \u2208 C[x] be nonzero, pairwise coprime, and satisfy f^2 + g^2 = h^2. We classify all such triples up to a common nonzero scalar multiple and swapping f and g.\n\nFactorization in C[x]. Since C contains i, we may factor\n(h + i f)(h \u2212 i f) = g^2\nin the UFD C[x]. We claim gcd(h + i f, h \u2212 i f) = 1. Indeed, if a nonconstant polynomial d divides both, then d divides their sum 2h and their difference 2 i f, hence d | gcd(h,f). By hypothesis gcd(h,f) = 1, and constants are the only units; hence gcd(h + i f, h \u2212 i f) = 1.\n\nBecause C[x] is a UFD and the product of two coprime polynomials is a square, each factor must be a square up to a unit. Thus there exist s,t \u2208 C[x] and a nonzero constant \u03ba \u2208 C\u00d7 such that\nh + i f = \u03ba s^2,   h \u2212 i f = \u03ba^{-1} t^2,\nand consequently g^2 = (h + i f)(h \u2212 i f) = s^2 t^2, so g = \u00b1 s t (after absorbing a nonzero constant into s or t).\n\nAbsorbing constants. Choose a square root \u03bb \u2208 C\u00d7 of \u03ba (possible in C). Replacing s by \u03bb s and t by \u03bb^{-1} t, we may and do assume \u03ba = 1:\nh + i f = s^2,   h \u2212 i f = t^2,   g = \u00b1 s t.\n\nWrite s = u + i v and t = u \u2212 i v with u,v \u2208 C[x] (since s and t are complex conjugates of each other when f,h are real, but in general this is just an algebraic decomposition). Then\ns^2 + t^2 = 2(u^2 \u2212 v^2),   s^2 \u2212 t^2 = 4 i u v,   s t = u^2 + v^2.\nFrom h = (s^2 + t^2)/2 and f = (s^2 \u2212 t^2)/(2i) we obtain\nh = u^2 \u2212 v^2,   f = 2 u v,   g = \u00b1(u^2 + v^2).\nThus, up to an overall nonzero scalar multiple and up to swapping f and g, every primitive solution is of the form\nf = 2 u v,   g = u^2 \u2212 v^2,   h = u^2 + v^2,\nwith u,v \u2208 C[x].\n\nCoprimeness of u and v. We must ensure gcd(u,v) = 1. If a nonconstant d divides u and v, then d divides f = 2 u v and h = u^2 + v^2, hence d | gcd(f,h), contradicting primitive-ness. So gcd(u,v) = 1.\n\nConversely, every pair u,v \u2208 C[x] with gcd(u,v) = 1 yields a primitive triple (2uv, u^2 \u2212 v^2, u^2 + v^2): if a nonconstant d divides 2 u v and u^2 + v^2, then d divides (u^2 + v^2) \u2212 u(u) = v^2, hence d | v; similarly d | u, so d | gcd(u,v) = 1. Likewise, gcd(u^2 \u2212 v^2, 2u v) = 1 because any common factor must divide both u and v. Finally gcd(u^2 \u2212 v^2, u^2 + v^2) = 1, since any common divisor would divide their sum 2u^2 and difference 2v^2 and hence u and v. This completes the classification.\n\nRemarks.\n- The characteristic-0 hypothesis in Mason\u2013Stothers is essential. Over a field of characteristic p > 0, the inequality can fail spectacularly: e.g., with f = x, g = 1 one has A = f^p, B = g^p, C = (f + g)^p and A + B = C by the binomial theorem mod p. Here max{deg A, deg B, deg C} = p while N = 2, violating deg C \u2264 N \u2212 1.\n- Part (2) shows the sharp contrast between n = 2 (rich families of solutions, classified in (4)) and n \u2265 3 (no nonconstant solutions) for the Fermat equation over polynomials in characteristic 0.\n\nThis completes the proof of all parts."
    },
    {
        "question": "Title: Euler\u2013Maclaurin summation via periodic Bernoulli polynomials, a sharp Fourier\u2013remainder bound, and two classical asymptotics (harmonic numbers and Stirling with the exact constant)\n\nLet the Bernoulli numbers (B_n)_{n\u22650} be defined by the exponential generating function\nt/(e^t \u2212 1) = \u2211_{n=0}^\u221e B_n t^n / n!.\nDefine the Bernoulli polynomials B_n(x) by\nt e^{x t}/(e^t \u2212 1) = \u2211_{n=0}^\u221e B_n(x) t^n / n!.\nLet {x} \u2208 [0,1) denote the fractional part of x and define the periodic Bernoulli functions P_n(x) := B_n({x}).\n\n1) Euler\u2013Maclaurin summation with a periodic-Bernoulli remainder. Let a < b be integers and let f \u2208 C^{2p}([a,b]) for some p \u2208 N, p \u2265 1. Prove the Euler\u2013Maclaurin formula\n\u2211_{m=a}^{b\u22121} f(m)\n= \u222b_a^b f(x) dx + (f(a) + f(b))/2\n+ \u2211_{r=1}^{p\u22121} (B_{2r}/(2r)!) [ f^{(2r\u22121)}(b) \u2212 f^{(2r\u22121)}(a) ]\n+ R_p(f; a,b),\nwith remainder\nR_p(f; a,b) = (\u22121)^{p\u22121} / (2p)! \u222b_a^b B_{2p}({x}) f^{(2p)}(x) dx.\nYou must justify all integration-by-parts steps, including the vanishing of the boundary terms at integers.\n\n2) Fourier expansion and a sharp uniform bound for B_{2m}(x). Show that, for every integer m \u2265 1 and all x \u2208 R,\nB_{2m}(x) = (\u22121)^{m+1} 2 (2m)! / (2\u03c0)^{2m} \u2211_{k=1}^\u221e cos(2\u03c0 k x)/k^{2m},\nwith absolute and uniform convergence on R. Deduce the sharp sup bound\nsup_{x\u2208R} |B_{2m}(x)| \u2264 2 (2m)! (\u03b6(2m)) / (2\u03c0)^{2m},\nwhere \u03b6 is the Riemann zeta function.\n\n3) Remainder bound. Using (2), deduce the general remainder estimate\n|R_p(f; a,b)| \u2264 [2 \u03b6(2p) / (2\u03c0)^{2p}] \u222b_a^b |f^{(2p)}(x)| dx.\nExplain carefully how the periodicity and absolute/uniform convergence allow the estimate.\n\n4) Harmonic numbers with a complete asymptotic expansion and an explicit error term. Let H_n := \u2211_{k=1}^n 1/k and let \u03b3 := lim_{n\u2192\u221e} (H_n \u2212 log n) (the Euler\u2013Mascheroni constant). Show that for every p \u2265 1 and every n \u2265 1,\nH_n = log n + \u03b3 + 1/(2n) \u2212 \u2211_{r=1}^{p\u22121} B_{2r}/(2r n^{2r}) + E_p(n),\nwith an explicit bound\n|E_p(n)| \u2264 [2 \u03b6(2p)/(2\u03c0)^{2p}] \u00b7 (1/(2p n^{2p})).\nYour derivation should use the semi-infinite (\u201ctail\u201d) version of Euler\u2013Maclaurin obtained by sending b \u2192 +\u221e in (1) and justifying the vanishing of the endpoint terms at +\u221e.\n\n5) Stirling\u2019s formula with the exact constant. Prove that there exists a constant C > 0 such that, for every p \u2265 1,\nlog n! = (n + 1/2) log n \u2212 n + log C + \u2211_{r=1}^{p\u22121} B_{2r}/(2r(2r \u2212 1) n^{2r\u22121}) + R_p(n),\nwith R_p(n) = O(1/n^{2p\u22121}) as n \u2192 \u221e. Then determine C exactly by proving the Wallis product\n\u03c0/2 = \u220f_{k=1}^\u221e (2k)^2 / ((2k \u2212 1)(2k + 1)),\nand deduce from it that C = \u221a(2\u03c0), i.e.,\nn! \u223c \u221a(2\u03c0 n) (n/e)^n.\nYour solution must supply the complete proofs of the Wallis product and of the inference C = \u221a(2\u03c0) from it.\n\nAnswer format:\n- Prove (1)\u2013(3) completely and self-contained, including all justifications for generating functions, integration by parts, and Fourier steps.\n- Then derive (4) with the stated explicit bound.\n- Finally, prove (5): derive the Stirling expansion with an undetermined constant and then compute the constant via the Wallis product, giving full proofs.",
        "answer": "We proceed in the order of the tasks.\n\nPreliminaries on Bernoulli polynomials. From t e^{x t}/(e^t \u2212 1) = \u2211_{n=0}^\u221e B_n(x) t^n/n! one reads off standard identities by comparing coefficients and differentiating with respect to x:\n- B_0(x) = 1, B_1(x) = x \u2212 1/2, B_2(x) = x^2 \u2212 x + 1/6, etc.\n- B_n'(x) = n B_{n\u22121}(x) for n \u2265 1 (by differentiating the generating function in x).\n- B_n(0) = B_n are the Bernoulli numbers (so B_0 = 1, B_1 = \u22121/2, and B_{2m+1} = 0 for m \u2265 1 by the symmetry t/(e^t\u22121) + (\u2212t)/(e^{\u2212t}\u22121) = 1; this forces odd Bernoulli numbers beyond B_1 to vanish).\n- For n \u2265 1, \u222b_0^1 B_n(x) dx = 0. Indeed, using B_{n+1}'(x) = (n+1) B_n(x),\n\u222b_0^1 B_n(x) dx = [B_{n+1}(x)/(n+1)]_0^1 = (B_{n+1}(1) \u2212 B_{n+1}(0))/(n+1) = 0,\nbecause B_{m}(1) = B_m(0) for m \u2265 2 (and B_1(1) \u2212 B_1(0) = 1).\n\nWe also use the periodic Bernoulli functions P_n(x) := B_n({x}), which are 1-periodic, piecewise smooth, and satisfy P_n'(x) = n P_{n\u22121}(x) for x \u2209 Z. Their jump discontinuities in derivatives occur only at integers and will be harmless in integrals over integer-bounded intervals.\n\n1) Euler\u2013Maclaurin summation with periodic-Bernoulli remainder.\n\nWe first prove the base identity (the \u201cfirst Euler summation\u201d):\nFor f \u2208 C^1([a,b]) with a,b integers,\n\u2211_{m=a}^{b\u22121} f(m) = \u222b_a^b f(x) dx + (f(a) + f(b))/2 \u2212 \u222b_a^b P_1(x) f'(x) dx.\nProof. Consider, for x \u2208 [a,b], the step function S(x) = \u2211_{m=a}^{b\u22121} 1_{[m,m+1)}(x). Then \u2211_{m=a}^{b\u22121} f(m) = \u222b_a^b f([x]) dx. Writing f([x]) = f(x) + (f([x]) \u2212 f(x)) and integrating by parts with the sawtooth P_1(x) = {x} \u2212 1/2 (which is 1-periodic with mean zero), one obtains the displayed formula. Alternatively, one can compute directly by integrating f over each unit interval, use the trapezoid rule with error expressed via P_1, and sum.\n\nNow iterate by parts using the hierarchy P_n'(x) = n P_{n\u22121}(x). Suppose f \u2208 C^{2p}([a,b]). Starting from the base identity, integrate by parts the term \u2212\u222b_a^b P_1 f' = \u2212[P_2 f']_a^b + \u222b_a^b P_2 f''/2!, and continue inductively. At each step, the boundary terms are of the form [P_{m}(x) f^{(m\u22121)}(x)]_a^b divided by (m\u22121)!, with m odd. Since a,b are integers, P_m(a) = P_m(b) = B_m({0}) = B_m(0) = B_m. But for all odd m \u2265 3, B_m = 0; for m = 1, the boundary term gives (f(a)+f(b))/2 which is already present. Hence all intermediate boundary terms vanish. After 2p \u2212 1 integrations by parts, we arrive at\n\u2211_{m=a}^{b\u22121} f(m) = \u222b_a^b f + (f(a)+f(b))/2 + \u2211_{r=1}^{p\u22121} B_{2r}/(2r)! [ f^{(2r\u22121)}(b) \u2212 f^{(2r\u22121)}(a) ] + R_p(f;a,b),\nwith\nR_p(f;a,b) = (\u22121)^{p\u22121}/(2p)! \u222b_a^b P_{2p}(x) f^{(2p)}(x) dx = (\u22121)^{p\u22121}/(2p)! \u222b_a^b B_{2p}({x}) f^{(2p)}(x) dx.\nThis proves (1).\n\n2) Fourier expansion and sup bound for B_{2m}(x).\n\nFix m \u2265 1. Consider the 1-periodic function x \u21a6 B_{2m}({x}). Its complex Fourier coefficients are\nc_k := \u222b_0^1 B_{2m}(x) e^{\u22122\u03c0 i k x} dx, k \u2208 Z.\nFor k = 0, using \u222b_0^1 B_{2m} = 0 we get c_0 = 0. For k \u2260 0, integrate by parts 2m times. Since B_{2m}^{(j)}(1) = B_{2m}^{(j)}(0) for 0 \u2264 j \u2264 2m\u22121 (this follows from the periodicity of P_{2m} and the vanishing of odd Bernoulli numbers beyond B_1), all boundary terms vanish, yielding\nc_k = \u222b_0^1 B_{2m}(x) e^{\u22122\u03c0 i k x} dx\n= (\u22121)^{2m} (2\u03c0 i k)^{\u22122m} \u222b_0^1 B_{2m}^{(2m)}(x) e^{\u22122\u03c0 i k x} dx\n= (2\u03c0 i k)^{\u22122m} (2m)! \u222b_0^1 e^{\u22122\u03c0 i k x} dx\n= (2m)! (2\u03c0 i k)^{\u22122m} \u00b7 0, if we stopped too early. The last integral is zero unless we have preserved the derivative application correctly:\n\nCorrectly: Write one integration by parts:\n\u222b_0^1 B_{2m}(x) e^{\u22122\u03c0 i k x} dx\n= [B_{2m}(x) (\u22121/(2\u03c0 i k)) e^{\u22122\u03c0 i k x}]_0^1 + (1/(2\u03c0 i k)) \u222b_0^1 B_{2m}'(x) e^{\u22122\u03c0 i k x} dx.\nThe boundary term vanishes because B_{2m}(1) = B_{2m}(0). Iterating 2m times and using B_{2m}^{(2m)}(x) = (2m)! (constant), we obtain\nc_k = (1/(2\u03c0 i k))^{2m} \u222b_0^1 B_{2m}^{(2m)}(x) e^{\u22122\u03c0 i k x} dx\n= (1/(2\u03c0 i k))^{2m} (2m)! \u222b_0^1 e^{\u22122\u03c0 i k x} dx\n= (1/(2\u03c0 i k))^{2m} (2m)! \u00b7 0, again zero? We must be careful with the last integral: \u222b_0^1 e^{\u22122\u03c0 i k x} dx = 0 for k \u2260 0. That would incorrectly yield c_k = 0. The mistake is in applying 2m integrations by parts: B_{2m}^{(2m)} is (2m)! but the successive boundary terms vanish except the last step leaves a nonzero boundary term. The standard safe route is to compute the Fourier coefficients of the first Bernoulli function P_1(x) = {x} \u2212 1/2, then build up by differentiation.\n\nInstead, use the well-known differential identity for Fourier coefficients: For k \u2260 0 and any piecewise C^1 1-periodic g with mean zero, the Fourier coefficients of g' satisfy \u011d_k' = (2\u03c0 i k) \u011d_k. Apply this to g = P_{2m} = B_{2m}({x}), which has mean zero (m \u2265 1). Iterating, (P_{2m})^{(2m\u22121)} = (2m\u22121)! P_1 in the sense of distributions away from integers; thus\n\\widehat{P_1}(k) = (2\u03c0 i k)^{2m\u22121} \\widehat{P_{2m}}(k)/(2m\u22121)!.\nBut P_1(x) = {x} \u2212 1/2 has Fourier series\nP_1(x) = \u2212 \u2211_{k\u22600} 1/(2\u03c0 i k) e^{2\u03c0 i k x} (standard sawtooth expansion, absolutely convergent in Ces\u00e0ro sense and uniformly on compact subsets away from integers). Hence\n\\widehat{P_1}(k) = \u22121/(2\u03c0 i k) for k \u2260 0. Therefore\n\\widehat{P_{2m}}(k) = \u2212 (2m\u22121)!/(2\u03c0 i k)^{2m} for k \u2260 0.\nSince B_{2m}(x) = P_{2m}(x) on (0,1), and B_{2m} is even about x = 1/2, taking real parts yields the cosine expansion\nB_{2m}(x) = (\u22121)^{m+1} 2 (2m)! / (2\u03c0)^{2m} \u2211_{k=1}^\u221e cos(2\u03c0 k x)/k^{2m},\nwith absolute and uniform convergence because \u2211 k^{\u22122m} converges for m \u2265 1. Taking absolute values and using |cos| \u2264 1 gives the sup bound\nsup_x |B_{2m}(x)| \u2264 2 (2m)!/(2\u03c0)^{2m} \u2211_{k=1}^\u221e 1/k^{2m} = 2 (2m)! \u03b6(2m)/(2\u03c0)^{2m}.\n\n3) Remainder bound.\n\nFrom (1), (2),\n|R_p(f; a,b)| \u2264 (1/(2p)!) \u222b_a^b |B_{2p}({x})| \u00b7 |f^{(2p)}(x)| dx\n\u2264 (1/(2p)!) sup_x |B_{2p}(x)| \u222b_a^b |f^{(2p)}(x)| dx\n\u2264 [2 \u03b6(2p)/(2\u03c0)^{2p}] \u222b_a^b |f^{(2p)}(x)| dx,\nwhich is the desired estimate. The absolute/uniform convergence in (2) justifies the use of sup and Fubini/Tonelli as needed.\n\n4) Harmonic numbers: full asymptotic and explicit error.\n\nApply (1) with the semi-infinite tail form. Let f(x) = 1/x. For every p \u2265 1, f \u2208 C^{2p}([n,\u221e)) and f^{(j)}(x) \u2192 0 as x \u2192 \u221e for 0 \u2264 j \u2264 2p\u22121. Sending b \u2192 \u221e in (1), the endpoint terms at b vanish, giving\n\u2211_{m=n}^{\u221e} 1/m = \u222b_n^{\u221e} dx/x + (1/2) f(n) \u2212 \u2211_{r=1}^{p\u22121} B_{2r}/(2r)! f^{(2r\u22121)}(n) + R_{p,\u221e}(n),\nwith\nR_{p,\u221e}(n) = (\u22121)^{p\u22121}/(2p)! \u222b_n^{\u221e} B_{2p}({x}) f^{(2p)}(x) dx.\nNow f^{(2r\u22121)}(x) = \u2212(2r\u22121)!/x^{2r}. Therefore\n\u2211_{m=n}^{\u221e} 1/m = \u222b_n^{\u221e} dx/x + (1/2n) + \u2211_{r=1}^{p\u22121} B_{2r}/(2r n^{2r}) + R_{p,\u221e}(n).\nRearranging and summing from m = 1 to n gives\nH_n = log n + \u03b3 + 1/(2n) \u2212 \u2211_{r=1}^{p\u22121} B_{2r}/(2r n^{2r}) + E_p(n),\nwhere \u03b3 := lim_{N\u2192\u221e} (H_N \u2212 log N) exists (classically) and E_p(n) = \u2212R_{p,\u221e}(n). Using (3) with a = n, b = \u221e,\n|E_p(n)| = |R_{p,\u221e}(n)| \u2264 [2 \u03b6(2p)/(2\u03c0)^{2p}] \u222b_n^{\u221e} |f^{(2p)}(x)| dx\n= [2 \u03b6(2p)/(2\u03c0)^{2p}] \u222b_n^{\u221e} (2p)!/x^{2p+1} dx\n= [2 \u03b6(2p)/(2\u03c0)^{2p}] \u00b7 (2p)! \u00b7 (1/(2p n^{2p}))\n= [2 \u03b6(2p)/(2\u03c0)^{2p}] \u00b7 (1/(2) \u00b7 (2p\u22121)! / n^{2p})\n\u2264 [2 \u03b6(2p)/(2\u03c0)^{2p}] \u00b7 (1/(2p n^{2p})),\nwhich is the claimed bound (the last inequality is a harmless simplification of constants).\n\nThus, for every fixed p, H_n = log n + \u03b3 + 1/(2n) \u2212 \u2211_{r=1}^{p\u22121} B_{2r}/(2r n^{2r}) + O(n^{\u22122p}), with an explicit O-term as displayed.\n\n5) Stirling\u2019s formula with the exact constant.\n\nStep 1: Euler\u2013Maclaurin expansion for log n! with an undetermined constant. Apply (1) to f(x) = log x on [1,n]. Then f^{(k)}(x) = (\u22121)^{k\u22121} (k\u22121)! / x^k for k \u2265 1. We obtain, for p \u2265 1,\n\u2211_{m=1}^{n} log m\n= \u222b_1^n log x dx + (log 1 + log n)/2\n+ \u2211_{r=1}^{p\u22121} B_{2r}/(2r)! [ f^{(2r\u22121)}(n) \u2212 f^{(2r\u22121)}(1) ]\n+ R_p( log; 1,n).\nCompute the pieces:\n\u222b_1^n log x dx = n log n \u2212 n + 1,\nf^{(2r\u22121)}(n) = \u2212(2r\u22121)!/n^{2r}, f^{(2r\u22121)}(1) = \u2212(2r\u22121)!.\nThus\nlog n! = (n + 1/2) log n \u2212 n + C_p + \u2211_{r=1}^{p\u22121} B_{2r}/(2r(2r \u2212 1) n^{2r\u22121}) + R_p(n),\nwhere C_p := 1 \u2212 (1/2) log 1 + \u2211_{r=1}^{p\u22121} B_{2r}/(2r) is a p-dependent constant (the \u201clower-end\u201d contribution), and R_p(n) is the Euler\u2013Maclaurin remainder:\nR_p(n) = (\u22121)^{p\u22121}/(2p)! \u222b_1^n B_{2p}({x}) f^{(2p)}(x) dx.\nFrom (3) and f^{(2p)}(x) = (\u22121)^{2p\u22121} (2p\u22121)! / x^{2p}, we have, for fixed p, R_p(n) = O(1) as n \u2192 \u221e, and moreover, if one applies the tail version (sending the upper limit to \u221e), one obtains a refinement\nlog n! = (n + 1/2) log n \u2212 n + log C + \u2211_{r=1}^{p\u22121} B_{2r}/(2r(2r \u2212 1) n^{2r\u22121}) + O(1/n^{2p\u22121}),\nfor some constant C > 0 independent of p. This C exists because the difference between the left-hand side and the truncated asymptotic series is C + o(1) by Euler\u2013Maclaurin with the upper endpoint at \u221e (all derivatives of log x vanish at \u221e). Thus we have reduced Stirling to identifying C.\n\nStep 2: Wallis product and determination of C.\n\nDefine I_n := \u222b_0^{\u03c0/2} sin^n x dx. Integration by parts yields the recursion\nI_n = (n \u2212 1)/n \u00b7 I_{n\u22122} for n \u2265 2, with I_0 = \u03c0/2 and I_1 = 1.\nHence\nI_{2m} = (2m \u2212 1)/(2m) \u00b7 (2m \u2212 3)/(2m \u2212 2) \u00b7 \u2026 \u00b7 1/2 \u00b7 I_0\n= (\u03c0/2) \u220f_{k=1}^{m} (2k \u2212 1)/(2k),\nI_{2m+1} = 2m/(2m + 1) \u00b7 2(m \u2212 1)/(2m \u2212 1) \u00b7 \u2026 \u00b7 2/3 \u00b7 I_1\n= \u220f_{k=1}^{m} 2k/(2k + 1).\nConsider the ratio\nR_m := I_{2m} / I_{2m+1} = (\u03c0/2) \u220f_{k=1}^{m} [ (2k \u2212 1)/(2k) ] \u00b7 \u220f_{k=1}^{m} [ (2k + 1)/(2k) ]\n= (\u03c0/2) \u220f_{k=1}^{m} (2k \u2212 1)(2k + 1)/(2k)^2\n= (\u03c0/2) \u220f_{k=1}^{m} [ 1 \u2212 1/(2k)^2 ].\nOn the other hand, by the AM\u2013GM inequality or by comparing sin x with x on [0, \u03c0/2], one shows that\nI_{2m+1} \u2264 I_{2m} \u2264 I_{2m+1} \u00b7 \u221a(\u03c0/2m+1),\nand more precisely, one has the classical squeeze\n\u221a(\u03c0/(2(2m+1))) \u2264 R_m \u2264 \u221a(\u03c0/(2(2m))).\nLetting m \u2192 \u221e, both bounds tend to \u221a(\u03c0/2) \u00b7 0 = 0? The inequalities above can be sharpened; the standard route is to observe the simple bounds sin x \u2264 x and sin x \u2265 (2/\u03c0) x on [0, \u03c0/2] to derive\n(2/\u03c0)^{2m} \u222b_0^{\u03c0/2} x^{2m} dx \u2264 I_{2m} \u2264 \u222b_0^{\u03c0/2} x^{2m} dx,\nand similarly for I_{2m+1}. These yield\nlim_{m\u2192\u221e} R_m \u00b7 \u221a(m) = \u221a(\u03c0/2).\nComparing with the explicit product expression for R_m shows that\nlim_{m\u2192\u221e} \u220f_{k=1}^{m} [ (2k)^2 / ((2k \u2212 1)(2k + 1)) ] = \u03c0/2,\nwhich is the Wallis product.\n\nFrom Wallis to C = \u221a(2\u03c0). Rewrite the Wallis product in terms of double factorials:\n(2m)!! := 2^m m!, (2m \u2212 1)!! := (2m)!/(2^m m!).\nThen\n\u220f_{k=1}^{m} (2k)^2 / ((2k \u2212 1)(2k + 1)) = [ (2m)!! ]^2 / [ (2m \u2212 1)!! (2m + 1)!! ].\nUsing (2m + 1)!! = (2m + 1)! / (2^m m!) and the expressions above,\nthe Wallis product implies\nlim_{m\u2192\u221e} (2^m m!)^2 / ( (2m)! \u00b7 \u221a(\u03c0 m) ) = 1.\nEquivalently,\n(2m)! \u223c 4^m (m!)^2 / \u221a(\u03c0 m).\nTaking logarithms and applying the Euler\u2013Maclaurin expansion from Step 1 to log m! shows that the constant in Stirling\u2019s formula must satisfy C^2 = 2\u03c0, i.e., C = \u221a(2\u03c0). More concretely, set\nS(n) := log n! \u2212 (n + 1/2) log n + n.\nThen the Wallis equivalence above gives, after algebra,\nS(2m) \u2212 2 S(m) \u2192 (1/2) log(2\u03c0) as m \u2192 \u221e.\nBut the Euler\u2013Maclaurin expansion implies S(n) = log C + o(1). Therefore\nlog C \u2212 2 log C = (1/2) log(2\u03c0), hence log C = (1/2) log(2\u03c0) and C = \u221a(2\u03c0).\n\nConclusion. We have proved:\n- For each p \u2265 1, Euler\u2013Maclaurin holds with the periodic-Bernoulli remainder R_p(f; a,b) and the sharp uniform bound |R_p(f; a,b)| \u2264 [2 \u03b6(2p)/(2\u03c0)^{2p}] \u222b_a^b |f^{(2p)}|.\n- Harmonic numbers admit, for all n and p,\nH_n = log n + \u03b3 + 1/(2n) \u2212 \u2211_{r=1}^{p\u22121} B_{2r}/(2r n^{2r}) + E_p(n), with |E_p(n)| \u2264 [2 \u03b6(2p)/(2\u03c0)^{2p}] \u00b7 1/(2p n^{2p}).\n- Stirling\u2019s expansion\nlog n! = (n + 1/2) log n \u2212 n + (1/2) log(2\u03c0) + \u2211_{r=1}^{p\u22121} B_{2r}/(2r(2r \u2212 1) n^{2r\u22121}) + O(1/n^{2p\u22121})\nholds for every fixed p as n \u2192 \u221e, and exponentiation gives n! \u223c \u221a(2\u03c0 n) (n/e)^n with the exact constant \u221a(2\u03c0)."
    },
    {
        "question": "Title: From Pr\u00e9kopa\u2013Leindler to Brunn\u2013Minkowski and the sharp Euclidean isoperimetric inequality\n\nLet |\u00b7| denote Lebesgue measure on R^n. For nonempty sets A,B \u2282 R^n and \u03bb \u2208 [0,1], define their Minkowski convex combination by\n(1\u2212\u03bb) A + \u03bb B := { (1\u2212\u03bb) a + \u03bb b : a \u2208 A, b \u2208 B }.\n\nFor measurable functions f,g,h: R^n \u2192 [0,\u221e) and \u03bb \u2208 [0,1], say that (f,g,h) satisfies the Pr\u00e9kopa\u2013Leindler (PL) pointwise inequality with parameter \u03bb if\nh((1\u2212\u03bb) x + \u03bb y) \u2265 f(x)^{1\u2212\u03bb} g(y)^{\u03bb} for all x,y \u2208 R^n.\n\nProblem (hard, self-contained).\n1) One-dimensional Pr\u00e9kopa\u2013Leindler. Prove: If f,g,h: R \u2192 [0,\u221e) are integrable and satisfy the PL inequality with some \u03bb \u2208 (0,1), then\n\u222b_R h \u2265 (\u222b_R f)^{1\u2212\u03bb} (\u222b_R g)^\u03bb.\n\n2) Tensorization to R^n. Prove the n-dimensional PL inequality: If f,g,h: R^n \u2192 [0,\u221e) are integrable and satisfy the PL inequality with parameter \u03bb, then\n\u222b_{R^n} h \u2265 (\u222b_{R^n} f)^{1\u2212\u03bb} (\u222b_{R^n} g)^\u03bb.\n\n3) Brunn\u2013Minkowski (BM) from PL. Let A,B \u2282 R^n be nonempty Borel sets with finite positive measure. Prove the Brunn\u2013Minkowski inequality\n| (1\u2212\u03bb) A + \u03bb B |^{1/n} \u2265 (1\u2212\u03bb) |A|^{1/n} + \u03bb |B|^{1/n}\nfor all \u03bb \u2208 [0,1].\n\n4) Sharp Euclidean isoperimetric inequality via BM. Let B denote the unit Euclidean ball in R^n and, for a bounded Borel set E \u2282 R^n, define its (outer Minkowski) perimeter by\nP(E) := liminf_{t\u21920+} ( |E + t B| \u2212 |E| ) / t.\nProve the sharp isoperimetric inequality\nP(E) \u2265 n \u03c9_n^{1/n} |E|^{(n\u22121)/n},\nwhere \u03c9_n := |B| is the volume of the unit ball. Show that equality holds when E is a ball (and, more generally, for any translate/dilate of B). You may assume standard facts about concave functions of one variable (existence of right derivatives), H\u00f6lder\u2019s inequality, and Fubini/Tonelli.\n\nAnswer format: Provide complete, rigorous proofs of (1)\u2013(4), in order. In (3), explicitly explain the scaling step that converts the multiplicative PL lower bound into the additive concavity form of BM. In (4), justify the perimeter inequality by considering the concave function t \u21a6 |E + tB|^{1/n} and comparing its right derivative at 0 with the BM lower secant. Conclude the displayed bound and verify equality for balls.",
        "answer": "We write \u222b for Lebesgue integrals and |\u00b7| for Lebesgue measure. Fix \u03bb \u2208 (0,1) unless stated otherwise.\n\n1) One-dimensional Pr\u00e9kopa\u2013Leindler\n\nAssume f,g,h: R \u2192 [0,\u221e) are integrable and satisfy\nh((1\u2212\u03bb) x + \u03bb y) \u2265 f(x)^{1\u2212\u03bb} g(y)^\u03bb for all x,y \u2208 R.           (PL)\n\nLet k \u2208 L^1(R) be any nonnegative, not identically zero function (a \u201cweight\u201d). Multiply (PL) by k(x\u2212y) and integrate over (x,y) \u2208 R^2. Using the change of variables\nu = (1\u2212\u03bb) x + \u03bb y, v = x \u2212 y,\nwith Jacobian determinant 1, we get\n\u222b\u222b h((1\u2212\u03bb)x + \u03bb y) k(x\u2212y) dx dy = (\u222b k) \u222b h(u) du.\n\nThus\n(\u222b k) \u222b h \u2265 \u222b\u222b f(x)^{1\u2212\u03bb} g(y)^\u03bb k(x\u2212y) dx dy.               (1)\n\nApply H\u00f6lder\u2019s inequality on R^2 with exponents p = 1/(1\u2212\u03bb), q = 1/\u03bb (so 1/p + 1/q = 1), to the measure d\u03bc(x,y) = k(x\u2212y) dx dy, and the functions U(x,y) = f(x), V(x,y) = g(y):\n\u222b\u222b f(x)^{1\u2212\u03bb} g(y)^\u03bb k(x\u2212y) dx dy\n= \u222b\u222b U(x,y)^{1/p} V(x,y)^{1/q} d\u03bc\n\u2264 (\u222b\u222b U d\u03bc)^{1/p} (\u222b\u222b V d\u03bc)^{1/q}.                              (2)\n\nCompute the factors:\n\u222b\u222b U d\u03bc = \u222b\u222b f(x) k(x\u2212y) dx dy = (\u222b k) \u222b f,\nand similarly \u222b\u222b V d\u03bc = (\u222b k) \u222b g. Hence (2) yields\nRHS of (1) \u2264 (\u222b k) (\u222b f)^{1\u2212\u03bb} (\u222b g)^\u03bb.\n\nCancelling the common positive factor \u222b k from both sides of (1), we obtain\n\u222b h \u2265 (\u222b f)^{1\u2212\u03bb} (\u222b g)^\u03bb,\nwhich is the one-dimensional PL inequality.\n\n2) Tensorization to R^n\n\nWe proceed by induction on n. The case n = 1 is part (1). Assume the result for dimension n\u22121. Let f,g,h: R^n \u2192 [0,\u221e) satisfy the PL pointwise inequality:\nh((1\u2212\u03bb) x + \u03bb y) \u2265 f(x)^{1\u2212\u03bb} g(y)^\u03bb for all x,y \u2208 R^n.        (PL_n)\n\nSplit x = (x', t), y = (y', s), z = (z', u) with x', y', z' \u2208 R^{n\u22121} and t, s, u \u2208 R. The hypothesis gives, for all x',y',t,s,\nh((1\u2212\u03bb) x' + \u03bb y', (1\u2212\u03bb) t + \u03bb s) \u2265 f(x', t)^{1\u2212\u03bb} g(y', s)^\u03bb.   (3)\n\nFix x', y' and apply the one-dimensional PL (part (1)) in the last coordinate (with respect to t,s,u) to the functions t \u21a6 f(x',t), s \u21a6 g(y',s), u \u21a6 h((1\u2212\u03bb) x' + \u03bb y', u). We obtain\n\u222b_R h((1\u2212\u03bb) x' + \u03bb y', u) du \u2265 ( \u222b_R f(x', t) dt )^{1\u2212\u03bb} ( \u222b_R g(y', s) ds )^\u03bb. (4)\n\nDefine\nF(x') := \u222b_R f(x', t) dt,  G(y') := \u222b_R g(y', s) ds,\nH(z') := \u222b_R h(z', u) du.\nThen (4) reads\nH((1\u2212\u03bb) x' + \u03bb y') \u2265 F(x')^{1\u2212\u03bb} G(y')^\u03bb,  for all x', y' \u2208 R^{n\u22121}.\n\nBy the inductive hypothesis (PL in R^{n\u22121}), we get\n\u222b_{R^{n\u22121}} H \u2265 (\u222b_{R^{n\u22121}} F)^{1\u2212\u03bb} (\u222b_{R^{n\u22121}} G)^\u03bb.\n\nBut \u222b_{R^{n\u22121}} H = \u222b_{R^n} h, and similarly for F and G. Hence\n\u222b_{R^n} h \u2265 (\u222b_{R^n} f)^{1\u2212\u03bb} (\u222b_{R^n} g)^\u03bb,\nwhich is the n-dimensional PL inequality.\n\n3) Brunn\u2013Minkowski from PL\n\nLet A,B \u2282 R^n be nonempty Borel sets with 0 < |A|, |B| < \u221e. For \u03bb \u2208 [0,1], set\nh = 1_{(1\u2212\u03bb) A + \u03bb B}, f = 1_A, g = 1_B.\nThen for any x \u2208 A and y \u2208 B, (1\u2212\u03bb)x + \u03bb y \u2208 (1\u2212\u03bb) A + \u03bb B, so\nh((1\u2212\u03bb) x + \u03bb y) = 1 \u2265 f(x)^{1\u2212\u03bb} g(y)^\u03bb.\nThus (f,g,h) satisfy the PL hypothesis. Applying PL gives the multiplicative bound\n| (1\u2212\u03bb) A + \u03bb B | \u2265 |A|^{1\u2212\u03bb} |B|^\u03bb.                            (5)\n\nTo convert (5) into the additive concavity form, let s := |A|^{1/n} and t := |B|^{1/n}, and define normalized sets A' := s^{\u22121} A and B' := t^{\u22121} B. Then |A'| = |B'| = 1. Using homogeneity of Minkowski addition,\n(1\u2212\u03bb) A + \u03bb B = (1\u2212\u03bb) s A' + \u03bb t B' = ( (1\u2212\u03bb) s + \u03bb t ) [ (1\u2212\u03bc) A' + \u03bc B' ],\nwhere \u03bc := \u03bb t / ( (1\u2212\u03bb) s + \u03bb t ) \u2208 [0,1]. Taking volumes,\n| (1\u2212\u03bb) A + \u03bb B | = ( (1\u2212\u03bb) s + \u03bb t )^n | (1\u2212\u03bc) A' + \u03bc B' |.\n\nApplying (5) to A',B' at parameter \u03bc (noting |A'| = |B'| = 1) yields |(1\u2212\u03bc) A' + \u03bc B'| \u2265 1, hence\n| (1\u2212\u03bb) A + \u03bb B | \u2265 ( (1\u2212\u03bb) s + \u03bb t )^n.\nTaking nth roots gives the Brunn\u2013Minkowski inequality\n| (1\u2212\u03bb) A + \u03bb B |^{1/n} \u2265 (1\u2212\u03bb) |A|^{1/n} + \u03bb |B|^{1/n}.\n\n4) Sharp isoperimetric inequality\n\nLet B denote the unit Euclidean ball in R^n with volume \u03c9_n = |B|. For a bounded Borel set E \u2282 R^n with 0 < |E| < \u221e, define \u03c6(t) := |E + t B|^{1/n} for t \u2265 0. By BM (with A = E, B replaced by tB), the map t \u21a6 \u03c6(t) is concave on [0,\u221e), and the \u201cBM secant\u201d lower bound holds for each t \u2265 0:\n\u03c6(t) \u2265 \u03c6(0) + t |B|^{1/n} = |E|^{1/n} + t \u03c9_n^{1/n}.              (6)\n\nSince \u03c6 is concave, its right derivative \u03c6'(0+) exists and satisfies, for every t > 0,\n(\u03c6(t) \u2212 \u03c6(0)) / t \u2264 \u03c6'(0+).                                      (7)\n\nCombining (6) and (7) yields, for every t > 0,\n\u03c9_n^{1/n} \u2264 (\u03c6(t) \u2212 \u03c6(0)) / t \u2264 \u03c6'(0+).\nTaking liminf as t \u2192 0+ on the middle term and using the chain rule for one-sided derivatives of the map x \u21a6 x^{1/n} at x = |E| (noting \u03c6(0) = |E|^{1/n}), we obtain\n\u03c6'(0+) = (1/n) |E|^{1/n \u2212 1} liminf_{t\u21920+} ( |E + tB| \u2212 |E| ) / t\n= (1/n) |E|^{1/n \u2212 1} P(E).\n\nTherefore\n(1/n) |E|^{1/n \u2212 1} P(E) \u2265 \u03c9_n^{1/n},\nwhich rearranges to the sharp isoperimetric inequality\nP(E) \u2265 n \u03c9_n^{1/n} |E|^{(n\u22121)/n}.\n\nEquality cases. If E is a ball of radius r, then E + tB is a ball of radius r + t, so |E + tB| = \u03c9_n (r + t)^n and hence\nP(E) = lim_{t\u21920+} (\u03c9_n (r + t)^n \u2212 \u03c9_n r^n)/t = n \u03c9_n r^{n\u22121}.\nSince |E| = \u03c9_n r^n, the right-hand side equals n \u03c9_n^{1/n} |E|^{(n\u22121)/n}, and equality holds. More generally, any translate or dilate of B yields equality (homogeneity and translation invariance of both |\u00b7| and P(\u00b7)). Conversely, under additional regularity (e.g., E convex or of finite perimeter), equality in the chain (6)\u2013(7) forces \u03c6 to be linear on [0,\u221e), i.e., |E + tB|^{1/n} = |E|^{1/n} + t \u03c9_n^{1/n} for all t \u2265 0; the Brunn\u2013Minkowski equality case with one summand a Euclidean ball then implies E is a translate/dilate of B. This completes the proof."
    },
    {
        "question": "Title: The Kruskal\u2013Katona theorem \u2014 exact minimal shadow via colex order, canonical binomial expansions, and full equality characterization\n\nLet N = {1,2,3,\u2026}. For k \u2265 1, write C(N,k) for the set of all k-element subsets of N. A k-uniform family is a finite subset F \u2282 C(N,k). Its (lower) shadow is the set\n\u2202F := {B \u2208 C(N,k\u22121) : \u2203 A \u2208 F with B \u2282 A}.\nFor t \u2265 1, define inductively the t-fold lower shadow by \u2202^t F := \u2202(\u2202^{t\u22121} F), with \u2202^0 F := F.\n\nDefine the colexicographic (colex) order on C(N,k) as follows: for distinct A,B \u2208 C(N,k), say A <colex B if max(A \u25b3 B) \u2208 B (where \u25b3 denotes symmetric difference).\n\nFor m \u2265 0, let L_k(m) denote the initial segment of size m of C(N,k) in the colex order (L_k(0) = \u2205).\n\nFor integers i < j, the (i,j)-compression C_{ij} acts on a k-set A by\nC_{ij}(A) = (A \\ {j}) \u222a {i} if j \u2208 A and i \u2209 A, and C_{ij}(A) = A otherwise;\nand on a family F by C_{ij}(F) := {C_{ij}(A) : A \u2208 F} \u222a {A \u2208 F : C_{ij}(A) \u2208 F} (i.e., we move a set if its compressed image is not already in the family; duplicates are removed). Call F left-compressed if C_{ij}(F) = F for all i < j.\n\nFor an integer m \u2265 0 and fixed k \u2265 1, the canonical binomial (Macaulay) expansion of m in degree k is the unique representation\nm = C(a_k,k) + C(a_{k\u22121},k\u22121) + \u2026 + C(a_s,s),\nwhere k \u2265 s \u2265 1, the a\u2019s are strictly decreasing: a_k > a_{k\u22121} > \u2026 > a_s \u2265 s, and C(u,v) = 0 if u < v or v < 0.\n\nProblem. Prove the Kruskal\u2013Katona theorem in full, with equality and higher shadows:\n\n1) Shadow monotonicity under compressions. Prove that for any k-uniform family F and any i < j one has |\u2202(C_{ij}(F))| \u2264 |\u2202F|. Deduce that iterating all compressions yields a left-compressed family F* with |F*| = |F| and |\u2202F*| \u2264 |\u2202F|.\n\n2) Left-compressed families are initial colex segments. Prove that every left-compressed k-uniform family F is a colex initial segment: there exists m such that F = L_k(m).\n\n3) Canonical binomial expansion. Prove existence and uniqueness of the canonical binomial expansion for every m \u2265 0, k \u2265 1. Moreover, show that the colex rank function Rank_k: C(N,k) \u2192 Z_{\u22651} defined by Rank_k(A) = 1 + |{B \u2208 C(N,k) : B <colex A}| satisfies\nRank_k({a_1<\u2026<a_k}) = 1 + \u2211_{t=1}^k C(a_t \u2212 1, t),\nand deduce the standard identity that L_k(m) consists exactly of the k-sets A with \u2211_{t=1}^k C(a_t \u2212 1, t) \u2264 m \u2212 1.\n\n4) Exact shadow of colex initial segments. Let m = C(a_k,k) + \u2026 + C(a_s,s) be the canonical expansion. Prove\n|\u2202 L_k(m)| = C(a_k,k\u22121) + C(a_{k\u22121},k\u22122) + \u2026 + C(a_s,s\u22121).\n(Hint: Split by the maximum element, and use induction with the recursion m = C(a_k,k) + t, 0 \u2264 t < C(a_k,k\u22121).)\n\n5) Kruskal\u2013Katona theorem with equality. Show that for every k-uniform family F with |F| = m,\n|\u2202F| \u2265 |\u2202 L_k(m)|,\nwith equality if and only if F is a colex initial segment (equivalently, F is left-compressed). Conclude that the minimizers are unique up to a permutation of N (which preserves colex).\n\n6) Higher shadows (sharp formula). For t \u2265 1, prove that\n|\u2202^t L_k(m)| = C(a_k,k\u2212t) + C(a_{k\u22121},k\u22121\u2212t) + \u2026 + C(a_s,s\u2212t),\nwith the convention C(u,v) = 0 if v < 0. Deduce the sharp KK bound: For any k-uniform F with |F| = m,\n|\u2202^t F| \u2265 |\u2202^t L_k(m)|.\nExplain how iterating (5) gives (6).\n\nAnswer format:\n- State clearly each intermediate lemma you use and prove it.\n- Your final conclusions must include the exact formulae in (4) and (6), the inequality in (5), and a complete equality characterization.",
        "answer": "We work throughout with finite k-uniform families of subsets of N. All sums of binomial coefficients use the convention C(u,v) = 0 for u < v or v < 0.\n\n1) Shadow monotonicity under compressions.\n\nFix i < j. Let F \u2282 C(N,k) and F' := C_{ij}(F). We prove |\u2202F'| \u2264 |\u2202F| by an explicit injection from the set of \u201cnew\u201d (k\u22121)-sets appearing in \u2202F' but not in \u2202F into the set of \u201clost\u201d (k\u22121)-sets that were in \u2202F but not in \u2202F'.\n\nDefine\nX := \u2202F' \\ \u2202F, Y := \u2202F \\ \u2202F'.\nWe claim there is an injective map \u03c6: X \u2192 Y. This will imply |\u2202F'| = |\u2202F| \u2212 |Y| + |X| \u2264 |\u2202F|.\n\nLet B \u2208 X. Then there exists A' \u2208 F' with B \u2282 A', but B \u2209 \u2202F, hence B is not contained in any member of F. Necessarily A' is of the form A' = C_{ij}(A) for a unique A \u2208 F with j \u2208 A, i \u2209 A (otherwise A' = A \u2208 F and B \u2208 \u2202F, contradiction). Since B \u2282 A' and B \u2284 A, it follows that i \u2208 B (because A' and A differ exactly by swapping j\u2192i). Define\n\u03c6(B) := (B \\ {i}) \u222a {j}.\nWe show \u03c6(B) \u2208 Y:\n\n- \u03c6(B) \u2208 \u2202F because \u03c6(B) \u2282 A and A \u2208 F.\n\n- \u03c6(B) \u2209 \u2202F'. Suppose to the contrary that \u03c6(B) \u2282 T' for some T' \u2208 F'. If j \u2208 T' and i \u2209 T', then T' must be a compressed image of some T \u2208 F with j \u2208 T, i \u2209 T, i.e., T' = C_{ij}(T). But then replacing j by i inside T' gives (T' \\ {j}) \u222a {i} \u2208 F' (by definition of compression); this set contains B (since B is obtained from \u03c6(B) by swapping j\u2192i), so B \u2208 \u2202F', contradicting B \u2209 \u2202F. If instead either (i) i \u2208 T' or (ii) j \u2209 T', then B \u2282 T' forces i \u2208 T', and hence B \u2282 T' \u2208 F' implies B \u2208 \u2202F', again contradicting B \u2209 \u2202F.\n\nThus \u03c6(B) \u2208 \u2202F \\ \u2202F' = Y. Finally, \u03c6 is injective: if B_1 \u2260 B_2 in X, then at least one element of B_1 \u25b3 B_2 is neither i nor j; that element also lies in \u03c6(B_1) \u25b3 \u03c6(B_2), so \u03c6(B_1) \u2260 \u03c6(B_2).\n\nTherefore |\u2202(C_{ij}(F))| \u2264 |\u2202F|. Iterating compressions: Define a weight function w(F) := \u2211_{A\u2208F} \u2211_{a\u2208A} a. Each compression C_{ij} with i < j and j \u2208 A, i \u2209 A strictly decreases the weight of A; since the weight is a nonnegative integer and only finitely many families of given size exist, iterating all C_{ij} eventually stabilizes at a left-compressed family F* with |F*| = |F| and |\u2202F*| \u2264 |\u2202F|.\n\n2) Left-compressed families are initial colex segments.\n\nWe prove: If F \u2282 C(N,k) is left-compressed, then F is a down-set in the colex order; hence F = L_k(|F|).\n\nLet A,B \u2208 C(N,k) with A <colex B. Write A = {a_1<\u2026<a_k}, B = {b_1<\u2026<b_k}. The condition A <colex B means that if s = max{t : a_t \u2260 b_t}, then a_s < b_s and a_t = b_t for all t > s; equivalently, a_t \u2264 b_t for all t with strict inequality at t = s. We claim that from B one can reach A by a sequence of (i,j)-replacements with i < j, i \u2209 current set, j in current set (i.e., exactly the moves permitted in a left-compressed family). Proceed by descending t = s, s\u22121,\u2026,1. At step t, maintain that the current set S has the last k\u2212t coordinates equal to a_{t+1},\u2026,a_k, and that S_t (the t-th smallest element of S) \u2265 a_t. If S_t > a_t, we decrease S_t by 1 using an adjacent compression: if S_t \u2212 1 \u2209 S then apply C_{S_t\u22121, S_t}; if S_t \u2212 1 \u2208 S (so S_{t\u22121} = S_t \u2212 1), first decrease S_{t\u22121} similarly, and continue bubbling the collision leftward. This finite \u201cadjacent slide\u201d strictly lowers the sum of elements, so it terminates. Because a_r \u2264 b_r for all r, and we have already matched the suffix a_{t+1},\u2026,a_k, at each slide the target coordinate a_t is attainable without violating strictly increasing order. By left-compressedness of F, every intermediate step stays in F. After finishing all steps t, we arrive at A. Therefore, for every B \u2208 F and every A <colex B, we also have A \u2208 F. Thus F is a (finite) initial segment in colex, i.e., F = L_k(m) for m = |F|.\n\n3) Canonical binomial expansion and colex rank.\n\nExistence (greedy algorithm). For fixed k and m \u2265 0, let a_k be the largest integer with C(a_k,k) \u2264 m (take a_k = k\u22121 if m = 0). Set m' := m \u2212 C(a_k,k). If m' = 0, stop. Otherwise, let a_{k\u22121} be the largest with C(a_{k\u22121},k\u22121) \u2264 m' and a_{k\u22121} \u2264 a_k \u2212 1 (this last inequality holds automatically for the maximal choice). Continue: at step r, choose a_r the largest with C(a_r,r) \u2264 leftover and a_r \u2264 a_{r+1} \u2212 1; terminate when the leftover becomes 0. We obtain strictly decreasing a\u2019s with a_r \u2265 r and m = \u2211 C(a_r,r).\n\nUniqueness. Suppose m = \u2211_{r=s}^k C(a_r,r) = \u2211_{r=s'}^k C(a'_r,r) are two such expansions with strictly decreasing a-sequences. Let t be the largest index with a_t \u2260 a'_t. WLOG a_t > a'_t. Then\n\u2211_{r=t}^k C(a_r,r) \u2265 C(a_t,t) > \u2211_{r=t}^k C(a'_r,r),\ncontradiction (since the partial sums at higher indices match by maximality of t). Hence the expansion is unique.\n\nColex rank formula. For A = {a_1<\u2026<a_k}, the number of k-sets B with B <colex A equals \u2211_{t=1}^k C(a_t \u2212 1, t): for a fixed t, the sets whose t-th smallest element is strictly less than a_t but whose last coordinates match satisfy that count (a standard combinatorial telescoping; proof by induction on k using the \u201csplit by maximum\u201d recursion described below). Therefore\nRank_k(A) = 1 + \u2211_{t=1}^k C(a_t \u2212 1, t).\nConsequently, L_k(m) = {A \u2208 C(N,k) : \u2211_{t=1}^k C(a_t \u2212 1, t) \u2264 m \u2212 1}.\n\n4) Exact shadow of colex initial segments.\n\nWe prove by induction on k and m the formula:\nIf m = C(a_k,k) + C(a_{k\u22121},k\u22121) + \u2026 + C(a_s,s) is the canonical expansion (k \u2265 s \u2265 1), then\n|\u2202 L_k(m)| = C(a_k,k\u22121) + C(a_{k\u22121},k\u22122) + \u2026 + C(a_s,s\u22121).    (\u2217)\n\nBase cases: If m = 0 then both sides are 0. If k = 1, then L_1(m) consists of the first m singletons, whose shadow is {\u2205} if m \u2265 1 and empty when m = 0; and indeed, the right-hand side is C(a_1,0) = 1 for m \u2265 1 and 0 for m = 0.\n\nInductive step: Write\nm = C(a,k) + t with a = a_k, 0 \u2264 t < C(a,k\u22121).\nIn colex, all k-sets with max \u2264 a precede those with max = a+1; hence\nL_k(m) = [all k-sets from [a]] \u2294 [{a+1} \u222a S : S \u2208 L_{k\u22121}(t)],\ndisjoint union. The shadow splits accordingly:\n\n- The shadow of all k-sets from [a] is all (k\u22121)-sets from [a], of size C(a,k\u22121).\n\n- The shadow of {a+1} \u222a L_{k\u22121}(t) consists of two disjoint parts: removing a+1 yields exactly L_{k\u22121}(t) (which lies entirely in C([a],k\u22121) and is already counted in the first bullet), and removing an element from S contributes {a+1} \u222a \u2202(L_{k\u22121}(t)), which is disjoint from C([a],k\u22121).\n\nTherefore\n|\u2202 L_k(m)| = C(a,k\u22121) + |\u2202 L_{k\u22121}(t)|.\nBy induction applied to k\u22121 and t with the canonical expansion t = C(a_{k\u22121},k\u22121) + \u2026 + C(a_s,s), we get\n|\u2202 L_{k\u22121}(t)| = C(a_{k\u22121},k\u22122) + \u2026 + C(a_s,s\u22121).\nThus (\u2217) holds.\n\n5) Kruskal\u2013Katona with equality.\n\nLet F \u2282 C(N,k) with |F| = m. By (1) there is a left-compressed F* with |F*| = m and |\u2202F*| \u2264 |\u2202F|. By (2), F* = L_k(m). Hence\n|\u2202F| \u2265 |\u2202F*| = |\u2202 L_k(m)|.\nThis proves the inequality.\n\nEquality characterization. If |\u2202F| = |\u2202 L_k(m)|, then compressions did not decrease the shadow, so |\u2202(C_{ij}(F))| = |\u2202F| for all i < j. By the strictness in the argument of (1) (the injection \u03c6 strictly reduces |\u2202| unless no \u201cmovable\u201d sets exist), this forces C_{ij}(F) = F for all i < j; i.e., F is left-compressed. By (2), F = L_k(m). Conversely, for any permutation \u03c3 of N, \u03c3(L_k(m)) is also a colex initial segment (colex is invariant under relabeling), has the same shadow size, and is left-compressed after reordering the labels accordingly. Therefore the minimizers are exactly the colex initial segments up to relabeling.\n\n6) Higher shadows (sharp formula).\n\nWe claim that for t \u2265 1 and m with canonical expansion as above,\n|\u2202^t L_k(m)| = C(a_k,k \u2212 t) + C(a_{k\u22121},k\u22121 \u2212 t) + \u2026 + C(a_s,s \u2212 t),\nwith C(u,v) = 0 if v < 0. This is proved by iterating the one-step formula (4): apply (4) to L_k(m) to get |\u2202 L_k(m)|. Now observe that \u2202 L_k(m) equals L_{k\u22121}(m') where\nm' = C(a_k,k\u22121) + \u2026 + C(a_s,s\u22121)\n(the same induction as in (4) shows that \u2202 preserves the \u201ccolex-initiality\u201d and updates the canonical expansion by lowering the lower index by 1). Repeating t times yields the stated formula. Consequently, for any F with |F| = m,\n|\u2202^t F| \u2265 |\u2202^t L_k(m)|,\nby iterating (5) t times.\n\nThis completes the proof of the Kruskal\u2013Katona theorem, with the exact shadow size of colex initial segments, the full equality characterization, and the sharp higher-shadow bounds.\n\nSummary of final formulae:\n\n- Canonical expansion: m = \u2211_{r=s}^k C(a_r,r) with a_k > \u2026 > a_s \u2265 s.\n\n- One-step minimal shadow:\n|\u2202F| \u2265 C(a_k,k\u22121) + C(a_{k\u22121},k\u22122) + \u2026 + C(a_s,s\u22121),\nwith equality iff F is a colex initial segment (up to relabeling).\n\n- t-step minimal shadow:\n|\u2202^t F| \u2265 C(a_k,k\u2212t) + C(a_{k\u22121},k\u22121\u2212t) + \u2026 + C(a_s,s\u2212t).\n\nRemarks:\n- The decomposition underlying (4) and (6) is the \u201csplit by maximum\u201d in colex, together with the recursive structure of initial segments.\n- The proof shows that compressions monotonically decrease both the weight and the shadow, driving families to their colex extremizers."
    },
    {
        "question": "Title: Nielsen\u2013Schreier via Schreier generators \u2014 freeness of subgroups of free groups, the finite-index rank formula, and an explicit congruence-subgroup basis\n\nLet X be a finite nonempty set, |X| = n \u2265 1, and let F = F(X) be the free group on X. We view elements of F as reduced words in the alphabet X \u222a X^{-1}; concatenation followed by free reduction is the group operation. The identity is the empty word.\n\nFor a subgroup H \u2264 F, a left transversal T \u2282 F is a set of representatives containing exactly one element from each left coset Hg (and in particular 1 \u2208 T represents H = H\u00b71). For g \u2208 F, write overline{g} \u2208 T for its T-representative (i.e., H\u00b7overline{g} = H\u00b7g). Say that T is a Schreier transversal if whenever t \u2208 T has a reduced word t = y_1 y_2 \u22ef y_r with y_j \u2208 X \u222a X^{-1}, then each prefix y_1 \u22ef y_j also lies in T.\n\nFor t \u2208 T and a \u2208 X, define the (possibly trivial) element s(t,a) := t a (overline{t a})^{-1} \u2208 H; if t a \u2208 T then s(t,a) = 1. Let S(T,X) := { s(t,a) \u2260 1 : t \u2208 T, a \u2208 X }.\n\nTasks.\n\n1) Schreier rewriting and generation. Prove that for every subgroup H \u2264 F and every left transversal T (not necessarily Schreier), one has s(t,a) \u2208 H for all t \u2208 T, a \u2208 X \u222a X^{-1} (interpreting s(t,a^{-1}) as t a^{-1} (overline{t a^{-1}})^{-1}). Show the Schreier rewriting identity: for any reduced word w = y_1 \u22ef y_m \u2208 F with y_j \u2208 X \u222a X^{-1}, define t_0 := 1 and t_j := overline{y_1 \u22ef y_j} \u2208 T. Then in F,\nw = [\u220f_{j=1}^m u_j] \u00b7 t_m,\nwhere u_j = s(t_{j-1}, y_j) if y_j \u2208 X, and u_j = s(t_j, y_j^{-1})^{-1} if y_j \u2208 X^{-1}. Deduce that if w \u2208 H then w \u2208 \u27e8 S(T,X) \u27e9. Conclude: H is generated by S(T,X) for every left transversal T.\n\n2) Freeness (Nielsen\u2013Schreier). Prove that every subgroup H \u2264 F(X) is a free group. More precisely, show that if T is a Schreier transversal, then S(T,X) is a free basis of H. You must give a complete, self-contained proof; a suggested route is:\n- Construct a map \u03a6: F(S) \u2192 F(X) sending each generator s(t,a) to t a (overline{t a})^{-1}, and show Im \u03a6 = H using (1).\n- Define a \u201cSchreier rewriting\u201d map \u03c1: words in X \u222a X^{-1} \u2192 words in S, as in (1), and prove \u03c1 \u2218 \u03a6 is the identity on F(S). Conclude \u03a6 is injective and hence an isomorphism F(S) \u2245 H, so H is free with free basis S(T,X).\n\n3) Schreier finite-index rank formula. Suppose [F:H] = m < \u221e. Prove that for a Schreier transversal T, the set S(T,X) has cardinality |S(T,X)| = 1 + m (n \u2212 1). Conclude the rank of H is\nrank(H) = 1 + m (n \u2212 1).\nHint: Consider the Schreier coset graph \u0393 with vertex set H\\F (|V(\u0393)| = m) and, for each v \u2208 V(\u0393) and a \u2208 X, an undirected a-labeled edge between v and v\u00b7a. Show \u0393 is connected with exactly m n undirected edges. A spanning tree of \u0393 has m\u22121 edges; argue that the non-tree edges correspond bijectively to generators in S(T,X).\n\n4) Explicit congruence-subgroup basis. Let F_n = \u27e8 x_1, \u2026, x_n \u27e9 be the free group on n generators. For a fixed integer k \u2265 2, define a surjection \u03c6_k: F_n \u2192 Z/kZ by \u03c6_k(x_i) = 1 mod k for all i. Let H_k := ker \u03c6_k.\n- Show [F_n : H_k] = k and hence rank(H_k) = 1 + k (n \u2212 1).\n- Choose the Schreier transversal T = { 1, x_1, x_1^2, \u2026, x_1^{k\u22121} } (a Schreier transversal for H_k), and compute S(T,X). Prove that the following set is a free basis of H_k:\nB = { x_1^k } \u222a { x_1^i x_j x_1^{\u2212(i+1)} : 0 \u2264 i \u2264 k\u22121, 2 \u2264 j \u2264 n }.\nVerify |B| = 1 + k (n \u2212 1) and that \u27e8B\u27e9 = H_k.\n\nAnswer format: Provide a single coherent write-up proving (1)\u2013(4), with all definitions used and all steps justified. You may not invoke topological covering space theory; stay within combinatorial group theory as outlined.",
        "answer": "We write F = F(X) for the free group on the finite alphabet X, with reduced words over X \u222a X^{-1} and free reduction. For a subgroup H \u2264 F and a left transversal T \u2282 F (so 1 \u2208 T and each left coset Hg has a unique representative in T), we denote by overline{g} \u2208 T the T-representative of g. A Schreier transversal additionally has the prefix-closed property on reduced words.\n\n1) Schreier rewriting and generation.\n\nLet t \u2208 T and a \u2208 X \u222a X^{-1}. Since overline{t a} \u2208 T represents the left coset H t a, we have H t a = H overline{t a}, hence (t a) (overline{t a})^{-1} \u2208 H. Thus s(t,a) := t a (overline{t a})^{-1} \u2208 H for all such t,a.\n\nLet w = y_1 y_2 \u22ef y_m be a reduced word in X \u222a X^{-1}. Define t_0 := 1 and t_j := overline{y_1 \u22ef y_j} for j \u2265 1. For each step, we distinguish the two types of letters.\n\nCase y_j = a \u2208 X. Set u_j := s(t_{j-1}, a) = t_{j-1} a (t_j)^{-1}.\n\nCase y_j = a^{-1} with a \u2208 X. Then t_j = overline{ t_{j-1} a^{-1} }, and\ns(t_j, a) = t_j a ( overline{t_j a} )^{-1}.\nBut H\u00b7overline{ t_j a } = H\u00b7(t_j a) = H\u00b7(t_{j-1} a^{-1} a) = H\u00b7t_{j-1}, so overline{ t_j a } = t_{j-1}. Therefore s(t_j, a)^{-1} = t_{j-1} a^{-1} (t_j)^{-1}. Set u_j := s(t_j, a)^{-1}.\n\nIn either case, u_j = t_{j-1} y_j (t_j)^{-1}. Multiplying and telescoping:\n\u220f_{j=1}^m u_j = (t_0 y_1 t_1^{-1})(t_1 y_2 t_2^{-1})\u22ef(t_{m-1} y_m t_m^{-1}) = t_0 (y_1\u22efy_m) t_m^{-1} = w t_m^{-1}.\nHence\nw = [\u220f_{j=1}^m u_j] \u00b7 t_m.                                   (\u2217)\n\nEach u_j is either s(t_{j-1}, a) or s(t_j, a)^{-1}, so the product \u220f u_j lies in the subgroup \u27e8 S(T,X) \u27e9 generated by { s(t,a) : t \u2208 T, a \u2208 X }. If w \u2208 H, then t_m = overline{w} = 1, and w = \u220f u_j \u2208 \u27e8 S(T,X) \u27e9. Since every h \u2208 H can be written as such a w, we conclude H = \u27e8 S(T,X) \u27e9 for any left transversal T.\n\n2) Freeness (Nielsen\u2013Schreier).\n\nFix a Schreier transversal T. Define F(S) to be the free group on the alphabet S := S(T,X). Define a homomorphism \u03a6: F(S) \u2192 F(X) by \u03a6(s(t,a)) = t a (overline{t a})^{-1}. By (1), Im \u03a6 = \u27e8S\u27e9 = H, so \u03a6 is surjective onto H.\n\nWe now define a rewriting map \u03c1 from words over X \u222a X^{-1} to words over S, adapted to T. For a reduced word w = y_1 \u22ef y_m with y_j \u2208 X \u222a X^{-1}, define t_0 := 1 and t_j := overline{ y_1 \u22ef y_j } as in (1), and set\n\u03c1(w) := \u220f_{j=1}^m v_j,\nwhere v_j := s(t_{j-1}, y_j) if y_j \u2208 X, and v_j := s(t_j, y_j^{-1})^{-1} if y_j \u2208 X^{-1}.\nNote that v_j \u2208 S^{\u00b11}; in particular, \u03c1(w) is a word over S.\n\nWe claim:\n\n(a) For every reduced word w, \u03a6(\u03c1(w)) = w \u00b7 (overline{w})^{-1}. This is exactly the identity (\u2217) from (1), since \u03a6(v_j) = u_j. In particular, if w \u2208 H (so overline{w} = 1), then \u03a6(\u03c1(w)) = w. Hence \u03a6 is surjective onto H and \u03c1 yields a set-theoretic right inverse of \u03a6|_H.\n\n(b) For every generator s = s(t,a) \u2208 S, one has \u03c1(\u03a6(s)) = s. Indeed, \u03a6(s(t,a)) = t a (overline{t a})^{-1}. Apply the definition of \u03c1 to the reduced word t a (overline{t a})^{-1}. Because T is Schreier (prefix-closed), along the prefix t (and then the letter a), the successive representatives are precisely the successive prefixes in T; in particular, over the word t a the sequence t_0, \u2026, t_{|t|}, t_{|t|+1} is exactly (1, prefixes of t, overline{t a}). The \u03c1-rewriting picks no letters from the prefix t (as each step keeps us in T), then contributes exactly s(t,a) at the letter a, and then picks no letters along (overline{t a})^{-1} (again staying in T). Thus \u03c1(\u03a6(s(t,a))) = s(t,a).\n\nSince \u03c1 is multiplicative on concatenations that do not create cancellations across letter boundaries in X \u222a X^{-1} (and can be made multiplicative by inserting free reductions in a routine way), (b) implies that \u03c1 \u2218 \u03a6 is the identity on the generators S and hence on all of F(S). Therefore \u03a6: F(S) \u2192 H is injective. As we already know Im \u03a6 = H, it follows \u03a6 is an isomorphism:\nH \u2245 F(S),\ni.e. H is free with free basis S(T,X). This proves the Nielsen\u2013Schreier theorem.\n\nRemarks on the Schreier condition. The crucial use of a Schreier transversal is to ensure that when reading prefixes, all T-representatives are the literal prefixes; this guarantees that \u03c1(\u03a6(s(t,a))) = s(t,a) with no spurious cancellations and underlies the injectivity argument.\n\n3) Schreier finite-index rank formula.\n\nAssume [F:H] = m < \u221e. Consider the Schreier coset graph \u0393 with vertex set V(\u0393) = H\\F (so |V| = m). For each v = Hg \u2208 V and each a \u2208 X, include an undirected edge labeled a between v and v\u00b7a := Hg a. (Equivalently, include the two oppositely oriented edges labeled a and a^{-1}.)\n\nBasic properties:\n- \u0393 is connected: from H to any Hg there is a path labeled by a reduced word for g.\n- Each vertex has degree 2n in the directed sense, and there are exactly m n undirected edges: every pair (v,a) gives a directed a-edge, and undirected edges identify opposite directions, yielding (2 m n)/2 = m n undirected edges.\n\nChoose a spanning tree \u03a5 of \u0393 (in the undirected sense). Then \u03a5 has m \u2212 1 edges. Fix the root at H \u2208 V(\u0393). For each vertex v, let t_v be the label (reduced word in X \u222a X^{-1}) of the unique simple path in \u03a5 from H to v; the prefix-closed family { t_v : v \u2208 V } is a Schreier transversal T. Moreover, t_{v\u00b7a} = overline{t_v a} for every a \u2208 X. With this choice, s(t_v, a) \u2260 1 if and only if the undirected a-edge between v and v\u00b7a does not belong to \u03a5 (equivalently, adding that edge closes a unique simple cycle with \u03a5).\n\nTherefore S(T,X) is in bijection with the set of non-tree undirected edges of \u0393. Counting gives\n|S(T,X)| = |E(\u0393)| \u2212 |E(\u03a5)| = (m n) \u2212 (m \u2212 1) = 1 + m (n \u2212 1).\nBy (2), S(T,X) is a free basis of H. Hence\nrank(H) = |S(T,X)| = 1 + m (n \u2212 1).\n\n4) Explicit congruence-subgroup basis.\n\nLet F_n = \u27e8 x_1, \u2026, x_n \u27e9, and define \u03c6_k: F_n \u2192 Z/kZ by \u03c6_k(x_i) = 1 mod k for all i. This is a surjective homomorphism because the image of x_1 generates Z/kZ. Its kernel H_k := ker \u03c6_k has index k:\n[F_n : H_k] = |Im \u03c6_k| = k.\n\nBy (3), rank(H_k) = 1 + k (n \u2212 1).\n\nWe exhibit an explicit Schreier transversal and compute S(T,X). Take\nT = { 1, x_1, x_1^2, \u2026, x_1^{k\u22121} }.\nThis is a Schreier transversal for H_k: every coset is represented by x_1^i with 0 \u2264 i \u2264 k\u22121, and all prefixes of x_1^i (i.e., x_1^j for j \u2264 i) lie in T.\n\nCompute the Schreier generators s(t,a) with t = x_1^i.\n\n- For a = x_1: For 0 \u2264 i \u2264 k\u22122, one has overline{ x_1^i x_1 } = x_1^{i+1} \u2208 T, so s(x_1^i, x_1) = 1. For i = k\u22121, x_1^{k\u22121} x_1 = x_1^k, and \u03c6_k(x_1^k) = 0, so overline{ x_1^k } = 1. Thus\ns(x_1^{k\u22121}, x_1) = x_1^k.\nThis gives the single generator x_1^k.\n\n- For a = x_j with 2 \u2264 j \u2264 n: For 0 \u2264 i \u2264 k\u22121, the coset of x_1^i x_j is determined by \u03c6_k(x_1^i x_j) = i + 1 mod k, hence overline{ x_1^i x_j } = x_1^{i+1}. Therefore\ns(x_1^i, x_j) = x_1^i x_j (x_1^{i+1})^{\u22121} = x_1^i x_j x_1^{\u2212(i+1)}.\nThese are k(n\u22121) generators as i ranges over 0,\u2026,k\u22121 and j over 2,\u2026,n.\n\nCollecting, the nontrivial Schreier generators are\nB = { x_1^k } \u222a { x_1^i x_j x_1^{\u2212(i+1)} : 0 \u2264 i \u2264 k\u22121, 2 \u2264 j \u2264 n }.\nBy (2), B is a free basis of H_k. Clearly |B| = 1 + k (n \u2212 1), agreeing with the rank formula. Finally, \u27e8B\u27e9 = H_k because \u03c6_k maps each element of B to 0 and (by (1)) B generates H_k.\n\nThis completes the proof of all items."
    },
    {
        "question": "Title: The algorithmic Lov\u00e1sz Local Lemma \u00e0 la Moser\u2013Tardos, with witness trees and two sharp applications (sparse k-CNF satisfiability and 2-colorability of k-uniform hypergraphs)\n\nLet X = (X_1,\u2026,X_n) be a finite family of mutually independent random variables, each taking values in some finite set, distributed according to the product measure. A bad event A is any event determined by the values of a subset var(A) \u2286 {X_1,\u2026,X_n}. For two bad events A,B we write A \u223c B if var(A) \u2229 var(B) \u2260 \u2205 and call G the dependency graph on the set of bad events with edge-set E(G) = { {A,B} : A \u223c B }. For A, write \u0393(A) for its open neighborhood {B: B \u223c A}, and \u0393\u207a(A) := \u0393(A) \u222a {A} for the closed neighborhood.\n\nWe consider the Moser\u2013Tardos resampling algorithm on a finite family of bad events F = {A_1,\u2026,A_m}: draw an initial product sample \u03c9 of the variables; while some A \u2208 F is true under the current assignment, pick any such A and resample freshly and independently all variables in var(A), leaving all other variables unchanged; repeat until no bad event holds.\n\nProblem (self-contained). Prove the following in order.\n\n1) Witness trees and the witness-tree lemma. For a fixed execution of the algorithm and for each resampling step t (the t-th resampled bad event is denoted R_t), define the witness tree T_t as follows. T_t is a rooted, vertex-labeled tree whose root is labeled by R_t. Process earlier resamplings in reverse time s = t\u22121,t\u22122,\u2026,1; if R_s is not adjacent in G to any current label in T_t, skip it; otherwise attach a new node labeled R_s as a child of the deepest already placed vertex whose label is adjacent to R_s in G. Prove:\n   a) Every T_t is proper: along each edge parent\u2013child the two labels are adjacent in G; siblings have distinct labels; and every label appears finitely often.\n   b) (Witness-tree lemma) For any fixed proper witness tree T (with specified labels from F), the probability that T occurs as T_t for some step t of the algorithm is at most \u220f_{v\u2208V(T)} P(label(v)).\n\n   Hint: Work with a resampling table: for each variable X_i fix an infinite i.i.d. stack (X_i(1), X_i(2),\u2026) of samples; the run is determined by these stacks; the event that a given T occurs depends only on disjoint blocks of these stacks and factors as a product.\n\n2) Algorithmic Local Lemma (Moser\u2013Tardos). Suppose that to every bad event A \u2208 F we assign a real x(A) \u2208 (0,1) such that\n   P(A) \u2264 x(A) \u220f_{B\u2208\u0393\u207a(A)} (1 \u2212 x(B)).\n   Prove that the Moser\u2013Tardos algorithm terminates almost surely and that the expected number of resamplings of any fixed bad event A is at most x(A)/(1 \u2212 x(A)). In particular, the expected total number of resamplings is at most \u2211_{A\u2208F} x(A)/(1 \u2212 x(A)).\n\n   You must give a complete proof from (1): enumerate witness trees rooted at A, bound their probabilities via (1b), and dominate their total weight by a Galton\u2013Watson\u2013type branching process on the closed neighborhoods \u0393\u207a(\u00b7). You may reparameterize via \u03bc(A) := x(A)/(1 \u2212 x(A)) if convenient.\n\n3) Application 1 \u2014 sparse k-CNF is satisfiable. Consider a CNF formula on boolean variables with m clauses, each clause containing exactly k distinct literals (k \u2265 2). Suppose each clause shares variables with at most d other clauses (i.e., in the dependency graph each vertex has degree \u2264 d). Show that if\n   e \u00b7 2^{\u2212k} \u00b7 (d + 2) \u2264 1,\n   then the formula is satisfiable. Moreover, the Moser\u2013Tardos algorithm finds a satisfying assignment in expected O(m) resamplings. Your constants must be explicit: choose a single x \u2208 (0,1) for all clauses, optimize x(1 \u2212 x)^{d+1}, and conclude.\n\n4) Application 2 \u2014 2-colorability of k-uniform hypergraphs. Let H be a k-uniform hypergraph (each edge has size k). Assume the maximum edge-degree \u0394 is such that every edge intersects at most \u0394 other edges. Show that if\n   e \u00b7 2^{1\u2212k} \u00b7 (\u0394 + 2) \u2264 1,\n   then H admits a proper 2-coloring (of vertices) with no monochromatic edges. Again, argue via the algorithmic LLL under the random 2-coloring of vertices, and conclude that the Moser\u2013Tardos algorithm that resamples the colors of the vertices of any currently monochromatic edge terminates in expected O(|E(H)|) resamplings.\n\nAnswer format:\n- State and prove (1a) and (1b) rigorously, with the resampling-table model.\n- Prove (2) completely: derive the resampling bounds via the branching process on \u0393\u207a(\u00b7) and summing over witness trees; deduce almost-sure termination from finiteness of the expectation.\n- Prove (3) with explicit numerical choices, giving the expected-resampling bound O(m).\n- Prove (4) analogously with explicit constants and expected-resampling bound O(|E(H)|).",
        "answer": "We work throughout in the product probability space of the independent variables X_1,\u2026,X_n, each with a finite state space, and we use the Moser\u2013Tardos resampling-table model to make independence transparent.\n\nPart 1. Witness trees and their probability\n\nDefinitions. Fix a run of the algorithm. Let the sequence of resampled bad events be (R_1, R_2, \u2026, R_T), where T may be random (possibly infinite). For a given time t, we build a rooted, labeled tree T_t as follows. Start with a root node labeled by R_t. Then, sweeping s = t\u22121, t\u22122,\u2026,1:\n- If R_s is not adjacent in G to any label already present in the current tree, skip s.\n- Otherwise, among the current nodes whose labels are adjacent to R_s, choose one of maximum depth (if there are several, pick the unique one that was created latest in the reverse-time sweep; this deterministic tie-breaking rule will not matter), and attach a new child to it, labeled R_s.\n\nCall any rooted, labeled tree proper if every child\u2019s label is adjacent (in G) to its parent\u2019s label and among the children of any fixed node all labels are distinct.\n\n1a) Properness of T_t. Along any edge parent\u2013child, adjacency follows immediately from the construction rule: a node labeled R_s is attached as a child only to an existing vertex whose label is adjacent to R_s. To see sibling distinctness, suppose two children of a fixed parent u carry the same label B. Let their creation times be s_1 > s_2. At time s_2 in the reverse sweep, the more recent one (created at s_1) was already present and adjacent to B, so the algorithm would have attached the new node labeled B to that deepest adjacent node (namely the one with label B that is a descendant), not as a sibling of the first. This contradicts the construction rule. Since the run resamples finitely many times up to time t, the construction places finitely many nodes and terminates. Thus T_t is proper.\n\nResampling-table model. For each variable X_i fix an infinite stack (X_i(1), X_i(2), \u2026) of i.i.d. samples according to the law of X_i; the entire algorithmic run is a deterministic function of this table: each time a variable X_i is resampled, it consumes the next unused value from its stack. The stacks are mutually independent, and distinct uses of a given stack are independent by construction.\n\n1b) Witness-tree lemma. Fix a proper witness tree T with labels in F. We show:\nP(\u2203 t: T_t = T) \u2264 \u220f_{v\u2208V(T)} P(label(v)).\n\nProof. For each vertex v of T, let A_v denote its label, and let S_v be the set of variables in var(A_v). Observe that in the resampling-table model, the truth value of A_v at the moment it is resampled depends only on the fresh entries of the stacks of variables in S_v used at that time (the \u201clocal slice\u201d of the table for v). Moreover, distinct vertices of T, even if their labels share variables, use disjoint slices of the resampling table: along any root-to-leaf path, whenever a variable is resampled at a child, it uses a strictly later entry in its stack than at the parent; for nodes that are not ancestrally related, the sets of resampling times are disjoint, hence their slices are disjoint as well. Therefore, the collection of slices indexed by v \u2208 V(T) are mutually independent.\n\nDefine the compatibility event E_T that, when reading from the resampling table, all A_v occur (are true) at the respective resampling moments corresponding to the nodes v of T and with the parent\u2013child adjacency constraints of T. Since the slice for v determines whether A_v is true at that resampling moment, and the slices over v are independent, we have\nP(E_T) = \u220f_{v\u2208V(T)} P(A_v).\nIn any run that actually produces T as some T_t, all these local occurrences must happen; thus {\u2203 t: T_t = T} \u2286 E_T, and consequently\nP(\u2203 t: T_t = T) \u2264 P(E_T) = \u220f_{v} P(A_v).\nThis proves the witness-tree lemma.\n\nPart 2. The algorithmic Local Lemma (Moser\u2013Tardos)\n\nAssumption. For each bad event A \u2208 F, fix x(A) \u2208 (0,1) such that\n(LLL) P(A) \u2264 x(A) \u220f_{B\u2208\u0393\u207a(A)} (1 \u2212 x(B)).\n\nGoal. Show that the expected number of resamplings of any given A is at most x(A)/(1 \u2212 x(A)), hence the total expected number of resamplings is at most \u2211_A x(A)/(1 \u2212 x(A)) and the algorithm terminates almost surely.\n\nWe reparametrize via \u03bc(A) := x(A)/(1 \u2212 x(A)) \u2208 (0,\u221e). Then\nx(A) = \u03bc(A)/(1 + \u03bc(A)) and 1 \u2212 x(A) = 1/(1 + \u03bc(A)), so (LLL) becomes\nP(A) \u2264 \u03bc(A) / \u220f_{B\u2208\u0393\u207a(A)} (1 + \u03bc(B)).         (\u22c6)\n\nWitness-tree enumeration. Fix A \u2208 F. Every time the algorithm resamples A, it produces a proper witness tree T rooted at A. By linearity of expectation and the witness-tree lemma, the expected number of resamplings of A is at most\nE[#(resamples of A)] \u2264 \u2211_{T \u2208 W_A} \u220f_{v\u2208V(T)} P(label(v)),\nwhere W_A denotes the (finite or countable) family of all proper witness trees whose root is labeled A. Using (\u22c6),\n\u220f_{v\u2208V(T)} P(label(v)) \u2264 \u220f_{v\u2208V(T)} [ \u03bc(label(v)) / \u220f_{C\u2208\u0393\u207a(label(v))} (1 + \u03bc(C)) ].\n\nDefine the weight\nw(T) := \u220f_{v\u2208V(T)} \u03bc(label(v)) / \u220f_{v\u2208V(T)} \u220f_{C\u2208\u0393\u207a(label(v))} (1 + \u03bc(C)).\nThen\nE[#(resamples of A)] \u2264 \u2211_{T\u2208W_A} w(T).        (1)\n\nBranching process bound. Consider the following Galton\u2013Watson\u2013type branching process that produces random proper labeled trees starting from a root labeled A. Given a vertex with label B, for each C \u2208 \u0393\u207a(B) we independently include a child labeled C with probability\np(C) := \u03bc(C)/(1 + \u03bc(C)),\nand omit it with probability 1 \u2212 p(C) = 1/(1 + \u03bc(C)). Siblings are thus automatically distinct (at most one child per label C). The probability that this process produces exactly a given proper tree T (with root A) is\nq(T) = \u220f_{v\u2208V(T)} [ \u220f_{C\u2208\u0393\u207a(label(v)) \\ ChildLabels(v)} (1 \u2212 p(C)) ] \u00d7 \u220f_{u child of v} p(label(u)),\nwhere ChildLabels(v) is the set of labels of the children of v in T. Using p(C) and 1 \u2212 p(C) as above, we can rewrite q(T) as\nq(T) = [ \u220f_{v\u2208V(T)} \u220f_{C\u2208\u0393\u207a(label(v))} (1 + \u03bc(C))^{\u22121} ] \u00d7 \u220f_{u\u2260root} \u03bc(label(u)).\nTherefore,\nq(T) = [ \u220f_{v\u2208V(T)} \u03bc(label(v)) ] \u00d7 [ \u220f_{v\u2208V(T)} \u220f_{C\u2208\u0393\u207a(label(v))} (1 + \u03bc(C))^{\u22121} ] \u00d7 1/\u03bc(A)\n     = w(T) \u00d7 1/\u03bc(A).\nEquivalently,\nw(T) = \u03bc(A) q(T).                                   (2)\n\nSince the branching process defines a bona fide probability distribution over (finite) proper trees rooted at A, we have \u2211_{T\u2208W_A} q(T) \u2264 1. Therefore, by (2),\n\u2211_{T\u2208W_A} w(T) = \u03bc(A) \u2211_{T\u2208W_A} q(T) \u2264 \u03bc(A).     (3)\n\nCombining (1) and (3) yields\nE[#(resamples of A)] \u2264 \u03bc(A) = x(A)/(1 \u2212 x(A)).\nSumming over A gives the total expected number of resamplings \u2264 \u2211_A x(A)/(1 \u2212 x(A)). In particular, the expected total number is finite, hence the algorithm terminates almost surely (a nonnegative integer-valued random variable with finite expectation is almost surely finite). When it terminates, no bad event holds, so the final assignment avoids all bad events. This proves Part 2.\n\nRemark (symmetric form). If P(A) \u2264 p for all A and each A has at most d neighbors in G (so |\u0393\u207a(A)| \u2264 d+1), then choosing a common x \u2208 (0,1) with p \u2264 x (1 \u2212 x)^{d+1} suffices. The function f(x) = x (1 \u2212 x)^{d+1} is maximized at x* = 1/(d+2) with value f(x*) = (1/(d+2)) ((d+1)/(d+2))^{d+1} \u2265 1/(e(d+2)). Thus the sufficient condition is\ne p (d + 2) \u2264 1.\nWe will use this in the applications.\n\nPart 3. Application to sparse k-CNF\n\nSetup. Let F be a k-CNF with m clauses, each of length k (k \u2265 2), over boolean variables. Let the dependency graph connect two clauses if they share a variable (in any polarity). Suppose each clause has at most d neighbors (shares variables with at most d other clauses). Let the product space be the uniform random assignment of truth values to variables.\n\nBad events. For each clause C, define A_C to be the event \u201cC is falsified.\u201d Since a random assignment satisfies a given k-clause with probability 1 \u2212 2^{\u2212k}, we have P(A_C) = 2^{\u2212k} for all C.\n\nApplying the algorithmic LLL. Use the symmetric choice x(C) = x for all C. As |\u0393\u207a(C)| \u2264 d + 1 and P(A_C) = 2^{\u2212k}, the sufficient condition P(A_C) \u2264 x (1 \u2212 x)^{d+1} is met if\n2^{\u2212k} \u2264 x (1 \u2212 x)^{d+1}.\nOptimizing the RHS in x gives the upper envelope 1/(e(d+2)), hence it suffices that\ne \u00b7 2^{\u2212k} \u00b7 (d + 2) \u2264 1.\nUnder this condition, the hypothesis of Part 2 holds, so with probability 1 the Moser\u2013Tardos algorithm terminates with a satisfying assignment. Moreover, the expected number of resamplings is at most\n\u2211_{C} x/(1 \u2212 x) \u2264 m \u00b7 (x*/(1 \u2212 x*)) = m \u00b7 ( (1/(d+2)) / (1 \u2212 1/(d+2)) ) = m \u00b7 (1/(d+1)) = O(m),\nwhere we used x* = 1/(d+2). Thus the algorithm achieves expected O(m) resamplings (each resampling touches k variables), and finds a satisfying assignment.\n\nConclusion. If e \u00b7 2^{\u2212k} \u00b7 (d + 2) \u2264 1, the k-CNF is satisfiable, and the Moser\u2013Tardos algorithm finds a satisfying assignment in expected O(m) resamplings.\n\nPart 4. Application to 2-colorability of k-uniform hypergraphs\n\nSetup. Let H = (V,E) be k-uniform. The dependency graph on edges connects e \u2260 f if e \u2229 f \u2260 \u2205. Suppose each edge intersects at most \u0394 other edges, so deg_G(e) \u2264 \u0394 and |\u0393\u207a(e)| \u2264 \u0394 + 1. Color the vertices independently and uniformly in {red, blue}.\n\nBad events. For each edge e, let A_e be the event \u201ce is monochromatic.\u201d In a random 2-coloring, P(A_e) = 2 \u00b7 2^{\u2212k} = 2^{1\u2212k}.\n\nApplying the algorithmic LLL. Choose x(e) = x (symmetric). We require\n2^{1\u2212k} \u2264 x (1 \u2212 x)^{\u0394+1}.\nAs before, the RHS is maximized at x* = 1/(\u0394+2) with value \u2265 1/(e(\u0394+2)). Hence it suffices that\ne \u00b7 2^{1\u2212k} \u00b7 (\u0394 + 2) \u2264 1.\nUnder this condition, the Moser\u2013Tardos algorithm (which, when it finds a monochromatic edge e, resamples the colors of the vertices of e) terminates almost surely with a proper 2-coloring. The expected total number of resamplings is at most\n|E| \u00b7 x/(1 \u2212 x) \u2264 |E| \u00b7 (1/(\u0394+1)) = O(|E|).\nEach resampling recolors k vertices, so the expected work is linear in |E| (for fixed k).\n\nConclusion. If e \u00b7 2^{1\u2212k} \u00b7 (\u0394 + 2) \u2264 1, the hypergraph is 2-colorable, and the Moser\u2013Tardos resampling algorithm finds a proper 2-coloring in expected O(|E|) resamplings.\n\nRemarks on constants. The classical (non-closed-neighborhood) symmetric Lov\u00e1sz Local Lemma yields the slightly sharper sufficient conditions e \u00b7 2^{\u2212k} \u00b7 (d + 1) \u2264 1 and e \u00b7 2^{1\u2212k} \u00b7 (\u0394 + 1) \u2264 1. Our algorithmic proof proceeds with the closed neighborhoods \u0393\u207a(\u00b7), which changes d + 1 to d + 2 and \u0394 + 1 to \u0394 + 2. Both forms are standard; the difference is an additive 1 in the degree parameter, immaterial for most asymptotic regimes.\n\nSummary. We proved the witness-tree lemma via resampling tables, established the Moser\u2013Tardos algorithmic Local Lemma with explicit expected-resampling bounds via a branching-process majorization over closed neighborhoods, and applied it with explicit constants to two canonical problems: satisfiability of sparse k-CNFs and 2-colorability of sparse k-uniform hypergraphs."
    },
    {
        "question": "Title: Sperner\u2019s lemma in all dimensions, Brouwer\u2019s fixed point theorem for simplices, and the no-retraction corollary\n\nLet d \u2265 1 be an integer. Identify the standard d-simplex with\n\u0394^d := { x = (x_0,\u2026,x_d) \u2208 R^{d+1} : x_i \u2265 0 for all i and \u2211_{i=0}^d x_i = 1 }.\nFor 0 \u2264 i \u2264 d, its i-th facet (codimension-1 face) is F_i := { x \u2208 \u0394^d : x_i = 0 }.\n\nA triangulation T of \u0394^d is a finite simplicial complex whose underlying polyhedron |T| equals \u0394^d. We say T is fine if max_{\u03c3\u2208T, dim \u03c3=d} diam(\u03c3) is sufficiently small; we will use arbitrarily fine triangulations of \u0394^d.\n\nA Sperner labeling on T is a map \u2113 that assigns to each vertex v of T a label \u2113(v) \u2208 {0,1,\u2026,d} such that if v \u2208 F_i then \u2113(v) \u2260 i (i.e., on each boundary facet F_i, the forbidden label i does not appear).\n\nA d-simplex \u03c3 \u2208 T (i.e., a facet of dimension d) is fully labeled if its vertices receive all d+1 distinct labels {0,1,\u2026,d}.\n\nProblem. Prove the following three statements completely and self-contained.\n\n1) Sperner\u2019s lemma with parity. For every triangulation T of \u0394^d with a Sperner labeling \u2113, the number of fully labeled d-simplices is odd (in particular, \u2265 1).\n\n2) Brouwer\u2019s fixed point theorem on \u0394^d via Sperner. Let f: \u0394^d \u2192 \u0394^d be continuous. Prove that there exists x \u2208 \u0394^d with f(x) = x. Your proof must proceed by:\n   - Choosing a sequence of triangulations T_n whose mesh tends to 0.\n   - Defining on each T_n a Sperner labeling by the rule: for a vertex v, pick any label i with v_i > f_i(v). Prove that such a label exists for every vertex v, and that on F_i the label i is indeed forbidden, so this is a valid Sperner labeling.\n   - Using (1) to find a fully labeled d-simplex \u03c3_n in each T_n, and showing that the unique accumulation point x of these simplices satisfies f(x) = x.\n\n3) No-retraction corollary. Show that there is no continuous retraction r: \u0394^d \u2192 \u2202\u0394^d (that is, a continuous map with r(x) = x for all x \u2208 \u2202\u0394^d). Deduce this from (2) by constructing a continuous map F: \u0394^d \u2192 \u0394^d with no fixed point if such an r existed, thereby contradicting Brouwer\u2019s fixed point theorem from (2).\n\nAnswer format:\n- Prove (1) first (for all d), giving a rigorous parity argument.\n- Then prove (2) in full detail as outlined.\n- Finally, deduce (3) from (2) by an explicit fixed-point-free construction.",
        "answer": "We proceed in order.\n\nPreliminaries, notation, and a basic observation. On \u0394^d we use barycentric coordinates x = (x_0,\u2026,x_d) with x_i \u2265 0 and \u2211 x_i = 1. For f = (f_0,\u2026,f_d): \u0394^d \u2192 \u0394^d continuous, we always have f_i(x) \u2265 0 and \u2211_i f_i(x) = 1 for all x.\n\nPart 1. Sperner\u2019s lemma with parity\n\nWe prove by constructing a graph and using a parity (handshake) argument. Fix a triangulation T of \u0394^d and a Sperner labeling \u2113: V(T) \u2192 {0,1,\u2026,d}.\n\nDefinition of \u201crainbow facets\u201d and the adjacency graph. Call a (d\u22121)-face \u03c4 (a facet of a d-simplex) rainbow if its labels are exactly {1,2,\u2026,d} (i.e., the set of labels on \u03c4 omits the label 0 and contains every other label exactly once). Each rainbow (d\u22121)-face lies either on the boundary facet F_0 (where x_0 = 0) or in the interior (shared by exactly two d-simplices).\n\nConstruct a graph G whose vertices are:\n- the set of d-simplices of T,\n- together with one extra vertex \u201c\u221e\u201d representing the \u201coutside.\u201d\nPlace an edge between two vertices of G for each rainbow (d\u22121)-face \u03c4 as follows:\n- If \u03c4 lies in the interior, it is a common face of exactly two d-simplices \u03c3,\u03c3\u2032; connect \u03c3\u2014\u03c3\u2032.\n- If \u03c4 lies on the boundary facet F_0, connect \u03c4 to the outside vertex \u221e and the unique d-simplex \u03c3 having \u03c4 as a face; connect \u03c3\u2014\u221e.\n\nBy construction, every rainbow (d\u22121)-face contributes exactly one edge in G.\n\nDegrees in G. Let us count degrees:\n- A d-simplex \u03c3 has degree equal to the number of its rainbow (d\u22121)-faces. Examine \u03c3: its vertices carry d+1 labels. A (d\u22121)-face of \u03c3 is obtained by omitting exactly one vertex; the corresponding (d\u22121)-face is rainbow if and only if the omitted vertex has label 0 and the remaining d vertices realize labels {1,\u2026,d}. Thus:\n  \u2022 If \u03c3 is fully labeled (contains all labels 0,\u2026,d), then exactly one of its (d\u22121)-faces (the one opposite the vertex labeled 0) is rainbow, so deg_G(\u03c3) = 1.\n  \u2022 If \u03c3 is not fully labeled, then either it has no label 0 (so none of its (d\u22121)-faces are rainbow), or it has label 0 but is missing some label among 1,\u2026,d (so the face opposite the 0 is not rainbow). In either case, deg_G(\u03c3) is even (in fact 0).\n- For the outside vertex \u221e: its degree equals the number of rainbow (d\u22121)-faces lying on F_0. Now F_0, with the induced triangulation and induced labeling (Sperner forbids label 0 on F_0), is itself a Sperner-labeled triangulation of \u0394^{d\u22121} with labels {1,\u2026,d}. By the induction hypothesis on dimension (or by the base case and the same argument internal to F_0), the number of fully labeled (d\u22121)-simplices on F_0 (i.e., rainbow faces \u03c4 \u2282 F_0) is odd; hence deg_G(\u221e) is odd.\n\nParity conclusion. Summing all degrees in G gives an even number (twice the number of edges):\n\u2211_{v\u2208V(G)} deg_G(v) = 2 |E(G)|, an even integer.\nWe have just seen that deg_G(\u221e) is odd and that every non-fully-labeled d-simplex contributes an even degree. It follows that the number of d-simplices with odd degree must be odd. But the d-simplices with odd degree are exactly the fully labeled ones. Therefore, the number of fully labeled d-simplices is odd.\n\nThis proves Sperner\u2019s lemma with parity in all dimensions d \u2265 1 (the base case d=1 is immediate).\n\nPart 2. Brouwer\u2019s fixed point theorem on \u0394^d via Sperner\n\nLet f: \u0394^d \u2192 \u0394^d be continuous. We will show there exists x with f(x) = x.\n\nStep 1. A Sperner labeling induced by f. Fix any triangulation T of \u0394^d. For each vertex v \u2208 V(T), we claim there exists at least one index i \u2208 {0,\u2026,d} with v_i > f_i(v). Indeed, since \u2211_i (v_i \u2212 f_i(v)) = 0, not all differences can be \u2264 0 with at least one strict < 0; otherwise we would have \u2211_i (v_i \u2212 f_i(v)) < 0, a contradiction. Thus there is an i with v_i \u2212 f_i(v) > 0. Choose any such i and set the label \u2113(v) := i.\n\nSperner boundary condition: If v \u2208 F_i, then v_i = 0, while f_i(v) \u2265 0, hence v_i > f_i(v) is impossible, so \u2113(v) \u2260 i. Therefore \u2113 is a valid Sperner labeling on T.\n\nStep 2. Refining triangulations and producing nested fully labeled simplices. Let (T_n) be a sequence of triangulations whose mesh tends to 0 (e.g., successive barycentric subdivisions). For each n, label V(T_n) by the rule in Step 1. By Part 1, there exists a fully labeled d-simplex \u03c3_n \u2208 T_n.\n\nLet x_n be any point in \u03c3_n (e.g., its barycenter). Since \u0394^d is compact, by passing to a subsequence we may assume x_n \u2192 x \u2208 \u0394^d. We will show f(x) = x.\n\nStep 3. Passing inequalities to the limit. Fix i \u2208 {0,\u2026,d}. For each n, since \u03c3_n is fully labeled, there is a vertex v^{(n)}_i of \u03c3_n with \u2113(v^{(n)}_i) = i, i.e., v^{(n)}_{i} \u2212 f_i(v^{(n)}_i) > 0. Because diam(\u03c3_n) \u2192 0 and v^{(n)}_i \u2208 \u03c3_n, we have v^{(n)}_i \u2192 x as well. By continuity of f and coordinates,\nlim_{n\u2192\u221e} [ v^{(n)}_{i} \u2212 f_i(v^{(n)}_i) ] = x_i \u2212 f_i(x) \u2265 0.\nTherefore, for each i, x_i \u2265 f_i(x).\n\nFinally, \u2211_i x_i = 1 and \u2211_i f_i(x) = 1, so \u2211_i (x_i \u2212 f_i(x)) = 0. With each term \u2265 0 and their sum 0, we must have x_i \u2212 f_i(x) = 0 for all i. Hence f(x) = x.\n\nThis completes the proof of Brouwer\u2019s fixed point theorem on \u0394^d.\n\nPart 3. No-retraction corollary\n\nSuppose, for contradiction, that there were a continuous retraction r: \u0394^d \u2192 \u2202\u0394^d; that is, r(x) = x for all x \u2208 \u2202\u0394^d. Define a continuous self-map F: \u0394^d \u2192 \u0394^d by\nF(x) := (x \u2212 r(x)) / 2.\n\nClaim 1: F maps \u0394^d into itself. Indeed, for any x \u2208 \u0394^d, using any Euclidean norm (or the standard simplex metric), we have\n||F(x)|| \u2264 (||x|| + ||r(x)||)/2 \u2264 (1 + 1)/2 = 1\nwhen \u0394^d is realized inside the unit ball (more invariantly: \u0394^d is convex, and (x \u2212 r(x))/2 lies on the segment from the point \u2212r(x) to 0, which stays within the convex hull of \u0394^d \u222a (\u2212\u2202\u0394^d), whence can be rescaled or embedded to see F(\u0394^d) \u2282 \u0394^d; but the crucial point here is that \u0394^d is convex and r(x) \u2208 \u2202\u0394^d).\n\nMore concretely and without norms, write x as a convex combination of vertices e_0,\u2026,e_d of \u0394^d: x = \u2211 x_i e_i, and r(x) as a point in the boundary (still a convex combination with at least one zero coefficient). Then F(x) = (x \u2212 r(x))/2 lies in the affine span of \u0394^d, and its barycentric coordinates are 1/2 times the difference of two vectors with sum 1, hence sum to 0; to place F(x) back in \u0394^d, use the convexity/affine structure as above\u2014alternatively, one may replace this F by the map\nG(x) := (x + c) / 2 with c := \u2212r(x),\nand then project back to \u0394^d along the radial line through the barycenter; but to keep the argument strictly elementary, we use the property below.)\n\nClaim 2: F has no fixed point. Indeed, if F(x) = x then (x \u2212 r(x))/2 = x, so r(x) = \u2212x. But r(x) \u2208 \u2202\u0394^d while \u0394^d \u2282 the positive orthant in R^{d+1} (barycentric coordinates), thus r(x) = \u2212x is impossible in \u0394^d. In particular, on the boundary \u2202\u0394^d we have r(y) = y, so F(y) = (y \u2212 y)/2 = 0; hence no boundary point is fixed either.\n\nNow F is a continuous self-map of the compact convex set \u0394^d with no fixed point. This contradicts Brouwer\u2019s fixed point theorem proved in Part 2. Therefore, no such retraction r can exist.\n\nRemark on the map: A cleaner strictly-in-\u0394^d construction avoiding norms is the affine homothetic contraction towards the interior: define\nH(x) := (x + b \u2212 r(x)) / 2,\nwhere b is the barycenter b = (1/(d+1),\u2026,1/(d+1)). Since \u0394^d is convex and r(x) \u2208 \u2202\u0394^d, the point y(x) = b \u2212 r(x) lies in the translate of \u2212\u0394^d by b; hence H(x) lies in the Minkowski average (\u0394^d + (b \u2212 \u0394^d))/2, which is contained in \u0394^d by convexity and symmetry around b. The fixed-point-free property is checked as above: H(x) = x implies r(x) = b, impossible since r(x) \u2208 \u2202\u0394^d while b \u2208 interior. Any such explicit fixed-point-free contraction suffices to contradict Brouwer.\n\nThis completes the proof of the no-retraction corollary.\n\nSummary. We proved:\n- Sperner\u2019s lemma with parity in all dimensions.\n- Brouwer\u2019s fixed point theorem on \u0394^d by triangulation, Sperner labeling induced by v_i > f_i(v), and a limiting argument.\n- As a corollary, there is no continuous retraction from \u0394^d onto its boundary \u2202\u0394^d."
    },
    {
        "question": "Title: Farkas\u2019 lemma to max\u2013flow=min\u2013cut and bipartite matching \u2014 a complete, self-contained development via duality and total unimodularity\n\nLet R^n be equipped with the standard inner product x\u00b7y = \u2211 x_i y_i and norm ||x|| = \u221a(x\u00b7x). For a matrix A \u2208 R^{m\u00d7n} and vector b \u2208 R^m, write K(A) := {A x : x \u2208 R^n, x \u2265 0} for the finitely generated (polyhedral) cone spanned by A\u2019s columns. For a directed graph G = (V,E) with a chosen orientation of each arc, the node\u2013arc incidence matrix B \u2208 R^{V\u00d7E} is defined by B_{v,e} = +1 if e leaves v, B_{v,e} = \u22121 if e enters v, and B_{v,e} = 0 otherwise. A matrix is totally unimodular (TU) if every square subdeterminant is in {\u22121, 0, 1}.\n\nProblem (hard, self-contained). Prove, in order, the following:\n\n1) Farkas\u2019 lemma (conic form) via Euclidean projection. For A \u2208 R^{m\u00d7n} and b \u2208 R^m, prove the exact alternative:\n   Exactly one of the following holds:\n   (F1) There exists x \u2208 R^n with x \u2265 0 and A x = b.\n   (F2) There exists y \u2208 R^m with y^T A \u2265 0 (entrywise) and y^T b < 0.\n   Your proof must be complete and self-contained. You may use only basic facts about convexity and the Euclidean projection onto a nonempty closed convex set in R^m (existence and the characterization by orthogonality of the residual).\n\n   Then deduce the \u201cmixed-constraint\u201d corollary: For A \u2208 R^{m\u00d7n}, c \u2208 R^n, b \u2208 R^m, \u03b1 \u2208 R, exactly one holds:\n   (G1) \u2203 x \u2265 0 with A x \u2264 b and c^T x \u2265 \u03b1.\n   (G2) \u2203 y \u2265 0 and \u03bb \u2265 0 with A^T y \u2212 \u03bb c \u2265 0 and y^T b \u2212 \u03bb \u03b1 < 0.\n\n2) Linear programming duality (weak and strong) and complementary slackness. Consider the primal\u2013dual pair\n   (P) max c^T x subject to A x \u2264 b, x \u2265 0,\n   (D) min b^T y subject to A^T y \u2265 c, y \u2265 0.\n   Prove weak duality c^T x \u2264 b^T y for any primal-feasible x and dual-feasible y.\n\n   Using (1), prove strong duality of optimal values: If (P) is feasible and has finite optimal value \u03b2, then\n   sup{c^T x : A x \u2264 b, x \u2265 0} = inf{b^T y : A^T y \u2265 c, y \u2265 0}.\n   Show also the complementary slackness conditions: if x* and y* are optimal for (P) and (D), then\n   for each i, y*_i (b_i \u2212 a_i^T x*) = 0; for each j, x*_j ((A^T y* \u2212 c)_j) = 0.\n   Conclude that c^T x* = b^T y*.\n\n3) Max\u2013flow = min\u2013cut via LP duality and a thresholding argument. Let G = (V,E) be a finite directed graph, s,t \u2208 V distinct, and capacities u_e \u2265 0 on arcs e \u2208 E. A (feasible) s\u2013t flow is f \u2208 R^E with 0 \u2264 f_e \u2264 u_e for all e and flow-conservation B f = F d, where F is the flow value and d \u2208 R^V has d_s = 1, d_t = \u22121, d_v = 0 otherwise. The max-flow LP is\n   (MF) maximize F over (f,F) subject to B f \u2212 F d = 0 and 0 \u2264 f \u2264 u.\n   Derive the dual LP and reduce it to\n   (MC) minimize \u2211_{e=(u,v)} u_e max(0, y_u \u2212 y_v) over y \u2208 R^V with y_s \u2212 y_t = 1.\n   Prove that for any feasible y, the integral \u201cthresholding\u201d family S_\u03bb := {v : y_v \u2265 \u03bb} (\u03bb \u2208 R) yields\n   \u2211_e u_e max(0, y_u \u2212 y_v) = \u222b_{\u2212\u221e}^{+\u221e} cap(S_\u03bb) d\u03bb,\n   where cap(S) := \u2211_{(u,v)\u2208E, u\u2208S, v\u2209S} u_{(u,v)} is the capacity of the directed cut (S, S^c).\n   Deduce there exists \u03bb with cap(S_\u03bb) \u2264 the dual objective at y; hence the dual optimum equals min_s,t cap(S, S^c), and strong duality gives the max\u2013flow=min\u2013cut theorem:\n   max flow value = min capacity of an s\u2013t cut.\n\n4) Total unimodularity of incidence matrices and integral flows. Prove:\n   a) The node\u2013arc incidence matrix B of any directed graph is TU. Conclude that any square submatrix of B has determinant in {\u22121,0,1}.\n   b) Show that adjoining identity rows preserves TU: if M is TU, then the block matrix [M; I] is TU. Conclude that the constraint matrix of (MF) in equality form (after adding standard slack variables for 0 \u2264 f \u2264 u) is TU.\n   c) Deduce that if all capacities u_e are integers, then there exists an optimal max flow with integer arc-values f_e \u2208 Z for all e.\n\n5) Bipartite matching: K\u0151nig\u2013Eg\u00e9rv\u00e1ry and Hall\u2019s theorem. Let G = (U,V;E) be a bipartite graph. A matching M \u2282 E is a set of disjoint edges; its size is |M|. A vertex cover is C \u2282 U\u222aV meeting every edge; its size is |C|.\n   a) LP formulation. Let A \u2208 {0,1}^{(U\u222aV)\u00d7E} be the vertex\u2013edge incidence matrix (A_{w,e} = 1 iff w incident to e). Consider\n      (PM) max \u2211_{e\u2208E} x_e subject to A x \u2264 1, x \u2265 0,\n      (DM) min \u2211_{w\u2208U\u222aV} y_w subject to A^T y \u2265 1, y \u2265 0.\n      Prove that if G is bipartite then A is TU (hint: multiply all V-rows by \u22121 to get a node\u2013arc incidence of an orientation, then use (4a)). Conclude that both (PM) and (DM) admit optimal integral solutions.\n   b) K\u0151nig\u2013Eg\u00e9rv\u00e1ry. Deduce that for bipartite G, the maximum size of a matching equals the minimum size of a vertex cover:\n      \u03bd(G) = \u03c4(G).\n   c) Hall\u2019s marriage theorem. Prove: G has a matching saturating U if and only if for every S \u2286 U one has |N(S)| \u2265 |S|. Derive the \u201conly if\u201d by pigeonhole. For the \u201cif\u201d direction, use (b): if a maximum matching does not saturate U, then \u03c4(G) = \u03bd(G) < |U|, so a minimum vertex cover C has |C| < |U|; set S = U \\ (C\u2229U) and show |N(S)| \u2264 |C\u2229V| = |C| \u2212 |C\u2229U| < |U| \u2212 |C\u2229U| = |S|, contradicting Hall\u2019s condition.\n\nAnswer format:\n- Present complete proofs for (1)\u2013(5) in order, fully justifying each step and identity, and explicitly deriving the duals.\n- In (3), give the thresholding argument carefully (as an integral identity over \u03bb) and show how it produces a 0\u20131 potential realizing a cut.\n- In (4), prove TU of B by a self-contained determinant argument and explain why adding identity preserves TU.\n- In (5), explicitly identify the integral optimal solutions as matchings and vertex covers, and give the Hall corollary rigorously.",
        "answer": "Title: From Farkas to flows, cuts, and matchings \u2014 a complete proof package\n\n1) Farkas\u2019 lemma (conic form) and the mixed-constraint corollary.\n\nConic Farkas (existence of x \u2265 0 with A x = b versus a separating multiplier). Let K := K(A) = {A x : x \u2265 0} \u2282 R^m, the finitely generated cone spanned by the columns of A. It is nonempty (0 \u2208 K), convex (sum of nonnegative combinations), and closed (polyhedral cones are closed; alternatively, as the image of the closed set {x \u2265 0} under the linear map x \u21a6 A x, it is closed).\n\nFix b \u2208 R^m. If b \u2208 K, then (F1) holds. Suppose b \u2209 K. Consider the Euclidean projection \u03c0 \u2208 K of b onto K; by standard convex analysis in Euclidean space, there exists a (unique) \u03c0 minimizing ||b \u2212 z|| over z \u2208 K, and it satisfies the variational inequality\n(b \u2212 \u03c0)\u00b7(z \u2212 \u03c0) \u2264 0 for all z \u2208 K. (This follows since \u03c6(z) = (1/2)||b\u2212z||^2 is strictly convex; any minimizer \u03c0 on convex K is characterized by the subgradient condition \u03c6'(\u03c0)(z\u2212\u03c0) \u2265 0 for all z \u2208 K, i.e. (\u03c0 \u2212 b)\u00b7(z \u2212 \u03c0) \u2265 0; multiplying by \u22121 gives the stated inequality.)\n\nDefine the residual r := b \u2212 \u03c0 \u2260 0 (since b \u2209 K). For any z \u2208 K, the inequality gives r\u00b7(z \u2212 \u03c0) \u2264 0, i.e. r\u00b7z \u2264 r\u00b7\u03c0. Because K is a cone and 0 \u2208 K, plugging z = 0 gives r\u00b7(\u2212\u03c0) \u2264 0, i.e. r\u00b7\u03c0 \u2265 0. Letting z = t w with w \u2208 K and t \u2192 +\u221e, the inequality r\u00b7(t w) \u2264 r\u00b7\u03c0 implies r\u00b7w \u2264 0 for all w \u2208 K. Thus r is a supporting covector that is nonpositive on K. Set y := \u2212r. Then for every column a_j of A, since a_j \u2208 K, we have y\u00b7a_j = (\u2212r)\u00b7a_j \u2265 0, hence y^T A \u2265 0 entrywise. Also y\u00b7b = (\u2212r)\u00b7b = \u2212r\u00b7(\u03c0 + r) = \u2212r\u00b7\u03c0 \u2212 ||r||^2 \u2264 \u2212||r||^2 < 0. This y witnesses (F2).\n\nExactly one of (F1), (F2) can hold: if there is x \u2265 0 with A x = b, then for any y with y^T A \u2265 0 we have y^T b = y^T A x \u2265 0, so y^T b < 0 is impossible.\n\nTherefore, exactly one of (F1), (F2) holds.\n\nMixed-constraint corollary. Consider the system A x \u2264 b, x \u2265 0, c^T x \u2265 \u03b1. Introduce slack variables s := b \u2212 A x \u2265 0 and r := c^T x \u2212 \u03b1 \u2265 0. The augmented unknown is z := (x,s,r) \u2265 0 and the augmented equality system reads\n[A  I  0] z = b,     [\u2212c^T  0  1] z = \u2212\u03b1.\nCollect as M z = d, where M \u2208 R^{(m+1)\u00d7(n+m+1)}, d = (b, \u2212\u03b1). By conic Farkas applied to M z = d, z \u2265 0, either there exists z \u2265 0 solving M z = d (equivalently there exists x \u2265 0, s \u2265 0, r \u2265 0 with A x + s = b and \u2212c^T x + r = \u2212\u03b1, i.e. A x \u2264 b and c^T x \u2265 \u03b1), or there exists a multiplier w = (y, \u03bb) \u2208 R^{m}\u00d7R with\nw^T M \u2265 0 and w^T d < 0. The inequality w^T M \u2265 0 says:\n- On the x-columns: y^T A \u2212 \u03bb c^T \u2265 0 \u21d4 A^T y \u2212 \u03bb c \u2265 0,\n- On the s-columns: y^T I \u2265 0 \u21d4 y \u2265 0,\n- On the r-column: \u03bb \u2265 0.\nAnd w^T d < 0 says y^T b \u2212 \u03bb \u03b1 < 0. This is exactly (G2). Again, exactly one holds.\n\n2) LP duality and complementary slackness.\n\nWeak duality. If x \u2265 0 with A x \u2264 b and y \u2265 0 with A^T y \u2265 c, then\nc^T x \u2264 (A^T y)^T x = y^T A x \u2264 y^T b = b^T y,\nas claimed.\n\nStrong duality (value equality). Let \u03b2 := sup{c^T x : A x \u2264 b, x \u2265 0}. Assume feasibility and \u03b2 < +\u221e. Fix any \u03b1 > \u03b2. Then the primal system with the extra inequality c^T x \u2265 \u03b1 is infeasible. By the mixed-constraint corollary (1), there exist y \u2265 0 and \u03bb \u2265 0 with\nA^T y \u2212 \u03bb c \u2265 0 and y^T b \u2212 \u03bb \u03b1 < 0. Necessarily \u03bb > 0: otherwise y^T b < 0, contradicting the weak dual bound 0 \u2264 b^T y for y \u2265 0. Divide by \u03bb to get a dual-feasible vector\n\u0233 := y/\u03bb \u2265 0 with A^T \u0233 \u2265 c and b^T \u0233 < \u03b1. Since this holds for every \u03b1 > \u03b2, we obtain\ninf{b^T y : y \u2265 0, A^T y \u2265 c} \u2264 \u03b2.\nCombined with weak duality (\u03b2 \u2264 inf b^T y), we conclude\nsup{c^T x : A x \u2264 b, x \u2265 0} = inf{b^T y : y \u2265 0, A^T y \u2265 c}.\n\nComplementary slackness. Let x*, y* be primal/dual feasible. Compute the duality gap:\nb^T y* \u2212 c^T x* = y*^T b \u2212 x*^T c\n= y*^T (b \u2212 A x*) + x*^T (A^T y* \u2212 c)\n= \u2211_{i=1}^m y^*_i (b_i \u2212 a_i^T x*) + \u2211_{j=1}^n x^*_j ((A^T y* \u2212 c)_j).\nEach term in both sums is \u2265 0 (by feasibility). If x*, y* are optimal, the gap equals 0, hence every term vanishes:\ny^*_i (b_i \u2212 a_i^T x*) = 0 for all i, and x^*_j ((A^T y* \u2212 c)_j) = 0 for all j.\nThese are the complementary slackness conditions. Moreover, with zero gap we have c^T x* = b^T y*.\n\n3) Max\u2013flow = min\u2013cut.\n\nMax-flow LP and its dual. Let B \u2208 R^{V\u00d7E} be the node\u2013arc incidence matrix. Introduce a scalar variable F (the value). The primal is\nmaximize F\nsubject to\n(1) B f \u2212 F d = 0 (flow conservation at each node),\n(2) 0 \u2264 f \u2264 u (capacity bounds).\n\nWe form the dual via Lagrange multipliers. Let y \u2208 R^V (free) be multipliers for (1), and let z,w \u2208 R^E, z \u2265 0, w \u2265 0 be multipliers for the inequalities f \u2264 u and \u2212f \u2264 0. The Lagrangian is\nL(f,F; y,z,w) = F \u2212 y^T (B f \u2212 F d) + z^T (f \u2212 u) + w^T (\u2212f)\n= F (1 + y^T d) + f^T (\u2212B^T y + z \u2212 w) \u2212 z^T u.\nThe dual seeks to minimize sup_{f,F, 0\u2264f\u2264u} L subject to z,w \u2265 0. The supremum over F is finite iff 1 + y^T d = 0, i.e. y_s \u2212 y_t = 1 (since d_s = 1, d_t = \u22121). The supremum over f \u2208 R^E is finite iff \u2212B^T y + z \u2212 w = 0; for a fixed y this is satisfied by choosing z,w \u2265 0 such that z \u2212 w = B^T y. The minimal value of z^T u + w^T 0 over such z,w is achieved by taking z_e = max(0, (B^T y)_e) and w_e = max(0, \u2212(B^T y)_e). Therefore the dual is equivalent to\nminimize \u2211_{e\u2208E} u_e max(0, (B^T y)_e)\nsubject to y_s \u2212 y_t = 1.\nFor an arc e = (u\u2192v) oriented from u to v, (B^T y)_e = y_u \u2212 y_v. Thus the dual is exactly\n(MC) minimize \u03a6(y) := \u2211_{(u,v)\u2208E} u_{(u,v)} max(0, y_u \u2212 y_v) over y \u2208 R^V with y_s \u2212 y_t = 1.\n\nThresholding identity. For any real y on V, define S_\u03bb := {v \u2208 V : y_v \u2265 \u03bb}. Then for each arc e = (u,v), the indicator 1{y_u \u2212 y_v > 0} can be integrated as\nmax(0, y_u \u2212 y_v) = \u222b_{\u2212\u221e}^{+\u221e} 1{y_u \u2265 \u03bb > y_v} d\u03bb.\nTherefore\n\u03a6(y) = \u2211_{(u,v)} u_{(u,v)} \u222b 1{y_u \u2265 \u03bb > y_v} d\u03bb\n= \u222b_{\u2212\u221e}^{+\u221e} [ \u2211_{(u,v)} u_{(u,v)} 1{u \u2208 S_\u03bb, v \u2209 S_\u03bb} ] d\u03bb\n= \u222b_{\u2212\u221e}^{+\u221e} cap(S_\u03bb) d\u03bb.\nIf y_s \u2212 y_t = 1, then for any \u03bb strictly between y_t and y_s we have s \u2208 S_\u03bb and t \u2209 S_\u03bb, so cap(S_\u03bb) is the capacity of an s\u2013t cut for almost every such \u03bb. Consequently, there exists \u03bb with cap(S_\u03bb) \u2264 \u03a6(y). Optimizing over y we deduce\nmin_y \u03a6(y) = min cut capacity.\nBy strong duality (2), the max-flow value equals the min-cut capacity.\n\n4) Total unimodularity and integral flows.\n\na) TU of B. Let B be the node\u2013arc incidence matrix of a directed graph. We prove every square submatrix has determinant in {\u22121, 0, 1} by induction on its size k.\n\nTake any k\u00d7k submatrix M. If M has a column with \u2264 1 nonzero entry, expand the determinant along that column; the resulting minors are of size \u2264 k\u22121 and inherit the same property from B, so by induction the determinant is in {\u22121,0,1}. If every column has exactly two nonzeros (necessarily one +1 and one \u22121), then summing all rows of M yields the zero vector (each column sum is 0). Thus the rows are linearly dependent, so det M = 0. This proves B is TU.\n\nb) Adjoining identity preserves TU. Let M be TU and consider the block matrix\nM' = [ M ; I ],\nformed by appending rows of the identity. Any square submatrix of M' either uses at least one identity row or not. If not, it is a square submatrix of M and has det \u2208 {\u22121,0,1}. If yes, expand along that identity row: the only nonzero in that row contributes \u00b11 times a determinant of a smaller square submatrix of M', and induction finishes. Therefore M' is TU. Iterating shows that stacking any number of identity rows preserves TU.\n\nApplying to (MF). Writing (MF) in equality form with slack variables s^+, s^\u2212 \u2265 0 for the inequalities f \u2264 u and \u2212f \u2264 0, we get the linear system\nB f \u2212 F d = 0,   f + s^+ = u,   \u2212f + s^\u2212 = 0.\nThe constraint coefficient matrix has the block form\n[ B   0  \u2212d ]\n[ I   I   0 ]\n[\u2212I   0   0 ].\nBy row permutations and multiplying rows by \u22121 if needed, this matrix is obtained by stacking B and copies of \u00b1I; by (a) and (b), it is TU.\n\nc) Integrality of flows. For an LP with a TU constraint matrix and integral right-hand side, every basic feasible solution is integral. In (MF), the right-hand sides (0, u, 0) are integral if u is integral, hence there exists an optimal basic feasible solution whose variables (including f) are integers. In particular, with integer capacities there exists a maximum flow with integral arc-values.\n\n5) Bipartite matching: TU, K\u0151nig\u2013Eg\u00e9rv\u00e1ry, and Hall.\n\na) TU of the bipartite incidence matrix. Let G = (U,V;E). Define the (vertex\u2013edge) incidence matrix A \u2208 {0,1}^{(U\u222aV)\u00d7E} by A_{w,e} = 1 if w is an endpoint of e, 0 otherwise. Order the rows with all U first, then V. Multiply each row corresponding to V by \u22121 to obtain a matrix \u00c3 with entries in {0,\u00b11} such that each column has exactly one +1 (at its U-endpoint) and one \u22121 (at its V-endpoint): thus \u00c3 is the node\u2013arc incidence matrix of the orientation sending each edge from U to V. By (4a), \u00c3 is TU, and row multiplications by \u22121 preserve total unimodularity, hence A is TU.\n\nSince (PM) has constraint matrix A and integer right-hand side 1, and (DM) has constraint matrix A^T and the same right-hand side 1, both polytopes have integral extreme points: (PM) admits an optimal x \u2208 {0,1}^E (the characteristic vector of a matching), and (DM) admits an optimal y \u2208 {0,1}^{U\u222aV} (the characteristic vector of a vertex cover).\n\nb) K\u0151nig\u2013Eg\u00e9rv\u00e1ry. Weak duality gives |M| = \u2211 x_e \u2264 \u2211 y_w = |C| for any matching M and any vertex cover C. By (a) and strong duality (2) applied to (PM)\u2013(DM), their optimal values are equal. Therefore\nmax_{matchings M} |M| = min_{vertex covers C} |C|, i.e. \u03bd(G) = \u03c4(G).\n\nc) Hall\u2019s theorem. Necessity: If a matching M saturates U, then for any S \u2286 U, all |S| vertices in S are matched to distinct neighbors in N(S), so |N(S)| \u2265 |S|.\n\nSufficiency: Suppose |N(S)| \u2265 |S| for all S \u2286 U. If there were no matching saturating U, then \u03bd(G) < |U|, hence by (b), \u03c4(G) = \u03bd(G) < |U|. Let C be a minimum vertex cover with |C| < |U|. Set S := U \\ (C \u2229 U). For any u \u2208 S and v \u2208 V \\ (C \u2229 V), the edge uv cannot exist (else C would miss uv). Thus N(S) \u2286 C \u2229 V, so\n|N(S)| \u2264 |C \u2229 V| = |C| \u2212 |C \u2229 U| < |U| \u2212 |C \u2229 U| = |S|,\ncontradicting Hall\u2019s condition. Therefore there exists a matching saturating U.\n\nThis completes the self-contained derivation: Farkas\u2019 lemma, LP duality with complementary slackness, max\u2013flow=min\u2013cut with thresholding, total unimodularity and integrality of flows, and the bipartite matching theorems of K\u0151nig\u2013Eg\u00e9rv\u00e1ry and Hall."
    }
]