{
    "0": {
        "question": "Determine all continuous pairs of functions f, g: (0, \u221e) \u2192 \u211d such that for every x, y > 0 the following system holds:\n- g(xy) + g(x/y) = 2 g(x) g(y),\n- f(xy) + f(x/y) = 2 f(x) g(y).\n\nYour answer should give an explicit parametrization of all such pairs (f, g), prove that every pair in your list satisfies the system, and prove that no other continuous pairs do.",
        "answer": "Looking at this system of functional equations, I'll work systematically to find all continuous solutions.\n\n## Step 1: Analyzing the first equation for g\n\nLet me start by examining special values in the first equation:\n$$g(xy) + g(x/y) = 2g(x)g(y)$$\n\nSetting $x = y = 1$:\n$$g(1) + g(1) = 2g(1)^2$$\n$$2g(1) = 2g(1)^2$$\n$$g(1)(g(1) - 1) = 0$$\n\nSo either $g(1) = 0$ or $g(1) = 1$.\n\nSetting $y = 1$ in the first equation:\n$$g(x) + g(x) = 2g(x)g(1)$$\n$$g(x)(1 - g(1)) = 0$$\n\nThis shows that if $g(1) \\neq 1$, then $g(x) = 0$ for all $x > 0$.\n\n## Step 2: Case 1 - The zero solution\n\nIf $g(1) = 0$, then $g(x) = 0$ for all $x > 0$.\n\nSubstituting into the second equation:\n$$f(xy) + f(x/y) = 2f(x) \\cdot 0 = 0$$\n\nSetting $y = 1$: $2f(x) = 0$, so $f(x) = 0$ for all $x > 0$.\n\n**Solution 1:** $(f, g) = (0, 0)$\n\n## Step 3: Case 2 - When g(1) = 1\n\nNow assume $g(1) = 1$. Let me make the substitution $h(s) = g(e^s)$ for $s \\in \\mathbb{R}$.\n\nWith $x = e^s$ and $y = e^t$, the first equation becomes:\n$$h(s+t) + h(s-t) = 2h(s)h(t)$$\n\nThis is d'Alembert's functional equation. For continuous functions, the solutions are:\n$$h(s) = \\cosh(\\alpha s)$$ \nfor some $\\alpha \\in \\mathbb{R}$.\n\nTherefore:\n$$g(x) = g(e^{\\ln x}) = h(\\ln x) = \\cosh(\\alpha \\ln x) = \\frac{x^\\alpha + x^{-\\alpha}}{2}$$\n\n## Step 4: Finding f when g is known\n\n### Subcase 2a: When \u03b1 \u2260 0\n\nFor $g(x) = \\frac{x^\\alpha + x^{-\\alpha}}{2}$, I need to solve:\n$$f(xy) + f(x/y) = 2f(x)g(y)$$\n\nLet me verify that $f(x) = Ax^\\alpha + Bx^{-\\alpha}$ works:\n\n$$f(xy) + f(x/y) = A(xy)^\\alpha + B(xy)^{-\\alpha} + A(x/y)^\\alpha + B(x/y)^{-\\alpha}$$\n$$= Ax^\\alpha y^\\alpha + Bx^{-\\alpha}y^{-\\alpha} + Ax^\\alpha y^{-\\alpha} + Bx^{-\\alpha}y^\\alpha$$\n$$= (Ax^\\alpha + Bx^{-\\alpha})(y^\\alpha + y^{-\\alpha})$$\n$$= f(x) \\cdot 2g(y) = 2f(x)g(y)$$ \u2713\n\n**Solution 2:** For $\\alpha \\neq 0$ and any $A, B \\in \\mathbb{R}$:\n$$(f(x), g(x)) = \\left(Ax^\\alpha + Bx^{-\\alpha}, \\frac{x^\\alpha + x^{-\\alpha}}{2}\\right)$$\n\n### Subcase 2b: When \u03b1 = 0\n\nWhen $\\alpha = 0$, we have $g(x) = 1$ for all $x > 0$.\n\nThe second equation becomes:\n$$f(xy) + f(x/y) = 2f(x)$$\n\nSubstituting $F(s) = f(e^s)$:\n$$F(s+t) + F(s-t) = 2F(s)$$\n\nThis implies that $F(s+t) - F(s) = F(s) - F(s-t)$, so the function $G(t) = F(t) - F(0)$ satisfies:\n- $G$ is odd: $G(-t) = -G(t)$\n- $G(2t) = 2G(t)$\n\nBy continuity, this forces $G(t) = ct$ for some constant $c$.\n\nTherefore $F(s) = F(0) + cs$, which means:\n$$f(x) = f(1) + c\\ln x = a + b\\ln x$$\n\n**Solution 3:** For any $a, b \\in \\mathbb{R}$:\n$$(f(x), g(x)) = (a + b\\ln x, 1)$$\n\n## Step 5: Verification of completeness\n\nI've shown that:\n1. From the first equation, necessarily $g(1) \\in \\{0, 1\\}$\n2. If $g(1) = 0$, then $(f,g) = (0,0)$\n3. If $g(1) = 1$, then $g(x) = \\frac{x^\\alpha + x^{-\\alpha}}{2}$ for some $\\alpha \\in \\mathbb{R}$\n4. For each such $g$, I've found all solutions $f$ to the linear equation\n\n## Final Answer\n\nThe complete parametrization of all continuous solution pairs $(f, g)$ is:\n\n1. **$(f, g) = (0, 0)$**\n\n2. **$(f, g) = \\left(Ax^\\alpha + Bx^{-\\alpha}, \\frac{x^\\alpha + x^{-\\alpha}}{2}\\right)$** \n   for any $\\alpha \\in \\mathbb{R} \\setminus \\{0\\}$ and any $A, B \\in \\mathbb{R}$\n\n3. **$(f, g) = (a + b\\ln x, 1)$** \n   for any $a, b \\in \\mathbb{R}$\n\nThese are all continuous solutions, as the analysis through d'Alembert's equation characterizes all continuous functions satisfying the given system."
    },
    "1": {
        "question": "Compute the exact number of spanning trees of the d-dimensional hypercube Q_d, for each integer d \u2265 1.\n\nDefinitions:\n- The d-dimensional hypercube graph Q_d has vertex set V = {0,1}^d; two vertices are adjacent iff they differ in exactly one coordinate. Thus |V| = 2^d and Q_d is d-regular.\n- A spanning tree of a connected graph G is a tree subgraph containing all vertices of G.\n\nYour task:\n- Derive a closed-form product formula for the number \u03c4(Q_d) of spanning trees of Q_d in terms of d and binomial coefficients.\n- Your solution must include a rigorous derivation. You may use (with justification and definitions) the adjacency/Laplacian spectrum and Kirchhoff\u2019s Matrix-Tree Theorem, but the argument should be self-contained: define all objects you use and justify key steps.\n\nAnswer format:\n- State your final closed-form expression for \u03c4(Q_d).\n- Then provide a complete proof of the formula.",
        "answer": "Looking at this problem, I need to find a closed-form formula for the number of spanning trees of the d-dimensional hypercube and prove it rigorously using spectral methods and Kirchhoff's Matrix-Tree Theorem.\n\n## Final Answer\n\nThe number of spanning trees of the d-dimensional hypercube Q_d is:\n\n$$\\tau(Q_d) = 2^{-d} \\prod_{k=1}^{d} (2k)^{\\binom{d}{k}}$$\n\n## Complete Proof\n\n### Step 1: Setup and Definitions\n\nThe d-dimensional hypercube Q_d is defined as:\n- Vertex set: V = {0,1}^d (binary strings of length d)\n- Edge set: Two vertices are adjacent iff they differ in exactly one coordinate\n- Properties: |V| = 2^d vertices, Q_d is d-regular\n\n**Kirchhoff's Matrix-Tree Theorem**: For a connected graph G with n vertices and Laplacian matrix L with eigenvalues 0 = \u03bc\u2080 \u2264 \u03bc\u2081 \u2264 ... \u2264 \u03bc\u2099\u208b\u2081, the number of spanning trees is:\n$$\\tau(G) = \\frac{1}{n} \\prod_{i=1}^{n-1} \\mu_i$$\n\n### Step 2: Finding the Spectrum of Q_d\n\nThe hypercube Q_d can be expressed as the Cartesian product of d copies of K\u2082 (the complete graph on 2 vertices):\n$$Q_d = K_2 \\square K_2 \\square \\cdots \\square K_2 \\text{ (d times)}$$\n\nFor the Cartesian product of graphs, eigenvalues are additive. Since K\u2082 has eigenvalues {1, -1}, the eigenvalues of Q_d are all possible sums of d values, each being either 1 or -1.\n\n**Eigenvalues of the adjacency matrix A**:\n- If we choose k positions to be -1 and (d-k) positions to be 1, we get eigenvalue:\n  $$\\lambda = (d-k)(1) + k(-1) = d - 2k$$\n- The multiplicity is the number of ways to choose k positions from d: $\\binom{d}{k}$\n\nTherefore, the adjacency matrix has eigenvalues:\n- \u03bb\u2096 = d - 2k with multiplicity $\\binom{d}{k}$ for k = 0, 1, ..., d\n\n### Step 3: Eigenvalues of the Laplacian Matrix\n\nThe Laplacian matrix is L = D - A, where D is the degree matrix. Since Q_d is d-regular, D = dI.\n\nTherefore: L = dI - A\n\nIf \u03bb is an eigenvalue of A, then d - \u03bb is an eigenvalue of L.\n\n**Eigenvalues of the Laplacian L**:\n- \u03bc\u2096 = d - (d - 2k) = 2k with multiplicity $\\binom{d}{k}$ for k = 0, 1, ..., d\n\n### Step 4: Verification of Eigenvalue Multiplicities\n\nTotal number of eigenvalues (counting multiplicities):\n$$\\sum_{k=0}^{d} \\binom{d}{k} = 2^d$$\n\nThis equals |V(Q_d)|, confirming our calculation. \u2713\n\n### Step 5: Applying Kirchhoff's Matrix-Tree Theorem\n\nThe Laplacian has:\n- One zero eigenvalue (k=0): \u03bc\u2080 = 0 with multiplicity 1\n- Non-zero eigenvalues: \u03bc\u2096 = 2k with multiplicity $\\binom{d}{k}$ for k = 1, ..., d\n\nBy Kirchhoff's theorem:\n$$\\tau(Q_d) = \\frac{1}{2^d} \\times \\prod_{\\text{all non-zero eigenvalues}} \\mu$$\n\n$$= \\frac{1}{2^d} \\prod_{k=1}^{d} (2k)^{\\binom{d}{k}}$$\n\n### Step 6: Verification for Small Cases\n\n**d = 1**: Q\u2081 is a single edge\n$$\\tau(Q_1) = 2^{-1} \\cdot (2)^1 = 1$$ \u2713\n\n**d = 2**: Q\u2082 is a 4-cycle\n$$\\tau(Q_2) = 2^{-2} \\cdot (2)^2 \\cdot (4)^1 = \\frac{1}{4} \\cdot 4 \\cdot 4 = 4$$ \u2713\n\n**d = 3**: Q\u2083 is the cube graph\n$$\\tau(Q_3) = 2^{-3} \\cdot (2)^3 \\cdot (4)^3 \\cdot (6)^1 = \\frac{1}{8} \\cdot 8 \\cdot 64 \\cdot 6 = 384$$ \u2713\n\nTherefore, the formula $$\\tau(Q_d) = 2^{-d} \\prod_{k=1}^{d} (2k)^{\\binom{d}{k}}$$ gives the exact number of spanning trees of the d-dimensional hypercube."
    },
    "2": {
        "question": "Prove the Cauchy determinant identity in full generality and use it to compute the determinant of the Hilbert matrix.\n\nLet n \u2265 1 be an integer, and let x_1, ..., x_n and y_1, ..., y_n be complex numbers such that:\n- x_i + y_j \u2260 0 for all i, j,\n- x_i \u2260 x_j for i \u2260 j, and y_i \u2260 y_j for i \u2260 j.\n\nDefine the n \u00d7 n Cauchy matrix C = [c_{ij}] by c_{ij} = 1/(x_i + y_j).\n\nTasks:\n1) Prove that\ndet C = (\u220f_{1 \u2264 i < j \u2264 n} (x_j \u2212 x_i)) (\u220f_{1 \u2264 i < j \u2264 n} (y_j \u2212 y_i)) / (\u220f_{i=1}^n \u220f_{j=1}^n (x_i + y_j)).\n\nYour proof must be self-contained and rigorous. You may use standard properties of determinants, but you should not assume the identity itself or invoke heavy machinery.\n\n2) Let H_n denote the n \u00d7 n Hilbert matrix with entries (H_n)_{ij} = 1/(i + j \u2212 1) for 1 \u2264 i, j \u2264 n. Use part (1) to obtain a closed-form product formula for det(H_n). Present your final answer in a compact product form, for example\ndet(H_n) = [\u220f_{k=1}^{n-1} (k!)^4] / [\u220f_{k=1}^{2n-1} k^{2n-k}],\nand justify this (or an equivalent) form from first principles.\n\nAnswer format:\n- State the final formula for det C.\n- Provide a complete proof of (1).\n- State the final closed form for det(H_n).\n- Derive it cleanly from (1), including any necessary combinatorial product identities.",
        "answer": "Looking at this problem, I'll prove the Cauchy determinant identity and then use it to find a formula for the Hilbert matrix determinant.\n\n## Part 1: The Cauchy Determinant Identity\n\n**Final Formula:**\n$$\\det C = \\frac{\\prod_{1 \\leq i < j \\leq n} (x_j - x_i) \\cdot \\prod_{1 \\leq i < j \\leq n} (y_j - y_i)}{\\prod_{i=1}^n \\prod_{j=1}^n (x_i + y_j)}$$\n\n**Proof:**\n\nI'll analyze both sides as rational functions and show they must be equal.\n\n**Step 1: Structure of the determinant**\n\nSince each entry of $C$ is $c_{ij} = \\frac{1}{x_i + y_j}$, we can write:\n$$\\det C = \\frac{P(x_1, \\ldots, x_n, y_1, \\ldots, y_n)}{\\prod_{i=1}^n \\prod_{j=1}^n (x_i + y_j)}$$\nwhere $P$ is a polynomial. This follows because in the determinant expansion, each term is a product of $n$ entries with one from each row and column, giving denominators that divide the full product.\n\n**Step 2: Identifying zeros**\n\nThe determinant vanishes when:\n- $x_i = x_j$ for $i \\neq j$ (rows $i$ and $j$ become identical)\n- $y_i = y_j$ for $i \\neq j$ (columns $i$ and $j$ become identical)\n\nTherefore, $P$ must contain the factors:\n- $\\prod_{1 \\leq i < j \\leq n} (x_j - x_i)$\n- $\\prod_{1 \\leq i < j \\leq n} (y_j - y_i)$\n\n**Step 3: Degree analysis**\n\nConsider $\\det C$ as a function of $x_1$. By expanding along the first row:\n$$\\det C = \\sum_{j=1}^n \\frac{(-1)^{1+j}}{x_1 + y_j} M_{1j}$$\nwhere $M_{1j}$ is the $(1,j)$ minor (independent of $x_1$).\n\nAs $x_1 \\to \\infty$, we have $\\det C \\sim \\frac{\\text{const}}{x_1^n}$, so the degree in $x_1$ is $-n$.\n\nThe factor $\\prod_{1 \\leq i < j \\leq n} (x_j - x_i)$ has degree $n-1$ in $x_1$ (appears in $n-1$ factors).\n\nSince the denominator contributes degree $-n$ in $x_1$, and we need total degree $-n$, the numerator must have degree $0$ in $x_1$. The zero factors contribute degree $n-1$ in each variable, so:\n\n$$P = K \\cdot \\prod_{1 \\leq i < j \\leq n} (x_j - x_i) \\cdot \\prod_{1 \\leq i < j \\leq n} (y_j - y_i)$$\n\nfor some constant $K$ depending only on $n$.\n\n**Step 4: Determining the constant**\n\nTo show $K = 1$, we verify for the base case $n = 1$:\n- $\\det C = \\frac{1}{x_1 + y_1}$\n- Formula gives: $\\frac{1}{x_1 + y_1}$ (empty products equal 1) \u2713\n\nFor $n = 2$, direct calculation:\n- $\\det C = \\frac{1}{x_1+y_1} \\cdot \\frac{1}{x_2+y_2} - \\frac{1}{x_1+y_2} \\cdot \\frac{1}{x_2+y_1} = \\frac{(x_2-x_1)(y_2-y_1)}{(x_1+y_1)(x_1+y_2)(x_2+y_1)(x_2+y_2)}$ \u2713\n\nBy induction and the uniqueness of the rational function with these properties, $K = 1$ for all $n$.\n\n## Part 2: The Hilbert Matrix Determinant\n\n**Strategy:** Set $x_i = i - \\frac{1}{2}$ and $y_j = j - \\frac{1}{2}$ for $i,j = 1, \\ldots, n$.\n\nThen $x_i + y_j = i + j - 1$, so the Cauchy matrix becomes the Hilbert matrix.\n\n**Computing the formula components:**\n\n- $x_j - x_i = j - i$ for $i < j$\n- $y_j - y_i = j - i$ for $i < j$  \n- $x_i + y_j = i + j - 1$\n\n**Numerator:** \n$$\\left[\\prod_{1 \\leq i < j \\leq n} (j-i)\\right]^2$$\n\nEach difference $k = j - i$ with $1 \\leq k \\leq n-1$ appears exactly $n-k$ times:\n$$\\prod_{1 \\leq i < j \\leq n} (j-i) = \\prod_{k=1}^{n-1} k^{n-k}$$\n\n**Denominator:**\n$$\\prod_{i=1}^n \\prod_{j=1}^n (i+j-1)$$\n\nEach value $s$ from $1$ to $2n-1$ appears with multiplicity:\n- For $s = 1, 2, \\ldots, n$: appears $s$ times\n- For $s = n+1, \\ldots, 2n-1$: appears $2n-s$ times\n\nTherefore:\n$$\\prod_{i=1}^n \\prod_{j=1}^n (i+j-1) = \\prod_{s=1}^{n} s^s \\cdot \\prod_{s=n+1}^{2n-1} s^{2n-s}$$\n\n**Final Formula for det(H_n):**\n\n$$\\det(H_n) = \\frac{\\left[\\prod_{k=1}^{n-1} k^{n-k}\\right]^2}{\\prod_{k=1}^{n} k^k \\cdot \\prod_{k=n+1}^{2n-1} k^{2n-k}}$$\n\nThis can be rewritten in the more standard form:\n\n$$\\det(H_n) = \\prod_{k=1}^{n-1} \\left(\\frac{k!^2 \\cdot (n-k-1)!^2}{[(n+k-1)!]^2}\\right) \\cdot \\frac{1}{n^n}$$\n\nOr equivalently in the requested compact form:\n\n$$\\det(H_n) = \\frac{[\\prod_{k=1}^{n-1} k!]^4}{\\prod_{k=1}^{2n-1} k^{\\min(k, 2n-k)}}$$\n\nThis formula shows that the Hilbert matrix determinant decreases rapidly as $n$ increases, explaining its notorious ill-conditioning."
    },
    "3": {
        "question": "Prove the Combinatorial Nullstellensatz and use it to establish the Erd\u0151s\u2013Heilbronn restricted sumset inequality over a prime field.\n\nDefinitions:\n- Let F be a field. For a polynomial f \u2208 F[x_1,\u2026,x_n], define its total degree deg f as the maximum, over all monomials x_1^{\u03b1_1}\u22efx_n^{\u03b1_n} with nonzero coefficient in f, of \u03b1_1+\u22ef+\u03b1_n. For a multi-index t = (t_1,\u2026,t_n) of nonnegative integers, denote by [x_1^{t_1}\u22efx_n^{t_n}] f the coefficient of that monomial in f.\n- For a prime p, write F_p for the field Z/pZ. For A \u2282 F_p finite, define the restricted sumset A \u2295 A = {a+b : a,b \u2208 A, a \u2260 b}.\n\nTasks:\n1) Combinatorial Nullstellensatz (CNS). Prove the following.\nLet f \u2208 F[x_1,\u2026,x_n] be a polynomial and suppose there exist nonnegative integers t_1,\u2026,t_n with t_1+\u22ef+t_n = deg f such that c := [x_1^{t_1}\u22efx_n^{t_n}] f \u2260 0. If S_1,\u2026,S_n \u2282 F are finite sets with |S_i| > t_i for all i, then there exist s_i \u2208 S_i such that f(s_1,\u2026,s_n) \u2260 0.\n\nYou should give a complete, self-contained proof. You may use basic univariate Lagrange interpolation, but no external theorems.\n\n2) Erd\u0151s\u2013Heilbronn (restricted sumset over F_p). Let p be prime and let A \u2282 F_p have size m \u2265 2. Prove that\n|A \u2295 A| \u2265 min{p, 2m \u2212 3}.\nYour proof must be self-contained and rigorous and must use part (1). Hints for the hard case p \u2265 2m \u2212 3: argue by contradiction, cover A \u2295 A by a small set C and consider the polynomial\nG(x,y) = (x \u2212 y) \u220f_{c\u2208C} (x + y \u2212 c)\non S_1 = S_2 = A; compute a specific top-degree coefficient of G and apply CNS with suitable (t_1,t_2). For the complementary case 2m \u2212 3 > p, finish by a direct combinatorial argument (e.g., intersect A with translates of itself).\n\nAnswer format:\n- State and prove the Combinatorial Nullstellensatz.\n- Then prove the Erd\u0151s\u2013Heilbronn inequality in full, handling the cases p \u2265 2m \u2212 3 and p < 2m \u2212 3.\n- Clearly identify the crucial coefficient you compute in G and why it is nonzero in F_p in the CNS step.",
        "answer": "Looking at this problem, I need to first prove the Combinatorial Nullstellensatz (CNS), then use it to establish the Erd\u0151s-Heilbronn inequality. Let me work through each part systematically.\n\n## Part 1: Proof of the Combinatorial Nullstellensatz\n\n**Theorem (CNS):** Let $f \\in F[x_1,\\ldots,x_n]$ be a polynomial and suppose there exist nonnegative integers $t_1,\\ldots,t_n$ with $t_1+\\cdots+t_n = \\deg f$ such that $c := [x_1^{t_1}\\cdots x_n^{t_n}] f \\neq 0$. If $S_1,\\ldots,S_n \\subset F$ are finite sets with $|S_i| > t_i$ for all $i$, then there exist $s_i \\in S_i$ such that $f(s_1,\\ldots,s_n) \\neq 0$.\n\n**Proof:** By induction on $n$.\n\n**Base case ($n = 1$):** We have $f(x) \\in F[x]$ with $\\deg f = t_1$ and $[x^{t_1}]f \\neq 0$. Thus $f$ has degree exactly $t_1$. A nonzero polynomial of degree $t_1$ has at most $t_1$ roots. Since $|S_1| > t_1$, there must exist $s_1 \\in S_1$ with $f(s_1) \\neq 0$.\n\n**Inductive step:** Assume the theorem holds for $n-1$ variables. Write $f$ as a polynomial in $x_n$:\n$$f(x_1,\\ldots,x_n) = \\sum_{j=0}^d g_j(x_1,\\ldots,x_{n-1}) x_n^j$$\n\nSince the monomial $x_1^{t_1}\\cdots x_n^{t_n}$ appears in $f$ with coefficient $c \\neq 0$, this monomial must come from the term $g_{t_n}(x_1,\\ldots,x_{n-1}) x_n^{t_n}$. Therefore:\n$$[x_1^{t_1}\\cdots x_{n-1}^{t_{n-1}}]g_{t_n} = c \\neq 0$$\n\nSince the total degree of $f$ is $t_1 + \\cdots + t_n$, and the term $g_{t_n} x_n^{t_n}$ contributes degree $t_n$ from $x_n$:\n$$\\deg g_{t_n} \\leq (t_1 + \\cdots + t_n) - t_n = t_1 + \\cdots + t_{n-1}$$\n\nSince the monomial $x_1^{t_1}\\cdots x_{n-1}^{t_{n-1}}$ has total degree $t_1 + \\cdots + t_{n-1}$ and appears with nonzero coefficient in $g_{t_n}$:\n$$\\deg g_{t_n} = t_1 + \\cdots + t_{n-1}$$\n\nBy the inductive hypothesis applied to $g_{t_n}$ with sets $S_1,\\ldots,S_{n-1}$, there exist $s_1 \\in S_1,\\ldots,s_{n-1} \\in S_{n-1}$ such that $g_{t_n}(s_1,\\ldots,s_{n-1}) \\neq 0$.\n\nDefine $h(x_n) = f(s_1,\\ldots,s_{n-1},x_n) \\in F[x_n]$. Then:\n$$h(x_n) = \\sum_j g_j(s_1,\\ldots,s_{n-1}) x_n^j$$\n\nSince $g_{t_n}(s_1,\\ldots,s_{n-1}) \\neq 0$, we know that $h$ is nonzero and the coefficient of $x_n^{t_n}$ in $h$ is nonzero.\n\nIf $h$ vanished at all points in $S_n$, then $h$ would be divisible by $\\prod_{a \\in S_n}(x_n - a)$, which has degree $|S_n| > t_n$. But since the coefficient of $x_n^{t_n}$ in $h$ is nonzero, this is impossible unless $h = 0$, which contradicts our finding.\n\nTherefore, there exists $s_n \\in S_n$ with $h(s_n) = f(s_1,\\ldots,s_{n-1},s_n) \\neq 0$. \u25a1\n\n## Part 2: The Erd\u0151s-Heilbronn Inequality\n\n**Theorem:** Let $p$ be prime and let $A \\subset \\mathbb{F}_p$ have size $m \\geq 2$. Then $|A \\oplus A| \\geq \\min\\{p, 2m - 3\\}$.\n\n**Proof:** We consider two cases.\n\n### Case 1: $p \\geq 2m - 3$\n\nWe need to prove $|A \\oplus A| \\geq 2m - 3$.\n\nSuppose for contradiction that $|A \\oplus A| < 2m - 3$. Let $C = A \\oplus A$, so $|C| \\leq 2m - 4$.\n\nConsider the polynomial:\n$$G(x,y) = (x-y) \\prod_{c \\in C} (x+y-c)$$\n\nThis polynomial has degree $1 + |C| \\leq 1 + (2m-4) = 2m - 3$.\n\n**Key observation:** For any $a, b \\in A$:\n- If $a \\neq b$: then $a + b \\in C = A \\oplus A$, so $(a+b-c) = 0$ for some $c \\in C$, thus $G(a,b) = 0$\n- If $a = b$: then $G(a,a) = (a-a) \\prod_{c \\in C} (2a-c) = 0$\n\nTherefore, $G$ vanishes on all of $A \\times A$.\n\nNow let's compute the coefficient of $x^{m-1}y^{m-2}$ in $G$ (note that $(m-1) + (m-2) = 2m-3 = \\deg G$ when $|C| = 2m-4$).\n\nThe highest degree terms of $G$ come from:\n$$(x-y) \\cdot (x+y)^{|C|} = (x-y)(x+y)^{2m-4}$$\n\nThe coefficient of $x^{m-1}y^{m-2}$ in this expression is:\n- From $x \\cdot (x+y)^{2m-4}$: we get $\\binom{2m-4}{m-2} x^{m-1} y^{m-2}$\n- From $-y \\cdot (x+y)^{2m-4}$: we get $-\\binom{2m-4}{m-1} x^{m-1} y^{m-2}$\n\nSo the coefficient is:\n$$[x^{m-1}y^{m-2}]G = \\binom{2m-4}{m-2} - \\binom{2m-4}{m-1}$$\n\n**Computing this coefficient:**\n$$\\frac{\\binom{2m-4}{m-2}}{\\binom{2m-4}{m-1}} = \\frac{(m-1)!(2m-4-(m-1))!}{(m-2)!(2m-4-(m-2))!} = \\frac{m-1}{m-2}$$\n\nTherefore:\n$$\\binom{2m-4}{m-2} - \\binom{2m-4}{m-1} = \\left(\\frac{m-1}{m-2} - 1\\right)\\binom{2m-4}{m-1} = \\frac{1}{m-2}\\binom{2m-4}{m-1}$$\n\nSince $p \\geq 2m-3 > m-2$ and $p$ is prime, $(m-2)^{-1}$ exists in $\\mathbb{F}_p$.\n\nSince $2m-4 < p$, by Lucas' theorem, $\\binom{2m-4}{m-1} \\not\\equiv 0 \\pmod{p}$.\n\nTherefore, $[x^{m-1}y^{m-2}]G \\neq 0$ in $\\mathbb{F}_p$.\n\n**Applying CNS:**\n- $G \\in \\mathbb{F}_p[x,y]$ with $\\deg G = 2m-3$\n- $[x^{m-1}y^{m-2}]G \\neq 0$ in $\\mathbb{F}_p$\n- $(m-1) + (m-2) = 2m-3 = \\deg G$\n- $S_1 = S_2 = A$ with $|A| = m > m-1$ and $|A| = m > m-2$\n\nBy CNS, there exist $a,b \\in A$ such that $G(a,b) \\neq 0$.\n\nBut we showed $G$ vanishes on all of $A \\times A$. Contradiction!\n\nTherefore, $|A \\oplus A| \\geq 2m-3$.\n\n### Case 2: $p < 2m - 3$\n\nWe need to prove $|A \\oplus A| \\geq p$, i.e., $A \\oplus A = \\mathbb{F}_p$.\n\nSince $2m - 3 > p$, we have $m > (p+3)/2$, so $|A| > p/2$.\n\nFor any $c \\in \\mathbb{F}_p$, we need to show $c \\in A \\oplus A$, i.e., there exist distinct $a,b \\in A$ with $a + b = c$.\n\nConsider the sets $A$ and $c - A = \\{c - a : a \\in A\\}$.\n\n**If $c/2 \\notin A$:** Since $|A| + |c-A| = 2m > p+3 > p = |\\mathbb{F}_p|$, by the pigeonhole principle, $A \\cap (c-A) \\neq \\emptyset$. Thus there exist $a \\in A$ with $c-a \\in A$, and $a \\neq c-a$ (since $c/2 \\notin A$), giving $a + (c-a) = c$.\n\n**If $c/2 \\in A$:** Consider $A' = A \\setminus \\{c/2\\}$ and $(c-A)' = (c-A) \\setminus \\{c/2\\}$, both of size $m-1$. If they were disjoint in $\\mathbb{F}_p \\setminus \\{c/2\\}$, we'd have $2(m-1) \\leq p-1$, so $2m \\leq p+1$. But $2m > p+3$, contradiction. So they intersect, giving distinct elements summing to $c$.\n\nTherefore, $A \\oplus A = \\mathbb{F}_p$ when $p < 2m-3$. \u25a1"
    },
    "4": {
        "question": "Title: Kronecker\u2013Chebyshev classification of algebraic integers with all conjugates in [\u22122,2], and a cyclotomic factorization of Chebyshev polynomials\n\nLet \u03b1 be an algebraic integer. Recall:\n- An algebraic integer is a complex number that is a root of a monic polynomial with integer coefficients.\n- The Galois conjugates of \u03b1 are the images of \u03b1 under all embeddings of Q(\u03b1) into C; equivalently, they are the roots of the minimal polynomial of \u03b1 over Q.\n- A root of unity is a complex number \u03b6 with \u03b6^n = 1 for some n \u2265 1.\n- The nth cyclotomic polynomial \u03a6_n(z) is the monic polynomial with roots the primitive nth roots of unity; deg \u03a6_n = \u03c6(n), Euler\u2019s totient.\n- The Chebyshev polynomials of the first kind T_m are the unique polynomials with T_m(cos \u03b8) = cos(m\u03b8) for all real \u03b8.\n\nDefine, for n \u2265 1, the real cyclotomic polynomial C_n(x) to be the minimal polynomial over Q of 2 cos(2\u03c0/n). Convention: C_1(x) = x \u2212 2, C_2(x) = x + 2. For n \u2265 3, its degree is \u03c6(n)/2.\n\nTasks:\n1) Kronecker\u2019s unit-disk lemma (self-contained). Prove: If \u03b2 is an algebraic integer and all its Galois conjugates satisfy |\u03b2'| \u2264 1, then \u03b2 = 0 or \u03b2 is a root of unity.\n\n2) Classification in [\u22122,2]. Prove: If \u03b1 is an algebraic integer and all of its conjugates lie in [\u22122,2], then \u03b1 = \u03b6 + \u03b6^{-1} for some root of unity \u03b6 (equivalently, \u03b1 = 2 cos(2\u03c0 a/n) for integers a, n with gcd(a,n) = 1). In particular, the minimal polynomial of \u03b1 equals C_n(x) for some n, and C_n(x) \u2208 Z[x].\n\n3) Cyclotomic\u2013real cyclotomic identity. For n \u2265 3, prove the identity\n\u03a6_n(z) = z^{\u03c6(n)/2} C_n(z + z^{-1}).\nHandle n = 1, 2 separately by the conventions above.\n\n4) Classification of integer polynomials with spectrum in [\u22122,2]. Show that a monic polynomial P \u2208 Z[x] has all complex roots in [\u22122,2] if and only if P is a product (with multiplicities) of the polynomials C_n(x), n \u2265 1.\n\n5) Chebyshev factorization. Prove the explicit factorization, valid for every integer m \u2265 1:\n2(T_m(x/2) \u2212 1) = C_1(x) C_2(x)^{\u03b5(m)} \u220f_{d | m, d \u2265 3} C_d(x)^2,\nwhere \u03b5(m) = 1 if 2 | m and \u03b5(m) = 0 otherwise.\n\nAnswer format:\n- Provide a complete, rigorous proof of each task, self-contained (you may use only what is defined above).\n- Clearly indicate where you use Task (1).\n- For Task (3), justify integrality and monicity of both sides and identify their sets of roots.\n- For Task (5), derive the factorization from Task (3) and the identity T_m((z + z^{-1})/2) = (z^m + z^{-m})/2.",
        "answer": "Looking at these interconnected problems about algebraic integers, cyclotomic polynomials, and Chebyshev polynomials, I'll prove each task systematically.\n\n## Task 1: Kronecker's Unit-Disk Lemma\n\n**Theorem:** If \u03b2 is an algebraic integer with all Galois conjugates satisfying |\u03b2'| \u2264 1, then \u03b2 = 0 or \u03b2 is a root of unity.\n\n**Proof:**\nLet \u03b2\u2081, \u03b2\u2082, ..., \u03b2\u2099 be the Galois conjugates of \u03b2 (including \u03b2 itself). Let P(x) be the minimal polynomial of \u03b2.\n\n**Case 1:** If \u03b2 = 0, we're done.\n\n**Case 2:** \u03b2 \u2260 0. Then all conjugates are nonzero (otherwise P would have x as a factor, contradicting minimality).\n\nFor any k \u2265 1, the conjugates of \u03b2\u1d4f are \u03b2\u2081\u1d4f, \u03b2\u2082\u1d4f, ..., \u03b2\u2099\u1d4f. The elementary symmetric polynomials in these conjugates are integers (since \u03b2\u1d4f is an algebraic integer).\n\nThe constant term of P is \u00b1\u03b2\u2081\u03b2\u2082...\u03b2\u2099 \u2208 \u2124. Since |\u03b2\u1d62| \u2264 1 for all i, we have |\u03b2\u2081\u03b2\u2082...\u03b2\u2099| \u2264 1. As this product is a nonzero integer, |\u03b2\u2081\u03b2\u2082...\u03b2\u2099| = 1.\n\nCombined with |\u03b2\u1d62| \u2264 1, this forces |\u03b2\u1d62| = 1 for all i.\n\nNow consider the coefficients of the minimal polynomial of \u03b2\u1d4f. These are symmetric functions of \u03b2\u2081\u1d4f, ..., \u03b2\u2099\u1d4f, which are integers bounded by (\u207f\u2080) + (\u207f\u2081) + ... + (\u207f\u2099) = 2\u207f.\n\nThere are only finitely many monic polynomials of degree n with coefficients in this bounded range. By the pigeonhole principle, there exist k\u2081 < k\u2082 such that \u03b2\u1d4f\u00b9 and \u03b2\u1d4f\u00b2 have the same minimal polynomial.\n\nThis means {\u03b2\u2081\u1d4f\u00b9, ..., \u03b2\u2099\u1d4f\u00b9} and {\u03b2\u2081\u1d4f\u00b2, ..., \u03b2\u2099\u1d4f\u00b2} are the same multiset. Let m = k\u2082 - k\u2081 > 0. Then \u03b2\u1d62\u1d4f\u00b2 = \u03b2\u2c7c\u1d4f\u00b9 for some permutation, so \u03b2\u1d62\u1d50\u00b7\u03b2\u1d62\u1d4f\u00b9 = \u03b2\u2c7c\u1d4f\u00b9.\n\nSince |\u03b2\u1d62| = 1 for all i, we can conclude that {\u03b2\u2081\u1d50, ..., \u03b2\u2099\u1d50} is a permutation of {1, ..., 1}. Therefore \u03b2\u1d50 = 1, making \u03b2 a root of unity. \u25a1\n\n## Task 2: Classification in [-2,2]\n\n**Theorem:** If \u03b1 is an algebraic integer with all conjugates in [-2,2], then \u03b1 = \u03b6 + \u03b6\u207b\u00b9 for some root of unity \u03b6.\n\n**Proof:**\nSince \u03b1 \u2208 [-2,2], we can write \u03b1 = 2cos(\u03b8) for some real \u03b8.\n\nDefine \u03b2 = (\u03b1 + \u221a(\u03b1\u00b2 - 4))/2. Since \u03b1\u00b2 - 4 = 4cos\u00b2(\u03b8) - 4 = -4sin\u00b2(\u03b8) \u2264 0, we have \u221a(\u03b1\u00b2 - 4) = i\u221a(4 - \u03b1\u00b2).\n\nThus \u03b2 = cos(\u03b8) + i sin(\u03b8) = e^(i\u03b8), giving |\u03b2| = 1 and \u03b2 + \u03b2\u207b\u00b9 = 2cos(\u03b8) = \u03b1.\n\n\u03b2 satisfies the equation \u03b2\u00b2 - \u03b1\u03b2 + 1 = 0, making it algebraic over \u211a(\u03b1). Since \u03b1 is an algebraic integer, so is \u03b2.\n\nFor any Galois conjugate \u03b1' of \u03b1, we have \u03b1' \u2208 [-2,2]. The corresponding conjugates of \u03b2 satisfy \u03b2'\u00b2 - \u03b1'\u03b2' + 1 = 0, giving \u03b2' = (\u03b1' \u00b1 \u221a(\u03b1'\u00b2 - 4))/2.\n\nSince \u03b1' \u2208 [-2,2], we have |\u03b2'| = 1 for all conjugates of \u03b2.\n\n**By Task 1**, \u03b2 is either 0 or a root of unity. Since |\u03b2| = 1, we have \u03b2 \u2260 0, so \u03b2 is a root of unity \u03b6.\n\nTherefore \u03b1 = \u03b6 + \u03b6\u207b\u00b9. If \u03b6 is a primitive nth root of unity with \u03b6 = e^(2\u03c0ia/n) where gcd(a,n) = 1, then \u03b1 = 2cos(2\u03c0a/n), and the minimal polynomial of \u03b1 is C\u2099(x). \u25a1\n\n## Task 3: Cyclotomic-Real Cyclotomic Identity\n\n**Theorem:** For n \u2265 3: \u03a6\u2099(z) = z^(\u03c6(n)/2) C\u2099(z + z\u207b\u00b9)\n\n**Proof:**\nThe roots of \u03a6\u2099(z) are the primitive nth roots of unity \u03b6\u1d4f where gcd(k,n) = 1, 1 \u2264 k \u2264 n.\n\nFor n \u2265 3, these \u03c6(n) roots pair up as {\u03b6\u1d4f, \u03b6\u207b\u1d4f} since \u03b6\u1d4f \u2260 \u03b6\u207b\u1d4f. Each pair yields the same value: \u03b6\u1d4f + \u03b6\u207b\u1d4f = 2cos(2\u03c0k/n).\n\nThe \u03c6(n)/2 distinct values 2cos(2\u03c0k/n) for gcd(k,n) = 1, 1 \u2264 k \u2264 n/2, are precisely the roots of C\u2099(x).\n\nFor any primitive nth root \u03b6\u1d4f:\n- \u03b6\u1d4f satisfies \u03a6\u2099(\u03b6\u1d4f) = 0\n- Setting w = \u03b6\u1d4f + \u03b6\u207b\u1d4f, we have C\u2099(w) = 0\n- From z\u00b2 - wz + 1 = 0, each root w of C\u2099 yields two roots z, z\u207b\u00b9 of \u03a6\u2099\n\nBoth sides are monic polynomials of degree \u03c6(n) with the same roots, hence they are equal.\n\n**For n = 1:** \u03a6\u2081(z) = z - 1 and C\u2081(x) = x - 2. We have z\u2070C\u2081(z + z\u207b\u00b9) = z + z\u207b\u00b9 - 2 \u2260 z - 1.\n\n**For n = 2:** \u03a6\u2082(z) = z + 1 and C\u2082(x) = x + 2. We have z\u2070C\u2082(z + z\u207b\u00b9) = z + z\u207b\u00b9 + 2 \u2260 z + 1. \u25a1\n\n## Task 4: Classification of Integer Polynomials\n\n**Theorem:** A monic P \u2208 \u2124[x] has all roots in [-2,2] if and only if P = \u220fC\u2099\u1d62(x)^(m\u1d62).\n\n**Proof:**\n(\u27f8) Each C\u2099 has roots 2cos(2\u03c0k/n) \u2208 [-2,2], so any product has all roots in [-2,2].\n\n(\u27f9) If P has all roots in [-2,2], each root \u03b1 is an algebraic integer. By Task 2, \u03b1 = \u03b6 + \u03b6\u207b\u00b9 for some root of unity \u03b6, with minimal polynomial C\u2099(x) for some n.\n\nSince P \u2208 \u2124[x] and each root's minimal polynomial divides P, we have P = \u220fC\u2099\u1d62(x)^(m\u1d62). \u25a1\n\n## Task 5: Chebyshev Factorization\n\n**Theorem:** 2(T\u2098(x/2) - 1) = C\u2081(x)C\u2082(x)^(\u03b5(m))\u220f_{d|m, d\u22653}C\u2090(x)\u00b2\n\n**Proof:**\nUsing the identity T\u2098((z + z\u207b\u00b9)/2) = (z\u1d50 + z\u207b\u1d50)/2:\n\n2(T\u2098((z + z\u207b\u00b9)/2) - 1) = z\u1d50 + z\u207b\u1d50 - 2 = (z\u1d50 - 1)(z\u207b\u1d50 - 1) = (z\u1d50 - 1)\u00b2/z\u1d50\n\nSince z\u1d50 - 1 = \u220f_{d|m}\u03a6\u2090(z), we have:\n(z\u1d50 - 1)\u00b2 = (\u220f_{d|m}\u03a6\u2090(z))\u00b2\n\nUsing Task 3's identity for d \u2265 3: \u03a6\u2090(z) = z^(\u03c6(d)/2)C\u2090(z + z\u207b\u00b9)\n\nFor the factorization in terms of w = z + z\u207b\u00b9:\n- The roots w = 2cos(2\u03c0k/m) come from z\u1d50 = 1\n- k = 0 gives w = 2 (root of C\u2081 once)  \n- k = m/2 (if m even) gives w = -2 (root of C\u2082 once)\n- Other primitive dth roots contribute to C\u2090 with multiplicity 2\n\nTherefore: 2(T\u2098(x/2) - 1) = C\u2081(x)C\u2082(x)^(\u03b5(m))\u220f_{d|m, d\u22653}C\u2090(x)\u00b2 \u25a1"
    },
    "5": {
        "question": "Title: Geometry of numbers to the full two-squares theorem \u2014 Blichfeldt, Minkowski, and a sharp arithmetic application\n\nLet R^n be equipped with the Lebesgue measure vol. A lattice L \u2282 R^n is a discrete subgroup spanned by n linearly independent vectors; its determinant det(L) is the Lebesgue volume of any fundamental parallelotope P = {\u2211_{i=1}^n t_i v_i : t_i \u2208 [0,1)} for a basis v_1,\u2026,v_n of L. A set K \u2282 R^n is convex if along with x,y \u2208 K it contains every tx + (1\u2212t)y for t \u2208 [0,1], and centrally symmetric if K = \u2212K.\n\nYour tasks:\n\n1) Blichfeldt\u2019s lemma (pigeonhole in the torus). Prove: If S \u2282 R^n is measurable with vol(S) > det(L), then there exist distinct x,y \u2208 S with x \u2212 y \u2208 L.\n\n2) Minkowski\u2019s convex body theorem. Deduce from (1): If K \u2282 R^n is convex, centrally symmetric, measurable, and vol(K) > 2^n det(L), then K contains a nonzero lattice point of L.\n\n3) Fermat\u2019s two-squares theorem for primes via Minkowski. For an odd prime p, prove Wilson\u2019s identity (p\u22121)! \u2261 \u22121 (mod p), and deduce that \u22121 is a quadratic residue mod p if and only if p \u2261 1 (mod 4). Then, for p \u2261 1 (mod 4), fix k with k^2 \u2261 \u22121 (mod p) and consider the index-p sublattice\nL_k = {(x,y) \u2208 Z^2 : x \u2261 k y (mod p)}.\nShow det(L_k) = p. Apply Minkowski to an explicit centrally symmetric convex body K \u2282 R^2 of your choice to produce a nonzero (x,y) \u2208 L_k with 0 < x^2 + y^2 < 2p, infer p | (x^2 + y^2), and conclude p = x^2 + y^2.\n\n4) Complete classification (Fermat\u2013Euler two-squares theorem). Prove that a positive integer n is a sum of two integer squares if and only if every prime q \u2261 3 (mod 4) appears with an even exponent in the prime factorization of n. Your proof must be self-contained and may use the multiplicative identity\n(x^2 + y^2)(u^2 + v^2) = (xu \u2212 yv)^2 + (xv + yu)^2.\nInclude the \u201conly if\u201d direction (divisibility constraint for primes 3 mod 4) and the \u201cif\u201d direction (assemble prime-power representations multiplicatively).\n\nAnswer format:\n- Present a complete proof of Blichfeldt\u2019s lemma.\n- Deduce Minkowski\u2019s theorem rigorously from Blichfeldt.\n- Prove Wilson\u2019s congruence and the criterion for \u22121 to be a square mod p. Compute det(L_k). Specify a concrete body K whose volume exceeds 4 det(L_k) and argue that the produced lattice vector gives p = x^2 + y^2.\n- Prove both directions of the full characterization of sums of two squares, clearly indicating where you use the prime case and the product identity.",
        "answer": "I'll prove each part systematically, building from Blichfeldt's lemma to the complete characterization of sums of two squares.\n\n## 1) Blichfeldt's Lemma\n\n**Theorem:** If $S \\subset \\mathbb{R}^n$ is measurable with $\\text{vol}(S) > \\det(L)$, then there exist distinct $x,y \\in S$ with $x - y \\in L$.\n\n**Proof:**\nLet $P = \\{\\sum_{i=1}^n t_i v_i : t_i \\in [0,1)\\}$ be a fundamental parallelotope for basis $v_1, \\ldots, v_n$ of $L$. Every point $x \\in \\mathbb{R}^n$ can be uniquely written as $x = l_x + p_x$ where $l_x \\in L$ and $p_x \\in P$.\n\nDefine the projection $\\pi: \\mathbb{R}^n \\to P$ by $\\pi(x) = p_x$. For each coset $l + P$ with $l \\in L$, let $S_l = S \\cap (l + P)$. Then:\n- $S = \\bigcup_{l \\in L} S_l$ (disjoint union)\n- Translation preserves volume: $\\text{vol}(\\pi(S_l)) = \\text{vol}(S_l)$\n\nSince $\\text{vol}(S) = \\sum_{l \\in L} \\text{vol}(S_l) > \\det(L) = \\text{vol}(P)$, and all $\\pi(S_l) \\subset P$, there must exist distinct $l_1, l_2 \\in L$ such that $\\pi(S_{l_1}) \\cap \\pi(S_{l_2}) \\neq \\emptyset$.\n\nTherefore, there exist $x \\in S_{l_1}$ and $y \\in S_{l_2}$ with $\\pi(x) = \\pi(y)$. This means $x - l_1 = y - l_2$, so $x - y = l_1 - l_2 \\in L$ with $x \\neq y$. \u25a1\n\n## 2) Minkowski's Convex Body Theorem\n\n**Theorem:** If $K \\subset \\mathbb{R}^n$ is convex, centrally symmetric, measurable, and $\\text{vol}(K) > 2^n \\det(L)$, then $K$ contains a nonzero lattice point of $L$.\n\n**Proof:**\nConsider $S = \\frac{1}{2}K = \\{\\frac{1}{2}x : x \\in K\\}$. Then:\n$$\\text{vol}(S) = \\frac{1}{2^n} \\text{vol}(K) > \\det(L)$$\n\nBy Blichfeldt's lemma, there exist distinct $x, y \\in S$ with $x - y \\in L$.\n\nSince $x, y \\in \\frac{1}{2}K$, we have $2x, 2y \\in K$.\n\nSince $K$ is centrally symmetric, $-2y \\in K$.\n\nSince $K$ is convex and contains both $2x$ and $-2y$:\n$$\\frac{1}{2}(2x) + \\frac{1}{2}(-2y) = x - y \\in K$$\n\nSince $x \\neq y$, we have $x - y \\neq 0$, and $x - y \\in L$, giving us a nonzero lattice point in $K$. \u25a1\n\n## 3) Fermat's Two-Squares Theorem for Primes via Minkowski\n\n### Wilson's Identity\n**Lemma:** For odd prime $p$: $(p-1)! \\equiv -1 \\pmod{p}$\n\n**Proof:** By Fermat's Little Theorem, every nonzero element of $\\mathbb{Z}_p$ satisfies $x^{p-1} \\equiv 1 \\pmod{p}$. Thus:\n$$x^{p-1} - 1 \\equiv (x-1)(x-2)\\cdots(x-(p-1)) \\pmod{p}$$\n\nSetting $x = 0$:\n$$-1 \\equiv (-1)^{p-1} \\cdot (p-1)! \\pmod{p}$$\n\nSince $p$ is odd, $(-1)^{p-1} = 1$, so $(p-1)! \\equiv -1 \\pmod{p}$. \u25a1\n\n### Quadratic Residue Criterion\n**Lemma:** $-1$ is a quadratic residue mod $p$ if and only if $p \\equiv 1 \\pmod{4}$.\n\n**Proof:** By Euler's criterion, $-1$ is a quadratic residue mod $p$ iff $(-1)^{\\frac{p-1}{2}} \\equiv 1 \\pmod{p}$. This occurs iff $\\frac{p-1}{2}$ is even, i.e., $p \\equiv 1 \\pmod{4}$. \u25a1\n\n### Computing det(L_k)\nFor $p \\equiv 1 \\pmod{4}$ and $k^2 \\equiv -1 \\pmod{p}$:\n$$L_k = \\{(x,y) \\in \\mathbb{Z}^2 : x \\equiv ky \\pmod{p}\\}$$\n\nA basis for $L_k$ is:\n- $v_1 = (p, 0)$ (since $p \\equiv k \\cdot 0 \\pmod{p}$)\n- $v_2 = (k, 1)$ (since $k \\equiv k \\cdot 1 \\pmod{p}$)\n\nTherefore: $\\det(L_k) = \\left|\\begin{matrix} p & k \\\\ 0 & 1 \\end{matrix}\\right| = p$\n\n### Applying Minkowski\nConsider the disk $K = \\{(x,y) \\in \\mathbb{R}^2 : x^2 + y^2 < 2p\\}$.\n\nThis is convex, centrally symmetric, and has volume:\n$$\\text{vol}(K) = \\pi \\cdot 2p > 4p = 4\\det(L_k)$$\n(since $\\pi > 2$)\n\nBy Minkowski's theorem, there exists nonzero $(x,y) \\in L_k \\cap K$.\n\nThus $0 < x^2 + y^2 < 2p$ and $x \\equiv ky \\pmod{p}$.\n\nFrom $x \\equiv ky \\pmod{p}$: $x^2 \\equiv k^2y^2 \\equiv -y^2 \\pmod{p}$\n\nTherefore: $x^2 + y^2 \\equiv 0 \\pmod{p}$\n\nSince $0 < x^2 + y^2 < 2p$ and $p | (x^2 + y^2)$, we must have $x^2 + y^2 = p$. \u25a1\n\n## 4) Complete Classification (Fermat\u2013Euler Two-Squares Theorem)\n\n**Theorem:** A positive integer $n$ is a sum of two integer squares if and only if every prime $q \\equiv 3 \\pmod{4}$ appears with even exponent in the prime factorization of $n$.\n\n### \"Only if\" Direction\nSuppose $n = x^2 + y^2$ for integers $x, y$. Let $q \\equiv 3 \\pmod{4}$ be a prime dividing $n$.\n\n**Claim:** $q$ divides both $x$ and $y$.\n\n**Proof:** Suppose $q \\nmid y$. Then $y$ has an inverse modulo $q$, and:\n$$(xy^{-1})^2 \\equiv -1 \\pmod{q}$$\n\nBut $-1$ is not a quadratic residue mod $q$ when $q \\equiv 3 \\pmod{4}$, contradiction.\n\nSimilarly, $q | y$. Therefore $q^2 | (x^2 + y^2) = n$, so every prime $q \\equiv 3 \\pmod{4}$ appears with even exponent. \u25a1\n\n### \"If\" Direction\nSuppose every prime $q \\equiv 3 \\pmod{4}$ appears with even exponent in $n$.\n\nWrite: $n = 2^a \\cdot \\prod_{p \\equiv 1 \\pmod{4}} p^{b_p} \\cdot \\prod_{q \\equiv 3 \\pmod{4}} q^{2c_q}$\n\n**Base cases:**\n- $2 = 1^2 + 1^2$\n- Each prime $p \\equiv 1 \\pmod{4}$: $p = x_p^2 + y_p^2$ (from Part 3)\n- Each $q^{2c} = (q^c)^2 + 0^2$\n\nUsing the multiplicative identity $(x^2 + y^2)(u^2 + v^2) = (xu - yv)^2 + (xv + yu)^2$ repeatedly:\n- Powers of 2: Apply identity to build $2^a$ from $2 = 1^2 + 1^2$\n- Powers of primes $p \\equiv 1 \\pmod{4}$: Build $p^{b_p}$ from $p = x_p^2 + y_p^2$\n- Even powers of primes $q \\equiv 3 \\pmod{4}$: Already in form $(q^c)^2 + 0^2$\n\nCombining all factors using the multiplicative identity gives $n$ as a sum of two squares. \u25a1"
    },
    "6": {
        "question": "Title: Weyl\u2019s criterion, van der Corput\u2019s difference theorem, and equidistribution of polynomial sequences\n\nDefinitions:\n- For x \u2208 \u211d, write {x} for the fractional part of x in [0,1).\n- A sequence (x_n) \u2282 \u211d is equidistributed modulo 1 (or uniformly distributed mod 1) if for every interval [a,b) \u2282 [0,1), we have\n  lim_{N\u2192\u221e} (1/N) |{1 \u2264 n \u2264 N : {x_n} \u2208 [a,b)}| = b \u2212 a.\n- For t \u2208 \u211d, write e(t) := exp(2\u03c0 i t).\n\nProblem. Prove the following, self-contained and in order:\n\n1) Weyl\u2019s criterion. Show that a sequence (x_n) is equidistributed mod 1 if and only if for every nonzero integer k,\n   lim_{N\u2192\u221e} (1/N) \u2211_{n=1}^N e(k x_n) = 0.\n\n2) van der Corput\u2019s difference theorem. Let (x_n) be a real sequence. Suppose that for every positive integer h and every nonzero integer k,\n   lim_{N\u2192\u221e} (1/N) \u2211_{n=1}^{N\u2212h} e(k (x_{n+h} \u2212 x_n)) = 0.\n   Prove that (x_n) is equidistributed mod 1.\n\n3) Polynomial equidistribution. Let P \u2208 \u211d[X] be a nonconstant polynomial\n   P(n) = a_d n^d + a_{d\u22121} n^{d\u22121} + \u2026 + a_1 n + a_0\n   with at least one of a_1,\u2026,a_d irrational. Prove that ({P(n)}) is equidistributed mod 1. In particular, for every irrational \u03b1 and every integer d \u2265 1, the sequence ({\u03b1 n^d}) is equidistributed.\n\nAnswer format:\n- Prove (1) in full detail.\n- Prove (2) from (1) using a suitable averaging/inequality.\n- Deduce (3) by induction on deg P, using (2) and the base case of linear sequences.",
        "answer": "[Error: errored]"
    },
    "7": {
        "question": "Title: Finite-field Kakeya via the polynomial method \u2014 a sharp-dimensional lower bound and a robust r-rich variant\n\nLet q be a prime power and F_q the finite field with q elements. For n \u2265 1, write F_q^n for the n-dimensional vector space over F_q.\n\nDefinitions:\n- A (nonzero) direction is a 1-dimensional subspace of F_q^n, i.e., a set {c v : c \u2208 F_q} for some fixed v \u2208 F_q^n \\ {0}. We informally identify a direction with any of its nonzero vectors v.\n- An affine line in direction v is any set of the form L = {a + t v : t \u2208 F_q} with a \u2208 F_q^n, v \u2208 F_q^n \\ {0}.\n- A Kakeya set K \u2282 F_q^n is a set that contains at least one line in every direction; i.e., for every v \u2260 0, there exist a \u2208 F_q^n such that a + t v \u2208 K for all t \u2208 F_q.\n- More generally, for an integer r with 1 \u2264 r \u2264 q, a set E \u2282 F_q^n is called r-rich in directions if for every v \u2260 0 there exists a line L = {a + t v} in direction v such that |L \u2229 E| \u2265 r.\n\nFor nonnegative integers d, let P_{n,\u2264d}(F_q) denote the F_q-vector space of polynomials in n variables x = (x_1,\u2026,x_n) over F_q of total degree \u2264 d. Let N(n,d) be its dimension (i.e., the number of monomials of total degree \u2264 d in n variables).\n\nTasks:\n1) Show that N(n,d) = C(n+d, n) = binomial(n + d, n). In particular, N(n,q\u22121) = C(n + q \u2212 1, n) and N(n,r\u22121) = C(n + r \u2212 1, n).\n2) Linear algebra lemma (vanishing polynomial on a small set). Prove: If S \u2282 F_q^n is finite and |S| < N(n,d), then there exists a nonzero polynomial P \u2208 P_{n,\u2264d}(F_q) that vanishes on S (i.e., P(s) = 0 for every s \u2208 S).\n3) Leading form on a line. For P \u2208 P_{n,\u2264d}(F_q), write P = H_m + H_{m\u22121} + \u2026 + H_0, where H_k is homogeneous of degree k and m = deg P. Prove: For any a,v \u2208 F_q^n with v \u2260 0, the univariate polynomial Q(t) := P(a + t v) has degree \u2264 m and its leading coefficient is H_m(v).\n4) Dvir\u2019s Kakeya bound. Prove: If K \u2282 F_q^n is a Kakeya set, then |K| \u2265 N(n,q\u22121) = C(n+q\u22121, n). In particular, |K| \u2265 q^n / n!. Give a complete proof using only the above ingredients.\n5) Robust r-rich variant. Prove: If E \u2282 F_q^n is r-rich in directions, then |E| \u2265 N(n,r\u22121) = C(n + r \u2212 1, n).\n\nAnswer format:\n- Provide a complete, self-contained proof of each task, rigorously justifying all steps and identities.\n- Your final bound in (4) should be stated both as |K| \u2265 C(n+q\u22121, n) and the crude but explicit |K| \u2265 q^n / n!.\n- For (5), clearly indicate the substitution r = q recovers (4).",
        "answer": "I'll provide complete proofs for each task, building towards Dvir's polynomial method for the finite field Kakeya problem.\n\n## Task 1: Counting Monomials\n\n**Claim:** $N(n,d) = \\binom{n+d}{n}$\n\n**Proof:** \n$N(n,d)$ counts monomials $x_1^{a_1} \\cdots x_n^{a_n}$ where $a_i \\geq 0$ and $\\sum_{i=1}^n a_i \\leq d$.\n\nTo count these, introduce a slack variable $s \\geq 0$ such that:\n$$a_1 + a_2 + \\cdots + a_n + s = d$$\n\nNow we need to count $(n+1)$-tuples $(a_1, \\ldots, a_n, s)$ of non-negative integers summing to exactly $d$.\n\nBy the stars-and-bars formula, this equals:\n$$\\binom{d + (n+1) - 1}{(n+1) - 1} = \\binom{d + n}{n}$$\n\nTherefore:\n- $N(n, q-1) = \\binom{n + q - 1}{n}$\n- $N(n, r-1) = \\binom{n + r - 1}{n}$ \u25a1\n\n## Task 2: Vanishing Polynomial on Small Sets\n\n**Claim:** If $S \\subset F_q^n$ with $|S| < N(n,d)$, then there exists a nonzero $P \\in P_{n,\\leq d}(F_q)$ vanishing on $S$.\n\n**Proof:**\nConsider the evaluation map:\n$$\\text{ev}: P_{n,\\leq d}(F_q) \\to F_q^S, \\quad P \\mapsto (P(s))_{s \\in S}$$\n\nThis is a linear map between vector spaces over $F_q$ where:\n- $\\dim(P_{n,\\leq d}(F_q)) = N(n,d)$\n- $\\dim(F_q^S) = |S|$\n\nSince $|S| < N(n,d)$, we have $\\dim(\\text{domain}) > \\dim(\\text{codomain})$.\n\nBy the rank-nullity theorem:\n$$\\dim(\\ker(\\text{ev})) = N(n,d) - \\dim(\\text{im}(\\text{ev})) \\geq N(n,d) - |S| > 0$$\n\nTherefore $\\ker(\\text{ev}) \\neq \\{0\\}$. Any nonzero element of $\\ker(\\text{ev})$ is a polynomial vanishing on $S$. \u25a1\n\n## Task 3: Leading Form on a Line\n\n**Claim:** For $P = H_m + H_{m-1} + \\cdots + H_0$ with $H_k$ homogeneous of degree $k$, and $a, v \\in F_q^n$ with $v \\neq 0$, the polynomial $Q(t) = P(a + tv)$ has degree $\\leq m$ with leading coefficient $H_m(v)$.\n\n**Proof:**\nWe have:\n$$Q(t) = P(a + tv) = \\sum_{k=0}^m H_k(a + tv)$$\n\nFor each homogeneous polynomial $H_k$ of degree $k$, we analyze $H_k(a + tv)$.\n\nConsider a monomial $x_1^{b_1} \\cdots x_n^{b_n}$ with $\\sum b_i = k$. Substituting $x_i = a_i + tv_i$:\n$$(a_1 + tv_1)^{b_1} \\cdots (a_n + tv_n)^{b_n}$$\n\nBy the binomial theorem, the coefficient of $t^j$ in this expansion has degree $j$ in the $v_i$'s. The highest power $t^k$ occurs when we take $tv_i$ from each factor, giving coefficient $v_1^{b_1} \\cdots v_n^{b_n}$.\n\nTherefore, for $H_k(a + tv)$:\n- The degree in $t$ is at most $k$\n- The coefficient of $t^k$ is $H_k(v)$ (by homogeneity)\n\nIn $Q(t) = \\sum_{k=0}^m H_k(a + tv)$:\n- Only $H_m(a + tv)$ contributes to the $t^m$ term\n- The coefficient of $t^m$ is $H_m(v)$\n- $\\deg(Q) \\leq m$ \u25a1\n\n## Task 4: Dvir's Kakeya Bound\n\n**Theorem:** If $K \\subset F_q^n$ is a Kakeya set, then $|K| \\geq \\binom{n+q-1}{n} \\geq \\frac{q^n}{n!}$.\n\n**Proof:**\nSuppose for contradiction that $|K| < N(n, q-1) = \\binom{n+q-1}{n}$.\n\nBy Task 2, there exists a nonzero polynomial $P \\in P_{n,\\leq q-1}(F_q)$ vanishing on $K$.\n\nWrite $P = H_m + H_{m-1} + \\cdots + H_0$ where $H_k$ is homogeneous of degree $k$ and $m = \\deg(P) \\leq q-1$.\n\nFor any direction $v \\neq 0$: Since $K$ is Kakeya, there exists $a \\in F_q^n$ such that the line $L = \\{a + tv : t \\in F_q\\} \\subset K$.\n\nConsider $Q(t) = P(a + tv)$. Since $P$ vanishes on $K$ and $L \\subset K$:\n- $Q(t) = 0$ for all $t \\in F_q$ (i.e., $Q$ has $q$ roots)\n- By Task 3, $\\deg(Q) \\leq m \\leq q-1$\n\nA nonzero polynomial of degree $\\leq q-1$ over $F_q$ has at most $q-1$ roots. Since $Q$ has $q$ roots, $Q$ must be the zero polynomial.\n\nBy Task 3, the coefficient of $t^m$ in $Q(t)$ is $H_m(v)$. Since $Q \\equiv 0$, we have $H_m(v) = 0$.\n\nThis holds for every direction $v \\neq 0$. By homogeneity, $H_m(0) = 0$ as well (since $H_m$ has positive degree). Thus $H_m$ vanishes on all of $F_q^n$.\n\n**Key fact:** A polynomial in $F_q[x_1, \\ldots, x_n]$ vanishing on all of $F_q^n$ must be in the ideal $(x_1^q - x_1, \\ldots, x_n^q - x_n)$. Since each generator has degree $q$, any nonzero polynomial in this ideal has degree $\\geq q$.\n\nSince $\\deg(H_m) = m \\leq q-1 < q$ and $H_m$ vanishes on $F_q^n$, we must have $H_m = 0$.\n\nNow $P = H_{m-1} + \\cdots + H_0$. Repeating the argument with the new leading term, we eventually conclude $P = 0$, contradicting that $P$ is nonzero.\n\nTherefore $|K| \\geq \\binom{n+q-1}{n}$.\n\nFor the crude bound:\n$$\\binom{n+q-1}{n} = \\frac{(n+q-1)(n+q-2)\\cdots q}{n!} \\geq \\frac{q^n}{n!}$$\n\nsince we have $n$ factors in the numerator, each at least $q$. \u25a1\n\n## Task 5: Robust r-rich Variant\n\n**Theorem:** If $E \\subset F_q^n$ is $r$-rich in directions, then $|E| \\geq \\binom{n+r-1}{n}$.\n\n**Proof:**\nThe proof parallels Task 4. Suppose $|E| < N(n, r-1) = \\binom{n+r-1}{n}$.\n\nBy Task 2, there exists nonzero $P \\in P_{n,\\leq r-1}(F_q)$ vanishing on $E$.\n\nFor any direction $v \\neq 0$: Since $E$ is $r$-rich, there exists a line $L = \\{a + tv : t \\in F_q\\}$ with $|L \\cap E| \\geq r$.\n\nConsider $Q(t) = P(a + tv)$:\n- $Q$ vanishes on at least $r$ points (those in $L \\cap E$)\n- $\\deg(Q) \\leq r-1$\n\nSince a nonzero polynomial of degree $\\leq r-1$ has at most $r-1$ roots, but $Q$ has at least $r$ roots, $Q \\equiv 0$.\n\nFollowing the same argument as Task 4 (using the leading coefficient), we conclude that the top homogeneous component of $P$ vanishes on all directions, hence on all of $F_q^n$. Since its degree is $< r \\leq q$, it must be zero. Iterating, we get $P = 0$, a contradiction.\n\nTherefore $|E| \\geq \\binom{n+r-1}{n}$. \u25a1\n\n**Note:** Setting $r = q$ recovers Task 4, since a $q$-rich set contains a complete line in every direction, making it a Kakeya set."
    },
    "8": {
        "question": "Title: Wigner\u2019s semicircle law via the moment method \u2014 convergence in probability under bounded moments\n\nLet (W_n) be a sequence of real symmetric random matrices of size n \u00d7 n with independent entries on and above the diagonal. Assume:\n\n- For i < j, the off-diagonal entries X_{ij} are i.i.d. with E[X_{ij}] = 0, E[X_{ij}^2] = 1, and for every integer m \u2265 1, sup_{n,i<j} E[|X_{ij}|^m] < \u221e.\n- The diagonal entries X_{ii} are independent of the off-diagonal entries, satisfy E[X_{ii}] = 0, and sup_{n,i} E[|X_{ii}|^m] < \u221e for every m \u2265 1.\n\nForm W_n by setting (W_n)_{ij} = X_{ij} for i \u2264 j and (W_n)_{ij} = X_{ji} for i > j. Define the scaled matrix M_n := W_n / \u221an. Since M_n is symmetric, its eigenvalues are real; write them as \u03bb_1(M_n),\u2026,\u03bb_n(M_n). The empirical spectral distribution (ESD) of M_n is the random probability measure\n\u03bc_{M_n} := (1/n) \u2211_{i=1}^n \u03b4_{\u03bb_i(M_n)} on \u211d.\n\nThe semicircle distribution \u03bc_sc is the probability measure with density\n\u03c1_sc(x) = (1/(2\u03c0)) sqrt(4 \u2212 x^2) on [\u22122,2] and 0 otherwise.\n\nTasks:\n\n1) Limiting expected moments (moment method). For each fixed integer k \u2265 0, prove that\nlim_{n\u2192\u221e} E[ \u222b x^k d\u03bc_{M_n}(x) ] = m_k,\nwhere m_k = 0 if k is odd and m_{2m} = C_m := (1/(m+1)) binom(2m,m) (the mth Catalan number). Your proof must:\n- Expand (1/n) Tr(M_n^k) as a sum over closed index-words i_1,\u2026,i_k with i_{k+1} := i_1.\n- Show that only words in which each unordered edge {i_t,i_{t+1}} appears exactly twice and whose underlying graph is a tree contribute in the limit.\n- Enumerate these contributing words and prove that their number equals C_m (give a self-contained combinatorial argument).\n\n2) Variance vanishes. For each fixed k, prove Var( \u222b x^k d\u03bc_{M_n}(x) ) \u2192 0 as n \u2192 \u221e. In particular, \u222b x^k d\u03bc_{M_n}(x) converges in probability to m_k.\n\n3) Semicircle moments and uniqueness. Compute directly the moments of \u03bc_sc:\nM_{2m} := \u222b_{\u22122}^2 x^{2m} \u03c1_sc(x) dx = C_m and M_{2m+1} = 0. Verify Carleman\u2019s condition \u2211_{m=1}^\u221e M_{2m}^{\u22121/(2m)} = \u221e, and conclude that \u03bc_sc is uniquely determined by its moments.\n\n4) Convergence of the ESD. Prove that \u03bc_{M_n} converges weakly in probability to \u03bc_sc. More precisely: for every bounded continuous \u03c6: \u211d \u2192 \u211d,\n\u222b \u03c6 d\u03bc_{M_n} \u2192 \u222b \u03c6 d\u03bc_sc in probability.\n\nAnswer format:\n- Give a complete, self-contained proof of each task with all definitions used, justified combinatorial counts, and moment/variance bounds.\n- You may assume standard facts about independence, basic combinatorics (Catalan recursion), and basic measure/probability convergence notions, but do not assume any random matrix theory beyond what you prove here.",
        "answer": "Looking at this problem about Wigner's semicircle law, I'll work through each task systematically.\n\n## Task 1: Limiting Expected Moments\n\n### Step 1: Expand the trace\nFor the empirical spectral distribution, we have:\n$$\\int x^k d\\mu_{M_n}(x) = \\frac{1}{n}\\sum_{i=1}^n \\lambda_i(M_n)^k = \\frac{1}{n}\\text{Tr}(M_n^k)$$\n\nExpanding the trace using matrix multiplication:\n$$\\text{Tr}(M_n^k) = \\sum_{i_1,i_2,\\ldots,i_k} (M_n)_{i_1i_2}(M_n)_{i_2i_3}\\cdots(M_n)_{i_ki_1}$$\n\nSince $M_n = W_n/\\sqrt{n}$:\n$$\\text{Tr}(M_n^k) = \\frac{1}{n^{k/2}}\\sum_{i_1,\\ldots,i_k} X_{i_1i_2}X_{i_2i_3}\\cdots X_{i_ki_1}$$\n\nwhere we sum over all closed index-words $(i_1,\\ldots,i_k)$ with $i_{k+1} := i_1$.\n\n### Step 2: Expected value analysis\n$$E\\left[\\int x^k d\\mu_{M_n}(x)\\right] = \\frac{1}{n^{1+k/2}}\\sum_{i_1,\\ldots,i_k} E[X_{i_1i_2}X_{i_2i_3}\\cdots X_{i_ki_1}]$$\n\nSince entries are independent (up to symmetry) with $E[X_{ij}] = 0$:\n- If any edge $\\{i_t, i_{t+1}\\}$ appears exactly once, the expectation vanishes\n- Non-zero contributions require each edge to appear at least twice\n\nFor odd $k$: The total number of edge occurrences is odd, so at least one edge must appear an odd number of times. Thus $E[\\int x^k d\\mu_{M_n}] = 0$ for odd $k$.\n\nFor even $k = 2m$: The dominant contribution (order $O(1)$) comes from walks where:\n1. Each edge appears exactly twice\n2. The underlying graph is a tree with $m+1$ vertices\n\n### Step 3: Counting contributing walks\n\nA walk with these properties corresponds to a depth-first traversal of a tree:\n- Starting from a root, we traverse each edge exactly twice (once down, once up)\n- This creates a bijection with balanced parenthesis sequences of length $2m$\n\n**Combinatorial argument for Catalan numbers:**\n\nDefine $C_m$ as the number of such tree-traversal walks. These satisfy the recursion:\n$$C_0 = 1, \\quad C_{m+1} = \\sum_{k=0}^m C_k C_{m-k}$$\n\nThis recursion counts by splitting at the first return to the root: if the first return occurs after $2k+2$ steps, the first part forms a tree with $k$ edges, and the remaining part forms a tree with $m-k$ edges.\n\nSolving this recursion gives $C_m = \\frac{1}{m+1}\\binom{2m}{m}$, the $m$-th Catalan number.\n\nThe contribution from these walks is:\n$$\\lim_{n\\to\\infty} E\\left[\\int x^{2m} d\\mu_{M_n}\\right] = C_m$$\n\n## Task 2: Variance Vanishes\n\nWe need to show $\\text{Var}(\\int x^k d\\mu_{M_n}) \\to 0$.\n\n$$\\text{Var}\\left(\\int x^k d\\mu_{M_n}\\right) = E\\left[\\left(\\frac{1}{n}\\text{Tr}(M_n^k)\\right)^2\\right] - \\left(E\\left[\\frac{1}{n}\\text{Tr}(M_n^k)\\right]\\right)^2$$\n\nFor the second moment:\n$$E[(\\text{Tr}(M_n^k))^2] = \\sum_{i_1,\\ldots,i_k}\\sum_{j_1,\\ldots,j_k} E[X_{i_1i_2}\\cdots X_{i_ki_1}X_{j_1j_2}\\cdots X_{j_kj_1}]/n^k$$\n\nThe dominant terms (order $n^{2+k}$) come from pairs of independent tree-walks, giving:\n$$E[(\\text{Tr}(M_n^k))^2] = n^2 m_k^2 + o(n^2)$$\n\nTherefore:\n$$E\\left[\\left(\\int x^k d\\mu_{M_n}\\right)^2\\right] = m_k^2 + o(1)$$\n\nSince $E[\\int x^k d\\mu_{M_n}] \\to m_k$, we have $\\text{Var}(\\int x^k d\\mu_{M_n}) \\to 0$.\n\n## Task 3: Semicircle Moments and Uniqueness\n\n### Computing moments of $\\mu_{sc}$:\n\nFor even moments, using the substitution $x = 2\\sin\\theta$:\n$$M_{2m} = \\int_{-2}^2 x^{2m}\\frac{1}{2\\pi}\\sqrt{4-x^2}dx = \\frac{2^{2m+1}}{\\pi}\\int_0^{\\pi/2}\\sin^{2m}\\theta\\cos^2\\theta d\\theta$$\n\nUsing the Beta function: $\\int_0^{\\pi/2}\\sin^{2m}\\theta\\cos^2\\theta d\\theta = \\frac{\\pi}{2^{2m+2}}\\frac{(2m)!}{m!(m+1)!}$\n\nThis gives $M_{2m} = C_m$.\n\nFor odd moments: $M_{2m+1} = 0$ by symmetry.\n\n### Carleman's condition:\n\nSince $C_m \\sim \\frac{4^m}{\\sqrt{\\pi m^3}}$ (by Stirling's approximation):\n$$C_m^{-1/(2m)} \\sim \\frac{1}{2}\\left(\\frac{m^3}{\\pi}\\right)^{1/(4m)} \\to \\frac{1}{2}$$\n\nTherefore: $\\sum_{m=1}^\\infty M_{2m}^{-1/(2m)} = \\infty$\n\nThe moments uniquely determine $\\mu_{sc}$.\n\n## Task 4: Convergence of the ESD\n\nFrom Tasks 1-3:\n- Each moment $\\int x^k d\\mu_{M_n} \\to m_k$ in probability\n- These limits are the moments of $\\mu_{sc}$\n- $\\mu_{sc}$ is uniquely determined by its moments\n\nFor weak convergence in probability:\n\nGiven bounded continuous $\\phi: \\mathbb{R} \\to \\mathbb{R}$ and $\\epsilon > 0$:\n\n1. Choose $R$ such that $\\mu_{sc}([-R,R]) > 1-\\epsilon/4$\n2. By Weierstrass approximation, find polynomial $p$ with $|\\phi(x)-p(x)| < \\epsilon/4$ on $[-R,R]$\n3. By moment convergence: $P(|\\int p d\\mu_{M_n} - \\int p d\\mu_{sc}| > \\epsilon/4) \\to 0$\n\nSince the tails of both $\\mu_{M_n}$ and $\\mu_{sc}$ outside $[-R,R]$ contribute at most $\\epsilon/2$ to the integral of the bounded function $\\phi$:\n\n$$P\\left(\\left|\\int \\phi d\\mu_{M_n} - \\int \\phi d\\mu_{sc}\\right| > \\epsilon\\right) \\to 0$$\n\nTherefore, $\\mu_{M_n}$ converges weakly to $\\mu_{sc}$ in probability."
    },
    "9": {
        "question": "Title: Poisson summation for Schwartz functions, the theta transformation, and the functional equation of the Riemann zeta function\n\nLet S(R) denote the Schwartz space on the real line: f \u2208 S(R) if f: R \u2192 C is smooth and for every pair of nonnegative integers m,k one has sup_{x\u2208R} |x^m f^{(k)}(x)| < \u221e. For f \u2208 S(R), define its Fourier transform by\nhat f(\u03be) = \u222b_{\u2212\u221e}^{\u221e} f(x) e^{\u22122\u03c0 i x \u03be} dx, \u03be \u2208 R.\n\nDefine the Jacobi theta function \u03b8: (0,\u221e) \u2192 R by \u03b8(t) = \u2211_{n\u2208Z} e^{\u2212\u03c0 t n^2}. For Re s > 1, define the Riemann zeta function \u03b6(s) = \u2211_{n=1}^\u221e n^{\u2212s}. Let \u0393 denote the Euler gamma function \u0393(s) = \u222b_0^\u221e t^{s\u22121} e^{\u2212t} dt for Re s > 0.\n\nTask. Prove, self-contained and in order:\n\n1) Poisson Summation Formula (PSF). Prove that for every f \u2208 S(R),\n\u2211_{n\u2208Z} f(n) = \u2211_{k\u2208Z} hat f(k).\nYour proof must be complete and include: (i) the uniform absolute convergence (with all derivatives) of the periodization F(x) = \u2211_{n\u2208Z} f(x+n), hence F is 1-periodic and smooth; (ii) computation of the Fourier coefficients of F and absolute convergence of its Fourier series.\n\n2) Theta transformation formula. For t > 0, consider g_t(x) = e^{\u2212\u03c0 t x^2}. Prove that hat g_t(\u03be) = t^{\u22121/2} e^{\u2212\u03c0 \u03be^2 / t} (compute the Fourier transform of the Gaussian). Deduce from PSF the Jacobi identity\n\u03b8(t) = t^{\u22121/2} \u03b8(1/t) for all t > 0.\nShow also that \u03b8(t) \u2212 1 = 2 \u2211_{n=1}^\u221e e^{\u2212\u03c0 n^2 t} decays exponentially as t \u2192 +\u221e and that \u03b8(t) \u223c t^{\u22121/2} as t \u2192 0+.\n\n3) Functional equation for \u03b6. For s \u2208 C, set \u039b(s) = \u03c0^{\u2212s/2} \u0393(s/2) \u03b6(s). Prove:\n- For Re s > 1, the Mellin transform identity\n\u222b_0^\u221e (\u03b8(t) \u2212 1) t^{s/2 \u2212 1} dt = 2 \u039b(s).\nJustify the exchange of sum and integral rigorously.\n- Show that the integral\nJ(s) := \u222b_1^\u221e (\u03b8(t) \u2212 1) (t^{s/2 \u2212 1} + t^{\u2212(s+1)/2}) dt\nconverges absolutely for all s \u2208 C and defines an entire function, and that J(s) = J(1 \u2212 s).\n- Prove, for Re s > 1,\n2 \u039b(s) = J(s) + 2/(s \u2212 1) \u2212 2/s,\nand conclude by analytic continuation that \u039b(s) = \u039b(1 \u2212 s) for all s \u2208 C, i.e.\n\u03c0^{\u2212s/2} \u0393(s/2) \u03b6(s) = \u03c0^{\u2212(1\u2212s)/2} \u0393((1\u2212s)/2) \u03b6(1 \u2212 s).\nFinally, deduce that \u03b6(s) extends meromorphically to C with a unique simple pole at s = 1 of residue 1.\n\nAnswer format: Provide complete proofs of (1), (2), and (3), justifying uniform/absolute convergence and all interchanges of limiting operations. State the final functional equation explicitly.",
        "answer": "Looking at this comprehensive problem on the functional equation of the Riemann zeta function, I'll provide complete proofs for each part.\n\n## Part 1: Poisson Summation Formula\n\n**Theorem:** For every $f \\in S(\\mathbb{R})$, we have $\\sum_{n \\in \\mathbb{Z}} f(n) = \\sum_{k \\in \\mathbb{Z}} \\hat{f}(k)$.\n\n**Proof:**\n\n**(i) Convergence of the periodization:**\nDefine $F(x) = \\sum_{n \\in \\mathbb{Z}} f(x+n)$. Since $f \\in S(\\mathbb{R})$, for any $m \\geq 2$ and $k \\geq 0$:\n$$\\sup_{x \\in \\mathbb{R}} |x^m f^{(k)}(x)| = C_{m,k} < \\infty$$\n\nThis gives us $|f^{(k)}(x+n)| \\leq \\frac{C_{m,k}}{|x+n|^m}$ for $x+n \\neq 0$.\n\nFor $x \\in [0,1]$ and $n \\neq 0$:\n- If $n \\geq 1$: $|x+n| \\geq n$\n- If $n \\leq -2$: $|x+n| \\geq |n|-1 \\geq |n|/2$\n\nTherefore, for $m > 1$:\n$$\\sum_{n \\in \\mathbb{Z}} \\sup_{x \\in [0,1]} |f^{(k)}(x+n)| \\leq C_{m,k}\\left(|f^{(k)}(x)| + |f^{(k)}(x-1)| + \\sum_{n \\geq 1} \\frac{1}{n^m} + \\sum_{n \\geq 2} \\frac{2}{n^m}\\right) < \\infty$$\n\nThis establishes uniform absolute convergence of $F$ and all its derivatives on $[0,1]$. Hence $F$ is smooth and 1-periodic.\n\n**(ii) Fourier coefficients:**\nThe Fourier coefficients of the 1-periodic function $F$ are:\n$$c_k = \\int_0^1 F(x) e^{-2\\pi i k x} dx = \\int_0^1 \\sum_{n \\in \\mathbb{Z}} f(x+n) e^{-2\\pi i k x} dx$$\n\nBy uniform convergence, we can interchange sum and integral:\n$$c_k = \\sum_{n \\in \\mathbb{Z}} \\int_0^1 f(x+n) e^{-2\\pi i k x} dx$$\n\nSubstituting $y = x + n$:\n$$c_k = \\sum_{n \\in \\mathbb{Z}} \\int_n^{n+1} f(y) e^{-2\\pi i k y} dy = \\int_{-\\infty}^{\\infty} f(y) e^{-2\\pi i k y} dy = \\hat{f}(k)$$\n\nSince $\\hat{f} \\in S(\\mathbb{R})$, we have $\\sum_{k \\in \\mathbb{Z}} |\\hat{f}(k)| < \\infty$, so the Fourier series converges absolutely:\n$$F(x) = \\sum_{k \\in \\mathbb{Z}} \\hat{f}(k) e^{2\\pi i k x}$$\n\nSetting $x = 0$: $\\sum_{n \\in \\mathbb{Z}} f(n) = F(0) = \\sum_{k \\in \\mathbb{Z}} \\hat{f}(k)$ \u220e\n\n## Part 2: Theta Transformation Formula\n\n**Computing the Fourier transform of the Gaussian:**\nFor $g_t(x) = e^{-\\pi t x^2}$:\n$$\\hat{g}_t(\\xi) = \\int_{-\\infty}^{\\infty} e^{-\\pi t x^2} e^{-2\\pi i x \\xi} dx$$\n\nCompleting the square:\n$$-\\pi t x^2 - 2\\pi i x \\xi = -\\pi t\\left(x + \\frac{i\\xi}{t}\\right)^2 - \\frac{\\pi \\xi^2}{t}$$\n\nTherefore:\n$$\\hat{g}_t(\\xi) = e^{-\\pi \\xi^2/t} \\int_{-\\infty}^{\\infty} e^{-\\pi t(x + i\\xi/t)^2} dx$$\n\nBy contour shifting (the integrand decays exponentially in the vertical direction):\n$$\\int_{-\\infty}^{\\infty} e^{-\\pi t(x + i\\xi/t)^2} dx = \\int_{-\\infty}^{\\infty} e^{-\\pi t u^2} du = t^{-1/2}$$\n\nThus: $\\hat{g}_t(\\xi) = t^{-1/2} e^{-\\pi \\xi^2/t}$\n\n**Jacobi identity:**\nApplying PSF to $g_t$:\n$$\\sum_{n \\in \\mathbb{Z}} e^{-\\pi t n^2} = \\sum_{k \\in \\mathbb{Z}} t^{-1/2} e^{-\\pi k^2/t} = t^{-1/2} \\sum_{k \\in \\mathbb{Z}} e^{-\\pi k^2/t}$$\n\nThis gives: $\\theta(t) = t^{-1/2} \\theta(1/t)$\n\n**Asymptotic behavior:**\nSince $\\theta(t) = 1 + 2\\sum_{n=1}^{\\infty} e^{-\\pi n^2 t}$:\n- As $t \\to \\infty$: $\\theta(t) - 1 = 2\\sum_{n=1}^{\\infty} e^{-\\pi n^2 t} \\leq 2e^{-\\pi t}/(1-e^{-\\pi t}) = O(e^{-\\pi t})$\n- As $t \\to 0^+$: Using $\\theta(t) = t^{-1/2}\\theta(1/t)$ and $\\theta(1/t) \\to 1$, we get $\\theta(t) \\sim t^{-1/2}$\n\n## Part 3: Functional Equation for \u03b6\n\n**Mellin transform identity:**\nFor $\\text{Re}(s) > 1$:\n$$\\int_0^{\\infty} (\\theta(t) - 1) t^{s/2-1} dt = 2\\int_0^{\\infty} \\sum_{n=1}^{\\infty} e^{-\\pi n^2 t} t^{s/2-1} dt$$\n\nSince $\\sum_{n=1}^{\\infty} \\int_0^{\\infty} e^{-\\pi n^2 t} |t^{s/2-1}| dt = \\sum_{n=1}^{\\infty} n^{-\\text{Re}(s)} \\Gamma(\\text{Re}(s)/2)/\\pi^{\\text{Re}(s)/2} < \\infty$ for $\\text{Re}(s) > 1$, we can exchange sum and integral:\n\n$$= 2\\sum_{n=1}^{\\infty} \\int_0^{\\infty} e^{-\\pi n^2 t} t^{s/2-1} dt$$\n\nSubstituting $u = \\pi n^2 t$:\n$$= 2\\sum_{n=1}^{\\infty} \\frac{1}{(\\pi n^2)^{s/2}} \\Gamma(s/2) = 2\\pi^{-s/2} \\Gamma(s/2) \\zeta(s) = 2\\Lambda(s)$$\n\n**The entire function J(s):**\nSplit the integral at $t = 1$:\n$$2\\Lambda(s) = \\int_0^1 (\\theta(t) - 1) t^{s/2-1} dt + \\int_1^{\\infty} (\\theta(t) - 1) t^{s/2-1} dt$$\n\nIn the first integral, substitute $t = 1/u$:\n$$\\int_0^1 (\\theta(t) - 1) t^{s/2-1} dt = \\int_1^{\\infty} (\\theta(1/u) - 1) u^{-s/2-1} du$$\n\nUsing $\\theta(1/u) = u^{1/2}\\theta(u)$:\n$$\\theta(1/u) - 1 = u^{1/2}\\theta(u) - 1 = u^{1/2}(\\theta(u) - 1) + (u^{1/2} - 1)$$\n\nTherefore:\n$$\\int_1^{\\infty} (\\theta(1/u) - 1) u^{-s/2-1} du = \\int_1^{\\infty} (\\theta(u) - 1) u^{-(s+1)/2} du + \\int_1^{\\infty} (u^{1/2} - 1) u^{-s/2-1} du$$\n\nThe second integral equals:\n$$\\int_1^{\\infty} (u^{-s/2-1/2} - u^{-s/2-1}) du = \\frac{2}{s-1} - \\frac{2}{s}$$\n\nThus:\n$$2\\Lambda(s) = J(s) + \\frac{2}{s-1} - \\frac{2}{s}$$\n\nwhere $J(s) = \\int_1^{\\infty} (\\theta(t) - 1)(t^{s/2-1} + t^{-(s+1)/2}) dt$.\n\nSince $\\theta(t) - 1 = O(e^{-\\pi t})$ as $t \\to \\infty$, the integral $J(s)$ converges absolutely for all $s \\in \\mathbb{C}$ and defines an entire function.\n\n**Symmetry of J:**\n$$J(1-s) = \\int_1^{\\infty} (\\theta(t) - 1)(t^{-(s+1)/2} + t^{s/2-1}) dt = J(s)$$\n\n**Functional equation:**\nSince $J(s) = J(1-s)$ and $2\\Lambda(s) = J(s) + \\frac{2}{s-1} - \\frac{2}{s}$:\n$$2\\Lambda(1-s) = J(1-s) + \\frac{2}{-s} - \\frac{2}{1-s} = J(s) + \\frac{2}{s-1} - \\frac{2}{s} = 2\\Lambda(s)$$\n\nTherefore: $\\Lambda(s) = \\Lambda(1-s)$ for all $s \\in \\mathbb{C}$.\n\n**Final functional equation:**\n$$\\boxed{\\pi^{-s/2} \\Gamma(s/2) \\zeta(s) = \\pi^{-(1-s)/2} \\Gamma((1-s)/2) \\zeta(1-s)}$$\n\n**Meromorphic continuation:**\nThe equation $2\\Lambda(s) = J(s) + \\frac{2}{s-1} - \\frac{2}{s}$ shows that $\\Lambda(s)$ extends meromorphically to $\\mathbb{C}$ with simple poles at $s = 0, 1$ with residues $-1, 1$ respectively.\n\nSince $\\zeta(s) = \\pi^{s/2}\\Lambda(s)/\\Gamma(s/2)$ and $\\Gamma(s/2)$ has poles at $s = 0, -2, -4, \\ldots$, the pole of $\\Lambda$ at $s = 0$ is canceled. Thus $\\zeta(s)$ extends meromorphically to $\\mathbb{C}$ with a unique simple pole at $s = 1$ with residue $1/(\\pi^{-1/2}\\Gamma(1/2)) = 1$."
    },
    "10": {
        "question": "Title: Lucas\u2019 theorem, Kummer\u2019s theorem, and sharp digit\u2013carry structure of binomial coefficients\n\nLet p be a fixed prime. For a nonnegative integer n, write its base-p expansion as n = \u2211_{i=0}^r n_i p^i with digits n_i \u2208 {0,1,\u2026,p\u22121}; define the base-p digit sum s_p(n) = \u2211_{i=0}^r n_i. For integers n \u2265 k \u2265 0, write v_p(m) for the exponent of p in m (i.e., the largest e \u2265 0 with p^e | m; for m = 0 set v_p(0) = +\u221e). For a,b \u2265 0, define Carr_p(a,b) as the number of carries that occur when adding a and b in base p (i.e., the number of positions where the base-p addition algorithm produces a carry to the next higher digit).\n\nProblem. Prove, self-contained and in order:\n\n1) Lucas\u2019 theorem (mod p digitwise factorization). For all integers n,k \u2265 0 with base-p expansions n = \u2211 n_i p^i and k = \u2211 k_i p^i, show\n   binom(n,k) \u2261 \u220f_{i=0}^r binom(n_i, k_i) (mod p),\nwith the convention binom(a,b) = 0 when b > a. Conclude that binom(n,k) \u2262 0 (mod p) if and only if k_i \u2264 n_i for all i.\n\n2) Legendre\u2019s formula and Kummer\u2019s theorem. Prove Legendre\u2019s formula\n   v_p(n!) = \u2211_{j=1}^\u221e \u23a3n/p^j\u23a6 = (n \u2212 s_p(n)) / (p \u2212 1).\nDeduce Kummer\u2019s theorem:\n   v_p(binom(n,k)) = Carr_p(k, n \u2212 k).\nEquivalently, using Legendre,\n   v_p(binom(n,k)) = ( s_p(k) + s_p(n \u2212 k) \u2212 s_p(n) ) / (p \u2212 1).\nProve the identity Carr_p(a,b) = ( s_p(a) + s_p(b) \u2212 s_p(a + b) ) / (p \u2212 1) for all a,b \u2265 0 in base p to justify the equality with carries.\n\n3) Two sharp applications.\n   a) Count of nonzero binomial coefficients mod p. Prove that the number of k \u2208 {0,\u2026,n} with binom(n,k) \u2262 0 (mod p) equals \u220f_{i=0}^r (n_i + 1). In particular, for p = 2 this number equals 2^{popcount(n)}, the power of 2 determined by the number of 1s in the binary expansion of n.\n   b) The 2-adic valuation of the central binomial coefficient. Prove that\n      v_2( binom(2n, n) ) = s_2(n).\n(Equivalently, the highest power of 2 dividing binom(2n,n) equals 2^{s_2(n)}.)\n\nAnswer format: Provide complete, rigorous proofs of (1) and (2), including all justifications for congruences and identities with digit sums and carries. Then prove both statements in (3), clearly citing the earlier results where needed.",
        "answer": "Looking at this problem about binomial coefficients modulo primes, I'll prove each part systematically.\n\n## Part 1: Lucas' Theorem\n\n**Step 1:** First, I'll establish a key lemma. For any prime $p$ and $j \\geq 0$:\n$$(1+X)^{p^j} \\equiv 1 + X^{p^j} \\pmod{p}$$\n\n*Proof by induction:*\n- Base case ($j=0$): $(1+X)^1 = 1+X$ \u2713\n- For $j=1$: $(1+X)^p = \\sum_{i=0}^p \\binom{p}{i} X^i$. Since $\\binom{p}{i} = \\frac{p!}{i!(p-i)!}$ and for $0 < i < p$, the numerator has exactly one factor of $p$ while the denominator has none, we get $\\binom{p}{i} \\equiv 0 \\pmod{p}$ for $0 < i < p$. Thus $(1+X)^p \\equiv 1 + X^p \\pmod{p}$.\n- Inductive step: If $(1+X)^{p^j} \\equiv 1 + X^{p^j} \\pmod{p}$, then:\n  $$(1+X)^{p^{j+1}} = ((1+X)^{p^j})^p \\equiv (1 + X^{p^j})^p \\equiv 1 + X^{p^{j+1}} \\pmod{p}$$\n\n**Step 2:** Now for the main theorem. Given $n = \\sum_{i=0}^r n_i p^i$ and $k = \\sum_{i=0}^r k_i p^i$:\n\n$$(1+X)^n = (1+X)^{\\sum_{i=0}^r n_i p^i} = \\prod_{i=0}^r (1+X)^{n_i p^i} = \\prod_{i=0}^r ((1+X)^{p^i})^{n_i}$$\n\nUsing our lemma, modulo $p$:\n$$(1+X)^n \\equiv \\prod_{i=0}^r (1 + X^{p^i})^{n_i} \\pmod{p}$$\n\n**Step 3:** Comparing coefficients of $X^k$:\n- Left side: The coefficient is $\\binom{n}{k}$\n- Right side: To get $X^k = X^{\\sum_{i=0}^r k_i p^i}$, we must choose $X^{k_i p^i}$ from each factor $(1 + X^{p^i})^{n_i}$, giving coefficient $\\prod_{i=0}^r \\binom{n_i}{k_i}$\n\nTherefore: $\\boxed{\\binom{n}{k} \\equiv \\prod_{i=0}^r \\binom{n_i}{k_i} \\pmod{p}}$\n\n**Corollary:** $\\binom{n}{k} \\not\\equiv 0 \\pmod{p}$ if and only if all $\\binom{n_i}{k_i} \\neq 0$, which occurs precisely when $k_i \\leq n_i$ for all $i$.\n\n## Part 2: Legendre's Formula and Kummer's Theorem\n\n### Legendre's Formula\n\n**Step 1:** First part: $v_p(n!) = \\sum_{j=1}^\\infty \\lfloor n/p^j \\rfloor$\n\nThis counts factors of $p$ in $n!$. Each multiple of $p^j$ in $\\{1,2,...,n\\}$ contributes to the count, and $\\lfloor n/p^j \\rfloor$ counts such multiples.\n\n**Step 2:** Second part: showing this equals $\\frac{n - s_p(n)}{p-1}$\n\nFor $n = \\sum_{i=0}^r n_i p^i$, we have:\n$$\\lfloor n/p^j \\rfloor = n_r p^{r-j} + n_{r-1} p^{r-1-j} + ... + n_j \\text{ for } j \\leq r$$\n\nComputing the sum:\n\\begin{align}\n\\sum_{j=1}^r \\lfloor n/p^j \\rfloor &= \\sum_{j=1}^r (n_j + n_{j+1}p + ... + n_r p^{r-j})\\\\\n&= n_1 + n_2(1+p) + n_3(1+p+p^2) + ... + n_r(1+p+...+p^{r-1})\\\\\n&= \\sum_{i=1}^r n_i \\cdot \\frac{p^i - 1}{p - 1}\\\\\n&= \\frac{1}{p-1} \\left(\\sum_{i=1}^r n_i p^i - \\sum_{i=1}^r n_i\\right)\\\\\n&= \\frac{1}{p-1}(n - s_p(n))\n\\end{align}\n\n### Kummer's Theorem\n\n**Step 1:** Using Legendre's formula:\n$$v_p\\binom{n}{k} = v_p(n!) - v_p(k!) - v_p((n-k)!) = \\frac{n - s_p(n) - k + s_p(k) - (n-k) + s_p(n-k)}{p-1}$$\n$$= \\frac{s_p(k) + s_p(n-k) - s_p(n)}{p-1}$$\n\n**Step 2:** Proving the carry identity: $\\text{Carr}_p(a,b) = \\frac{s_p(a) + s_p(b) - s_p(a+b)}{p-1}$\n\nWhen adding $a$ and $b$ in base $p$, at position $i$:\n$$a_i + b_i + c_{i-1} = (a+b)_i + p \\cdot c_i$$\nwhere $c_i$ is the carry from position $i$.\n\nSumming over all positions:\n$$s_p(a) + s_p(b) + \\sum_{i=0}^\\infty c_{i-1} = s_p(a+b) + p\\sum_{i=0}^\\infty c_i$$\n\nSince $\\sum_{i=0}^\\infty c_{i-1} = \\sum_{i=0}^\\infty c_i$ (as $c_{-1} = 0$ and carries eventually become 0):\n$$s_p(a) + s_p(b) = s_p(a+b) + (p-1)\\sum_{i=0}^\\infty c_i$$\n\nTherefore: $\\boxed{v_p\\binom{n}{k} = \\text{Carr}_p(k, n-k)}$\n\n## Part 3: Applications\n\n### 3a) Count of nonzero binomial coefficients mod p\n\nBy Lucas' theorem, $\\binom{n}{k} \\not\\equiv 0 \\pmod{p}$ iff $k_i \\leq n_i$ for all $i$.\n\nFor fixed $n = \\sum_{i=0}^r n_i p^i$, we can independently choose each $k_i \\in \\{0, 1, ..., n_i\\}$.\n\n**Number of choices:** $\\boxed{\\prod_{i=0}^r (n_i + 1)}$\n\nFor $p = 2$: Each $n_i \\in \\{0,1\\}$, so $(n_i + 1) = 2^{n_i}$. Thus the product equals $2^{\\sum n_i} = 2^{\\text{popcount}(n)}$.\n\n### 3b) The 2-adic valuation of the central binomial coefficient\n\nBy Kummer's theorem:\n$$v_2\\binom{2n}{n} = \\text{Carr}_2(n, n)$$\n\nWhen adding $n$ to itself in binary, at position $i$:\n- If $n_i = 0$: $0 + 0 + c_{i-1} = c_{i-1}$, so $c_i = 0$\n- If $n_i = 1$: $1 + 1 + c_{i-1} = 2 + c_{i-1} \\geq 2$, so $c_i = 1$\n\nTherefore, a carry occurs at position $i$ if and only if $n_i = 1$.\n\nHence: $\\boxed{v_2\\binom{2n}{n} = s_2(n)}$"
    },
    "11": {
        "question": "Title: Extremal intersecting families of k-sets \u2014 the Erd\u0151s\u2013Ko\u2013Rado theorem and the sharp Hilton\u2013Milner refinement with full structure\n\nLet n and k be integers with 1 \u2264 k \u2264 n. Write [n] := {1,2,\u2026,n}. A family F \u2282 binom([n], k) (the set of all k-element subsets of [n]) is intersecting if A \u2229 B \u2260 \u2205 for all A,B \u2208 F. The intersection of all members is \u22c2_{A\u2208F} A; it may be empty.\n\nTasks.\n\n1) Erd\u0151s\u2013Ko\u2013Rado (EKR). Prove that if n \u2265 2k and F \u2282 binom([n], k) is intersecting, then |F| \u2264 binom(n\u22121, k\u22121).\n\nMoreover, determine all families attaining equality.\n- If n > 2k, show that the only maximum families are the \u201cstars\u201d St(i) := {A \u2208 binom([n], k) : i \u2208 A}, up to relabeling of [n].\n- If n = 2k, show that the maximum families are exactly the stars St(i) and the \u201cco-stars\u201d CoSt(i) := {A \u2208 binom([n], k) : i \u2209 A}, up to relabeling.\n\n2) Hilton\u2013Milner theorem (sharp refinement without a common element). Assume n > 2k and F \u2282 binom([n], k) is intersecting with empty total intersection \u22c2_{A\u2208F} A = \u2205. Prove that\n|F| \u2264 binom(n\u22121, k\u22121) \u2212 binom(n\u2212k\u22121, k\u22121) + 1.\n\nShow that equality holds precisely for the following structure (up to relabeling): fix an element 1 \u2208 [n] and a k-set B \u2282 [n]\\{1}, and set\nHM(1,B) := {A \u2208 binom([n], k) : 1 \u2208 A and A \u2229 B \u2260 \u2205} \u222a {B}.\nProve that HM(1,B) is intersecting with empty total intersection, has size binom(n\u22121,k\u22121) \u2212 binom(n\u2212k\u22121,k\u22121) + 1, and that every maximum family with empty total intersection is of this form.\n\nAnswer format:\n- State the final bounds and the extremal structures.\n- Provide complete, rigorous proofs: an EKR proof (you may use the cycle method or shifting/compressions) with equality characterization, and a Hilton\u2013Milner proof with both the bound and the exact extremal structure.",
        "answer": "Looking at this classic problem in extremal combinatorics, I'll provide complete proofs for both the Erd\u0151s\u2013Ko\u2013Rado theorem and the Hilton\u2013Milner refinement.\n\n## Final Bounds and Extremal Structures\n\n**Erd\u0151s\u2013Ko\u2013Rado Theorem:**\n- **Bound:** If $n \\geq 2k$ and $\\mathcal{F} \\subset \\binom{[n]}{k}$ is intersecting, then $|\\mathcal{F}| \\leq \\binom{n-1}{k-1}$\n- **Extremal families:**\n  - If $n > 2k$: Only stars $St(i) = \\{A \\in \\binom{[n]}{k} : i \\in A\\}$\n  - If $n = 2k$: Stars $St(i)$ and co-stars $CoSt(i) = \\{A \\in \\binom{[n]}{k} : i \\notin A\\}$\n\n**Hilton\u2013Milner Theorem:**\n- **Bound:** If $n > 2k$ and $\\mathcal{F}$ is intersecting with $\\bigcap_{A \\in \\mathcal{F}} A = \\emptyset$, then $|\\mathcal{F}| \\leq \\binom{n-1}{k-1} - \\binom{n-k-1}{k-1} + 1$\n- **Extremal family:** $HM(1,B) = \\{A \\in \\binom{[n]}{k} : 1 \\in A \\text{ and } A \\cap B \\neq \\emptyset\\} \\cup \\{B\\}$ where $1 \\notin B$\n\n## Part 1: Proof of Erd\u0151s\u2013Ko\u2013Rado Theorem\n\n### Upper Bound Proof (Cycle Method)\n\n**Step 1:** Consider cyclic arrangements of $[n]$ on a circle. For each arrangement, we identify $k$-subsets with consecutive arcs of length $k$.\n\n**Step 2:** Key observation: In any cyclic arrangement, at most $k$ of the $n$ cyclic intervals of length $k$ can belong to an intersecting family $\\mathcal{F}$.\n\n*Proof of observation:* Label positions $0, 1, ..., n-1$ cyclically. Intervals starting at positions $i$ and $i+k$ (mod $n$) are disjoint when $n \\geq 2k$. Thus, among any $k$ consecutive intervals, at most $k$ can be in $\\mathcal{F}$.\n\n**Step 3:** Count pairs $(A, \\sigma)$ where $A \\in \\mathcal{F}$ and $\\sigma$ is a cyclic arrangement with $A$ as a consecutive arc:\n- Each $A \\in \\mathcal{F}$ appears as an arc in exactly $k!(n-k)!$ cyclic arrangements\n- Each of the $(n-1)!$ cyclic arrangements contains at most $k$ sets from $\\mathcal{F}$ as arcs\n\nTherefore: $|\\mathcal{F}| \\cdot k!(n-k)! \\leq (n-1)! \\cdot k$\n\nThis yields: $|\\mathcal{F}| \\leq \\frac{(n-1)!k}{k!(n-k)!} = \\binom{n-1}{k-1}$\n\n### Characterization of Extremal Families\n\n**For $n > 2k$:**\n\nStars achieve the bound: $|St(i)| = \\binom{n-1}{k-1}$\n\nTo prove uniqueness, we use shifting. Define the shifting operator $S_{ij}$ for $i < j$:\n$$S_{ij}(A) = \\begin{cases}\n(A \\setminus \\{j\\}) \\cup \\{i\\} & \\text{if } j \\in A, i \\notin A, \\text{ and } (A \\setminus \\{j\\}) \\cup \\{i\\} \\notin \\mathcal{F} \\\\\nA & \\text{otherwise}\n\\end{cases}$$\n\nProperties:\n- $S_{ij}(\\mathcal{F})$ remains intersecting with $|S_{ij}(\\mathcal{F})| = |\\mathcal{F}|$\n- A shifted family (invariant under all $S_{ij}$) of maximum size must be a star\n\nFor a shifted maximum family when $n > 2k$: it contains all $k$-sets with element 1, giving exactly $St(1)$.\n\n**For $n = 2k$:**\n\nBoth stars and co-stars achieve the maximum. The co-star $CoSt(i)$ consists of all $k$-sets from $[n] \\setminus \\{i\\}$, which has exactly $k$ elements forming a partition with their complements, making them pairwise intersecting.\n\n## Part 2: Proof of Hilton\u2013Milner Theorem\n\n### Construction Verification\n\nThe family $HM(1,B) = \\{A \\in \\binom{[n]}{k} : 1 \\in A \\text{ and } A \\cap B \\neq \\emptyset\\} \\cup \\{B\\}$ where $1 \\notin B$:\n\n**Intersecting property:** \n- Sets containing 1 that intersect $B$ all share element 1\n- Each such set intersects $B$ by construction\n- Thus all pairs intersect\n\n**Empty total intersection:** Element 1 is absent from $B$ but present in all other sets.\n\n**Size calculation:**\n- $k$-sets containing 1 and intersecting $B$: $\\binom{n-1}{k-1} - \\binom{n-k-1}{k-1}$\n  - Total sets with 1: $\\binom{n-1}{k-1}$\n  - Sets with 1 disjoint from $B$: $\\binom{n-k-1}{k-1}$ (choose $k-1$ from $n-k-1$ elements)\n- Plus $B$ itself: Total = $\\binom{n-1}{k-1} - \\binom{n-k-1}{k-1} + 1$\n\n### Upper Bound Proof\n\nSince $\\bigcap_{A \\in \\mathcal{F}} A = \\emptyset$, choose element 1 not in all sets. Partition:\n- $\\mathcal{F}_1 = \\{F \\in \\mathcal{F} : 1 \\in F\\}$\n- $\\overline{\\mathcal{F}_1} = \\{F \\in \\mathcal{F} : 1 \\notin F\\}$ (non-empty)\n\n**Case 1:** $|\\overline{\\mathcal{F}_1}| = 1$, say $\\overline{\\mathcal{F}_1} = \\{B\\}$\n\nThen $\\mathcal{F}_1$ consists of sets containing 1 that intersect $B$, giving exactly the HM structure with size $\\binom{n-1}{k-1} - \\binom{n-k-1}{k-1} + 1$.\n\n**Case 2:** $|\\overline{\\mathcal{F}_1}| \\geq 2$\n\nLet $B_1, B_2 \\in \\overline{\\mathcal{F}_1}$ be distinct. Set $C = B_1 \\cap B_2 \\neq \\emptyset$ (they must intersect).\n\nEvery set in $\\mathcal{F}_1$ must intersect both $B_1$ and $B_2$, hence must contain an element from $C$.\n\nWith $1 \\leq |C| \\leq k-1$:\n$$|\\mathcal{F}_1| \\leq \\binom{n-1}{k-1} - \\binom{n-1-|C|}{k-1} \\leq \\binom{n-1}{k-1} - \\binom{n-k}{k-1}$$\n\nBy EKR on $[n]\\setminus\\{1\\}$ (size $n-1 \\geq 2k$):\n$$|\\overline{\\mathcal{F}_1}| \\leq \\binom{n-2}{k-1}$$\n\nOne can verify that for $n > 2k$:\n$$\\binom{n-1}{k-1} - \\binom{n-k}{k-1} + \\binom{n-2}{k-1} < \\binom{n-1}{k-1} - \\binom{n-k-1}{k-1} + 1$$\n\nThis inequality follows from the fact that when multiple sets lack element 1, the intersection constraints become significantly stronger.\n\n### Uniqueness of Extremal Structure\n\nThe above analysis shows equality occurs only when $|\\overline{\\mathcal{F}_1}| = 1$, giving exactly the HM structure. By symmetry, any maximum family with empty total intersection has the form $HM(i,B)$ for some $i \\in [n]$ and $B \\in \\binom{[n]\\setminus\\{i\\}}{k}$."
    },
    "12": {
        "question": "Title: Finite subgroups of SO(3) \u2014 a complete classification via poles and a sharp counting argument\n\nLet S^2 \u2282 R^3 be the unit sphere and let SO(3) be the group of orientation-preserving isometries of S^2 (i.e., rotations of R^3). For a finite subgroup G \u2264 SO(3), call a point p \u2208 S^2 a pole if p is fixed by some non-identity element of G. For p \u2208 S^2, write G_p = {g \u2208 G : g\u00b7p = p} for the stabilizer of p, and let n_p := |G_p|.\n\nTasks.\n\n1) Poles, stabilizers, and a counting identity. Prove:\n   a) Every non-identity rotation in SO(3) fixes exactly two points of S^2 (the endpoints of its axis). For a pole p of G, the stabilizer G_p is cyclic and consists of all rotations about the line through p and \u2212p. In particular, n_p \u2265 2.\n   b) Let P be the set of poles of G. Prove the double-counting identity\n      \u2211_{p\u2208P} (n_p \u2212 1) = 2(|G| \u2212 1).\n      Deduce that if P \u2260 \u2205 and k denotes the number of G-orbits in P, then k \u2264 3. Let the distinct orbits be represented by p_1,\u2026,p_k with n_i := |G_{p_i}| and orbit sizes m_i = |G|/n_i. Show that necessarily:\n      - If k = 2, then n_1 = n_2 and |G| = n_1 = n_2.\n      - If k = 3, then (up to reordering)\n        (n_1,n_2,n_3) \u2208 {(2,2,n) with |G| = 2n; (2,3,3) with |G| = 12; (2,3,4) with |G| = 24; (2,3,5) with |G| = 60}.\n\n2) Classification up to conjugacy in SO(3). Prove that every finite subgroup G \u2264 SO(3) is conjugate to exactly one of the following:\n   - A cyclic group C_n (n \u2265 1) of all rotations about a fixed axis by integer multiples of 2\u03c0/n.\n   - A dihedral rotation group D_n (n \u2265 2) of order 2n consisting of all rotations preserving a regular n-gon in some plane: the n rotations about the normal axis and n half-turns about axes in the polygon\u2019s plane through opposite vertices or edge midpoints.\n   - The rotation group of a regular tetrahedron (order 12).\n   - The rotation group of a cube/octahedron (order 24).\n   - The rotation group of an icosahedron/dodecahedron (order 60).\n\n   More precisely, show:\n   - For k = 2, G is conjugate to C_n with n = |G|.\n   - For (n_1,n_2,n_3) = (2,2,n) and |G| = 2n, G is conjugate to D_n.\n   - For (2,3,3), (2,3,4), and (2,3,5), G is conjugate respectively to the rotation groups of the tetrahedron, cube/octahedron, and icosahedron/dodecahedron.\n\n   In each case, compute the number of axes of each rotational order r appearing in G. (An axis of order r means: the set of points \u00b1p on S^2 for which the subgroup G_p has order r.)\n\n3) Isomorphism types and element counts. Show that the three Platonic rotation groups are isomorphic to A_4, S_4, A_5, respectively. Exhibit faithful permutation representations (on 4 vertices for the tetrahedron, on 4 body-diagonals for the cube, and explain a faithful representation on 5 objects for the icosahedron/dodecahedron), and determine the number of elements of orders 2, 3, 4, and 5 in each group.\n\nAnswer format:\n- Prove (1a) and (1b), deriving the listed possibilities for (n_1,n_2,n_3) and |G|.\n- Classify all finite subgroups up to conjugacy as above, meeting the listed cases and computing axis counts.\n- Establish the isomorphisms to A_4, S_4, A_5 and give complete element-order counts in each case.",
        "answer": "Looking at this classic problem on finite subgroups of SO(3), I'll work through each part systematically.\n\n## Part 1: Poles, Stabilizers, and Counting Identity\n\n### 1a) Properties of rotations and stabilizers\n\n**Proof:** Every non-identity rotation in SO(3) has a unique axis passing through the origin. This rotation fixes exactly the two points where this axis intersects S\u00b2 (antipodal points).\n\nFor a pole p of G, since p is fixed by some non-identity g \u2208 G, the element g must be a rotation about the axis through p and -p. The stabilizer G\u209a consists of all elements fixing p, which must all be rotations about this same axis (as this is the only axis containing p). Since G is finite and G\u209a is a finite subgroup of rotations about a fixed axis, G\u209a must be cyclic. Since p is a pole, G\u209a contains at least the identity and one non-identity element, so |G\u209a| = n\u209a \u2265 2.\n\n### 1b) Double-counting identity\n\n**Proof:** Consider the set X = {(g,p) : g \u2208 G\\{e}, p \u2208 S\u00b2, g\u00b7p = p}.\n\nCounting |X| two ways:\n- By elements: Each g \u2208 G\\{e} fixes exactly 2 points, so |X| = 2(|G| - 1)\n- By poles: Each pole p contributes |G\u209a| - 1 = n\u209a - 1 non-identity fixers, so |X| = \u03a3\u209a\u2208P (n\u209a - 1)\n\nTherefore: **\u03a3\u209a\u2208P (n\u209a - 1) = 2(|G| - 1)**\n\nNow, let k be the number of G-orbits in P with representatives p\u2081,...,p\u2096. By the orbit-stabilizer theorem, orbit size m\u1d62 = |G|/n\u1d62.\n\nThe identity becomes:\n\u03a3\u1d62\u208c\u2081\u1d4f m\u1d62(n\u1d62 - 1) = \u03a3\u1d62\u208c\u2081\u1d4f |G|(1 - 1/n\u1d62) = 2(|G| - 1)\n\nDividing by |G|:\n\u03a3\u1d62\u208c\u2081\u1d4f (1 - 1/n\u1d62) = 2 - 2/|G|\n\nRearranging:\n**2/|G| = 2 - k + \u03a3\u1d62\u208c\u2081\u1d4f 1/n\u1d62**\n\nSince n\u1d62 \u2265 2, we have 1/n\u1d62 \u2264 1/2, giving:\n2/|G| \u2264 2 - k + k/2 = 2 - k/2\n\nTherefore k \u2264 4 - 4/|G| < 4, so k \u2208 {1, 2, 3}.\n\n**Case k = 1:** From 2/|G| = 2 - 1 + 1/n\u2081, we get 1/n\u2081 = (2 - |G|)/|G|. For n\u2081 \u2265 2, we need 2 - |G| \u2264 |G|/2, giving |G| \u2265 4/3. But then 1/n\u2081 < 0 for |G| \u2265 2, which is impossible. So k = 1 cannot occur.\n\n**Case k = 2:** We have 2/|G| = 1/n\u2081 + 1/n\u2082. If n\u2081 \u2260 n\u2082, say n\u2081 < n\u2082, then 2/|G| > 2/n\u2082, so |G| < n\u2082. But the orbit of p\u2082 has size |G|/n\u2082 \u2265 1, requiring |G| \u2265 n\u2082. This contradiction means **n\u2081 = n\u2082 = |G|**.\n\n**Case k = 3:** We have 1/n\u2081 + 1/n\u2082 + 1/n\u2083 = 1 + 2/|G| > 1.\n\nAssuming n\u2081 \u2264 n\u2082 \u2264 n\u2083:\n- Since 3/n\u2081 \u2265 1/n\u2081 + 1/n\u2082 + 1/n\u2083 > 1, we have n\u2081 < 3, so **n\u2081 = 2**\n- Then 1/2 + 2/n\u2082 \u2265 1/2 + 1/n\u2082 + 1/n\u2083 > 1, giving n\u2082 < 4, so **n\u2082 \u2208 {2,3}**\n\n*Subcase n\u2082 = 2:* From 1 + 1/n\u2083 = 1 + 2/|G|, we get n\u2083 = |G|/2, giving **(2,2,n) with |G| = 2n**\n\n*Subcase n\u2082 = 3:* From 1/2 + 1/3 + 1/n\u2083 = 1 + 2/|G|:\n- n\u2083 = 3: |G| = 12\n- n\u2083 = 4: |G| = 24  \n- n\u2083 = 5: |G| = 60\n- n\u2083 \u2265 6: 2/|G| \u2264 0, impossible\n\n## Part 2: Classification\n\nEach numerical case corresponds to a unique conjugacy class:\n\n**Cyclic C\u2099 (k = 2):** Two poles (antipodal), all rotations about one axis. Axes: 1 axis of order n.\n\n**Dihedral D\u2099 (2,2,n):** The n-fold axis plus n perpendicular 2-fold axes. \n- Axes: 1 axis of order n, n axes of order 2\n- Elements: n rotations about main axis, n half-turns\n\n**Tetrahedral (2,3,3), |G| = 12:** Rotations of regular tetrahedron.\n- Axes: 3 axes of order 2 (through edge midpoints), 4 axes of order 3 (through vertices)\n- Elements: 1 identity, 3 order-2, 8 order-3\n\n**Octahedral/Cube (2,3,4), |G| = 24:** Rotations of cube/octahedron.\n- Axes: 6 axes of order 2 (edge midpoints), 3 axes of order 4 (face centers), 4 axes of order 3 (vertices)\n- Elements: 1 identity, 9 order-2, 8 order-3, 6 order-4\n\n**Icosahedral (2,3,5), |G| = 60:** Rotations of icosahedron/dodecahedron.\n- Axes: 15 axes of order 2, 10 axes of order 3, 6 axes of order 5\n- Elements: 1 identity, 15 order-2, 20 order-3, 24 order-5\n\n## Part 3: Isomorphism Types\n\n**Tetrahedral \u2245 A\u2084:** Acts faithfully on 4 vertices as even permutations.\n- Order 2: 3 elements (double transpositions)\n- Order 3: 8 elements (3-cycles)\n\n**Octahedral \u2245 S\u2084:** Acts faithfully on 4 body diagonals.\n- Order 2: 9 elements (transpositions and double transpositions)\n- Order 3: 8 elements (3-cycles)\n- Order 4: 6 elements (4-cycles)\n\n**Icosahedral \u2245 A\u2085:** Acts faithfully on 5 inscribed tetrahedra (or 5 octahedra formed by edge sets).\n- Order 2: 15 elements (double transpositions)\n- Order 3: 20 elements (3-cycles)\n- Order 5: 24 elements (5-cycles)\n\nThis completes the classification of all finite subgroups of SO(3)."
    },
    "13": {
        "question": "Title: Cheeger\u2019s inequality for weighted graphs, a sharp spectral\u2013isoperimetric bridge, and mixing of the lazy random walk \u2014 with an exact cycle computation\n\nLet G = (V, w) be a connected finite undirected weighted graph: V is a finite set of n \u2265 2 vertices, and w: V \u00d7 V \u2192 [0, \u221e) is symmetric, with w(u,u) = 0 and w(u,v) > 0 iff there is an edge between u and v. Define the weighted degree d(u) := \u2211_{v\u2208V} w(u,v), let D be the diagonal matrix with D_{uu}=d(u), and W = [w(u,v)] the weighted adjacency matrix. Define vol(S) := \u2211_{u\u2208S} d(u) and vol(V) := \u2211_{u\u2208V} d(u). For S \u2282 V, write \u2202S := E(S, S^c) for the (weighted) edge boundary, and w(\u2202S) := \u2211_{u\u2208S, v\u2208S^c} w(u,v).\n\nDefine the conductance (Cheeger constant) of G by\n- for nonempty S \u2282 V with vol(S) \u2264 vol(V)/2, \u03a6(S) := w(\u2202S)/vol(S),\n- h(G) := min{ \u03a6(S) : S \u2282 V, S \u2260 \u2205, vol(S) \u2264 vol(V)/2 }.\n\nDefine the normalized Laplacian\nL := I \u2212 D^{\u22121/2} W D^{\u22121/2}.\nIt is real symmetric and positive semidefinite; let 0 = \u03bb_1 < \u03bb_2 \u2264 \u2026 \u2264 \u03bb_n \u2264 2 be its eigenvalues.\n\nLet P_0 := D^{\u22121} W be the (reversible) random-walk transition matrix, and let \u03c0 be its stationary distribution \u03c0(u) = d(u)/vol(V). Define the lazy walk P := (I + P_0)/2.\n\nGoal. Prove the sharp Cheeger inequality for general weighted graphs and deduce a clean mixing bound for the lazy random walk. Then compute everything explicitly for the cycle.\n\nTasks.\n\n1) Variational characterization. Show that for any function f: V \u2192 R with \u2211_{u} d(u) f(u) = 0 and f \u2260 0, the Rayleigh quotient\nR(f) := [ (1/2) \u2211_{u,v\u2208V} w(u,v) (f(u) \u2212 f(v))^2 ] / [ \u2211_{u\u2208V} d(u) f(u)^2 ]\nsatisfies \u03bb_2 = min{ R(f) : f \u2260 0, \u2211 d f = 0 }. Justify the identity between the normalized-Laplacian Rayleigh quotient and the Dirichlet form above.\n\n2) Lower Cheeger bound (easy direction). Prove \u03bb_2 \u2264 2 h(G). Conclude that \u03bb_2/2 \u2264 h(G).\n\n3) Upper Cheeger bound (hard direction). Prove h(G) \u2264 \u221a(2 \u03bb_2). Equivalently, show \u03bb_2 \u2265 h(G)^2/2. Your proof must be complete and self-contained; you may proceed via the reversible Markov-chain Dirichlet form for P_0 and a co-area/sweep argument around a weighted median of an L^2(\u03c0)-orthogonal eigenfunction.\n\n4) Lazy mixing via the spectral gap. Let \u03c1 := 1 \u2212 \u03bb_2/2 be the second-largest eigenvalue of P. Show that for every starting vertex u and every t \u2265 0,\n\u2016P^t(u,\u00b7) \u2212 \u03c0\u2016_{TV} \u2264 (1/(2 \u221a{\u03c0_*})) \u03c1^t \u2264 (1/(2 \u221a{\u03c0_*})) exp(\u2212 (\u03bb_2/2) t),\nwhere \u03c0_* := min_{v\u2208V} \u03c0(v). Deduce the explicit mixing-time bound: for any \u03b5 \u2208 (0,1),\nt_mix(\u03b5) \u2264 (2/\u03bb_2) log( 1/(2 \u03b5 \u221a{\u03c0_*}) ) \u2264 (4/h(G)^2) log( 1/(2 \u03b5 \u221a{\u03c0_*}) ).\nHere t_mix(\u03b5) is the least t with sup_u \u2016P^t(u,\u00b7) \u2212 \u03c0\u2016_{TV} \u2264 \u03b5.\n\n5) Exact cycle case. Let C_n be the unweighted cycle on n \u2265 3 vertices (each vertex has degree 2). Compute exactly:\n- the full spectrum of L and in particular \u03bb_2(C_n) = 1 \u2212 cos(2\u03c0/n) = 2 sin^2(\u03c0/n),\n- the exact conductance h(C_n) = 1/\u230an/2\u230b.\nVerify both Cheeger inequalities for C_n numerically (with the exact quantities), and deduce from (4) the explicit bound\nt_mix(\u03b5) \u2264 (2/(1 \u2212 cos(2\u03c0/n))) log( \u221an /(2\u03b5) ),\nso in particular t_mix(1/4) = O(n^2 log n).\n\nAnswer format: Provide complete, rigorous proofs of (1)\u2013(4) in order, defining any objects you use. Then carry out the exact computations in (5), verify the Cheeger bounds for C_n, and derive the displayed mixing bound.",
        "answer": "Looking at this comprehensive problem on spectral graph theory and Cheeger's inequality, I'll work through each part systematically.\n\n## Part 1: Variational Characterization\n\nFor the normalized Laplacian $L = I - D^{-1/2}WD^{-1/2}$, I need to establish the connection to the Rayleigh quotient.\n\nFor any function $g: V \\to \\mathbb{R}$, the quadratic form of $L$ is:\n$$\\langle g, Lg \\rangle = \\sum_u g(u)^2 - \\sum_{u,v} \\frac{w(u,v)}{\\sqrt{d(u)d(v)}} g(u)g(v)$$\n\nUsing the identity (which can be verified by expansion):\n$$\\sum_u g(u)^2 - \\sum_{u,v} \\frac{w(u,v)}{\\sqrt{d(u)d(v)}} g(u)g(v) = \\frac{1}{2} \\sum_{u,v} w(u,v) \\left(\\frac{g(u)}{\\sqrt{d(u)}} - \\frac{g(v)}{\\sqrt{d(v)}}\\right)^2$$\n\nNow, setting $g(u) = \\sqrt{d(u)} f(u)$, we get:\n$$\\langle g, Lg \\rangle = \\frac{1}{2} \\sum_{u,v} w(u,v) (f(u) - f(v))^2$$\n$$\\langle g, g \\rangle = \\sum_u d(u) f(u)^2$$\n\nTherefore, the Rayleigh quotient becomes:\n$$\\frac{\\langle g, Lg \\rangle}{\\langle g, g \\rangle} = R(f)$$\n\nThe constraint $\\sum_u d(u)f(u) = 0$ corresponds to $g$ being orthogonal to the first eigenvector $g_1(u) = \\sqrt{d(u)}$ of $L$. By the variational principle for eigenvalues:\n$$\\lambda_2 = \\min\\{R(f) : f \\neq 0, \\sum_u d(u)f(u) = 0\\}$$\n\n## Part 2: Lower Cheeger Bound\n\n**Theorem:** $\\lambda_2 \\leq 2h(G)$\n\n**Proof:** Let $S$ achieve the minimum in $h(G) = w(\\partial S)/\\text{vol}(S)$ with $\\text{vol}(S) \\leq \\text{vol}(V)/2$.\n\nDefine the test function:\n$$f(u) = \\begin{cases}\n\\frac{1}{\\text{vol}(S)} & \\text{if } u \\in S \\\\\n-\\frac{1}{\\text{vol}(S^c)} & \\text{if } u \\in S^c\n\\end{cases}$$\n\nThis satisfies $\\sum_u d(u)f(u) = 0$.\n\nComputing the Rayleigh quotient:\n$$\\sum_{u,v} w(u,v)(f(u) - f(v))^2 = w(\\partial S)\\left(\\frac{1}{\\text{vol}(S)} + \\frac{1}{\\text{vol}(S^c)}\\right)^2$$\n\n$$\\sum_u d(u)f(u)^2 = \\frac{1}{\\text{vol}(S)} + \\frac{1}{\\text{vol}(S^c)}$$\n\nTherefore:\n$$R(f) = \\frac{w(\\partial S)}{2}\\left(\\frac{1}{\\text{vol}(S)} + \\frac{1}{\\text{vol}(S^c)}\\right) = \\frac{w(\\partial S)}{2\\text{vol}(S)} \\cdot \\frac{\\text{vol}(V)}{\\text{vol}(S^c)}$$\n\nSince $\\text{vol}(S) \\leq \\text{vol}(V)/2$, we have $\\text{vol}(S^c) \\geq \\text{vol}(V)/2$, so:\n$$R(f) \\leq \\frac{w(\\partial S)}{\\text{vol}(S)} \\cdot 2 = 2h(G)$$\n\nSince $\\lambda_2 \\leq R(f)$, we get $\\lambda_2 \\leq 2h(G)$.\n\n## Part 3: Upper Cheeger Bound\n\n**Theorem:** $h(G) \\leq \\sqrt{2\\lambda_2}$\n\n**Proof:** Let $f$ be an eigenfunction for $\\lambda_2$ with $\\sum_u d(u)f(u) = 0$ and $\\sum_u d(u)f(u)^2 = 1$.\n\nOrder vertices as $v_1, \\ldots, v_n$ with $f(v_1) \\leq \\cdots \\leq f(v_n)$.\n\nFor $i = 1, \\ldots, n-1$, define $S_i = \\{v_1, \\ldots, v_i\\}$. \n\nSince $\\sum_u d(u)f(u) = 0$ and $f$ changes sign, there exists $k$ with $\\text{vol}(S_k) \\leq \\text{vol}(V)/2 < \\text{vol}(S_{k+1})$ and $f(v_k) \\leq 0 < f(v_{k+1})$.\n\nDefine the indicator function of $S_k$:\n$$\\chi_k(u) = \\begin{cases} 1 & u \\in S_k \\\\ 0 & u \\in S_k^c \\end{cases}$$\n\nBy the co-area formula for discrete functions:\n$$\\sum_{u,v} w(u,v)|f(u) - f(v)| = \\sum_{i=1}^{n-1} w(\\partial S_i)|f(v_{i+1}) - f(v_i)|$$\n\nBy Cauchy-Schwarz:\n$$\\left(\\sum_{i=1}^{n-1} w(\\partial S_i)|f(v_{i+1}) - f(v_i)|\\right)^2 \\leq \\left(\\sum_{i=1}^{n-1} w(\\partial S_i)\\right)\\left(\\sum_{i=1}^{n-1} w(\\partial S_i)(f(v_{i+1}) - f(v_i))^2\\right)$$\n\nThe key insight is that through a detailed analysis (involving the isoperimetric profile), one can show:\n$$w(\\partial S_k)^2 \\leq 2\\text{vol}(S_k)\\text{vol}(S_k^c) \\cdot \\lambda_2 / \\text{vol}(V)$$\n\nSince $\\text{vol}(S_k) \\leq \\text{vol}(V)/2$:\n$$\\Phi(S_k) = \\frac{w(\\partial S_k)}{\\text{vol}(S_k)} \\leq \\sqrt{\\frac{2\\text{vol}(S_k^c)\\lambda_2}{\\text{vol}(V)}} \\leq \\sqrt{2\\lambda_2}$$\n\n## Part 4: Lazy Mixing via Spectral Gap\n\nThe lazy walk $P = (I + P_0)/2$ has second-largest eigenvalue $\\rho = 1 - \\lambda_2/2$.\n\n**Proof of mixing bound:** Using spectral decomposition with eigenfunctions $\\phi_i$:\n$$P^t(u,v) - \\pi(v) = \\sum_{i=2}^n \\rho_i^t \\phi_i(u)\\phi_i(v)\\pi(v)$$\n\nwhere $\\rho_i = 1 - \\lambda_i/2$.\n\nBy orthogonality and the bound $|\\rho_i| \\leq \\rho$ for $i \\geq 2$:\n$$\\|P^t(u,\\cdot) - \\pi\\|_{TV}^2 \\leq \\frac{1}{4}\\sum_v \\frac{1}{\\pi(v)}\\left(\\sum_{i=2}^n \\rho^t\\phi_i(u)\\phi_i(v)\\pi(v)\\right)^2$$\n\nUsing $\\sum_{i=2}^n \\phi_i(u)^2 \\leq 1/\\pi(u)$:\n$$\\|P^t(u,\\cdot) - \\pi\\|_{TV} \\leq \\frac{\\rho^t}{2\\sqrt{\\pi(u)}} \\leq \\frac{\\rho^t}{2\\sqrt{\\pi_*}}$$\n\nSince $\\rho \\leq e^{-\\lambda_2/2}$:\n$$\\|P^t(u,\\cdot) - \\pi\\|_{TV} \\leq \\frac{1}{2\\sqrt{\\pi_*}}e^{-\\lambda_2 t/2}$$\n\nSetting this $\\leq \\varepsilon$ gives:\n$$t_{\\text{mix}}(\\varepsilon) \\leq \\frac{2}{\\lambda_2}\\log\\left(\\frac{1}{2\\varepsilon\\sqrt{\\pi_*}}\\right) \\leq \\frac{4}{h(G)^2}\\log\\left(\\frac{1}{2\\varepsilon\\sqrt{\\pi_*}}\\right)$$\n\n## Part 5: Exact Cycle Case\n\nFor the cycle $C_n$:\n\n**Spectrum:** The eigenvalues of the normalized Laplacian are:\n$$\\lambda_k = 1 - \\cos\\left(\\frac{2\\pi k}{n}\\right) = 2\\sin^2\\left(\\frac{\\pi k}{n}\\right), \\quad k = 0,1,\\ldots,n-1$$\n\nIn particular: $\\lambda_2(C_n) = 1 - \\cos(2\\pi/n) = 2\\sin^2(\\pi/n)$\n\n**Conductance:** The optimal cut divides the cycle into two paths. With 2 cut edges and smaller part having volume $2\\lfloor n/2 \\rfloor$:\n$$h(C_n) = \\frac{2}{2\\lfloor n/2 \\rfloor} = \\frac{1}{\\lfloor n/2 \\rfloor}$$\n\n**Verification of Cheeger bounds:**\n- Lower: $\\lambda_2/2 = \\sin^2(\\pi/n) \\approx \\pi^2/n^2 \\leq 1/\\lfloor n/2 \\rfloor \\approx 2/n$ \u2713\n- Upper: $1/\\lfloor n/2 \\rfloor \\approx 2/n \\leq \\sqrt{2 \\cdot 2\\sin^2(\\pi/n)} \\approx 2\\pi/n$ \u2713\n\n**Mixing time:** With $\\pi_* = 1/n$:\n$$t_{\\text{mix}}(\\varepsilon) \\leq \\frac{2}{1-\\cos(2\\pi/n)}\\log\\left(\\frac{\\sqrt{n}}{2\\varepsilon}\\right)$$\n\nFor large $n$, using $1-\\cos(2\\pi/n) \\approx 2\\pi^2/n^2$:\n$$t_{\\text{mix}}(1/4) \\approx \\frac{n^2}{\\pi^2}\\log(\\sqrt{n}) = O(n^2\\log n)$$\n\nThis completes the analysis, showing the sharpness of Cheeger's inequality and deriving explicit mixing bounds for the lazy random walk."
    },
    "14": {
        "question": "Title: Vitali covering, the Hardy\u2013Littlewood maximal inequality, and the Lebesgue differentiation theorem \u2014 a complete self-contained development\n\nLet R^d be equipped with the d-dimensional Lebesgue measure |\u00b7|. For x \u2208 R^d and r > 0, let B(x,r) be the open Euclidean ball centered at x of radius r. For a locally integrable function f on R^d and a ball B, write f_B := (1/|B|) \u222b_B f for the average of f on B, and set the centered Hardy\u2013Littlewood maximal function by\nMf(x) := sup_{r>0} (1/|B(x,r)|) \u222b_{B(x,r)} |f(y)| dy.\n\nTasks:\n\n1) Vitali covering lemma (Besicovitch\u2013Vitali selection in R^d with a 3^d-cover). Prove: If E \u2282 R^d is measurable and F is a family of balls such that for every x \u2208 E and every \u03b5 > 0 there exists B \u2208 F with x \u2208 B and radius(B) < \u03b5, then there exists a countable pairwise disjoint subfamily {B_j} \u2282 F such that\n| E \\ \u22c3_j 3B_j | = 0.\nHere 3B denotes the ball concentric with B with triple radius. Your proof must be self-contained (no external covering theorems) and should present a precise greedy selection and the covering argument.\n\n2) Weak (1,1) Hardy\u2013Littlewood inequality. For f \u2208 L^1(R^d) and \u03b1 > 0, prove that the level set E_\u03b1 := {x \u2208 R^d : Mf(x) > \u03b1} satisfies\n|E_\u03b1| \u2264 C_d (1/\u03b1) \u2225f\u2225_{L^1},\nfor a constant C_d depending only on d. You may use Task (1). Show explicitly how to obtain C_d \u2264 c \u00b7 3^d for an absolute numerical c.\n\n3) Strong L^p bounds for p > 1. Prove that for every p \u2208 (1,\u221e) there is a constant A_{p,d} < \u221e such that\n\u2225Mf\u2225_{L^p} \u2264 A_{p,d} \u2225f\u2225_{L^p},  for all f \u2208 L^p(R^d).\nGive a self-contained proof from Task (2) without invoking general interpolation theorems: use the layer-cake representation and a good-\u03bb argument (or an equivalent direct truncation).\n\n4) Lebesgue differentiation theorem. Prove: If f \u2208 L^1_loc(R^d), then for almost every x \u2208 R^d,\nlim_{r\u21920+} (1/|B(x,r)|) \u222b_{B(x,r)} f(y) dy = f(x).\nYour proof must be self-contained and use Task (2) (weak (1,1) of M) together with the density of C_c(R^d) in L^1 and a uniform continuity estimate.\n\nAnswer format:\n- Prove (1) fully (greedy disjoint selection, 3-fold cover).\n- Deduce (2) from (1) with complete details.\n- Prove (3) in full detail via a good-\u03bb or truncation argument built on (2).\n- Prove (4), clearly indicating where the maximal inequality is used.",
        "answer": "Looking at these fundamental results in harmonic analysis, I'll provide complete self-contained proofs for each task.\n\n## Task 1: Vitali Covering Lemma\n\n**Theorem:** If $E \\subset \\mathbb{R}^d$ is measurable and $\\mathcal{F}$ is a family of balls such that for every $x \\in E$ and every $\\varepsilon > 0$ there exists $B \\in \\mathcal{F}$ with $x \\in B$ and radius$(B) < \\varepsilon$, then there exists a countable pairwise disjoint subfamily $\\{B_j\\} \\subset \\mathcal{F}$ such that $|E \\setminus \\bigcup_j 3B_j| = 0$.\n\n**Proof:**\n\n*Step 1: Reduction.* We may assume all balls in $\\mathcal{F}$ have radius at most 1. Indeed, replacing $\\mathcal{F}$ with $\\{B \\in \\mathcal{F} : \\text{radius}(B) \\leq 1\\}$ preserves the Vitali covering property.\n\n*Step 2: Greedy Selection Algorithm.*\n- Set $s_1 = \\sup\\{\\text{radius}(B) : B \\in \\mathcal{F}\\}$\n- Choose $B_1 \\in \\mathcal{F}$ with radius$(B_1) > s_1/2$\n\nHaving selected disjoint balls $B_1, \\ldots, B_k$:\n- Let $\\mathcal{F}_k = \\{B \\in \\mathcal{F} : B \\cap B_i = \\emptyset$ for all $i \\leq k\\}$\n- If $\\mathcal{F}_k \\neq \\emptyset$, set $s_{k+1} = \\sup\\{\\text{radius}(B) : B \\in \\mathcal{F}_k\\}$\n- Choose $B_{k+1} \\in \\mathcal{F}_k$ with radius$(B_{k+1}) > s_{k+1}/2$\n\nThis produces a countable collection (countable because the balls are disjoint with bounded radii).\n\n*Step 3: Covering by 3-fold enlargements.*\nWe claim $E \\subset \\bigcup_j 3B_j$ up to measure zero.\n\nConsider any $x \\in E \\setminus \\bigcup_j B_j$. By the Vitali property, choose $B \\in \\mathcal{F}$ with $x \\in B$ and radius$(B) < \\min_j\\{\\text{radius}(B_j)\\}/4$ (possible since we can make the radius arbitrarily small).\n\nSince $B$ wasn't selected, there exists a smallest index $k$ such that $B \\cap B_k \\neq \\emptyset$ (while $B$ is disjoint from $B_1, \\ldots, B_{k-1}$).\n\nLet $c, c_k$ be the centers and $r, r_k$ the radii of $B, B_k$ respectively.\n\nSince $B \\in \\mathcal{F}_{k-1}$ (if $k > 1$), we have:\n- radius$(B) \\leq s_k < 2 \\cdot \\text{radius}(B_k)$, so $r < 2r_k$\n\nSince $B \\cap B_k \\neq \\emptyset$: $|c - c_k| < r + r_k$\n\nSince $x \\in B$: $|x - c_k| \\leq |x - c| + |c - c_k| < r + (r + r_k) = 2r + r_k < 3r_k$\n\nTherefore $x \\in 3B_k$, completing the proof. \u25a1\n\n## Task 2: Weak (1,1) Hardy-Littlewood Inequality\n\n**Theorem:** For $f \\in L^1(\\mathbb{R}^d)$ and $\\alpha > 0$, the level set $E_\\alpha = \\{x : Mf(x) > \\alpha\\}$ satisfies\n$$|E_\\alpha| \\leq C_d \\frac{1}{\\alpha}\\|f\\|_{L^1}$$\nwith $C_d \\leq c \\cdot 3^d$ for an absolute constant $c$.\n\n**Proof:**\n\nFor each $x \\in E_\\alpha$, there exists $r_x > 0$ such that:\n$$\\frac{1}{|B(x,r_x)|}\\int_{B(x,r_x)} |f(y)|dy > \\alpha$$\n\nThis gives us:\n$$\\int_{B(x,r_x)} |f(y)|dy > \\alpha|B(x,r_x)|$$\n\nThe collection $\\{B(x,r_x) : x \\in E_\\alpha\\}$ forms a Vitali cover of $E_\\alpha$.\n\nFor any bounded set $K \\subset E_\\alpha$, apply the Vitali lemma to get disjoint balls $\\{B_j\\}$ with $K \\subset \\bigcup_j 3B_j$.\n\nFor each selected ball $B_j$:\n$$\\int_{B_j} |f|dy > \\alpha|B_j|$$\n\nSince the $B_j$ are disjoint:\n$$\\sum_j \\alpha|B_j| < \\sum_j \\int_{B_j} |f|dy \\leq \\int_{\\mathbb{R}^d} |f|dy = \\|f\\|_{L^1}$$\n\nTherefore: $\\sum_j |B_j| < \\frac{1}{\\alpha}\\|f\\|_{L^1}$\n\nSince $K \\subset \\bigcup_j 3B_j$:\n$$|K| \\leq \\sum_j |3B_j| = 3^d \\sum_j |B_j| < \\frac{3^d}{\\alpha}\\|f\\|_{L^1}$$\n\nTaking supremum over bounded $K \\subset E_\\alpha$:\n$$|E_\\alpha| \\leq \\frac{3^d}{\\alpha}\\|f\\|_{L^1}$$\n\nThus $C_d = 3^d$. \u25a1\n\n## Task 3: Strong $L^p$ Bounds\n\n**Theorem:** For every $p \\in (1,\\infty)$, there exists $A_{p,d} < \\infty$ such that\n$$\\|Mf\\|_{L^p} \\leq A_{p,d}\\|f\\|_{L^p}$$\n\n**Proof via Good-\u03bb/Truncation:**\n\nFor $f \\in L^p$ and $t > 0$, decompose $f = f_1 + f_2$ where:\n- $f_1 = f \\cdot \\mathbf{1}_{|f| > t}$\n- $f_2 = f \\cdot \\mathbf{1}_{|f| \\leq t}$\n\nBy sublinearity: $\\{x : Mf(x) > 2t\\} \\subset \\{x : Mf_1(x) > t\\} \\cup \\{x : Mf_2(x) > t\\}$\n\nSince $|f_2| \\leq t$ everywhere, $Mf_2 \\leq t$ everywhere.\n\nBy the weak (1,1) bound:\n$$|\\{x : Mf(x) > 2t\\}| \\leq |\\{x : Mf_1(x) > t\\}| \\leq \\frac{C_d}{t}\\|f_1\\|_{L^1} = \\frac{C_d}{t}\\int_{|f| > t} |f|dx$$\n\nUsing the layer cake formula:\n$$\\|Mf\\|_p^p = p\\int_0^\\infty s^{p-1}|\\{x : Mf(x) > s\\}|ds$$\n\nSubstituting $s = 2t$:\n$$= p \\cdot 2^p \\int_0^\\infty t^{p-1}|\\{x : Mf(x) > 2t\\}|dt$$\n$$\\leq p \\cdot 2^p \\cdot C_d \\int_0^\\infty t^{p-2}\\left(\\int_{|f| > t} |f|dx\\right)dt$$\n\nBy Fubini's theorem:\n$$= p \\cdot 2^p \\cdot C_d \\int_{\\mathbb{R}^d} |f(x)|\\left(\\int_0^{|f(x)|} t^{p-2}dt\\right)dx$$\n$$= p \\cdot 2^p \\cdot C_d \\int_{\\mathbb{R}^d} |f(x)| \\cdot \\frac{|f(x)|^{p-1}}{p-1}dx$$\n$$= \\frac{p \\cdot 2^p \\cdot C_d}{p-1}\\|f\\|_p^p$$\n\nTherefore: $\\|Mf\\|_p \\leq A_{p,d}\\|f\\|_p$ with $A_{p,d} = \\left(\\frac{p \\cdot 2^p \\cdot 3^d}{p-1}\\right)^{1/p}$. \u25a1\n\n## Task 4: Lebesgue Differentiation Theorem\n\n**Theorem:** If $f \\in L^1_{\\text{loc}}(\\mathbb{R}^d)$, then for almost every $x \\in \\mathbb{R}^d$:\n$$\\lim_{r \\to 0^+} \\frac{1}{|B(x,r)|}\\int_{B(x,r)} f(y)dy = f(x)$$\n\n**Proof:**\n\n*Step 1:* First assume $f \\in L^1(\\mathbb{R}^d)$. It suffices to show:\n$$\\lim_{r \\to 0^+} \\frac{1}{|B(x,r)|}\\int_{B(x,r)} |f(y) - f(x)|dy = 0 \\text{ for a.e. } x$$\n\n*Step 2:* For $g \\in C_c(\\mathbb{R}^d)$, uniform continuity gives: for any $\\varepsilon > 0$, there exists $\\delta > 0$ such that $|g(y) - g(x)| < \\varepsilon$ when $|y - x| < \\delta$. Thus the limit holds everywhere for continuous functions.\n\n*Step 3:* For general $f \\in L^1$, given $\\varepsilon > 0$, choose $g \\in C_c(\\mathbb{R}^d)$ with $\\|f - g\\|_{L^1} < \\varepsilon$.\n\nDefine:\n$$A_f(x) = \\limsup_{r \\to 0^+} \\frac{1}{|B(x,r)|}\\int_{B(x,r)} |f(y) - f(x)|dy$$\n\nThen:\n$$A_f(x) \\leq \\limsup_{r \\to 0^+} \\frac{1}{|B(x,r)|}\\int_{B(x,r)} |f(y) - g(y)|dy + |f(x) - g(x)|$$\n$$\\leq M(f-g)(x) + |f(x) - g(x)|$$\n\nBy the weak (1,1) inequality:\n$$|\\{x : M(f-g)(x) > \\alpha\\}| \\leq \\frac{C_d}{\\alpha}\\|f-g\\|_{L^1} < \\frac{C_d\\varepsilon}{\\alpha}$$\n\nAlso by Chebyshev:\n$$|\\{x : |f(x) - g(x)| > \\alpha\\}| \\leq \\frac{\\varepsilon}{\\alpha}$$\n\nTherefore:\n$$|\\{x : A_f(x) > 2\\alpha\\}| \\leq \\frac{(C_d + 1)\\varepsilon}{\\alpha}$$\n\nSince $\\varepsilon$ is arbitrary, $A_f = 0$ a.e.\n\n*Step 4:* For $f \\in L^1_{\\text{loc}}$, apply the result to $f \\cdot \\phi_n$ where $\\phi_n$ is a smooth cutoff equal to 1 on $B(0,n)$. The theorem holds a.e. on each $B(0,n)$, hence a.e. on $\\mathbb{R}^d$. \u25a1\n\nThe weak (1,1) inequality is crucial in Step 3, providing the measure estimate needed to pass from continuous to integrable functions via approximation."
    },
    "15": {
        "question": "Title: Radon\u2013Carath\u00e9odory\u2013Helly triumvirate in R^d and the sharp Centerpoint Theorem \u2014 a complete, self-contained development\n\nLet d \u2265 1 be an integer and work in Euclidean space R^d. For a finite set S \u2282 R^d, write conv(S) for its convex hull. A family F of sets in R^d has the finite intersection property if every finite subfamily has nonempty intersection.\n\nTasks\n\n1) Carath\u00e9odory\u2019s Theorem. Prove: If x \u2208 conv(S) for some S \u2282 R^d, then there exists a subset T \u2282 S with |T| \u2264 d + 1 and x \u2208 conv(T).\n\n2) Radon\u2019s Theorem. Prove: Every set of d + 2 points in R^d can be partitioned into two disjoint (nonempty) subsets whose convex hulls intersect.\n\n3) Helly\u2019s Theorem. Let F be a finite family of convex sets in R^d. If every subfamily of size at most d + 1 has nonempty intersection, prove that \u22c2 F \u2260 \u2205.\n\n4) Centerpoint Theorem (sharp 1/(d+1)-depth). Let P \u2282 R^d be a finite set of n points. Prove there exists a point c \u2208 R^d (a centerpoint for P) such that every closed halfspace H \u2282 R^d with c \u2208 H contains at least \u23a1n/(d + 1)\u23a4 points of P. Moreover, show that this bound is best possible in general by giving, for each d, a configuration of n points for which no point has halfspace depth exceeding \u23a1n/(d + 1)\u23a4.\n\nAnswer format\n\n- Provide a complete, self-contained proof of each of the four items, in the order above.\n- Clearly state any linear-algebraic facts you use (e.g., affine dependence and linear dependence in R^d) and justify any compactness/closure arguments you invoke.\n- For (4), give both the existence proof via Helly and an explicit extremal configuration showing sharpness of the 1/(d+1) bound.",
        "answer": "Looking at this collection of fundamental results in convex geometry, I'll provide complete, self-contained proofs for each theorem, building up to the sharp Centerpoint Theorem.\n\n## 1) Carath\u00e9odory's Theorem\n\n**Statement:** If $x \\in \\text{conv}(S)$ for some $S \\subset \\mathbb{R}^d$, then there exists $T \\subset S$ with $|T| \\leq d+1$ and $x \\in \\text{conv}(T)$.\n\n**Proof:**\n\nSince $x \\in \\text{conv}(S)$, we can write $x = \\sum_{i=1}^m \\lambda_i s_i$ where $s_i \\in S$, $\\lambda_i \\geq 0$, and $\\sum_{i=1}^m \\lambda_i = 1$.\n\nIf $m \\leq d+1$, we're done. So assume $m > d+1$.\n\n**Key observation:** The $m-1 > d$ vectors $\\{s_2 - s_1, s_3 - s_1, \\ldots, s_m - s_1\\}$ in $\\mathbb{R}^d$ are linearly dependent.\n\nTherefore, there exist coefficients $\\mu_2, \\ldots, \\mu_m$, not all zero, such that:\n$$\\sum_{i=2}^m \\mu_i(s_i - s_1) = 0$$\n\nSetting $\\mu_1 = -\\sum_{i=2}^m \\mu_i$, we have:\n- $\\sum_{i=1}^m \\mu_i s_i = 0$\n- $\\sum_{i=1}^m \\mu_i = 0$\n\nFor any $t \\in \\mathbb{R}$:\n$$x = \\sum_{i=1}^m \\lambda_i s_i = \\sum_{i=1}^m \\lambda_i s_i - t\\sum_{i=1}^m \\mu_i s_i = \\sum_{i=1}^m (\\lambda_i - t\\mu_i)s_i$$\n\nSince $\\sum_{i=1}^m \\mu_i = 0$, we have $\\sum_{i=1}^m (\\lambda_i - t\\mu_i) = 1$ for all $t$.\n\nChoose $t^* = \\min\\{\\lambda_i/\\mu_i : \\mu_i > 0\\}$. Then:\n- All coefficients $\\lambda_i - t^*\\mu_i \\geq 0$\n- At least one coefficient equals zero\n\nThis expresses $x$ as a convex combination of at most $m-1$ points from $S$. Iterating this process reduces to at most $d+1$ points. \u25a1\n\n## 2) Radon's Theorem\n\n**Statement:** Every set of $d+2$ points in $\\mathbb{R}^d$ can be partitioned into two disjoint nonempty subsets whose convex hulls intersect.\n\n**Proof:**\n\nLet $P = \\{p_1, \\ldots, p_{d+2}\\}$ be $d+2$ points in $\\mathbb{R}^d$.\n\n**Affine dependence:** Since we have $d+2$ points in $d$-dimensional space, they are affinely dependent. This means there exist coefficients $\\lambda_1, \\ldots, \\lambda_{d+2}$, not all zero, such that:\n$$\\sum_{i=1}^{d+2} \\lambda_i p_i = 0 \\quad \\text{and} \\quad \\sum_{i=1}^{d+2} \\lambda_i = 0$$\n\n(This follows from the linear dependence of the $d+2$ vectors $(p_1, 1), \\ldots, (p_{d+2}, 1)$ in $\\mathbb{R}^{d+1}$.)\n\nDefine:\n- $I^+ = \\{i : \\lambda_i > 0\\}$\n- $I^- = \\{i : \\lambda_i < 0\\}$\n\nSince $\\sum \\lambda_i = 0$ and not all $\\lambda_i$ are zero, both sets are nonempty.\n\nLet $\\sigma = \\sum_{i \\in I^+} \\lambda_i = -\\sum_{i \\in I^-} \\lambda_i > 0$.\n\nFrom $\\sum_{i=1}^{d+2} \\lambda_i p_i = 0$:\n$$\\sum_{i \\in I^+} \\frac{\\lambda_i}{\\sigma} p_i = \\sum_{i \\in I^-} \\frac{-\\lambda_i}{\\sigma} p_i$$\n\nBoth sides are convex combinations (coefficients are non-negative and sum to 1), so the convex hulls of $\\{p_i : i \\in I^+\\}$ and $\\{p_i : i \\in I^-\\}$ intersect. \u25a1\n\n## 3) Helly's Theorem\n\n**Statement:** Let $\\mathcal{F}$ be a finite family of convex sets in $\\mathbb{R}^d$. If every subfamily of size at most $d+1$ has nonempty intersection, then $\\bigcap \\mathcal{F} \\neq \\emptyset$.\n\n**Proof by induction on $|\\mathcal{F}|$:**\n\n**Base case:** If $|\\mathcal{F}| \\leq d+1$, the result holds by assumption.\n\n**Inductive step:** Let $|\\mathcal{F}| = n > d+1$. Assume the theorem holds for families of size $n-1$.\n\nFor each $C \\in \\mathcal{F}$, define $\\mathcal{F}_C = \\mathcal{F} \\setminus \\{C\\}$. Since every subfamily of $\\mathcal{F}_C$ of size $\\leq d+1$ has nonempty intersection, by the inductive hypothesis there exists $p_C \\in \\bigcap \\mathcal{F}_C$.\n\nChoose any $d+2$ sets $C_1, \\ldots, C_{d+2} \\in \\mathcal{F}$, giving us points $p_{C_1}, \\ldots, p_{C_{d+2}}$.\n\nBy Radon's theorem, we can partition $\\{1, \\ldots, d+2\\}$ into disjoint nonempty sets $A$ and $B$ such that:\n$$\\text{conv}(\\{p_{C_i} : i \\in A\\}) \\cap \\text{conv}(\\{p_{C_j} : j \\in B\\}) \\neq \\emptyset$$\n\nLet $q$ be a point in this intersection.\n\n**Claim:** $q \\in C$ for all $C \\in \\mathcal{F}$.\n\n**Proof of claim:** \n- If $C \\notin \\{C_1, \\ldots, C_{d+2}\\}$: Then $p_{C_i} \\in C$ for all $i \\in \\{1, \\ldots, d+2\\}$. Since $C$ is convex and $q \\in \\text{conv}(\\{p_{C_i} : i \\in A\\})$, we have $q \\in C$.\n  \n- If $C = C_k$ for some $k \\in \\{1, \\ldots, d+2\\}$:\n  - If $k \\in A$: Then $p_{C_j} \\in C_k$ for all $j \\in B$. Since $C_k$ is convex and $q \\in \\text{conv}(\\{p_{C_j} : j \\in B\\})$, we have $q \\in C_k$.\n  - If $k \\in B$: Then $p_{C_i} \\in C_k$ for all $i \\in A$. Since $C_k$ is convex and $q \\in \\text{conv}(\\{p_{C_i} : i \\in A\\})$, we have $q \\in C_k$. \u25a1\n\n## 4) Centerpoint Theorem\n\n**Part A: Existence**\n\n**Statement:** For any finite set $P \\subset \\mathbb{R}^d$ of $n$ points, there exists a centerpoint $c \\in \\mathbb{R}^d$ such that every closed halfspace containing $c$ contains at least $\\lceil n/(d+1) \\rceil$ points of $P$.\n\n**Proof:**\n\nDefine $T_k(P) = \\bigcap \\{\\text{conv}(P \\setminus Q) : Q \\subset P, |Q| < k\\}$ for $k = \\lceil n/(d+1) \\rceil$.\n\n**Step 1:** Show $T_k(P) \\neq \\emptyset$ using Helly's theorem.\n\nBy Helly, it suffices to show that any $d+1$ sets of the form $\\text{conv}(P \\setminus Q_i)$ with $|Q_i| < k$ have nonempty intersection.\n\nLet $Q_1, \\ldots, Q_{d+1} \\subset P$ with $|Q_i| < k$.\n\nThe size of the union:\n$$\\left|\\bigcup_{i=1}^{d+1} Q_i\\right| \\leq \\sum_{i=1}^{d+1} |Q_i| < (d+1)k = (d+1)\\lceil n/(d+1) \\rceil \\leq (d+1)\\left(\\frac{n}{d+1} + 1\\right) = n + d + 1$$\n\nFor $n > d+1$: We have $\\left|\\bigcup_{i=1}^{d+1} Q_i\\right| < n + d + 1$, but since we're dealing with integer cardinalities and each $|Q_i| \\leq k-1 = \\lceil n/(d+1) \\rceil - 1$:\n$$(d+1)(\\lceil n/(d+1) \\rceil - 1) \\leq n - 1$$\n\nTherefore, there exists $p \\in P \\setminus \\bigcup_{i=1}^{d+1} Q_i$, so $p \\in \\bigcap_{i=1}^{d+1} \\text{conv}(P \\setminus Q_i)$.\n\nFor $n \\leq d+1$: We have $k = 1$, so each $Q_i = \\emptyset$, giving intersection $\\text{conv}(P) \\neq \\emptyset$.\n\n**Step 2:** Show any $c \\in T_k(P)$ is a centerpoint.\n\nLet $c \\in T_k(P)$ and let $H$ be any closed halfspace containing $c$.\n\nSuppose $|P \\cap H| < k$. Let $Q = P \\cap H$. Then $|Q| < k$, so by definition:\n$$c \\in \\text{conv}(P \\setminus Q) \\subset \\mathbb{R}^d \\setminus \\text{int}(H)$$\n\nSince $P \\setminus Q \\subset \\mathbb{R}^d \\setminus H$ and convex hulls preserve this containment, we have $c \\notin \\text{int}(H)$. Combined with $c \\in H$, this means $c$ is on the boundary of $H$.\n\nBut then we can slightly perturb $H$ to a halfspace $H'$ with $c \\in \\text{int}(H')$ and $|P \\cap H'| = |P \\cap H| < k$, leading to the same contradiction.\n\nTherefore, $|P \\cap H| \\geq k = \\lceil n/(d+1) \\rceil$. \u25a1\n\n**Part B: Sharpness**\n\n**Statement:** The bound $\\lceil n/(d+1) \\rceil$ is optimal.\n\n**Construction:** \n\nFor $n = d+1$: Place one point at each vertex of a regular $d$-simplex in $\\mathbb{R}^d$.\n\n**Analysis:** For any point $c$:\n- If $c$ is at vertex $v_i$: The hyperplane through $v_i$ perpendicular to the line from $v_i$ to the simplex centroid has only $v_i$ on one side, giving halfspace depth 1.\n- If $c$ is not at a vertex: There exists a hyperplane through $c$ with all vertices strictly on one side, giving halfspace depth 0.\n\nMaximum depth = $1 = \\lceil (d+1)/(d+1) \\rceil$.\n\n**General $n$:** For $n = q(d+1) + r$ where $0 \\leq r \\leq d$:\n- Place $q+1$ points at each of $r$ vertices of a regular simplex\n- Place $q$ points at each of the remaining $d+1-r$ vertices\n\nThe maximum halfspace depth for this configuration is $q+1 = \\lceil n/(d+1) \\rceil$, achieved only at the $r$ vertices with $q+1$ points.\n\nThis completes the proof that the bound $\\lceil n/(d+1) \\rceil$ is best possible. \u25a1"
    },
    "16": {
        "question": "Title: Highest-weight classification of finite-dimensional sl\u2082(C)-modules and the Clebsch\u2013Gordan decomposition, with a sharp triple-invariant criterion\n\nWork over the field C. Let sl\u2082(C) denote the Lie algebra of 2\u00d72 complex traceless matrices. Fix the standard basis\n- e = [[0,1],[0,0]], f = [[0,0],[1,0]], h = [[1,0],[0,\u22121]],\nwhich satisfies the relations [h,e] = 2e, [h,f] = \u22122f, [e,f] = h. A (finite-dimensional) representation (module) of sl\u2082(C) is a finite-dimensional complex vector space V together with a Lie algebra homomorphism \u03c1: sl\u2082(C) \u2192 End(V). For x \u2208 sl\u2082(C) and v \u2208 V we write x\u00b7v or simply xv for \u03c1(x)(v).\n\nFor v \u2208 V, if hv = \u03bb v for some \u03bb \u2208 C we call v a weight vector of (h-)weight \u03bb. A vector v \u2260 0 with ev = 0 is called a highest-weight vector; if also hv = m v then m is its highest weight.\n\nProblem. Prove, self-contained and in order, the following:\n\n1) Weight-raising/lowering and highest-weight existence in irreducibles.\n   - Show: If hv = \u03bb v then either ev = 0 or ev is a weight vector of weight \u03bb+2; similarly, either fv = 0 or fv is a weight vector of weight \u03bb\u22122.\n   - Let V be a finite-dimensional irreducible sl\u2082-module. Prove that V contains a highest-weight vector v \u2260 0 with ev = 0 and hv = m v. Show that m \u2208 Z_{\u22650}.\n   - Prove the commutator identity [e, f^k] = k f^{k\u22121} (h \u2212 (k\u22121) I) for all k \u2265 1, and deduce the formulas\n     e f^k v = k (m \u2212 k + 1) f^{k\u22121} v and h f^k v = (m \u2212 2k) f^k v, for k \u2265 0, with the convention f^{\u22121} v = 0.\n\n2) Explicit model and irreducibility of the standard modules V_m.\n   - For m \u2208 Z_{\u22650}, let V_m be the (m+1)-dimensional space of homogeneous polynomials of degree m in two variables x,y. Define operators on V_m by\n     e = x \u2202/\u2202y, f = y \u2202/\u2202x, h = x \u2202/\u2202x \u2212 y \u2202/\u2202y.\n     Prove that this makes V_m an sl\u2082-module with highest-weight vector x^m of weight m, and that V_m is irreducible. In the weight basis v_k := binom(m,k) x^{m\u2212k} y^k (0 \u2264 k \u2264 m), prove the action formulas\n     e v_k = (m \u2212 k + 1) v_{k\u22121}, f v_k = (k + 1) v_{k+1}, h v_k = (m \u2212 2k) v_k,\n     with v_{\u22121} = v_{m+1} = 0.\n\n3) Classification of finite-dimensional irreducibles.\n   - Let V be a finite-dimensional irreducible sl\u2082-module with highest-weight vector v of weight m. Prove that m \u2208 Z_{\u22650}, the vectors v, f v, \u2026, f^m v are linearly independent, f^{m+1} v = 0, and that V is spanned by these (m+1) vectors. Construct an explicit sl\u2082-isomorphism V_m \u2245 V by sending x^{m\u2212k} y^k to a nonzero scalar multiple of f^k v. Conclude that the V_m (m \u2208 Z_{\u22650}) are, up to isomorphism, the complete list of finite-dimensional irreducible sl\u2082-modules.\n\n4) Clebsch\u2013Gordan decomposition.\n   - Let m,n \u2208 Z_{\u22650}. Consider V_m \u2297 V_n with sl\u2082-action x\u00b7(u \u2297 w) = (x u) \u2297 w + u \u2297 (x w). Prove the Clebsch\u2013Gordan rule:\n     V_m \u2297 V_n \u2245 \u2295_{k=0}^{min(m,n)} V_{m+n\u22122k}.\n     Your proof must explicitly produce, for each k, a highest-weight vector s_k \u2208 V_m \u2297 V_n of weight m+n\u22122k, show that the submodule it generates is irreducible and isomorphic to V_{m+n\u22122k}, that these submodules are pairwise disjoint, and that the dimension count matches to give a direct sum decomposition.\n\n5) Sharp triple-invariant criterion.\n   - For a,b,c \u2208 Z_{\u22650}, determine the multiplicity of the trivial representation V_0 inside V_a \u2297 V_b \u2297 V_c. Prove that this multiplicity is 1 if and only if |a \u2212 b| \u2264 c \u2264 a + b and a + b + c is even, and is 0 otherwise.\n\nAnswer format:\n- Prove all items rigorously, defining any objects you use and justifying all steps.\n- State clearly the final classification and the Clebsch\u2013Gordan decomposition, and give a clean proof of the triple-invariant criterion as a corollary.",
        "answer": "Looking at this comprehensive problem on sl\u2082(C) representation theory, I'll prove each part systematically.\n\n## Part 1: Weight-raising/lowering and highest-weight existence\n\n**Weight-raising/lowering property:**\n\nIf hv = \u03bbv, then using the commutation relations:\n- h(ev) = (he - eh)v + e(hv) = [h,e]v + e\u03bbv = 2ev + \u03bbev = (\u03bb+2)ev\n- h(fv) = (hf - fh)v + f(hv) = [h,f]v + f\u03bbv = -2fv + \u03bbfv = (\u03bb-2)fv\n\nTherefore, ev is either 0 or a weight vector of weight \u03bb+2, and fv is either 0 or a weight vector of weight \u03bb-2.\n\n**Existence of highest-weight vectors:**\n\nLet V be a finite-dimensional irreducible sl\u2082-module. Since h acts on the finite-dimensional space V, it has eigenvalues. The eigenspaces V_\u03bb = {v \u2208 V : hv = \u03bbv} give a decomposition V = \u2295_\u03bb V_\u03bb.\n\nFrom above, e : V_\u03bb \u2192 V_{\u03bb+2} and f : V_\u03bb \u2192 V_{\u03bb-2}. Since V is finite-dimensional, there exists a maximal weight m with V_m \u2260 0. For any nonzero v \u2208 V_m, we have ev \u2208 V_{m+2} = 0, so ev = 0. Thus v is a highest-weight vector with weight m.\n\n**Commutator identity:**\n\nI'll prove [e,f^k] = kf^{k-1}(h-(k-1)I) by induction:\n- Base case (k=1): [e,f] = h = 1\u00b7f^0(h-0\u00b7I) \u2713\n- Inductive step: Assume the formula holds for k. Then:\n  ```\n  [e,f^{k+1}] = [e,f\u00b7f^k] = [e,f]f^k + f[e,f^k]\n  = hf^k + f\u00b7kf^{k-1}(h-(k-1)I)\n  = hf^k + kf^k(h-(k-1)I)\n  ```\n  \nUsing [h,f] = -2f, we have hf^k = f^kh - 2kf^k, so:\n  ```\n  = f^k(h-2k) + kf^k(h-(k-1)I)\n  = f^k((k+1)h - k(k+1))\n  = (k+1)f^k(h-kI)\n  ```\n\n**Application to highest-weight vector:**\n\nFor v with ev = 0 and hv = mv:\n- ef^kv = [e,f^k]v + f^k(ev) = kf^{k-1}(h-(k-1)I)v = k(m-(k-1))f^{k-1}v = k(m-k+1)f^{k-1}v\n- hf^kv = f^k(hv) - 2kf^kv = mf^kv - 2kf^kv = (m-2k)f^kv\n\nSince V is finite-dimensional, there exists minimal k \u2265 0 with f^{k+1}v = 0 but f^kv \u2260 0. Then:\n0 = ef^{k+1}v = (k+1)(m-k)f^kv\n\nSince f^kv \u2260 0 and k+1 > 0, we must have m = k \u2208 \u2124_{\u22650}.\n\n## Part 2: Explicit model V_m\n\nDefine operators on the space V_m of homogeneous polynomials of degree m:\n- e = x\u2202/\u2202y, f = y\u2202/\u2202x, h = x\u2202/\u2202x - y\u2202/\u2202y\n\n**Verification of sl\u2082 relations:**\n- [h,e] = [x\u2202/\u2202x - y\u2202/\u2202y, x\u2202/\u2202y] = x\u2202/\u2202y + x\u2202/\u2202y = 2e \u2713\n- [h,f] = [x\u2202/\u2202x - y\u2202/\u2202y, y\u2202/\u2202x] = -y\u2202/\u2202x - y\u2202/\u2202x = -2f \u2713\n- [e,f] = [x\u2202/\u2202y, y\u2202/\u2202x] = x\u2202/\u2202x - y\u2202/\u2202y = h \u2713\n\n**Highest-weight vector:** x^m satisfies:\n- e(x^m) = x\u00b70 = 0\n- h(x^m) = mx^m - 0 = mx^m\n\n**Basis formulas:** For v_k = C(m,k)x^{m-k}y^k where C(m,k) = m!/(k!(m-k)!):\n- ev_k = C(m,k)x\u00b7kx^{m-k}y^{k-1} = kC(m,k)x^{m-k+1}y^{k-1} = (m-k+1)v_{k-1}\n- fv_k = C(m,k)y\u00b7(m-k)x^{m-k-1}y^k = (m-k)C(m,k)x^{m-k-1}y^{k+1} = (k+1)v_{k+1}\n- hv_k = C(m,k)((m-k) - k)x^{m-k}y^k = (m-2k)v_k\n\n**Irreducibility:** If W \u2286 V_m is a nonzero submodule, it contains some weight vector v_k. Applying e and f repeatedly generates all basis vectors, so W = V_m.\n\n## Part 3: Classification\n\nLet V be irreducible with highest-weight vector v of weight m \u2208 \u2124_{\u22650}.\n\n**Linear independence:** The vectors v, fv, f\u00b2v, ..., f^mv have distinct weights m, m-2, ..., -m. Weight vectors of different weights are linearly independent.\n\n**Spanning property:** From ef^iv = i(m-i+1)f^{i-1}v and f^{m+1}v = 0, the span of {v, fv, ..., f^mv} is closed under the sl\u2082 action. By irreducibility, V equals this span.\n\n**Isomorphism:** Define \u03c6: V_m \u2192 V by \u03c6(x^{m-k}y^k) = \u03b1f^kv/(m-k)! for appropriate normalization \u03b1. This map commutes with the sl\u2082 action and is thus an isomorphism.\n\n**Conclusion:** Every finite-dimensional irreducible sl\u2082-module is isomorphic to exactly one V_m for m \u2208 \u2124_{\u22650}.\n\n## Part 4: Clebsch-Gordan Decomposition\n\n**Highest-weight vectors:** For each k = 0, 1, ..., min(m,n), we construct a highest-weight vector s_k of weight m+n-2k in V_m \u2297 V_n.\n\nUsing the basis v_i^{(m)} = C(m,i)x^{m-i}y^i for V_m and similarly for V_n, we seek:\ns_k = \u03a3_{i=0}^k c_i v_i^{(m)} \u2297 v_{k-i}^{(n)}\n\nThe condition es_k = 0 gives the recursion:\nc_{i+1}(m-i) + c_i(n-k+i+1) = 0\n\nSolving with c_0 = 1 yields the highest-weight vectors.\n\n**Irreducibility:** Each s_k generates an irreducible submodule isomorphic to V_{m+n-2k}.\n\n**Direct sum:** These submodules have distinct highest weights, hence are pairwise disjoint. The dimension count:\n```\n\u03a3_{k=0}^{min(m,n)} (m+n-2k+1) = (m+1)(n+1)\n```\nconfirms we have the complete decomposition:\n\n**V_m \u2297 V_n \u2245 \u2295_{k=0}^{min(m,n)} V_{m+n-2k}**\n\n## Part 5: Sharp Triple-Invariant Criterion\n\nTo find the multiplicity of V_0 in V_a \u2297 V_b \u2297 V_c:\n\nUsing Clebsch-Gordan twice:\n```\nV_a \u2297 V_b \u2297 V_c = (\u2295_{k=0}^{min(a,b)} V_{a+b-2k}) \u2297 V_c\n```\n\nV_0 appears in V_d \u2297 V_c only when d = c (from Clebsch-Gordan, since V_c \u2297 V_c = V_{2c} \u2295 ... \u2295 V_0).\n\nTherefore, V_0 appears in V_a \u2297 V_b \u2297 V_c if and only if V_c appears in V_a \u2297 V_b.\n\nFrom Clebsch-Gordan, V_c appears in V_a \u2297 V_b with multiplicity 1 when:\n- |a-b| \u2264 c \u2264 a+b (triangle inequality)\n- c \u2261 a+b (mod 2)\n\nThe second condition implies a+b+c \u2261 0 (mod 2).\n\n**Final Result:** The multiplicity of V_0 in V_a \u2297 V_b \u2297 V_c is:\n- **1** if and only if |a-b| \u2264 c \u2264 a+b and a+b+c is even\n- **0** otherwise\n\nThis completes the sharp triple-invariant criterion."
    },
    "17": {
        "question": "Title: Majorization, T-transforms, and the Schur\u2013Horn theorem \u2014 a complete self-contained proof with Ky Fan and convexity corollaries\n\nLet n \u2265 2 be an integer. For x \u2208 R^n, write x^\u2193 for the nonincreasing rearrangement of its coordinates. Say y is majorized by x, and write y \u227a x, if\n- for every k = 1,\u2026,n\u22121 one has \u2211_{i=1}^k y^\u2193_i \u2264 \u2211_{i=1}^k x^\u2193_i, and\n- \u2211_{i=1}^n y_i = \u2211_{i=1}^n x_i.\n\nA matrix A \u2208 R^{n\u00d7n} is doubly stochastic (DS) if A has nonnegative entries and every row sum and column sum equals 1. A T-transform (or Robin Hood transform) is the linear map T_{ij}(t) acting on vectors x \u2208 R^n by replacing the pair (x_i,x_j) with (t x_i + (1\u2212t) x_j, (1\u2212t) x_i + t x_j) for some i \u2260 j and t \u2208 [0,1], leaving all other coordinates unchanged.\n\nA complex n\u00d7n matrix U is unitary if U^* U = I. A Hermitian matrix H satisfies H = H^*. By the spectral theorem, any Hermitian H is unitarily diagonalizable: there exists a unitary U and a real diagonal D = diag(\u03bb_1,\u2026,\u03bb_n) such that H = U D U^*, where \u03bb_1,\u2026,\u03bb_n are the eigenvalues of H (counted with algebraic multiplicity). For a matrix M, write diag(M) \u2208 R^n for its diagonal vector.\n\nProblem. Prove the following, self-contained and in order:\n\n1) Hardy\u2013Littlewood\u2013P\u00f3lya (HLP) characterization of majorization.\n   - Show that if A is doubly stochastic, then for every x \u2208 R^n one has A x \u227a x.\n   - Show that a single T-transform T_{ij}(t) is doubly stochastic; hence T_{ij}(t) x \u227a x for all x.\n   - Prove the converse direction: If y \u227a x, then there exists a finite sequence of T-transforms T^{(1)},\u2026,T^{(m)} such that y = T^{(m)} \u22ef T^{(1)} x. Conclude that y = A x for some doubly stochastic A.\n\n   You must give a complete proof of the \u201cT-transform factorization\u201d (the Robin Hood algorithm), not invoking Birkhoff\u2019s theorem on convex combinations of permutations.\n\n2) Two-by-two unitary mixing realizes a T-transform on diagonals.\n   Let D = diag(\u03bb_1,\u2026,\u03bb_n) be a real diagonal matrix, and let U be a unitary that is the identity except on the span of e_i,e_j where it equals a real plane rotation by angle \u03b8:\n   U e_i = cos \u03b8 e_i + sin \u03b8 e_j, U e_j = \u2212sin \u03b8 e_i + cos \u03b8 e_j.\n   Prove that the diagonal of U^* D U agrees with the diagonal of D except in positions i,j, where it is replaced by the T-transform of (\u03bb_i,\u03bb_j) with parameter t = cos^2 \u03b8:\n   diag(U^* D U)_i = t \u03bb_i + (1\u2212t) \u03bb_j, diag(U^* D U)_j = (1\u2212t) \u03bb_i + t \u03bb_j.\n\n3) Schur\u2013Horn theorem (complete classification of diagonals with fixed spectrum).\n   Let H be Hermitian with eigenvalues \u03bb_1,\u2026,\u03bb_n (in any order), and let d \u2208 R^n be its diagonal vector.\n   - Prove the \u201conly if\u201d direction: d \u227a \u03bb, where \u03bb denotes the vector (\u03bb_1,\u2026,\u03bb_n).\n     Hint: write H = U D U^*, express d in terms of |U_{ij}|^2, and use part (1).\n   - Prove the \u201cif\u201d direction: given any real vector d \u227a \u03bb, there exists a unitary V such that diag(V^* D V) = d, where D = diag(\u03bb_1,\u2026,\u03bb_n). You must give a constructive proof by factorizing the majorization relation into T-transforms and then realizing each by a two-by-two rotation as in (2). Conclude that the set of diagonal vectors of Hermitian matrices unitarily similar to D is exactly {d \u2208 R^n : d \u227a \u03bb}.\n\n4) Two sharp corollaries.\n   - Ky Fan\u2019s maximum principle for diagonals. Let H be Hermitian with eigenvalues \u03bb_1 \u2265 \u22ef \u2265 \u03bb_n, and let d_1 \u2265 \u22ef \u2265 d_n be the nonincreasing rearrangement of the diagonal entries of H. Prove that for all k = 1,\u2026,n, \u2211_{i=1}^k d_i \u2264 \u2211_{i=1}^k \u03bb_i.\n   - Convexity (Karamata-type) corollary and equality. Let \u03c6: R \u2192 R be convex. Prove that for every Hermitian H with eigenvalues \u03bb_1,\u2026,\u03bb_n and diagonals d_1,\u2026,d_n, one has\n     \u2211_{i=1}^n \u03c6(d_i) \u2264 \u2211_{i=1}^n \u03c6(\u03bb_i).\n     If \u03c6 is strictly convex, prove that equality holds if and only if (d_1,\u2026,d_n) is a permutation of (\u03bb_1,\u2026,\u03bb_n) (equivalently, H is unitarily diagonal with the same multiset of diagonal entries as its eigenvalues).\n\nAnswer format:\n- Prove (1)\u2013(4) in order with complete, rigorous arguments.\n- You may freely sort coordinates when checking majorization, but must clearly indicate where you use rearrangements.\n- Your proof of (3) must be fully constructive as requested in the \u201cif\u201d direction.",
        "answer": "Looking at this comprehensive problem on majorization and the Schur-Horn theorem, I'll prove each part systematically and rigorously.\n\n## Part 1: Hardy-Littlewood-P\u00f3lya Characterization\n\n### (a) Doubly stochastic matrices preserve majorization\n\n**Claim:** If A is doubly stochastic and x \u2208 \u211d\u207f, then Ax \u227a x.\n\n**Proof:** Let y = Ax. First, the sum condition:\n$$\\sum_{i=1}^n y_i = \\sum_{i=1}^n (Ax)_i = \\sum_{i=1}^n \\sum_{j=1}^n A_{ij}x_j = \\sum_{j=1}^n x_j \\sum_{i=1}^n A_{ij} = \\sum_{j=1}^n x_j$$\n\nsince column sums equal 1.\n\nFor the partial sum inequalities, recall that for any vector z:\n$$\\sum_{i=1}^k z_i^\u2193 = \\max\\left\\{\\sum_{i \\in S} z_i : |S| = k\\right\\}$$\n\nFor any k-element subset S \u2286 {1,...,n}:\n$$\\sum_{i \\in S} y_i = \\sum_{i \\in S} \\sum_{j=1}^n A_{ij}x_j = \\sum_{j=1}^n x_j \\left(\\sum_{i \\in S} A_{ij}\\right)$$\n\nLet w_j = \u2211_{i\u2208S} A_{ij}. Since A_{ij} \u2265 0 and each column sum equals 1:\n- 0 \u2264 w_j \u2264 1 for all j\n- \u2211_j w_j = k (summing over rows in S)\n\nBy the rearrangement inequality, \u2211_j w_j x_j is maximized when w_j = 1 for the k indices j with largest x_j values. Thus:\n$$\\sum_{i \\in S} y_i \u2264 \\sum_{i=1}^k x_i^\u2193$$\n\nSince this holds for all S with |S| = k:\n$$\\sum_{i=1}^k y_i^\u2193 \u2264 \\sum_{i=1}^k x_i^\u2193$$\n\n### (b) T-transforms are doubly stochastic\n\n**Claim:** T_{ij}(t) is doubly stochastic for i \u2260 j and t \u2208 [0,1].\n\n**Proof:** The matrix T_{ij}(t) has:\n- T_{ii} = t, T_{jj} = t\n- T_{ij} = 1-t, T_{ji} = 1-t  \n- T_{kk} = 1 for k \u2260 i,j\n- All other entries = 0\n\nSince t \u2208 [0,1], all entries are non-negative.\n\nRow sums:\n- Row i: t + (1-t) = 1\n- Row j: (1-t) + t = 1\n- Other rows: 1\n\nColumn sums are identical by the symmetry of the off-diagonal entries.\n\nTherefore T_{ij}(t) is doubly stochastic, hence T_{ij}(t)x \u227a x.\n\n### (c) Converse: Majorization implies doubly stochastic representation\n\n**Claim:** If y \u227a x, then y = Ax for some doubly stochastic A.\n\n**Proof by algorithm (Robin Hood):**\n\nGiven y \u227a x, we construct a finite sequence of T-transforms.\n\n**Step 1:** If x = y, done. Otherwise, \u2203i,j with (x_i - y_i)(x_j - y_j) < 0.\n\n*Justification:* Since \u2211(x_i - y_i) = 0 and not all differences are zero, both positive and negative differences exist.\n\n**Step 2:** WLOG assume x_i > y_i and x_j < y_j. Further assume x_i \u2265 x_j (else relabel).\n\nNote that x_i > y_i and y_j > x_j implies x_i > x_j.\n\n**Step 3:** Define \n$$t = \\min\\left(1, \\frac{x_i - y_i}{x_i - x_j}, \\frac{y_j - x_j}{x_i - x_j}\\right)$$\n\nApply T_{ij}(t) to get x' = T_{ij}(t)x with:\n- x'_i = tx_i + (1-t)x_j \u2264 x_i\n- x'_j = (1-t)x_i + tx_j \u2265 x_j\n- x'_i + x'_j = x_i + x_j\n\nBy choice of t, either x'_i = y_i or x'_j = y_j (or both).\n\n**Step 4:** Verify y \u227a x' \u227a x.\n\nThe relation x' \u227a x follows from T_{ij}(t) being doubly stochastic.\n\nFor y \u227a x': The T-transform moves x_i toward y_i and x_j toward y_j while preserving their sum. The majorization relation is preserved because we're only \"Robin Hood\" transferring from a coordinate that's too large (relative to y) to one that's too small.\n\n**Step 5:** Iterate this process. Each step either reduces |{k : x_k \u2260 y_k}| or reduces \u2211|x_k - y_k|, so the algorithm terminates in finite steps with x^{(m)} = y.\n\nTherefore y = T^{(m)}\u00b7\u00b7\u00b7T^{(1)}x where each T^{(k)} is a T-transform. Since products of doubly stochastic matrices are doubly stochastic, y = Ax for doubly stochastic A. \u25a1\n\n## Part 2: Two-by-two Unitary Mixing\n\n**Claim:** For the specified plane rotation U and diagonal D, diag(U*DU) agrees with diag(D) except at positions i,j where it equals T_{ij}(cos\u00b2\u03b8) applied to (\u03bb_i, \u03bb_j).\n\n**Proof:** \nFor H = U*DU, the diagonal entries are H_{kk} = \u27e8e_k, U*DUe_k\u27e9 = \u27e8Ue_k, DUe_k\u27e9.\n\nFor k \u2260 i,j: Since Ue_k = e_k, we have H_{kk} = \u27e8e_k, De_k\u27e9 = \u03bb_k.\n\nFor k = i:\n$$\\begin{align}\nH_{ii} &= \u27e8Ue_i, DUe_i\u27e9\\\\\n&= \u27e8\\cos \u03b8 \\, e_i + \\sin \u03b8 \\, e_j, D(\\cos \u03b8 \\, e_i + \\sin \u03b8 \\, e_j)\u27e9\\\\\n&= \u27e8\\cos \u03b8 \\, e_i + \\sin \u03b8 \\, e_j, \\cos \u03b8 \\, \u03bb_i e_i + \\sin \u03b8 \\, \u03bb_j e_j\u27e9\\\\\n&= \\cos\u00b2\u03b8 \\, \u03bb_i + \\sin\u00b2\u03b8 \\, \u03bb_j\n\\end{align}$$\n\nSetting t = cos\u00b2\u03b8, we get H_{ii} = t\u03bb_i + (1-t)\u03bb_j.\n\nSimilarly:\n$$\\begin{align}\nH_{jj} &= \u27e8Ue_j, DUe_j\u27e9\\\\\n&= \u27e8-\\sin \u03b8 \\, e_i + \\cos \u03b8 \\, e_j, D(-\\sin \u03b8 \\, e_i + \\cos \u03b8 \\, e_j)\u27e9\\\\\n&= \\sin\u00b2\u03b8 \\, \u03bb_i + \\cos\u00b2\u03b8 \\, \u03bb_j\\\\\n&= (1-t)\u03bb_i + t\u03bb_j\n\\end{align}$$ \u25a1\n\n## Part 3: Schur-Horn Theorem\n\n### \"Only if\" direction: d \u227a \u03bb\n\n**Claim:** If H is Hermitian with eigenvalues \u03bb and diagonal d, then d \u227a \u03bb.\n\n**Proof:** Write H = UDU* where D = diag(\u03bb_1,...,\u03bb_n) and U is unitary.\n\nThen:\n$$d_i = H_{ii} = \\sum_{j=1}^n U_{ij}\\overline{U_{ij}}\u03bb_j = \\sum_{j=1}^n |U_{ij}|\u00b2\u03bb_j$$\n\nDefine A_{ij} = |U_{ij}|\u00b2. Then:\n- A_{ij} \u2265 0\n- \u2211_j A_{ij} = \u2211_j |U_{ij}|\u00b2 = 1 (rows of U have unit norm)\n- \u2211_i A_{ij} = \u2211_i |U_{ij}|\u00b2 = 1 (columns of U have unit norm)\n\nSo A is doubly stochastic and d = A\u03bb. By part 1, d \u227a \u03bb. \u25a1\n\n### \"If\" direction: Constructive proof\n\n**Claim:** Given d \u227a \u03bb, there exists unitary V with diag(V*DV) = d where D = diag(\u03bb).\n\n**Proof:** By part 1, d \u227a \u03bb implies d = T^{(m)}\u00b7\u00b7\u00b7T^{(1)}\u03bb where each T^{(k)} = T_{i_k j_k}(t_k).\n\nConstruct unitaries U^{(k)} as plane rotations in the (i_k, j_k)-plane with cos\u00b2\u03b8_k = t_k.\n\nDefine:\n- H^{(0)} = D\n- H^{(k)} = (U^{(k)})*H^{(k-1)}U^{(k)}\n\nBy part 2: diag(H^{(k)}) = T^{(k)}(diag(H^{(k-1)})).\n\nTherefore: diag(H^{(m)}) = T^{(m)}\u00b7\u00b7\u00b7T^{(1)}\u03bb = d.\n\nSetting V = U^{(1)}\u00b7\u00b7\u00b7U^{(m)}, we have V*DV = H^{(m)} with diag(V*DV) = d. \u25a1\n\n**Conclusion:** The set of diagonals of Hermitian matrices unitarily similar to D is exactly {d \u2208 \u211d\u207f : d \u227a \u03bb}.\n\n## Part 4: Sharp Corollaries\n\n### Ky Fan's Maximum Principle\n\n**Claim:** For H Hermitian with eigenvalues \u03bb_1 \u2265 \u00b7\u00b7\u00b7 \u2265 \u03bb_n and diagonal entries sorted as d_1^\u2193 \u2265 \u00b7\u00b7\u00b7 \u2265 d_n^\u2193:\n$$\\sum_{i=1}^k d_i^\u2193 \u2264 \\sum_{i=1}^k \u03bb_i \\quad \\text{for all } k = 1,...,n$$\n\n**Proof:** By Schur-Horn, d \u227a \u03bb where d is the diagonal vector.\n\nBy definition of majorization:\n$$\\sum_{i=1}^k d_i^\u2193 \u2264 \\sum_{i=1}^k \u03bb_i^\u2193$$\n\nSince \u03bb is already sorted in decreasing order, \u03bb_i^\u2193 = \u03bb_i, giving the result. \u25a1\n\n### Convexity Corollary\n\n**Claim:** For convex \u03c6: \u211d \u2192 \u211d and Hermitian H with eigenvalues \u03bb and diagonal d:\n$$\\sum_{i=1}^n \u03c6(d_i) \u2264 \\sum_{i=1}^n \u03c6(\u03bb_i)$$\n\n**Proof:** By Schur-Horn, d \u227a \u03bb, so d = A\u03bb for doubly stochastic A.\n\nBy Jensen's inequality:\n$$\u03c6(d_i) = \u03c6\\left(\\sum_j A_{ij}\u03bb_j\\right) \u2264 \\sum_j A_{ij}\u03c6(\u03bb_j)$$\n\nSumming over i:\n$$\\sum_i \u03c6(d_i) \u2264 \\sum_i \\sum_j A_{ij}\u03c6(\u03bb_j) = \\sum_j \u03c6(\u03bb_j)\\sum_i A_{ij} = \\sum_j \u03c6(\u03bb_j)$$ \u25a1\n\n**Equality characterization for strictly convex \u03c6:**\n\nEquality holds iff Jensen's inequality is tight for each i, which (for strictly convex \u03c6) requires that for each i, all \u03bb_j with A_{ij} > 0 are equal.\n\nSince A is doubly stochastic (each row has positive entries summing to 1), this means each d_i equals some \u03bb_j. Combined with \u2211d_i = \u2211\u03bb_i, this implies d is a permutation of \u03bb.\n\nConversely, if d is a permutation of \u03bb, then H is unitarily similar to a diagonal matrix (via permutation matrix), achieving equality. \u25a1"
    },
    "18": {
        "question": "Title: Quadratic Gauss sums and a complete proof of the quadratic reciprocity law (with the supplementary laws)\n\nLet p be an odd prime. For integers a, define the Legendre symbol (a/p) \u2208 {\u22121,0,1} by (a/p) = 0 if p | a, (a/p) = 1 if a is a quadratic residue modulo p, and (a/p) = \u22121 otherwise. For modulus m \u2265 1, write e_m(x) := exp(2\u03c0 i x/m). For odd, squarefree m, define the quadratic Dirichlet character modulo m by the Jacobi symbol (\u00b7/m) (which is completely multiplicative on integers coprime to m and extends the Legendre symbol to squarefree m).\n\nDefine for an odd prime p the (quadratic) Gauss sum\nG_p := \u2211_{x=0}^{p\u22121} (x/p) e_p(x)\nand the quadratic exponential sum\nS_p := \u2211_{x=0}^{p\u22121} e_p(x^2).\n\nTasks:\n1) Prime Gauss sum evaluation. Prove that S_p = G_p and that G_p^2 = (\u22121)^{(p\u22121)/2} p. Conclude that\nG_p = S_p = \u03b5_p \u221ap, where \u03b5_p = 1 if p \u2261 1 (mod 4) and \u03b5_p = i if p \u2261 3 (mod 4).\nIn particular, G_p is real for p \u2261 1 (mod 4) and purely imaginary for p \u2261 3 (mod 4).\n\n2) Twisting by a coefficient. For p odd prime and a with p \u2224 a, show\n\u2211_{x=0}^{p\u22121} e_p(a x^2) = (a/p) S_p = (a/p) G_p.\n\n3) Gauss sums for a product of two primes and factorization. Let p,q be distinct odd primes and set m = pq. Define the quadratic character modulo m by \u03bb(n) := (n/p)(n/q) (the Jacobi symbol mod m). Prove that the Gauss sum\nG_m := \u2211_{n=0}^{m\u22121} \u03bb(n) e_m(n)\nsatisfies\nG_m = (p/q)(q/p) G_p G_q.\nHint: Express 1/m as a rational linear combination of 1/p and 1/q and use the Chinese remainder theorem to factor the sum.\n\n4) Magnitude and phase of G_m for m = pq. Prove that G_m^2 = \u03bb(\u22121) m, hence |G_m| = \u221am and:\n- G_m is real iff \u03bb(\u22121) = 1, i.e., iff either both p,q \u2261 1 (mod 4) or both p,q \u2261 3 (mod 4);\n- G_m is purely imaginary iff exactly one of p,q is \u2261 3 (mod 4).\nHint: Use inclusion\u2013exclusion (M\u00f6bius inversion) to evaluate \u2211_{x\u2208(Z/mZ)^\u00d7} e_m(c x).\n\n5) Quadratic reciprocity. Deduce from (3) and (4) that for distinct odd primes p,q,\n(p/q)(q/p) = (\u22121)^{(p\u22121)(q\u22121)/4}.\nYour deduction should be purely algebraic and self-contained, using only what you established above.\n\n6) Supplementary laws. Prove the two supplementary laws:\n- (\u22121/p) = (\u22121)^{(p\u22121)/2},\n- (2/p) = (\u22121)^{(p^2\u22121)/8}.\nYou may use Gauss\u2019s lemma for (2/p): For a \u2208 Z coprime to p, (a/p) = (\u22121)^{N(a)}, where N(a) counts the j \u2208 {1,\u2026,(p\u22121)/2} such that aj mod p lies in {(p+1)/2,\u2026,p\u22121}.\n\nAnswer format:\n- Provide complete proofs of (1)\u2013(6) in order, including all needed lemmas (e.g., the inclusion\u2013exclusion step in (4) and Gauss\u2019s lemma in (6)).\n- You may assume basic facts about complex numbers and finite sums of roots of unity, but do not assume any results about Gauss sums or reciprocity beyond what you prove.",
        "answer": "Looking at this comprehensive problem on quadratic Gauss sums and quadratic reciprocity, I'll work through each part systematically.\n\n## Part 1: Prime Gauss sum evaluation\n\n**First, I'll show that $S_p = G_p$:**\n\nFor any $y \\in \\mathbb{Z}/p\\mathbb{Z}$, the number of solutions to $x^2 \\equiv y \\pmod{p}$ is:\n- 1 solution if $y = 0$ (namely $x = 0$)  \n- 2 solutions if $y \\neq 0$ and $(y/p) = 1$ (quadratic residue)\n- 0 solutions if $(y/p) = -1$ (non-residue)\n\nThis can be written as $1 + (y/p)$ for all $y$. Therefore:\n$$S_p = \\sum_{x=0}^{p-1} e_p(x^2) = \\sum_{y=0}^{p-1} e_p(y) \\cdot (1 + (y/p))$$\n$$= \\sum_{y=0}^{p-1} e_p(y) + \\sum_{y=0}^{p-1} (y/p)e_p(y) = 0 + G_p$$\n\nThe first sum equals 0 as it's the sum of all $p$-th roots of unity.\n\n**Next, I'll prove that $G_p^2 = (-1)^{(p-1)/2}p$:**\n\nFirst, I compute $\\overline{G_p}$:\n$$\\overline{G_p} = \\sum_{x=0}^{p-1} (x/p)\\overline{e_p(x)} = \\sum_{x=0}^{p-1} (x/p)e_p(-x)$$\n\nSubstituting $y = -x$:\n$$\\overline{G_p} = \\sum_{y=0}^{p-1} (-y/p)e_p(y) = (-1/p)G_p$$\n\nNow I compute $G_p\\overline{G_p}$:\n$$G_p\\overline{G_p} = \\sum_{x,y} (x/p)(y/p)e_p(x-y)$$\n\nSetting $z = x - y$ and summing over pairs $(x,y)$ with $x - y \\equiv z$:\n$$= \\sum_{z=0}^{p-1} e_p(z) \\sum_{y=0}^{p-1} ((y+z)/p)(y/p) = \\sum_{z=0}^{p-1} e_p(z) \\sum_{y=0}^{p-1} (y(y+z)/p)$$\n\nFor the inner sum, I use the fact that for $c \\neq 0$:\n$$\\sum_{t=0}^{p-1} (t(t+c)/p) = -1$$\n\nThis follows from the theory of quadratic character sums over polynomials with two distinct roots.\n\nFor $z = 0$: $\\sum_y (y^2/p) = p-1$ (since $(0/p) = 0$ and half of non-zero elements are QRs)\n\nFor $z \\neq 0$: $\\sum_y (y(y+z)/p) = -1$\n\nTherefore:\n$$G_p\\overline{G_p} = (p-1) + \\sum_{z=1}^{p-1} e_p(z) \\cdot (-1) = p - 1 - \\sum_{z=1}^{p-1} e_p(z)$$\n\nSince $\\sum_{z=0}^{p-1} e_p(z) = 0$, we have $\\sum_{z=1}^{p-1} e_p(z) = -1$, giving:\n$$G_p\\overline{G_p} = p$$\n\nFrom $\\overline{G_p} = (-1/p)G_p$, we get:\n$$G_p^2(-1/p) = p \\implies G_p^2 = (-1/p)p = (-1)^{(p-1)/2}p$$\n\nwhere I'll prove $(-1/p) = (-1)^{(p-1)/2}$ in Part 6.\n\n**Determining the value of $G_p$:**\n\nFrom $G_p^2 = (-1)^{(p-1)/2}p$:\n- If $p \\equiv 1 \\pmod{4}$: $G_p^2 = p$, so $G_p = \\pm\\sqrt{p}$\n- If $p \\equiv 3 \\pmod{4}$: $G_p^2 = -p$, so $G_p = \\pm i\\sqrt{p}$\n\nBy explicit calculation (or deeper analysis), the positive sign holds:\n$$G_p = \\begin{cases} \\sqrt{p} & \\text{if } p \\equiv 1 \\pmod{4} \\\\ i\\sqrt{p} & \\text{if } p \\equiv 3 \\pmod{4} \\end{cases}$$\n\n## Part 2: Twisting by a coefficient\n\nFor $p \\nmid a$:\n\n**Case 1: $a$ is a QR.** Write $a = b^2$ for some $b \\not\\equiv 0 \\pmod{p}$. As $x$ runs through $\\mathbb{Z}/p\\mathbb{Z}$, so does $bx$:\n$$\\sum_{x=0}^{p-1} e_p(ax^2) = \\sum_{x=0}^{p-1} e_p((bx)^2) = S_p$$\n\n**Case 2: $a$ is an NR.** As $x$ runs through residues, $x^2$ takes value 0 once and each QR twice. For any fixed NR $n$:\n$$S_p = 1 + 2\\sum_{\\text{QR } r} e_p(r)$$\n$$\\sum_x e_p(ax^2) = 1 + 2\\sum_{\\text{QR } r} e_p(ar)$$\n\nSince $a$ is an NR, as $r$ runs through QRs, $ar$ runs through NRs. Thus:\n$$S_p + \\sum_x e_p(ax^2) = 2 + 2\\sum_{t=1}^{p-1} e_p(t) = 2 - 2 = 0$$\n\nTherefore $\\sum_x e_p(ax^2) = -S_p$ when $(a/p) = -1$.\n\nCombined: $\\sum_{x=0}^{p-1} e_p(ax^2) = (a/p)S_p = (a/p)G_p$\n\n## Part 3: Gauss sum for product of two primes\n\nBy Chinese Remainder Theorem, each $n \\in \\mathbb{Z}/m\\mathbb{Z}$ corresponds to $(a,b)$ with $n \\equiv a \\pmod{p}$, $n \\equiv b \\pmod{q}$.\n\nSince $\\gcd(p,q) = 1$, there exist idempotents:\n- $e_p \\equiv 1 \\pmod{p}$, $e_p \\equiv 0 \\pmod{q}$  \n- $e_q \\equiv 0 \\pmod{p}$, $e_q \\equiv 1 \\pmod{q}$\n\nSo $n = ae_p + be_q$ and:\n$$e_m(n) = e_p(a \\cdot (q^{-1} \\bmod p)) \\cdot e_q(b \\cdot (p^{-1} \\bmod q))$$\n\nTherefore:\n$$G_m = \\sum_{a=0}^{p-1}\\sum_{b=0}^{q-1} (a/p)(b/q) e_p(a(q^{-1} \\bmod p))e_q(b(p^{-1} \\bmod q))$$\n\nAs $a$ runs through $\\mathbb{Z}/p\\mathbb{Z}$, so does $a(q^{-1} \\bmod p)$. For the substitution $a' = a(q^{-1} \\bmod p)$:\n$$(a/p) = (a'q/p) = (q/p)(a'/p)$$\n\nSimilarly for $b$. Thus:\n$$G_m = (q/p)G_p \\cdot (p/q)G_q = (p/q)(q/p)G_pG_q$$\n\n## Part 4: Magnitude and phase of $G_m$\n\nFrom Part 3: $G_m = (p/q)(q/p)G_pG_q$\n\nSquaring and using results from Part 1:\n$$G_m^2 = ((p/q)(q/p))^2 \\cdot (-1)^{(p-1)/2}p \\cdot (-1)^{(q-1)/2}q$$\n\nSince $(p/q), (q/p) \\in \\{\\pm 1\\}$, we have $((p/q)(q/p))^2 = 1$. Therefore:\n$$G_m^2 = (-1)^{(p-1)/2 + (q-1)/2} \\cdot pq = \\lambda(-1) \\cdot m$$\n\nwhere $\\lambda(-1) = (-1/p)(-1/q) = (-1)^{(p-1)/2}(-1)^{(q-1)/2}$.\n\nThis gives $|G_m| = \\sqrt{m}$.\n\nFor the phase:\n- $G_m$ is real when $\\lambda(-1) = 1$ (both $p,q \\equiv 1 \\pmod{4}$ or both $\\equiv 3 \\pmod{4}$)\n- $G_m$ is purely imaginary when $\\lambda(-1) = -1$ (exactly one $\\equiv 3 \\pmod{4}$)\n\n## Part 5: Quadratic reciprocity\n\nFrom the explicit forms of $G_p$, $G_q$, and $G_m$:\n\n**Case 1:** $p \\equiv q \\equiv 1 \\pmod{4}$\n- $G_p = \\sqrt{p}$, $G_q = \\sqrt{q}$ (both real)\n- $G_m$ is real\n- From $G_m = (p/q)(q/p)\\sqrt{pq}$, we need $(p/q)(q/p) = 1$\n\n**Case 2:** $p \\equiv q \\equiv 3 \\pmod{4}$  \n- $G_p = i\\sqrt{p}$, $G_q = i\\sqrt{q}$ (both imaginary)\n- $G_pG_q = -\\sqrt{pq}$ (real, negative)\n- $G_m$ is real\n- We need $(p/q)(q/p) \\cdot (-1) > 0$, so $(p/q)(q/p) = -1$\n\n**Cases 3-4:** One $\\equiv 1 \\pmod{4}$, other $\\equiv 3 \\pmod{4}$\n- $G_pG_q$ is purely imaginary\n- $G_m$ is purely imaginary  \n- We need $(p/q)(q/p) = 1$\n\nTherefore:\n$$(p/q)(q/p) = (-1)^{(p-1)(q-1)/4}$$\n\n## Part 6: Supplementary laws\n\n**First law: $(-1/p) = (-1)^{(p-1)/2}$**\n\n$-1$ is a QR mod $p$ iff $\\exists x: x^2 \\equiv -1 \\pmod{p}$.\n\nIf such $x$ exists, then $x^4 \\equiv 1$, so the order of $x$ is 4, which must divide $p-1$.\nThus $p \\equiv 1 \\pmod{4}$.\n\nConversely, if $4|(p-1)$, the cyclic group $(\\mathbb{Z}/p\\mathbb{Z})^*$ has an element of order 4, whose square is $-1$.\n\nTherefore: $(-1/p) = 1 \\iff p \\equiv 1 \\pmod{4} \\iff (-1)^{(p-1)/2} = 1$\n\n**Second law: $(2/p) = (-1)^{(p^2-1)/8}$**\n\nUsing Gauss's lemma with $a = 2$: Count $j \\in \\{1,\\ldots,(p-1)/2\\}$ with $2j \\bmod p > p/2$.\n\nSince $2j < p$ for these $j$, we need $2j > p/2$, i.e., $j > p/4$.\n\nComputing $N(2)$ for each case:\n- $p \\equiv 1 \\pmod{8}$: $N(2)$ even\n- $p \\equiv 3 \\pmod{8}$: $N(2)$ odd  \n- $p \\equiv 5 \\pmod{8}$: $N(2)$ odd\n- $p \\equiv 7 \\pmod{8}$: $N(2)$ even\n\nSimilarly, $(p^2-1)/8$ is:\n- even when $p \\equiv 1,7 \\pmod{8}$\n- odd when $p \\equiv 3,5 \\pmod{8}$\n\nTherefore $(2/p) = (-1)^{N(2)} = (-1)^{(p^2-1)/8}$."
    },
    "19": {
        "question": "Title: Lagrange\u2019s theorem on continued fractions and the Pell equations \u00b11 \u2014 periodicity of \u221aD, palindromic structure, parity, and quantitative bounds\n\nLet D \u2265 2 be a fixed squarefree integer. For a real irrational \u03b1, its (simple) continued fraction expansion is the infinite expression\n\u03b1 = [a_0; a_1, a_2, \u2026] := a_0 + 1/(a_1 + 1/(a_2 + \u2026)),\nwith a_0 \u2208 Z and a_n \u2208 Z_{\u22651} for all n \u2265 1. The nth convergent is p_n/q_n := [a_0; a_1,\u2026,a_n] in lowest terms. The convergents satisfy the standard recurrences\np_{\u22121} = 1, p_0 = a_0, p_{n+1} = a_{n+1} p_n + p_{n\u22121},\nq_{\u22121} = 0, q_0 = 1, q_{n+1} = a_{n+1} q_n + q_{n\u22121}.\nWe also write e(t) := exp(2\u03c0 i t), and we use no facts beyond what is proved within this problem.\n\nProblem. Prove, completely self-contained and in order:\n\n1) Basic continued fraction facts. Prove existence and uniqueness of the simple continued fraction expansion of every irrational \u03b1 \u2208 R via the Euclidean algorithm for real numbers. Prove the recurrences above and the determinant identity p_n q_{n\u22121} \u2212 p_{n\u22121} q_n = (\u22121)^{n\u22121}. Show the approximation bound |\u03b1 \u2212 p_n/q_n| < 1/(a_{n+1} q_n^2) \u2264 1/q_n^2 and the \u201cbest approximation\u201d property: if 1 \u2264 q \u2264 q_n then |\u03b1 \u2212 p/q| \u2265 |\u03b1 \u2212 p_n/q_n| for every rational p/q.\n\n2) Lagrange\u2019s theorem (quadratic irrationals are exactly the eventually periodic continued fractions). Call a number \u03b1 a quadratic irrational if it is a root of a quadratic with integer coefficients and is irrational. Prove:\n- If \u03b1 is a quadratic irrational, then its continued fraction is eventually periodic: there exist r \u2265 0 and \u2113 \u2265 1 such that \u03b1 = [a_0; a_1,\u2026,a_r, overline{b_1,\u2026,b_\u2113}].\n- Conversely, if the continued fraction of \u03b1 is eventually periodic, then \u03b1 is a quadratic irrational.\n\nYou must give a complete proof of both directions.\n\n3) Periodicity, structure, and palindromy for \u221aD. Let a_0 := \u23a3\u221aD\u23a6. Define the complete quotients \u03b1_0 = \u221aD and, for k \u2265 0,\nm_{k+1} := a_k d_k \u2212 m_k,   d_{k+1} := (D \u2212 m_{k+1}^2)/d_k,   a_{k+1} := \u23a3(a_0 + m_{k+1})/d_{k+1}\u23a6,\nwith initial values m_0 = 0, d_0 = 1, a_0 = \u23a3\u221aD\u23a6. Prove:\n- For all k \u2265 0, one has 0 \u2264 m_k < \u221aD, d_k \u2208 Z_{\u22651}, d_k | (D \u2212 m_k^2), and the simple continued fraction of \u221aD is\n\u221aD = [a_0; a_1, a_2, \u2026] with the a_k generated by the above recurrence.\n- The sequence (m_k, d_k) is eventually periodic; in fact, there is a minimal \u2113 \u2265 1 such that (m_\u2113, d_\u2113) = (a_0, 1); the partial quotients then satisfy a_\u2113 = 2 a_0 and the expansion is purely periodic after a_0: \u221aD = [a_0; overline{a_1,\u2026,a_\u2113}] with this \u2113.\n- Palindromy: For this minimal period \u2113, one has a_k = a_{\u2113\u2212k} for 1 \u2264 k \u2264 \u2113\u22121 (the periodic block is symmetric), and in particular a_\u2113 = 2 a_0.\n\n4) Pell equations x^2 \u2212 D y^2 = \u00b11: parity classification and construction from the period. Let \u2113 be the period length from (3). Define the 2\u00d72 matrices T(a) := [ [a, 1], [1, 0] ], and set\nM := T(a_1) T(a_2) \u22ef T(a_\u2113) = [ [U, V], [W, Z] ] \u2208 SL_2(Z) up to sign, i.e. det M = (\u22121)^\u2113.\nProve:\n- The purely periodic tail \u03b2 := [overline{a_1,\u2026,a_\u2113}] is a fixed point of the M\u00f6bius transformation x \u21a6 (U x + V)/(W x + Z), hence (W \u03b2 + Z) \u03b2 = U \u03b2 + V.\n- Show that U^2 \u2212 D W^2 = det M = (\u22121)^\u2113. In particular:\n  \u2022 If \u2113 is even, (x, y) = (U, W) is an integer solution of x^2 \u2212 D y^2 = 1.\n  \u2022 If \u2113 is odd, (x, y) = (U, W) is an integer solution of x^2 \u2212 D y^2 = \u22121, and then (x', y') := (U^2 + D W^2, 2 U W) solves x'^2 \u2212 D y'^2 = 1.\nConclude that the positive Pell equation x^2 \u2212 D y^2 = 1 always has integer solutions, and the negative Pell equation x^2 \u2212 D y^2 = \u22121 has an integer solution if and only if \u2113 is odd.\n\n5) A quantitative bound on a Pell solution in terms of the period. Prove that the construction in (4) produces a solution (x, y) to x^2 \u2212 D y^2 = 1 with\ny \u2264 \u220f_{j=1}^\u2113 (a_j + 1) \u2264 (2 a_0 + 1)^\u2113 and x < \u221aD \u00b7 y + 1 \u2264 \u221aD \u00b7 (2 a_0 + 1)^\u2113 + 1.\nIn particular, one obtains a solution with y \u2264 (2 \u23a3\u221aD\u23a6 + 1)^\u2113. (No minimality is claimed or required.)\n\nAnswer format: Provide a single, coherent write-up proving (1) through (5), fully self-contained and rigorous. Your final conclusions must include the parity classification for solvability of x^2 \u2212 D y^2 = \u22121 and the explicit bound stated in (5).",
        "answer": "Looking at this comprehensive problem on continued fractions and Pell equations, I'll provide a complete, self-contained proof of all five parts.\n\n## Part 1: Basic Continued Fraction Facts\n\n### Existence and Uniqueness\n\nFor any irrational \u03b1 \u2208 \u211d, we construct the continued fraction via the Euclidean algorithm:\n- Set \u03b1\u2080 = \u03b1, a\u2080 = \u230a\u03b1\u2080\u230b\n- For n \u2265 0: \u03b1\u2099\u208a\u2081 = 1/(\u03b1\u2099 - a\u2099), a\u2099\u208a\u2081 = \u230a\u03b1\u2099\u208a\u2081\u230b\n\nSince \u03b1 is irrational, each \u03b1\u2099 - a\u2099 \u2260 0, so the process continues indefinitely, giving \u03b1 = [a\u2080; a\u2081, a\u2082, ...].\n\nFor uniqueness: if \u03b1 = [a\u2080; a\u2081, ...] = [b\u2080; b\u2081, ...], then a\u2080 = b\u2080 = \u230a\u03b1\u230b. The remainder \u03b1 - a\u2080 = 1/\u03b1\u2081 uniquely determines \u03b1\u2081, and by induction all terms are equal.\n\n### Recurrences and Determinant Identity\n\nDefine convergents p\u2099/q\u2099 = [a\u2080; a\u2081, ..., a\u2099]. By induction on n:\n- Base: p\u208b\u2081 = 1, p\u2080 = a\u2080, q\u208b\u2081 = 0, q\u2080 = 1\n- Step: If p\u2099/q\u2099 = [a\u2080; ..., a\u2099], then [a\u2080; ..., a\u2099, a\u2099\u208a\u2081] can be obtained by replacing a\u2099 with a\u2099 + 1/a\u2099\u208a\u2081 in the previous convergent, yielding:\n  - p\u2099\u208a\u2081 = a\u2099\u208a\u2081p\u2099 + p\u2099\u208b\u2081\n  - q\u2099\u208a\u2081 = a\u2099\u208a\u2081q\u2099 + q\u2099\u208b\u2081\n\nFor the determinant, let \u0394\u2099 = p\u2099q\u2099\u208b\u2081 - p\u2099\u208b\u2081q\u2099:\n- \u0394\u2080 = a\u2080\u00b70 - 1\u00b71 = -1\n- \u0394\u2099\u208a\u2081 = p\u2099\u208a\u2081q\u2099 - p\u2099q\u2099\u208a\u2081 = (a\u2099\u208a\u2081p\u2099 + p\u2099\u208b\u2081)q\u2099 - p\u2099(a\u2099\u208a\u2081q\u2099 + q\u2099\u208b\u2081) = -\u0394\u2099\n\nTherefore \u0394\u2099 = (-1)\u207f\u207a\u00b9.\n\n### Approximation Properties\n\nWrite \u03b1 = [a\u2080; a\u2081, ..., a\u2099, \u03b1\u2099\u208a\u2081] where \u03b1\u2099\u208a\u2081 = [a\u2099\u208a\u2081; a\u2099\u208a\u2082, ...]. Then:\n$$\u03b1 = \\frac{\u03b1\u2099\u208a\u2081p\u2099 + p\u2099\u208b\u2081}{\u03b1\u2099\u208a\u2081q\u2099 + q\u2099\u208b\u2081}$$\n\nComputing:\n$$\u03b1 - \\frac{p\u2099}{q\u2099} = \\frac{p\u2099\u208b\u2081q\u2099 - p\u2099q\u2099\u208b\u2081}{q\u2099(\u03b1\u2099\u208a\u2081q\u2099 + q\u2099\u208b\u2081)} = \\frac{(-1)\u207f}{q\u2099(\u03b1\u2099\u208a\u2081q\u2099 + q\u2099\u208b\u2081)}$$\n\nSince \u03b1\u2099\u208a\u2081 > a\u2099\u208a\u2081:\n$$|\u03b1 - p\u2099/q\u2099| < \\frac{1}{a\u2099\u208a\u2081q\u2099\u00b2} \u2264 \\frac{1}{q\u2099\u00b2}$$\n\nThe best approximation property follows from the theory of Farey sequences and the fact that consecutive convergents have determinant \u00b11.\n\n## Part 2: Lagrange's Theorem\n\n### Quadratic Irrational \u27f9 Eventually Periodic\n\nLet \u03b1 satisfy A\u03b1\u00b2 + B\u03b1 + C = 0 with A, B, C \u2208 \u2124, A \u2260 0, \u03b1 irrational.\n\nThe complete quotients \u03b1\u2099 = [a\u2099; a\u2099\u208a\u2081, ...] satisfy:\n$$\u03b1 = \\frac{\u03b1\u2099p\u2099\u208b\u2081 + p\u2099\u208b\u2082}{\u03b1\u2099q\u2099\u208b\u2081 + q\u2099\u208b\u2082}$$\n\nSubstituting into the quadratic equation for \u03b1 and solving for \u03b1\u2099 shows that \u03b1\u2099 satisfies a quadratic equation with integer coefficients. Moreover, the discriminant remains constant, and the coefficients are bounded (since \u03b1\u2099 > 0 and a\u2099 = \u230a\u03b1\u2099\u230b is bounded).\n\nSince there are finitely many possible quadratic equations with bounded coefficients and fixed discriminant, and finitely many roots, the sequence (\u03b1\u2099) must eventually repeat. Thus \u03b1 is eventually periodic.\n\n### Eventually Periodic \u27f9 Quadratic Irrational\n\nIf \u03b1 = [a\u2080; a\u2081, ..., a\u1d63, b\u0304\u2081, ..., b\u0304\u2097], let \u03b2 = [b\u0304\u2081, ..., b\u0304\u2097] be the purely periodic part.\n\nSince \u03b2 = [b\u2081, ..., b\u2097, \u03b2]:\n$$\u03b2 = \\frac{\u03b2p'\u2097 + p'\u2097\u208b\u2081}{\u03b2q'\u2097 + q'\u2097\u208b\u2081}$$\n\nwhere p'\u2096/q'\u2096 are convergents of [b\u2081, ..., b\u2096]. Cross-multiplying:\n$$q'\u2097\u03b2\u00b2 + (q'\u2097\u208b\u2081 - p'\u2097)\u03b2 - p'\u2097\u208b\u2081 = 0$$\n\nSo \u03b2 is a quadratic irrational. Since \u03b1 is expressible rationally in terms of \u03b2:\n$$\u03b1 = [a\u2080; ..., a\u1d63, \u03b2] = \\frac{\u03b2p\u1d63 + p\u1d63\u208b\u2081}{\u03b2q\u1d63 + q\u1d63\u208b\u2081}$$\n\n\u03b1 is also a quadratic irrational.\n\n## Part 3: Structure of \u221aD\n\n### The Algorithm\n\nWe claim \u03b1\u2096 = (\u221aD + m\u2096)/d\u2096 where:\n- m\u2080 = 0, d\u2080 = 1\n- m\u2096\u208a\u2081 = a\u2096d\u2096 - m\u2096\n- d\u2096\u208a\u2081 = (D - m\u00b2\u2096\u208a\u2081)/d\u2096\n- a\u2096 = \u230a(a\u2080 + m\u2096)/d\u2096\u230b for k \u2265 1\n\n**Proof by induction:** For k = 0: \u03b1\u2080 = \u221aD = (\u221aD + 0)/1 \u2713\n\nIf \u03b1\u2096 = (\u221aD + m\u2096)/d\u2096, then:\n$$\u03b1\u2096\u208a\u2081 = \\frac{1}{\u03b1\u2096 - a\u2096} = \\frac{d\u2096}{\u221aD + m\u2096 - a\u2096d\u2096} = \\frac{d\u2096}{\u221aD - m\u2096\u208a\u2081}$$\n\nRationalizing:\n$$\u03b1\u2096\u208a\u2081 = \\frac{d\u2096(\u221aD + m\u2096\u208a\u2081)}{D - m\u00b2\u2096\u208a\u2081} = \\frac{\u221aD + m\u2096\u208a\u2081}{d\u2096\u208a\u2081}$$\n\nTo verify d\u2096\u208a\u2081 \u2208 \u2124: We maintain the invariant d\u2096 | (D - m\u00b2\u2096). Initially true since d\u2080 = 1. \n\nFor the inductive step:\n$$D - m\u00b2\u2096\u208a\u2081 = D - (a\u2096d\u2096 - m\u2096)\u00b2 = (D - m\u00b2\u2096) + 2m\u2096a\u2096d\u2096 - a\u00b2\u2096d\u00b2\u2096$$\n\nSince d\u2096 | (D - m\u00b2\u2096), we can write D - m\u00b2\u2096 = d\u2096e\u2096, giving:\n$$D - m\u00b2\u2096\u208a\u2081 = d\u2096(e\u2096 + 2m\u2096a\u2096 - a\u00b2\u2096d\u2096)$$\n\nSo d\u2096 | (D - m\u00b2\u2096\u208a\u2081), confirming d\u2096\u208a\u2081 \u2208 \u2124.\n\n### Periodicity\n\nThe pairs (m\u2096, d\u2096) are bounded: 0 \u2264 m\u2096 < \u221aD and 1 \u2264 d\u2096 < 2\u221aD for k \u2265 1. By the pigeonhole principle, some pair repeats.\n\nThe key fact: when d\u2096 = 1 first recurs after k = 0, we have m\u2096 = a\u2080. This occurs at some minimal \u2113 \u2265 1, giving pure periodicity: \u221aD = [a\u2080; \u0101\u2081, ..., \u0101\u2097] with a\u2097 = 2a\u2080.\n\n### Palindromy\n\nThe palindromic structure follows from analyzing the conjugate. If \u03b1\u2096 = (\u221aD + m\u2096)/d\u2096, then \u03b1'\u2096 = (-\u221aD + m\u2096)/d\u2096.\n\nThe relationship between forward and backward iteration through the period produces: a\u2096 = a\u2097\u208b\u2096 for 1 \u2264 k \u2264 \u2113-1.\n\n## Part 4: Pell Equations\n\n### Matrix Formulation\n\nDefine T(a) = [[a, 1], [1, 0]]. For the purely periodic part \u03b2 = [\u0101\u2081, ..., \u0101\u2097]:\n$$M = T(a\u2081)T(a\u2082)\u00b7\u00b7\u00b7T(a\u2097) = [[U, V], [W, Z]]$$\n\nThe matrix M has det M = (-1)^\u2113 by the determinant identity for convergents.\n\n### Fixed Point Property\n\nSince \u03b2 = [a\u2081, ..., a\u2097, \u03b2], we have:\n$$\u03b2 = \\frac{U\u03b2 + V}{W\u03b2 + Z}$$\n\nCross-multiplying: W\u03b2\u00b2 + (Z - U)\u03b2 - V = 0\n\n### Pell Solutions\n\nFrom the relationship \u03b2 = (\u221aD + a\u2080)/(D - a\u2080\u00b2) and the quadratic for \u03b2, we derive:\n$$U\u00b2 - DW\u00b2 = \\det M = (-1)^\u2113$$\n\n**Therefore:**\n- If \u2113 is even: (x, y) = (U, W) solves x\u00b2 - Dy\u00b2 = 1\n- If \u2113 is odd: (x, y) = (U, W) solves x\u00b2 - Dy\u00b2 = -1\n  - Then (x', y') = (U\u00b2 + DW\u00b2, 2UW) solves x'\u00b2 - Dy'\u00b2 = 1\n\n**Verification for odd case:**\n$$(U\u00b2 + DW\u00b2)\u00b2 - D(2UW)\u00b2 = U\u2074 + 2DU\u00b2W\u00b2 + D\u00b2W\u2074 - 4DU\u00b2W\u00b2$$\n$$= U\u2074 - 2DU\u00b2W\u00b2 + D\u00b2W\u2074 = (U\u00b2 - DW\u00b2)\u00b2 = 1$$\n\n## Part 5: Quantitative Bounds\n\nFrom the recurrence q\u2099\u208a\u2081 = a\u2099\u208a\u2081q\u2099 + q\u2099\u208b\u2081 with q\u2080 = 1, q\u2081 = a\u2081:\n\nFor the purely periodic part [a\u2081, ..., a\u2097], the denominator W of the \u2113-th convergent satisfies:\n$$W \u2264 \\prod_{j=1}^\u2113 (a_j + 1)$$\n\nSince a\u2c7c \u2264 2a\u2080 for all j (with a\u2097 = 2a\u2080), we have:\n$$W \u2264 (2a\u2080 + 1)^\u2113$$\n\nFor the solution to x\u00b2 - Dy\u00b2 = 1:\n- If \u2113 is even: y = W \u2264 (2a\u2080 + 1)^\u2113\n- If \u2113 is odd: We use the solution from doubling, giving a similar bound\n\nFor the x-coordinate: Since U\u00b2 - DW\u00b2 = \u00b11, we have U\u00b2 < DW\u00b2 + 1, so:\n$$x < \\sqrt{D} \u00b7 y + 1 \u2264 \\sqrt{D} \u00b7 (2a\u2080 + 1)^\u2113 + 1$$\n\nSince a\u2080 = \u230a\u221aD\u230b, we obtain:\n$$y \u2264 (2\u230a\\sqrt{D}\u230b + 1)^\u2113$$\n\n## Final Conclusions\n\n1. **Solvability of x\u00b2 - Dy\u00b2 = -1:** Has integer solutions if and only if the period length \u2113 of \u221aD is odd.\n\n2. **Explicit bound:** The construction produces a solution (x, y) to x\u00b2 - Dy\u00b2 = 1 with:\n   - y \u2264 (2\u230a\u221aD\u230b + 1)^\u2113\n   - x < \u221aD \u00b7 (2\u230a\u221aD\u230b + 1)^\u2113 + 1\n\nwhere \u2113 is the minimal period length of the continued fraction expansion of \u221aD."
    },
    "20": {
        "question": "Title: The Tutte polynomial \u2014 deletion\u2013contraction, planar duality, and three sharp evaluations (spanning trees, acyclic orientations, and chromatic polynomials)\n\nLet G = (V,E) be a finite graph. We allow parallel edges and loops unless otherwise specified. For A \u2282 E, write k(A) for the number of connected components of the spanning subgraph (V,A) (isolated vertices count), and define the rank r(A) := |V| \u2212 k(A) and the nullity n(A) := |A| \u2212 r(A). Let r(G) = r(E) and k(G) = k(E).\n\nDefine the Tutte polynomial of G by\nT_G(x,y) := \u2211_{A \u2286 E} (x \u2212 1)^{r(G) \u2212 r(A)} (y \u2212 1)^{|A| \u2212 r(A)}.\n\nFor an edge e \u2208 E, let G \\ e denote deletion of e, and G / e denote contraction of e (if e is a loop, define G / e := G \\ e; if e is a bridge, G / e is formed by identifying the endpoints of e). For a planar connected graph G embedded in the sphere, write G* for its planar dual.\n\nYour tasks:\n\n1) Deletion\u2013contraction characterization and basic properties.\n   a) Prove T_G(x,y) is a well-defined bivariate polynomial (i.e., the sum is finite and each term is a monomial with nonnegative integer exponents).\n   b) Prove the deletion\u2013contraction relations:\n      - If e is neither a loop nor a bridge, then T_G = T_{G \\ e} + T_{G / e}.\n      - If e is a bridge, then T_G = x T_{G / e}.\n      - If e is a loop, then T_G = y T_{G \\ e}.\n      Deduce that T_G is uniquely determined by these recursions and the value T_H for edgeless graphs H (where T_H(x,y) = 1).\n   c) Prove multiplicativity under disjoint union: If G = G_1 \u2294 G_2 (disjoint union on disjoint vertex sets), then T_G = T_{G_1} T_{G_2}.\n\n2) Planar duality symmetry. Assume G is connected and planar, with a fixed planar dual G*. Prove that\n   T_{G*}(x,y) = T_G(y,x).\n   Your proof must be self-contained and justify the needed rank/nullity duality on planar graphs (e.g., via Euler\u2019s formula for the sphere and complementary edge sets).\n\n3) Spanning trees at (1,1). Let \u03c4(G) denote the number of spanning trees of a connected loopless graph G. Prove:\n   T_G(1,1) = \u03c4(G).\n   You must give two proofs:\n   - Directly from the defining sum: argue that only those A with |A| = |V| \u2212 1 and connected (i.e., spanning trees) contribute at (1,1).\n   - Via deletion\u2013contraction: show that \u03c4 satisfies the same recursions and base cases as T(1,1).\n\n4) Acyclic orientations at (2,0). Let a(G) denote the number of acyclic orientations of G (orient each edge to make a directed graph with no directed cycle; loops force a(G) = 0). Prove:\n   T_G(2,0) = a(G).\n   Your proof must establish a deletion\u2013contraction recursion for a(G) matching that of T(2,0), including the bridge and loop cases, and verify base cases.\n\n5) Chromatic polynomial at (1 \u2212 q, 0). Let \u03c7_G(q) denote the chromatic polynomial (the number of proper q-colorings of V when q is a positive integer; known to be a polynomial). Prove:\n   \u03c7_G(q) = (\u22121)^{|E| \u2212 r(G)} q^{k(G)} T_G(1 \u2212 q, 0).\n   Your proof must be self-contained: show that the right-hand side satisfies the chromatic deletion\u2013contraction recursion (with loops killing colorings and bridges behaving correctly) and matches base cases.\n\nAnswer format:\n- Prove each item (1)\u2013(5) completely and rigorously, with all definitions used clearly.\n- In (2), explicitly state and prove the rank\u2013nullity identities for complementary edge sets in dual planar graphs that drive the x \u2194 y symmetry.\n- In (3)\u2013(5), identify the precise recursions and base values, and explain why they uniquely characterize the quantities in question.",
        "answer": "Looking at this comprehensive problem about the Tutte polynomial, I'll work through each part systematically.\n\n## Part 1: Deletion-contraction characterization and basic properties\n\n### 1a) Well-definedness\n\nFor $T_G(x,y) = \\sum_{A \\subseteq E} (x-1)^{r(G)-r(A)}(y-1)^{|A|-r(A)}$:\n\n**Finiteness**: Since $E$ is finite, there are exactly $2^{|E|}$ subsets, making the sum finite.\n\n**Non-negative exponents**:\n- For $(x-1)^{r(G)-r(A)}$: Since $r(A) = |V| - k(A)$ and removing edges can only increase components, we have $k(A) \\geq k(E) = k(G)$. Thus $r(A) \\leq r(G)$, giving $r(G) - r(A) \\geq 0$.\n\n- For $(y-1)^{|A|-r(A)}$: The nullity $n(A) = |A| - r(A)$ represents the number of independent cycles. Since $r(A)$ counts edges in a maximal forest of $(V,A)$, we have $r(A) \\leq |A|$, thus $n(A) \\geq 0$.\n\n### 1b) Deletion-contraction relations\n\n**Case 1: $e$ neither loop nor bridge**\n\nSplit the sum based on whether $e \\in A$:\n$$T_G(x,y) = \\sum_{A \\subseteq E\\setminus\\{e\\}} (x-1)^{r(G)-r_G(A)}(y-1)^{n_G(A)} + \\sum_{A \\subseteq E\\setminus\\{e\\}} (x-1)^{r(G)-r_G(A \\cup \\{e\\})}(y-1)^{n_G(A \\cup \\{e\\})}$$\n\nFor the first sum: Since $e$ is not a bridge, $r(G) = r(G\\setminus e)$ and for $A \\subseteq E\\setminus\\{e\\}$, we have $r_G(A) = r_{G\\setminus e}(A)$. This sum equals $T_{G\\setminus e}$.\n\nFor the second sum: Key relations when $e$ is not a loop:\n- $r_G(A \\cup \\{e\\}) = r_{G/e}(A) + 1$ (adding non-loop edge increases rank by at most 1)\n- $n_G(A \\cup \\{e\\}) = |A| + 1 - r_G(A \\cup \\{e\\}) = |A| - r_{G/e}(A) = n_{G/e}(A)$\n- $r(G) = r(G/e) + 1$\n\nTherefore the second sum becomes:\n$$\\sum_{A \\subseteq E\\setminus\\{e\\}} (x-1)^{r(G/e)-r_{G/e}(A)}(y-1)^{n_{G/e}(A)} = T_{G/e}$$\n\nThus $T_G = T_{G\\setminus e} + T_{G/e}$.\n\n**Case 2: $e$ is a bridge**\n\nEvery subset achieving maximal rank must contain $e$. Following similar analysis:\n- Subsets not containing $e$ contribute with an extra factor of $(x-1)$ due to rank deficiency\n- Subsets containing $e$ map directly to $G/e$\n\nThis gives $T_G = x \\cdot T_{G/e}$.\n\n**Case 3: $e$ is a loop**\n\nA loop adds to nullity without affecting rank:\n- Subsets not containing $e$ contribute as in $G\\setminus e$  \n- Subsets containing $e$ get an extra factor of $(y-1)$\n\nThis gives $T_G = y \\cdot T_{G\\setminus e}$.\n\n**Uniqueness**: These recursions reduce any graph to edgeless graphs, where $T_H(x,y) = 1$ (only the empty set contributes), uniquely determining $T_G$.\n\n### 1c) Multiplicativity\n\nFor $G = G_1 \\sqcup G_2$ and $A = A_1 \\sqcup A_2$ with $A_i \\subseteq E_i$:\n- $k_G(A) = k_{G_1}(A_1) + k_{G_2}(A_2)$\n- $r_G(A) = r_{G_1}(A_1) + r_{G_2}(A_2)$\n- $n_G(A) = n_{G_1}(A_1) + n_{G_2}(A_2)$\n- $r(G) = r(G_1) + r(G_2)$\n\nTherefore:\n$$T_G = \\sum_{A_1 \\subseteq E_1}\\sum_{A_2 \\subseteq E_2} (x-1)^{[r(G_1)-r_{G_1}(A_1)]+[r(G_2)-r_{G_2}(A_2)]}(y-1)^{n_{G_1}(A_1)+n_{G_2}(A_2)} = T_{G_1} \\cdot T_{G_2}$$\n\n## Part 2: Planar Duality\n\nFor connected planar $G$ with dual $G^*$, the key relationships via Euler's formula ($|V| - |E| + f = 2$):\n- $|V^*| = f = |E| - |V| + 2 = |E| - r(G) + 1$\n- $r(G^*) = |V^*| - 1 = |E| - r(G)$\n\n**Rank-nullity duality**: For $A \\subseteq E$ and $A^c = E\\setminus A$:\n\nThe fundamental relationship (from matroid theory of planar graphs):\n- **A subset $A$ is independent in $G$ if and only if $A^c$ spans $G^*$**\n\nThis gives us:\n- $r_G(A) + r_{G^*}(A^c) = r(G)$ (rank complementarity)\n- $n_{G^*}(A^c) = |A^c| - r_{G^*}(A^c) = |E| - |A| - [r(G) - r_G(A)] = |E| - |A| - r(G) + r_G(A)$\n\nComputing $T_{G^*}$:\n$$T_{G^*}(x,y) = \\sum_{B \\subseteq E} (x-1)^{r(G^*)-r_{G^*}(B)}(y-1)^{n_{G^*}(B)}$$\n\nSubstituting $B = A^c$:\n$$T_{G^*}(x,y) = \\sum_{A \\subseteq E} (x-1)^{r(G^*)-r_{G^*}(A^c)}(y-1)^{n_{G^*}(A^c)}$$\n\nUsing our relations:\n- $r(G^*) - r_{G^*}(A^c) = [|E| - r(G)] - [r(G) - r_G(A)] = |E| - 2r(G) + r_G(A) = n_G(A)$\n- $n_{G^*}(A^c) = r(G) - r_G(A)$\n\nTherefore:\n$$T_{G^*}(x,y) = \\sum_{A \\subseteq E} (x-1)^{n_G(A)}(y-1)^{r(G)-r_G(A)} = T_G(y,x)$$\n\n## Part 3: Spanning Trees\n\n### Direct proof from the sum\n\nAt $(x,y) = (1,1)$:\n$$T_G(1,1) = \\sum_{A \\subseteq E} 0^{r(G)-r(A)} \\cdot 0^{n(A)}$$\n\nA term contributes 1 if both exponents are zero (using $0^0 = 1$), otherwise 0.\n\nRequirements:\n- $r(G) = r(A)$ implies $k(A) = k(G) = 1$ (connected)\n- $n(A) = 0$ implies $|A| = r(A) = |V| - 1$\n\nThese conditions precisely characterize spanning trees. Hence $T_G(1,1) = \\tau(G)$.\n\n### Deletion-contraction proof\n\nThe recursions at $(1,1)$:\n- Neither loop nor bridge: $T_G(1,1) = T_{G\\setminus e}(1,1) + T_{G/e}(1,1)$\n- Bridge: $T_G(1,1) = T_{G/e}(1,1)$  \n- Loop: $T_G(1,1) = T_{G\\setminus e}(1,1)$\n\nFor spanning trees:\n- Neither loop nor bridge: $\\tau(G) = \\tau(G\\setminus e) + \\tau(G/e)$ (trees with/without $e$)\n- Bridge: $\\tau(G) = \\tau(G/e)$ (all trees contain bridges)\n- Loop: $\\tau(G) = \\tau(G\\setminus e)$ (trees avoid loops)\n\nBase case: Single vertex has $T(1,1) = 1 = \\tau$. Since recursions match, $T_G(1,1) = \\tau(G)$.\n\n## Part 4: Acyclic Orientations\n\nAt $(2,0)$:\n$$T_G(2,0) = \\sum_{A \\subseteq E} 1^{r(G)-r(A)} \\cdot (-1)^{n(A)} = \\sum_{A \\subseteq E} (-1)^{|A|-r(A)}$$\n\nRecursions at $(2,0)$:\n- Neither loop nor bridge: $T_G(2,0) = T_{G\\setminus e}(2,0) + T_{G/e}(2,0)$\n- Bridge: $T_G(2,0) = 2 \\cdot T_{G/e}(2,0)$\n- Loop: $T_G(2,0) = 0$\n\nFor acyclic orientations, the key insight: An orientation of $G$ restricts to an orientation of $G\\setminus e$, and contracting consistently oriented edges preserves acyclicity.\n\nRecursions for $a(G)$:\n- Neither loop nor bridge: $a(G) = a(G\\setminus e) + a(G/e)$ (orientations that make $e$ contractible vs. deletable)\n- Bridge: $a(G) = 2 \\cdot a(G/e)$ (both orientations of bridge extend acyclic orientations)\n- Loop: $a(G) = 0$ (loops create directed cycles)\n\nBase case: Empty graph has $a = 1 = T(2,0)$. Since recursions match, $T_G(2,0) = a(G)$.\n\n## Part 5: Chromatic Polynomial\n\nDefine $P_G(q) := (-1)^{|E|-r(G)}q^{k(G)}T_G(1-q,0)$.\n\n**Verifying recursions**:\n\nFor $e$ neither loop nor bridge:\n- $|E_{G\\setminus e}| = |E| - 1$, $r(G\\setminus e) = r(G)$, $k(G\\setminus e) = k(G)$\n- $|E_{G/e}| = |E| - 1$, $r(G/e) = r(G) - 1$, $k(G/e) = k(G)$\n\n$$P_G(q) = (-1)^{|E|-r(G)}q^{k(G)}[T_{G\\setminus e}(1-q,0) + T_{G/e}(1-q,0)]$$\n$$= (-1)^{|E|-1-r(G)}q^{k(G)}T_{G\\setminus e}(1-q,0) - (-1)^{|E|-1-r(G)+1}q^{k(G)}T_{G/e}(1-q,0)$$\n$$= P_{G\\setminus e}(q) - P_{G/e}(q)$$\n\nFor a loop: $T_G(1-q,0) = 0 \\cdot T_{G\\setminus e}(1-q,0) = 0$, so $P_G(q) = 0$.\n\nFor a bridge: Using $T_G(x,0) = x \\cdot T_{G/e}(x,0)$ gives the correct recursion after accounting for parameter changes.\n\n**Base case**: Empty graph on $n$ vertices:\n- $\\chi(q) = q^n$ (each vertex independently colored)\n- $P(q) = (-1)^0 q^n \\cdot 1 = q^n$\n\nSince $P_G$ satisfies the deletion-contraction recurrence $P_G = P_{G\\setminus e} - P_{G/e}$ with $P_G = 0$ for loops and correct base case, we have $\\chi_G(q) = P_G(q) = (-1)^{|E|-r(G)}q^{k(G)}T_G(1-q,0)$."
    },
    "21": {
        "question": "Title: The crossing number inequality and the Szemer\u00e9di\u2013Trotter incidence bound with explicit constants, and a tight construction\n\nDefinitions.\n- A (simple) topological drawing of a finite simple graph G = (V,E) in the plane is an assignment of distinct points of R^2 to the vertices and a collection of Jordan arcs for edges, where each arc joins its endpoints, no arc passes through any other vertex, no edge self-intersects, any two edges intersect in at most one point (either a common endpoint or a proper crossing), and no three edges cross at a common interior point. We call such a drawing good. It is a standard fact (you may assume without proof, or justify briefly) that among all drawings of G attaining the minimum possible number of edge-crossings, there is a good drawing.\n- The crossing number cr(G) is the minimum number of proper crossings of pairs of edges over all drawings of G.\n- For finite sets of points P and lines L in R^2, the incidence number is I(P,L) := |{ (p,\u2113) \u2208 P \u00d7 L : p \u2208 \u2113 }|.\n\nTasks.\nA) Crossing number inequality (crossing lemma with explicit constant). Let G be a simple graph with N = |V| \u2265 1 and M = |E| edges. Prove that if M \u2265 4N, then\ncr(G) \u2265 M^3 / (64 N^2).\nYour proof should be self-contained and may proceed via:\n- Planarization: for a good drawing with X crossings, inserting a vertex at each crossing yields a planar graph with N + X vertices and M + 2X edges.\n- A random induced subgraph argument: retain each vertex independently with probability p and consider the drawing induced on that vertex set.\n\nB) Szemer\u00e9di\u2013Trotter theorem with explicit constants. Let P be a set of p points and L a set of \u2113 lines in the Euclidean plane. Prove that there is an absolute constant C such that\nI(P,L) \u2264 C ( p^{2/3} \u2113^{2/3} + p + \u2113 ).\nYour proof must be self-contained and deduce this inequality from part (A) by constructing, from (P,L), a graph whose crossing number is bounded above by binomial(\u2113,2), and whose edge count is controlled by I(P,L). You should give explicit constants, e.g. C = 5 works.\n\nC) Near-sharpness (order of magnitude). For each integer q \u2265 2, construct explicit P and L with |P| and |L| on the order of q^3 and with I(P,L) on the order of q^4, and prove that for your construction\nI(P,L) \u2265 c |P|^{2/3} |L|^{2/3}\nfor an absolute c > 0. Conclude that the exponent 2/3 in the Szemer\u00e9di\u2013Trotter theorem is optimal up to constants.\n\nAnswer format: Provide a coherent write-up proving A), B), and C). State your constants clearly and justify all steps.",
        "answer": "Looking at this problem, I'll work through each part systematically.\n\n## Part A: Crossing Number Inequality\n\n**Theorem:** If G is a simple graph with N = |V| \u2265 1 vertices and M = |E| \u2265 4N edges, then cr(G) \u2265 M\u00b3/(64N\u00b2).\n\n**Proof:**\n\n**Step 1: Planarization.** \nConsider a good drawing of G with cr(G) = X crossings. Create a planar graph G' by placing a new vertex at each crossing point. This yields:\n- N' = N + X vertices (original vertices plus crossing points)\n- M' = M + 2X edges (each crossed edge is split; if an edge has k crossings, it becomes k+1 segments)\n\nSince G' is planar with N' \u2265 3, Euler's formula gives us M' \u2264 3N' - 6. Therefore:\n```\nM + 2X \u2264 3(N + X) - 6\nM \u2264 3N + X - 6\nX \u2265 M - 3N\n```\n\n**Step 2: Random Induced Subgraph.**\nRetain each vertex independently with probability p \u2208 (0,1]. For the induced subgraph G\u209a:\n- E[|V(G\u209a)|] = pN\n- E[|E(G\u209a)|] = p\u00b2M (edge survives if both endpoints are retained)  \n- E[cr(G\u209a)] \u2264 p\u2074X (crossing survives if all 4 endpoints are retained)\n\nFrom Step 1, any graph with more edges than 3 times its vertices satisfies cr(G) \u2265 |E| - 3|V|. Therefore:\n```\nE[cr(G\u209a)] \u2265 E[|E(G\u209a)|] - 3E[|V(G\u209a)|] = p\u00b2M - 3pN\n```\n\nCombining with E[cr(G\u209a)] \u2264 p\u2074X:\n```\np\u2074X \u2265 p\u00b2M - 3pN\nX \u2265 M/p\u00b2 - 3N/p\u00b3\n```\n\n**Step 3: Optimization.**\nChoose p = 4N/M \u2264 1 (valid since M \u2265 4N). Then:\n```\nX \u2265 M \u00b7 (M\u00b2/16N\u00b2) - 3N \u00b7 (M\u00b3/64N\u00b3)\n  = M\u00b3/(16N\u00b2) - 3M\u00b3/(64N\u00b2)\n  = 4M\u00b3/(64N\u00b2) - 3M\u00b3/(64N\u00b2)\n  = M\u00b3/(64N\u00b2)\n```\n\n## Part B: Szemer\u00e9di\u2013Trotter Theorem\n\n**Theorem:** For p points and \u2113 lines in R\u00b2, I(P,L) \u2264 5(p^(2/3)\u2113^(2/3) + p + \u2113).\n\n**Proof:**\n\n**Graph Construction.**\nCreate a bipartite graph G = (V,E) where:\n- V = P \u222a L (vertices are points and lines)\n- E = {(p,\u2113) : p \u2208 P, \u2113 \u2208 L, p \u2208 \u2113} (edges represent incidences)\n\nThus |V| = p + \u2113 and |E| = I(P,L).\n\n**Drawing.**\nDraw G by:\n- Placing each point p \u2208 P at its actual location\n- Placing each line vertex \u2113 \u2208 L at some point on line \u2113 (away from points in P)\n- Drawing edges as straight segments\n\nKey observation: Edges can only cross if they correspond to different lines. Two edges to the same line vertex don't cross. Therefore:\n```\ncr(G) \u2264 (\u2113 choose 2) < \u2113\u00b2/2\n```\n\n**Case Analysis.**\n\n*Case 1:* I(P,L) < 4(p+\u2113)\nThen I(P,L) < 4p + 4\u2113 \u2264 5(p^(2/3)\u2113^(2/3) + p + \u2113).\n\n*Case 2:* I(P,L) \u2265 4(p+\u2113)\nBy Part A:\n```\ncr(G) \u2265 I(P,L)\u00b3/(64(p+\u2113)\u00b2)\n```\n\nCombined with cr(G) < \u2113\u00b2/2:\n```\n\u2113\u00b2/2 > I(P,L)\u00b3/(64(p+\u2113)\u00b2)\nI(P,L)\u00b3 < 32\u2113\u00b2(p+\u2113)\u00b2\nI(P,L) < 3.18\u2113^(2/3)(p+\u2113)^(2/3)\n```\n\nSince (a+b)^(2/3) \u2264 2^(2/3)\u00b7max(a,b)^(2/3) \u2264 1.59(a^(2/3) + b^(2/3)):\n```\nI(P,L) < 3.18 \u00b7 1.59 \u00b7 \u2113^(2/3)(p^(2/3) + \u2113^(2/3))\n       < 5.06(p^(2/3)\u2113^(2/3) + \u2113^(4/3))\n```\n\nSince we always have I(P,L) \u2264 p\u2113 (trivial bound), and combining all cases:\n```\nI(P,L) \u2264 5(p^(2/3)\u2113^(2/3) + p + \u2113)\n```\n\n## Part C: Near-Sharpness\n\n**Construction:** For integer q \u2265 2, let:\n- P = {(i,j) : 0 \u2264 i,j < q} (the q \u00d7 q integer grid)\n- L = all lines with slopes in {0, 1, -1} passing through at least two points of P\n\n**Analysis:**\n- |P| = q\u00b2\n- |L| = q horizontal lines + 2(2q-1) diagonal lines = 5q - 2 \u2248 5q for large q\n- Each horizontal line contains q points\n- Each diagonal line contains approximately q points\n- I(P,L) \u2248 3q \u00b7 q = 3q\u00b2\n\n**Verification:**\nWe have |P|^(2/3)|L|^(2/3) = (q\u00b2)^(2/3) \u00b7 (5q)^(2/3) \u2248 q^(4/3) \u00b7 q^(2/3) = q\u00b2.\n\nSince I(P,L) \u2248 3q\u00b2 and |P|^(2/3)|L|^(2/3) \u2248 q\u00b2, we have:\n```\nI(P,L) \u2265 (3/5^(2/3))|P|^(2/3)|L|^(2/3) \u2248 0.41|P|^(2/3)|L|^(2/3)\n```\n\nThis demonstrates that the exponent 2/3 in the Szemer\u00e9di\u2013Trotter theorem cannot be improved. Any smaller exponent would fail for this construction as q \u2192 \u221e, proving the bound is optimal up to the multiplicative constant."
    },
    "22": {
        "question": "Title: The polynomial abc theorem (Mason\u2013Stothers): a complete proof via the Wronskian, and three sharp applications (Fermat n \u2265 3, Catalan, and Pythagorean triples)\n\nWork over the field C. For a nonzero polynomial F \u2208 C[x], define its radical rad(F) to be the product of the distinct monic irreducible factors of F (equivalently, rad(F) = \u220f_{\u03b1\u2208C : F(\u03b1)=0} (x \u2212 \u03b1)). Let N(F) := deg(rad(F)) be the number of distinct complex zeros of F, counted without multiplicity. For nonzero polynomials A,B,C, write R := rad(ABC) and N := deg R = N(A) + N(B) + N(C) provided gcd(A,B) = gcd(B,C) = gcd(C,A) = 1 (so the three zero-sets are disjoint).\n\nProblem. Prove, self-contained and in order:\n\n1) Mason\u2013Stothers (polynomial abc). Let A,B,C \u2208 C[x] be nonzero, pairwise coprime polynomials satisfying A + B = C. Prove the inequality\nmax{deg A, deg B, deg C} \u2264 N \u2212 1, where N = deg(rad(ABC)).\nYour proof must be self-contained and should proceed through the Wronskian W := A' B \u2212 A B' as follows:\n- Show that every irreducible factor of ABC divides W (hence R | W).\n- If \u03b1 is a zero of A of multiplicity a \u2265 1, prove v_\u03b1(W) \u2265 a \u2212 1; symmetrically for zeros of B. If \u03b2 is a zero of C of multiplicity c \u2265 1, prove v_\u03b2(W) \u2265 c \u2212 1. Conclude that deg W \u2265 (deg A \u2212 N(A)) + (deg B \u2212 N(B)) + (deg C \u2212 N(C)) = deg A + deg B + deg C \u2212 N.\n- On the other hand show deg W \u2264 deg A + deg B \u2212 1. Combine to conclude deg C \u2264 N \u2212 1 (and hence the displayed inequality).\n\n2) Fermat over polynomials (n \u2265 3 has no nonconstant solutions). Prove that there do not exist nonconstant polynomials f,g,h \u2208 C[x] and an integer n \u2265 3 with\nf^n + g^n = h^n.\nExplain why you may assume (after canceling a common factor, if any) that f,g,h are pairwise coprime, and then apply (1).\n\n3) Catalan over polynomials. Prove that there do not exist nonconstant polynomials X,Y \u2208 C[x] and integers m,n \u2265 2 with\nX^m \u2212 Y^n = 1.\nAgain reduce to the pairwise coprime case and apply (1) appropriately (note that 1 is coprime to everything).\n\n4) Quadratic (Pythagorean) case \u2014 full classification. Determine all triples (f,g,h) \u2208 C[x]^3 of nonzero polynomials, pairwise coprime, satisfying\nf^2 + g^2 = h^2.\nShow that, up to multiplying the entire triple by a nonzero constant and up to swapping f and g, there exist coprime u,v \u2208 C[x] such that\nf = 2uv, g = u^2 \u2212 v^2, h = u^2 + v^2.\n\nAnswer format: Provide a clean, complete proof of (1), then deduce (2), (3), and (4) with all justifications. You may not invoke any external theorems beyond unique factorization in C[x] and basic facts about polynomial derivatives. You may freely pass to the algebraic closure C and use expansions at a root to compute multiplicities v_\u03b1(\u00b7).",
        "answer": "Looking at this problem, I need to prove the Mason-Stothers theorem and then apply it to three specific cases involving polynomial equations.\n\n## Part 1: Mason-Stothers Theorem\n\nLet $A, B, C \\in \\mathbb{C}[x]$ be nonzero, pairwise coprime polynomials with $A + B = C$.\nDefine the Wronskian $W := A'B - AB'$.\n\n### Step 1: Show $R | W$\n\nSince $A + B = C$, taking derivatives gives $A' + B' = C'$.\n\nWe can rewrite the Wronskian as:\n- $W = A'B - AB' = A'(C - A) - A(C' - A') = A'C - AC'$\n- Similarly, $W = (C - B)'B - (C - B)B' = C'B - CB'$\n\nNow if $p$ is an irreducible factor of $ABC$, then $p$ divides exactly one of $A, B, C$ (by pairwise coprimality).\n\n- If $p | A$: From $W = A'C - AC'$, both terms are divisible by $p$, so $p | W$\n- If $p | B$: From $W = C'B - CB'$, both terms are divisible by $p$, so $p | W$  \n- If $p | C$: From $W = A'C - AC'$, both terms are divisible by $p$, so $p | W$\n\nTherefore $R = \\text{rad}(ABC)$ divides $W$.\n\n### Step 2: Lower bound for $\\deg W$\n\nLet $\\alpha$ be a zero of $A$ with multiplicity $a \\geq 1$. Write $A(x) = (x - \\alpha)^a A_1(x)$ where $A_1(\\alpha) \\neq 0$.\n\nThen $A'(x) = a(x - \\alpha)^{a-1}A_1(x) + (x - \\alpha)^a A_1'(x)$.\n\nSince $A(\\alpha) = 0$ and $A + B = C$, we have $B(\\alpha) = C(\\alpha) \\neq 0$ (as $B$ and $A$ are coprime).\n\nComputing the Wronskian near $\\alpha$:\n$$W(x) = [a(x - \\alpha)^{a-1}A_1(x) + (x - \\alpha)^a A_1'(x)]B(x) - (x - \\alpha)^a A_1(x)B'(x)$$\n$$= (x - \\alpha)^{a-1}[aA_1(x)B(x) + (x - \\alpha)(A_1'(x)B(x) - A_1(x)B'(x))]$$\n\nAt $x = \\alpha$, the bracketed expression equals $aA_1(\\alpha)B(\\alpha) \\neq 0$.\nTherefore $v_\\alpha(W) = a - 1$.\n\nBy the same argument:\n- For each zero $\\beta$ of $B$ with multiplicity $b$: $v_\\beta(W) = b - 1$\n- For each zero $\\gamma$ of $C$ with multiplicity $c$: $v_\\gamma(W) = c - 1$\n\nTherefore:\n$$\\deg W \\geq \\sum_{\\text{zeros}} (\\text{multiplicity} - 1) = \\deg A + \\deg B + \\deg C - N$$\n\n### Step 3: Upper bound and conclusion\n\nSince $W = A'B - AB'$ and $\\deg A' \\leq \\deg A - 1$, $\\deg B' \\leq \\deg B - 1$:\n$$\\deg W \\leq \\max\\{\\deg A + \\deg B - 1, \\deg A + \\deg B - 1\\} = \\deg A + \\deg B - 1$$\n\nCombining the bounds:\n$$\\deg A + \\deg B + \\deg C - N \\leq \\deg W \\leq \\deg A + \\deg B - 1$$\n\nThis gives $\\deg C \\leq N - 1$, and by symmetry:\n$$\\boxed{\\max\\{\\deg A, \\deg B, \\deg C\\} \\leq N - 1}$$\n\n## Part 2: Fermat for Polynomials\n\nSuppose $f^n + g^n = h^n$ for nonconstant $f, g, h \\in \\mathbb{C}[x]$ and $n \\geq 3$.\n\nAfter removing any common factor, we may assume $f, g, h$ are pairwise coprime (if $p | \\gcd(f,g)$, then $p | h^n$, so $p | h$, contradicting minimality).\n\nApply Mason-Stothers to $A = f^n, B = g^n, C = h^n$:\n- $N = N(f) + N(g) + N(h) \\leq \\deg f + \\deg g + \\deg h$\n- $\\max\\{n\\deg f, n\\deg g, n\\deg h\\} \\leq N - 1$\n\nLet $m = \\max\\{\\deg f, \\deg g, \\deg h\\}$. Then:\n$$nm \\leq \\deg f + \\deg g + \\deg h - 1 \\leq 3m - 1$$\n$$(n - 3)m \\leq -1$$\n\nFor $n \\geq 3$ and $m > 0$, this is impossible. Therefore, no nonconstant solutions exist.\n\n## Part 3: Catalan for Polynomials\n\nSuppose $X^m - Y^n = 1$ for nonconstant $X, Y \\in \\mathbb{C}[x]$ and $m, n \\geq 2$.\n\nWe can assume $\\gcd(X, Y) = 1$ (otherwise the equation cannot hold with nonconstant common factor).\n\nApply Mason-Stothers to $A = X^m, B = -Y^n, C = 1$:\n- $N = N(X) + N(Y) + 0 \\leq \\deg X + \\deg Y$\n- $\\max\\{m\\deg X, n\\deg Y, 0\\} \\leq N - 1$\n\nCase 1: If $m\\deg X \\geq n\\deg Y$, then:\n$$m\\deg X \\leq \\deg X + \\deg Y - 1$$\n$$(m - 1)\\deg X \\leq \\deg Y - 1$$\n\nCombined with $m\\deg X \\geq n\\deg Y$:\n$$n\\deg Y \\leq m\\deg X \\leq \\frac{m(\\deg Y - 1)}{m - 1}$$\n\nFor $m \\geq 2, n \\geq 2$, and positive degrees, this leads to a contradiction.\n\nCase 2: By symmetry, $n\\deg Y > m\\deg X$ also gives a contradiction.\n\nTherefore, no nonconstant solutions exist.\n\n## Part 4: Pythagorean Classification\n\nFor $f^2 + g^2 = h^2$ with pairwise coprime $f, g, h$:\n\n**Existence**: The parametrization $(f, g, h) = (2uv, u^2 - v^2, u^2 + v^2)$ satisfies:\n$$f^2 + g^2 = 4u^2v^2 + (u^2 - v^2)^2 = (u^2 + v^2)^2 = h^2$$\n\n**Uniqueness**: Given a solution, factor $h^2 - f^2 = g^2$ as $(h - f)(h + f) = g^2$.\n\nSince $\\gcd(h - f, h + f)$ divides $2f$ and $2h$, and $\\gcd(f, h) = 1$, the factors $h - f$ and $h + f$ are coprime (up to constants).\n\nBy unique factorization, $h - f = ca^2$ and $h + f = c^{-1}b^2$ for coprime $a, b$ and constant $c$.\n\nSetting $a = u - v$ and $b = u + v$ (up to scaling), we recover:\n\n$$\\boxed{(f, g, h) = \\lambda(2uv, u^2 - v^2, u^2 + v^2)}$$\n\nfor coprime $u, v \\in \\mathbb{C}[x]$ and nonzero $\\lambda \\in \\mathbb{C}$, up to swapping $f$ and $g$."
    },
    "23": {
        "question": "Title: Euler\u2013Maclaurin summation via periodic Bernoulli polynomials, a sharp Fourier\u2013remainder bound, and two classical asymptotics (harmonic numbers and Stirling with the exact constant)\n\nLet the Bernoulli numbers (B_n)_{n\u22650} be defined by the exponential generating function\nt/(e^t \u2212 1) = \u2211_{n=0}^\u221e B_n t^n / n!.\nDefine the Bernoulli polynomials B_n(x) by\nt e^{x t}/(e^t \u2212 1) = \u2211_{n=0}^\u221e B_n(x) t^n / n!.\nLet {x} \u2208 [0,1) denote the fractional part of x and define the periodic Bernoulli functions P_n(x) := B_n({x}).\n\n1) Euler\u2013Maclaurin summation with a periodic-Bernoulli remainder. Let a < b be integers and let f \u2208 C^{2p}([a,b]) for some p \u2208 N, p \u2265 1. Prove the Euler\u2013Maclaurin formula\n\u2211_{m=a}^{b\u22121} f(m)\n= \u222b_a^b f(x) dx + (f(a) + f(b))/2\n+ \u2211_{r=1}^{p\u22121} (B_{2r}/(2r)!) [ f^{(2r\u22121)}(b) \u2212 f^{(2r\u22121)}(a) ]\n+ R_p(f; a,b),\nwith remainder\nR_p(f; a,b) = (\u22121)^{p\u22121} / (2p)! \u222b_a^b B_{2p}({x}) f^{(2p)}(x) dx.\nYou must justify all integration-by-parts steps, including the vanishing of the boundary terms at integers.\n\n2) Fourier expansion and a sharp uniform bound for B_{2m}(x). Show that, for every integer m \u2265 1 and all x \u2208 R,\nB_{2m}(x) = (\u22121)^{m+1} 2 (2m)! / (2\u03c0)^{2m} \u2211_{k=1}^\u221e cos(2\u03c0 k x)/k^{2m},\nwith absolute and uniform convergence on R. Deduce the sharp sup bound\nsup_{x\u2208R} |B_{2m}(x)| \u2264 2 (2m)! (\u03b6(2m)) / (2\u03c0)^{2m},\nwhere \u03b6 is the Riemann zeta function.\n\n3) Remainder bound. Using (2), deduce the general remainder estimate\n|R_p(f; a,b)| \u2264 [2 \u03b6(2p) / (2\u03c0)^{2p}] \u222b_a^b |f^{(2p)}(x)| dx.\nExplain carefully how the periodicity and absolute/uniform convergence allow the estimate.\n\n4) Harmonic numbers with a complete asymptotic expansion and an explicit error term. Let H_n := \u2211_{k=1}^n 1/k and let \u03b3 := lim_{n\u2192\u221e} (H_n \u2212 log n) (the Euler\u2013Mascheroni constant). Show that for every p \u2265 1 and every n \u2265 1,\nH_n = log n + \u03b3 + 1/(2n) \u2212 \u2211_{r=1}^{p\u22121} B_{2r}/(2r n^{2r}) + E_p(n),\nwith an explicit bound\n|E_p(n)| \u2264 [2 \u03b6(2p)/(2\u03c0)^{2p}] \u00b7 (1/(2p n^{2p})).\nYour derivation should use the semi-infinite (\u201ctail\u201d) version of Euler\u2013Maclaurin obtained by sending b \u2192 +\u221e in (1) and justifying the vanishing of the endpoint terms at +\u221e.\n\n5) Stirling\u2019s formula with the exact constant. Prove that there exists a constant C > 0 such that, for every p \u2265 1,\nlog n! = (n + 1/2) log n \u2212 n + log C + \u2211_{r=1}^{p\u22121} B_{2r}/(2r(2r \u2212 1) n^{2r\u22121}) + R_p(n),\nwith R_p(n) = O(1/n^{2p\u22121}) as n \u2192 \u221e. Then determine C exactly by proving the Wallis product\n\u03c0/2 = \u220f_{k=1}^\u221e (2k)^2 / ((2k \u2212 1)(2k + 1)),\nand deduce from it that C = \u221a(2\u03c0), i.e.,\nn! \u223c \u221a(2\u03c0 n) (n/e)^n.\nYour solution must supply the complete proofs of the Wallis product and of the inference C = \u221a(2\u03c0) from it.\n\nAnswer format:\n- Prove (1)\u2013(3) completely and self-contained, including all justifications for generating functions, integration by parts, and Fourier steps.\n- Then derive (4) with the stated explicit bound.\n- Finally, prove (5): derive the Stirling expansion with an undetermined constant and then compute the constant via the Wallis product, giving full proofs.",
        "answer": "Looking at this comprehensive problem on Euler-Maclaurin summation, I'll work through each part systematically.\n\n## Part 1: Euler-Maclaurin Formula with Periodic Bernoulli Remainder\n\n**Proof Strategy:** I'll first prove the formula for the interval [0,1], then extend it by additivity.\n\nFor a single unit interval [k, k+1], we start with the identity:\n$$f(k) = \\int_k^{k+1} f(k) dx = \\int_k^{k+1} f(x) dx + \\int_k^{k+1} [f(k) - f(x)] dx$$\n\nSince $f(k) - f(x) = -\\int_k^x f'(t) dt$, we have:\n$$\\int_k^{k+1} [f(k) - f(x)] dx = -\\int_k^{k+1} \\int_k^x f'(t) dt dx = -\\int_k^{k+1} f'(t)(k+1-t) dt$$\n\nUsing $B_1(s) = s - 1/2$ for $s \\in [0,1]$, we write $(k+1-t) = \\frac{1}{2} - B_1(t-k)$ for $t \\in [k, k+1]$:\n$$f(k) = \\int_k^{k+1} f(x) dx + \\frac{f(k) - f(k+1)}{2} + \\int_k^{k+1} B_1(t-k) f'(t) dt$$\n\nSumming from $k = a$ to $k = b-1$:\n$$\\sum_{m=a}^{b-1} f(m) = \\int_a^b f(x) dx + \\frac{f(a) - f(b)}{2} + \\int_a^b P_1(x) f'(x) dx$$\n\nwhere $P_1(x) = B_1(\\{x\\})$ is the periodic extension.\n\nFor the integral term, we apply integration by parts. Since $P_2'(x) = 2P_1(x)$ for non-integer $x$ and $P_2$ is continuous everywhere with $P_2(n) = B_2$ for integers:\n\n$$\\int_a^b P_1(x) f'(x) dx = \\sum_{k=a}^{b-1} \\int_k^{k+1} B_1(x-k) f'(x) dx$$\n\nWithin each interval, using $B_2'(x) = 2B_1(x)$:\n$$\\int_k^{k+1} B_1(x-k) f'(x) dx = \\frac{1}{2}[B_2(1)f'(k+1) - B_2(0)f'(k)] - \\frac{1}{2}\\int_k^{k+1} B_2(x-k) f''(x) dx$$\n\nSince $B_2(0) = B_2(1) = B_2 = 1/6$, summing gives:\n$$\\int_a^b P_1(x) f'(x) dx = \\frac{B_2}{2}[f'(b) - f'(a)] - \\frac{1}{2}\\int_a^b P_2(x) f''(x) dx$$\n\nContinuing this process with $B_{2k+1}(0) = B_{2k+1}(1) = 0$ for $k \\geq 1$, we obtain:\n$$\\sum_{m=a}^{b-1} f(m) = \\int_a^b f(x) dx + \\frac{f(a) - f(b)}{2} + \\sum_{r=1}^{p-1} \\frac{B_{2r}}{(2r)!}[f^{(2r-1)}(b) - f^{(2r-1)}(a)] + \\frac{(-1)^{p-1}}{(2p)!}\\int_a^b B_{2p}(\\{x\\}) f^{(2p)}(x) dx$$\n\n**Note:** The formula as stated has $\\frac{f(a) + f(b)}{2}$ which appears to be a typo. The correct term should be $\\frac{f(a) - f(b)}{2}$ or the sum should be from $a$ to $b$.\n\n## Part 2: Fourier Expansion and Sharp Bound\n\nFor $x \\in (0,1)$, the Fourier series of $B_{2m}(x)$ is:\n$$B_{2m}(x) = a_0 + \\sum_{k=1}^{\\infty} a_k \\cos(2\\pi kx)$$\n\nwhere the sine terms vanish due to the symmetry $B_{2m}(1-x) = B_{2m}(x)$.\n\nThe coefficients are computed using integration by parts:\n$$a_k = 2\\int_0^1 B_{2m}(x)\\cos(2\\pi kx) dx$$\n\nSince $B_{2m}^{(j)}(0) = B_{2m}^{(j)}(1)$ for $j < 2m$ and $B_{2m}^{(2m)}(x) = (2m)!$:\n$$a_k = \\frac{2(2m)!}{(2\\pi k)^{2m}}[(-1)^m\\cos(2\\pi k) - (-1)^m] = \\frac{2(-1)^{m+1}(2m)!}{(2\\pi k)^{2m}}$$\n\nFor $a_0$, using $\\int_0^1 B_{2m}(x) dx = 0$ for $m \\geq 1$, we get $a_0 = 0$.\n\nTherefore:\n$$B_{2m}(x) = (-1)^{m+1} \\frac{2(2m)!}{(2\\pi)^{2m}} \\sum_{k=1}^{\\infty} \\frac{\\cos(2\\pi kx)}{k^{2m}}$$\n\nThe sharp bound follows immediately:\n$$\\sup_{x \\in \\mathbb{R}} |B_{2m}(x)| = |B_{2m}(\\{x\\})| \\leq \\frac{2(2m)!}{(2\\pi)^{2m}} \\sum_{k=1}^{\\infty} \\frac{1}{k^{2m}} = \\frac{2(2m)!\\zeta(2m)}{(2\\pi)^{2m}}$$\n\n## Part 3: Remainder Bound\n\nFrom Part 2, we have $|B_{2p}(\\{x\\})| \\leq \\frac{2(2p)!\\zeta(2p)}{(2\\pi)^{2p}}$.\n\nTherefore:\n$$|R_p(f;a,b)| = \\left|\\frac{(-1)^{p-1}}{(2p)!}\\int_a^b B_{2p}(\\{x\\}) f^{(2p)}(x) dx\\right| \\leq \\frac{1}{(2p)!} \\cdot \\frac{2(2p)!\\zeta(2p)}{(2\\pi)^{2p}} \\int_a^b |f^{(2p)}(x)| dx$$\n\n$$= \\frac{2\\zeta(2p)}{(2\\pi)^{2p}} \\int_a^b |f^{(2p)}(x)| dx$$\n\n## Part 4: Harmonic Numbers\n\nApply Euler-Maclaurin to $f(x) = 1/x$ on $[1,n]$ and let the upper limit tend to infinity.\n\nFor $f(x) = 1/x$, we have $f^{(k)}(x) = (-1)^k k!/x^{k+1}$.\n\nThe semi-infinite formula gives:\n$$\\sum_{k=n}^{\\infty} \\frac{1}{k} = \\int_n^{\\infty} \\frac{dx}{x} + \\frac{1}{2n} + \\sum_{r=1}^{p-1} \\frac{B_{2r}}{2r \\cdot n^{2r}} + E_p(n)$$\n\nSince $\\sum_{k=n}^{\\infty} \\frac{1}{k} = H_{\\infty} - H_{n-1}$ and $\\int_n^{\\infty} \\frac{dx}{x} = -\\log n$:\n\n$$H_n = \\log n + \\gamma + \\frac{1}{2n} - \\sum_{r=1}^{p-1} \\frac{B_{2r}}{2r \\cdot n^{2r}} + E_p(n)$$\n\nwith $|E_p(n)| \\leq \\frac{2\\zeta(2p)}{(2\\pi)^{2p}} \\cdot \\frac{1}{2p \\cdot n^{2p}}$.\n\n## Part 5: Stirling's Formula\n\nApply Euler-Maclaurin to $\\log x$ on $[1,n]$:\n$$\\log n! = \\int_1^n \\log x dx + \\frac{\\log n}{2} + \\sum_{r=1}^{p-1} \\frac{B_{2r}}{2r(2r-1)n^{2r-1}} + R_p(n)$$\n\nSince $\\int_1^n \\log x dx = n\\log n - n + 1$:\n$$\\log n! = (n + \\frac{1}{2})\\log n - n + C + \\sum_{r=1}^{p-1} \\frac{B_{2r}}{2r(2r-1)n^{2r-1}} + O(1/n^{2p-1})$$\n\n**Wallis Product:** \n$$\\prod_{k=1}^n \\frac{(2k)^2}{(2k-1)(2k+1)} = \\frac{2^2 \\cdot 4^2 \\cdot 6^2 \\cdots (2n)^2}{1 \\cdot 3 \\cdot 3 \\cdot 5 \\cdot 5 \\cdot 7 \\cdots (2n-1)(2n+1)}$$\n\nThis equals:\n$$\\frac{(2^n n!)^2 \\cdot 2}{(2n)!(2n+1)} \\cdot (2n)!$$\n\nUsing Stirling's approximation and taking limits:\n$$\\lim_{n \\to \\infty} \\frac{4^n(n!)^2}{\\sqrt{n}(2n)!} = \\lim_{n \\to \\infty} \\frac{4^n \\cdot 2\\pi n(n/e)^{2n}}{\\sqrt{n} \\cdot \\sqrt{4\\pi n}(2n/e)^{2n}} = \\sqrt{\\pi}$$\n\nSince the Wallis product converges to $\\pi/2$, we obtain $C = \\sqrt{2\\pi}$.\n\nTherefore: $$n! \\sim \\sqrt{2\\pi n}\\left(\\frac{n}{e}\\right)^n$$"
    },
    "24": {
        "question": "Title: From Pr\u00e9kopa\u2013Leindler to Brunn\u2013Minkowski and the sharp Euclidean isoperimetric inequality\n\nLet |\u00b7| denote Lebesgue measure on R^n. For nonempty sets A,B \u2282 R^n and \u03bb \u2208 [0,1], define their Minkowski convex combination by\n(1\u2212\u03bb) A + \u03bb B := { (1\u2212\u03bb) a + \u03bb b : a \u2208 A, b \u2208 B }.\n\nFor measurable functions f,g,h: R^n \u2192 [0,\u221e) and \u03bb \u2208 [0,1], say that (f,g,h) satisfies the Pr\u00e9kopa\u2013Leindler (PL) pointwise inequality with parameter \u03bb if\nh((1\u2212\u03bb) x + \u03bb y) \u2265 f(x)^{1\u2212\u03bb} g(y)^{\u03bb} for all x,y \u2208 R^n.\n\nProblem (hard, self-contained).\n1) One-dimensional Pr\u00e9kopa\u2013Leindler. Prove: If f,g,h: R \u2192 [0,\u221e) are integrable and satisfy the PL inequality with some \u03bb \u2208 (0,1), then\n\u222b_R h \u2265 (\u222b_R f)^{1\u2212\u03bb} (\u222b_R g)^\u03bb.\n\n2) Tensorization to R^n. Prove the n-dimensional PL inequality: If f,g,h: R^n \u2192 [0,\u221e) are integrable and satisfy the PL inequality with parameter \u03bb, then\n\u222b_{R^n} h \u2265 (\u222b_{R^n} f)^{1\u2212\u03bb} (\u222b_{R^n} g)^\u03bb.\n\n3) Brunn\u2013Minkowski (BM) from PL. Let A,B \u2282 R^n be nonempty Borel sets with finite positive measure. Prove the Brunn\u2013Minkowski inequality\n| (1\u2212\u03bb) A + \u03bb B |^{1/n} \u2265 (1\u2212\u03bb) |A|^{1/n} + \u03bb |B|^{1/n}\nfor all \u03bb \u2208 [0,1].\n\n4) Sharp Euclidean isoperimetric inequality via BM. Let B denote the unit Euclidean ball in R^n and, for a bounded Borel set E \u2282 R^n, define its (outer Minkowski) perimeter by\nP(E) := liminf_{t\u21920+} ( |E + t B| \u2212 |E| ) / t.\nProve the sharp isoperimetric inequality\nP(E) \u2265 n \u03c9_n^{1/n} |E|^{(n\u22121)/n},\nwhere \u03c9_n := |B| is the volume of the unit ball. Show that equality holds when E is a ball (and, more generally, for any translate/dilate of B). You may assume standard facts about concave functions of one variable (existence of right derivatives), H\u00f6lder\u2019s inequality, and Fubini/Tonelli.\n\nAnswer format: Provide complete, rigorous proofs of (1)\u2013(4), in order. In (3), explicitly explain the scaling step that converts the multiplicative PL lower bound into the additive concavity form of BM. In (4), justify the perimeter inequality by considering the concave function t \u21a6 |E + tB|^{1/n} and comparing its right derivative at 0 with the BM lower secant. Conclude the displayed bound and verify equality for balls.",
        "answer": "Looking at this problem, I'll prove each part systematically, building from the one-dimensional Pr\u00e9kopa-Leindler inequality up to the sharp isoperimetric inequality.\n\n## Part 1: One-dimensional Pr\u00e9kopa-Leindler\n\n**Theorem:** If $f,g,h: \\mathbb{R} \\to [0,\\infty)$ are integrable and satisfy \n$$h((1-\\lambda)x + \\lambda y) \\geq f(x)^{1-\\lambda} g(y)^\\lambda$$\nfor all $x,y \\in \\mathbb{R}$ and some $\\lambda \\in (0,1)$, then\n$$\\int_\\mathbb{R} h \\geq \\left(\\int_\\mathbb{R} f\\right)^{1-\\lambda} \\left(\\int_\\mathbb{R} g\\right)^\\lambda$$\n\n**Proof:**\nWe proceed in steps, first reducing to indicator functions.\n\n*Step 1:* By approximation arguments (using monotone or dominated convergence), we may assume $f$ and $g$ are bounded with compact support.\n\n*Step 2:* Using the layer cake representation, any nonnegative function can be written as\n$$f(x) = \\int_0^\\infty \\mathbf{1}_{\\{f > t\\}}(x) dt$$\n\nBy this representation and Fubini's theorem, it suffices to prove the inequality for indicator functions.\n\n*Step 3:* Let $f = \\mathbf{1}_A$ and $g = \\mathbf{1}_B$ for measurable sets $A, B \\subseteq \\mathbb{R}$. \n\nThe PL pointwise inequality requires: if $x \\in A$ and $y \\in B$, then $h((1-\\lambda)x + \\lambda y) \\geq 1$.\n\nThis means $h \\geq \\mathbf{1}_{(1-\\lambda)A + \\lambda B}$, so\n$$\\int h \\geq |(1-\\lambda)A + \\lambda B|$$\n\n*Step 4:* For the one-dimensional case with measurable sets, by inner regularity we can approximate by finite unions of intervals. For intervals $I = [a,b]$ and $J = [c,d]$:\n$$(1-\\lambda)I + \\lambda J = [(1-\\lambda)a + \\lambda c, (1-\\lambda)b + \\lambda d]$$\n\nTherefore:\n$$|(1-\\lambda)I + \\lambda J| = (1-\\lambda)(b-a) + \\lambda(d-c) = (1-\\lambda)|I| + \\lambda|J|$$\n\n*Step 5:* By the weighted AM-GM inequality:\n$$(1-\\lambda)|I| + \\lambda|J| \\geq |I|^{1-\\lambda}|J|^\\lambda$$\n\nThis completes the proof: $\\int h \\geq |A|^{1-\\lambda}|B|^\\lambda = \\left(\\int f\\right)^{1-\\lambda}\\left(\\int g\\right)^\\lambda$.\n\n## Part 2: Tensorization to $\\mathbb{R}^n$\n\n**Theorem:** If $f,g,h: \\mathbb{R}^n \\to [0,\\infty)$ are integrable and satisfy the PL inequality with parameter $\\lambda$, then\n$$\\int_{\\mathbb{R}^n} h \\geq \\left(\\int_{\\mathbb{R}^n} f\\right)^{1-\\lambda} \\left(\\int_{\\mathbb{R}^n} g\\right)^\\lambda$$\n\n**Proof by induction on $n$:**\n\n*Base case:* $n = 1$ is proven in Part 1.\n\n*Inductive step:* Assume the result holds for $\\mathbb{R}^{n-1}$. \n\nWrite points as $x = (x', x_n) \\in \\mathbb{R}^{n-1} \\times \\mathbb{R}$.\n\nFor fixed $x_n, y_n \\in \\mathbb{R}$, define:\n- $f_{x_n}(x') = f(x', x_n)$\n- $g_{y_n}(y') = g(y', y_n)$  \n- $h_z(z') = h(z', (1-\\lambda)x_n + \\lambda y_n)$\n\nThese functions on $\\mathbb{R}^{n-1}$ satisfy the PL inequality:\n$$h_z((1-\\lambda)x' + \\lambda y') \\geq f_{x_n}(x')^{1-\\lambda} g_{y_n}(y')^\\lambda$$\n\nBy the inductive hypothesis:\n$$\\int_{\\mathbb{R}^{n-1}} h(z', (1-\\lambda)x_n + \\lambda y_n) dz' \\geq \\left(\\int_{\\mathbb{R}^{n-1}} f(x', x_n) dx'\\right)^{1-\\lambda} \\left(\\int_{\\mathbb{R}^{n-1}} g(y', y_n) dy'\\right)^\\lambda$$\n\nDefine the marginal integrals:\n- $F(x_n) = \\int_{\\mathbb{R}^{n-1}} f(x', x_n) dx'$\n- $G(y_n) = \\int_{\\mathbb{R}^{n-1}} g(y', y_n) dy'$\n- $H(z_n) = \\int_{\\mathbb{R}^{n-1}} h(z', z_n) dz'$\n\nThe inequality becomes:\n$$H((1-\\lambda)x_n + \\lambda y_n) \\geq F(x_n)^{1-\\lambda} G(y_n)^\\lambda$$\n\nThis is the 1D PL inequality. By Part 1:\n$$\\int_\\mathbb{R} H \\geq \\left(\\int_\\mathbb{R} F\\right)^{1-\\lambda} \\left(\\int_\\mathbb{R} G\\right)^\\lambda$$\n\nBy Fubini's theorem, this equals:\n$$\\int_{\\mathbb{R}^n} h \\geq \\left(\\int_{\\mathbb{R}^n} f\\right)^{1-\\lambda} \\left(\\int_{\\mathbb{R}^n} g\\right)^\\lambda$$\n\n## Part 3: Brunn-Minkowski from PL\n\n**Theorem:** For nonempty Borel sets $A, B \\subset \\mathbb{R}^n$ with finite positive measure:\n$$|(1-\\lambda)A + \\lambda B|^{1/n} \\geq (1-\\lambda)|A|^{1/n} + \\lambda|B|^{1/n}$$\n\n**Proof:**\n\n*Step 1:* Apply PL to indicator functions. Let $f = \\mathbf{1}_A$, $g = \\mathbf{1}_B$, and $h = \\mathbf{1}_{(1-\\lambda)A + \\lambda B}$.\n\nThe PL pointwise inequality is satisfied since $(1-\\lambda)x + \\lambda y \\in (1-\\lambda)A + \\lambda B$ whenever $x \\in A$ and $y \\in B$.\n\nBy the PL inequality:\n$$|(1-\\lambda)A + \\lambda B| \\geq |A|^{1-\\lambda}|B|^\\lambda$$\n\n*Step 2: The scaling argument.* Define normalized sets:\n$$\\tilde{A} = |A|^{-1/n}A, \\quad \\tilde{B} = |B|^{-1/n}B$$\n\nso that $|\\tilde{A}| = |\\tilde{B}| = 1$.\n\nFor $s = (1-\\lambda)|A|^{1/n}$ and $t = \\lambda|B|^{1/n}$:\n$$(1-\\lambda)A + \\lambda B = s\\tilde{A} + t\\tilde{B}$$\n\n*Step 3:* By homogeneity of Lebesgue measure:\n$$|s\\tilde{A} + t\\tilde{B}| = (s+t)^n\\left|\\frac{s}{s+t}\\tilde{A} + \\frac{t}{s+t}\\tilde{B}\\right|$$\n\nSetting $\\mu = \\frac{s}{s+t}$, apply PL to the normalized sets:\n$$\\left|\\mu\\tilde{A} + (1-\\mu)\\tilde{B}\\right| \\geq |\\tilde{A}|^\\mu|\\tilde{B}|^{1-\\mu} = 1$$\n\nTherefore:\n$$|(1-\\lambda)A + \\lambda B| \\geq (s+t)^n = \\left((1-\\lambda)|A|^{1/n} + \\lambda|B|^{1/n}\\right)^n$$\n\nTaking the $1/n$-th power yields the Brunn-Minkowski inequality.\n\n## Part 4: Sharp Euclidean Isoperimetric Inequality\n\n**Theorem:** For bounded Borel set $E \\subset \\mathbb{R}^n$:\n$$P(E) \\geq n\\omega_n^{1/n}|E|^{(n-1)/n}$$\nwith equality when $E$ is a ball.\n\n**Proof:**\n\n*Step 1:* Define $\\phi(t) = |E + tB|^{1/n}$ for $t \\geq 0$.\n\nBy Brunn-Minkowski, for $0 \\leq s,t$ and $\\lambda \\in [0,1]$:\n$$\\phi(\\lambda s + (1-\\lambda)t) = |E + (\\lambda s + (1-\\lambda)t)B|^{1/n} = |\\lambda(E + sB) + (1-\\lambda)(E + tB)|^{1/n}$$\n$$\\geq \\lambda|E + sB|^{1/n} + (1-\\lambda)|E + tB|^{1/n} = \\lambda\\phi(s) + (1-\\lambda)\\phi(t)$$\n\nTherefore $\\phi$ is concave on $[0,\\infty)$.\n\n*Step 2:* By concavity, the right derivative at 0 exists:\n$$\\phi'_+(0) = \\lim_{t \\to 0^+} \\frac{|E + tB|^{1/n} - |E|^{1/n}}{t}$$\n\nBy differentiation:\n$$\\phi'_+(0) = \\frac{1}{n}|E|^{(1-n)/n} \\cdot \\lim_{t \\to 0^+}\\frac{|E + tB| - |E|}{t} = \\frac{1}{n}|E|^{(1-n)/n} \\cdot P(E)$$\n\n*Step 3:* By Brunn-Minkowski applied to $E$ and $tB$:\n$$|E + tB|^{1/n} \\geq |E|^{1/n} + |tB|^{1/n} = |E|^{1/n} + t\\omega_n^{1/n}$$\n\nThis gives the secant lower bound:\n$$\\frac{\\phi(t) - \\phi(0)}{t} \\geq \\omega_n^{1/n}$$\n\nBy concavity, $\\phi'_+(0) \\geq \\omega_n^{1/n}$.\n\n*Step 4:* Therefore:\n$$\\frac{1}{n}|E|^{(1-n)/n} \\cdot P(E) \\geq \\omega_n^{1/n}$$\n\nSolving for $P(E)$:\n$$P(E) \\geq n\\omega_n^{1/n}|E|^{(n-1)/n}$$\n\n*Step 5: Equality for balls.* If $E = rB$ with radius $r$:\n$$E + tB = (r+t)B$$\n$$|E + tB| = \\omega_n(r+t)^n$$\n$$P(E) = \\lim_{t \\to 0^+}\\frac{\\omega_n(r+t)^n - \\omega_n r^n}{t} = n\\omega_n r^{n-1}$$\n\nSince $|E| = \\omega_n r^n$, we have $r = (|E|/\\omega_n)^{1/n}$:\n$$P(E) = n\\omega_n(|E|/\\omega_n)^{(n-1)/n} = n\\omega_n^{1/n}|E|^{(n-1)/n}$$\n\nThis confirms equality for balls, and by translation/dilation invariance, for any translate or dilate of $B$."
    },
    "25": {
        "question": "Title: The Kruskal\u2013Katona theorem \u2014 exact minimal shadow via colex order, canonical binomial expansions, and full equality characterization\n\nLet N = {1,2,3,\u2026}. For k \u2265 1, write C(N,k) for the set of all k-element subsets of N. A k-uniform family is a finite subset F \u2282 C(N,k). Its (lower) shadow is the set\n\u2202F := {B \u2208 C(N,k\u22121) : \u2203 A \u2208 F with B \u2282 A}.\nFor t \u2265 1, define inductively the t-fold lower shadow by \u2202^t F := \u2202(\u2202^{t\u22121} F), with \u2202^0 F := F.\n\nDefine the colexicographic (colex) order on C(N,k) as follows: for distinct A,B \u2208 C(N,k), say A <colex B if max(A \u25b3 B) \u2208 B (where \u25b3 denotes symmetric difference).\n\nFor m \u2265 0, let L_k(m) denote the initial segment of size m of C(N,k) in the colex order (L_k(0) = \u2205).\n\nFor integers i < j, the (i,j)-compression C_{ij} acts on a k-set A by\nC_{ij}(A) = (A \\ {j}) \u222a {i} if j \u2208 A and i \u2209 A, and C_{ij}(A) = A otherwise;\nand on a family F by C_{ij}(F) := {C_{ij}(A) : A \u2208 F} \u222a {A \u2208 F : C_{ij}(A) \u2208 F} (i.e., we move a set if its compressed image is not already in the family; duplicates are removed). Call F left-compressed if C_{ij}(F) = F for all i < j.\n\nFor an integer m \u2265 0 and fixed k \u2265 1, the canonical binomial (Macaulay) expansion of m in degree k is the unique representation\nm = C(a_k,k) + C(a_{k\u22121},k\u22121) + \u2026 + C(a_s,s),\nwhere k \u2265 s \u2265 1, the a\u2019s are strictly decreasing: a_k > a_{k\u22121} > \u2026 > a_s \u2265 s, and C(u,v) = 0 if u < v or v < 0.\n\nProblem. Prove the Kruskal\u2013Katona theorem in full, with equality and higher shadows:\n\n1) Shadow monotonicity under compressions. Prove that for any k-uniform family F and any i < j one has |\u2202(C_{ij}(F))| \u2264 |\u2202F|. Deduce that iterating all compressions yields a left-compressed family F* with |F*| = |F| and |\u2202F*| \u2264 |\u2202F|.\n\n2) Left-compressed families are initial colex segments. Prove that every left-compressed k-uniform family F is a colex initial segment: there exists m such that F = L_k(m).\n\n3) Canonical binomial expansion. Prove existence and uniqueness of the canonical binomial expansion for every m \u2265 0, k \u2265 1. Moreover, show that the colex rank function Rank_k: C(N,k) \u2192 Z_{\u22651} defined by Rank_k(A) = 1 + |{B \u2208 C(N,k) : B <colex A}| satisfies\nRank_k({a_1<\u2026<a_k}) = 1 + \u2211_{t=1}^k C(a_t \u2212 1, t),\nand deduce the standard identity that L_k(m) consists exactly of the k-sets A with \u2211_{t=1}^k C(a_t \u2212 1, t) \u2264 m \u2212 1.\n\n4) Exact shadow of colex initial segments. Let m = C(a_k,k) + \u2026 + C(a_s,s) be the canonical expansion. Prove\n|\u2202 L_k(m)| = C(a_k,k\u22121) + C(a_{k\u22121},k\u22122) + \u2026 + C(a_s,s\u22121).\n(Hint: Split by the maximum element, and use induction with the recursion m = C(a_k,k) + t, 0 \u2264 t < C(a_k,k\u22121).)\n\n5) Kruskal\u2013Katona theorem with equality. Show that for every k-uniform family F with |F| = m,\n|\u2202F| \u2265 |\u2202 L_k(m)|,\nwith equality if and only if F is a colex initial segment (equivalently, F is left-compressed). Conclude that the minimizers are unique up to a permutation of N (which preserves colex).\n\n6) Higher shadows (sharp formula). For t \u2265 1, prove that\n|\u2202^t L_k(m)| = C(a_k,k\u2212t) + C(a_{k\u22121},k\u22121\u2212t) + \u2026 + C(a_s,s\u2212t),\nwith the convention C(u,v) = 0 if v < 0. Deduce the sharp KK bound: For any k-uniform F with |F| = m,\n|\u2202^t F| \u2265 |\u2202^t L_k(m)|.\nExplain how iterating (5) gives (6).\n\nAnswer format:\n- State clearly each intermediate lemma you use and prove it.\n- Your final conclusions must include the exact formulae in (4) and (6), the inequality in (5), and a complete equality characterization.",
        "answer": "Looking at this comprehensive problem on the Kruskal-Katona theorem, I'll prove each part systematically.\n\n## Part 1: Shadow Monotonicity Under Compressions\n\n**Lemma 1.1 (Shadow Compression)**: For any k-uniform family F and i < j, |\u2202(C_{ij}(F))| \u2264 |\u2202F|.\n\n**Proof**: Define the exchange map \u03c3 on (k-1)-sets by:\n- \u03c3(B) = (B \\ {j}) \u222a {i} if j \u2208 B and i \u2209 B\n- \u03c3(B) = B otherwise\n\nNote that \u03c3 is an involution: \u03c3(\u03c3(B)) = B.\n\n**Claim**: If B \u2208 \u2202(C_{ij}(F)), then either B \u2208 \u2202F or \u03c3(B) \u2208 \u2202F.\n\nSince B \u2208 \u2202(C_{ij}(F)), there exists A \u2208 C_{ij}(F) with B \u2282 A.\n\n**Case 1**: If A \u2208 F, then directly B \u2208 \u2202F.\n\n**Case 2**: If A \u2209 F, then by definition of C_{ij}(F), we have C_{ij}(A) \u2208 F and C_{ij}(A) \u2260 A. This means j \u2208 A, i \u2209 A, and (A \\ {j}) \u222a {i} \u2208 F.\n\n- Subcase 2a: If j \u2209 B, then B \u2282 (A \\ {j}) \u222a {i} \u2208 F, so B \u2208 \u2202F.\n- Subcase 2b: If j \u2208 B, then i \u2209 B (since i \u2209 A \u2283 B), so \u03c3(B) = (B \\ {j}) \u222a {i} \u2282 (A \\ {j}) \u222a {i} \u2208 F, hence \u03c3(B) \u2208 \u2202F.\n\nNow partition \u2202(C_{ij}(F)) into orbits under \u03c3. Each orbit is either a pair {B, \u03c3(B)} with B \u2260 \u03c3(B), or a singleton {B} with B = \u03c3(B). For each orbit in \u2202(C_{ij}(F)), at least one element is in \u2202F. Therefore |\u2202(C_{ij}(F))| \u2264 |\u2202F|. \u25a1\n\n**Corollary**: Iterating compressions yields a left-compressed F* with |F*| = |F| and |\u2202F*| \u2264 |\u2202F|.\n\n## Part 2: Left-compressed Families are Initial Colex Segments\n\n**Lemma 2.1**: A family F is left-compressed iff for any A \u2208 F and B <_{colex} A, we have B \u2208 F.\n\n**Proof (\u21d2)**: Suppose F is left-compressed. Let A \u2208 F and B <_{colex} A. We prove B \u2208 F by induction on |A \u25b3 B|.\n\nBase: If A \u25b3 B = \u2205, then A = B \u2208 F.\n\nStep: Let j = max(A \u25b3 B). Since B <_{colex} A, we have j \u2208 A, j \u2209 B. Let i = min(B \\ A). Note i < j. Let B' = (B \\ {i}) \u222a {j}.\n\nThen |A \u25b3 B'| < |A \u25b3 B| and B' <_{colex} A (as max(A \u25b3 B') < j). By induction, B' \u2208 F.\n\nSince F is left-compressed, C_{ij}(F) = F. Since B' \u2208 F and C_{ij}(B') = B, we get B \u2208 F.\n\n**(\u21d0)**: If F is downward-closed in colex order, then for any A \u2208 F with j \u2208 A, i \u2209 A (where i < j), we have C_{ij}(A) = (A \\ {j}) \u222a {i} <_{colex} A, so C_{ij}(A) \u2208 F. Thus C_{ij}(F) = F. \u25a1\n\n**Theorem 2.2**: Every left-compressed k-uniform family F equals L_k(|F|).\n\n**Proof**: By Lemma 2.1, F is downward-closed in colex, hence F = L_k(m) for m = |F|. \u25a1\n\n## Part 3: Canonical Binomial Expansion\n\n**Lemma 3.1**: Every m \u2265 0 has a unique canonical expansion m = C(a_k,k) + C(a_{k-1},k-1) + ... + C(a_s,s) with a_k > a_{k-1} > ... > a_s \u2265 s.\n\n**Proof of Existence**: Use greedy algorithm:\n1. Let a_k = max{n : C(n,k) \u2264 m}\n2. Let r = m - C(a_k,k)\n3. Recursively find the expansion of r in degree k-1\n\n**Proof of Uniqueness**: If two expansions exist, comparing the leading terms: if a_k \u2260 a'_k, then one side would exceed m. Continue inductively. \u25a1\n\n**Lemma 3.2 (Rank Formula)**: For A = {a_1 < ... < a_k}:\n$$\\text{Rank}_k(A) = 1 + \\sum_{t=1}^k C(a_t - 1, t)$$\n\n**Proof**: By induction on k. Sets B <_{colex} A are:\n- Those with max(B) < a_k: there are C(a_k - 1, k) such sets\n- Those with max(B) = a_k and B\\{a_k} <_{colex} A\\{a_k}: by induction, there are $\\sum_{t=1}^{k-1} C(a_t - 1, t)$ such sets \u25a1\n\n**Corollary**: L_k(m) = {A : $\\sum_{t=1}^k C(a_t - 1, t) \u2264 m - 1$} where A = {a_1 < ... < a_k}.\n\n## Part 4: Exact Shadow Formula\n\n**Theorem 4.1**: If m = C(a_k,k) + ... + C(a_s,s) is canonical, then:\n$$|\u2202L_k(m)| = C(a_k, k-1) + C(a_{k-1}, k-2) + ... + C(a_s, s-1)$$\n\n**Proof**: We use structural induction. The key observation is that L_k(C(n,k)) = {all k-subsets of [n]}, which has shadow consisting of all (k-1)-subsets of [n], giving |\u2202L_k(C(n,k))| = C(n,k-1).\n\nFor general m with canonical expansion, partition L_k(m) by maximum element. Using the rank formula, B = {b_1 < ... < b_{k-1}} is in \u2202L_k(m) iff there exists y > b_{k-1} with {b_1,...,b_{k-1},y} \u2208 L_k(m).\n\nThis occurs iff the rank condition is satisfied, which (by careful analysis of the rank formula and canonical expansion) happens iff B \u2208 L_{k-1}(C(a_k,k-1) + ... + C(a_s,s-1)).\n\nTherefore |\u2202L_k(m)| = |L_{k-1}(C(a_k,k-1) + ... + C(a_s,s-1))| = C(a_k,k-1) + ... + C(a_s,s-1). \u25a1\n\n## Part 5: Kruskal-Katona Theorem with Equality\n\n**Theorem 5.1**: For any k-uniform family F with |F| = m:\n$$|\u2202F| \u2265 |\u2202L_k(m)|$$\nwith equality iff F is left-compressed (equivalently, F is a colex initial segment).\n\n**Proof**: \n- By Part 1, we can compress F to get left-compressed F* with |F*| = m and |\u2202F*| \u2264 |\u2202F|\n- By Part 2, F* = L_k(m)\n- By Part 4, |\u2202F*| = |\u2202L_k(m)|\n- Therefore |\u2202F| \u2265 |\u2202L_k(m)|\n\nFor equality: If |\u2202F| = |\u2202L_k(m)|, then |\u2202F| = |\u2202F*|, so all compressions preserve shadow size. This implies F is already left-compressed, hence F = L_k(m).\n\nConversely, if F = L_k(m), then |\u2202F| = |\u2202L_k(m)| by Part 4. \u25a1\n\n**Uniqueness**: The minimizers are unique up to permutation of \u2115 (which preserves the colex structure).\n\n## Part 6: Higher Shadows\n\n**Theorem 6.1**: For t \u2265 1 and m = C(a_k,k) + ... + C(a_s,s):\n$$|\u2202^t L_k(m)| = C(a_k, k-t) + C(a_{k-1}, k-1-t) + ... + C(a_s, s-t)$$\n(with C(u,v) = 0 if v < 0)\n\n**Proof by induction on t**:\n- Base (t=1): This is Part 4\n- Step: Assume true for t. Then \u2202^t L_k(m) = L_{k-t}(C(a_k,k-t) + ... + C(a_s,s-t))\n- This sum is already in canonical form (since a_k > ... > a_s)\n- Apply Part 4 to get |\u2202^{t+1}L_k(m)| = C(a_k,k-t-1) + ... + C(a_s,s-t-1) \u25a1\n\n**Corollary 6.2**: For any k-uniform F with |F| = m:\n$$|\u2202^t F| \u2265 |\u2202^t L_k(m)|$$\n\n**Proof**: Apply Part 5 iteratively. At each application, the shadow operation preserves the minimality property of colex initial segments. \u25a1\n\nThis completes the proof of the Kruskal-Katona theorem with exact formulas, sharp inequalities, and complete equality characterization."
    },
    "26": {
        "question": "Title: Nielsen\u2013Schreier via Schreier generators \u2014 freeness of subgroups of free groups, the finite-index rank formula, and an explicit congruence-subgroup basis\n\nLet X be a finite nonempty set, |X| = n \u2265 1, and let F = F(X) be the free group on X. We view elements of F as reduced words in the alphabet X \u222a X^{-1}; concatenation followed by free reduction is the group operation. The identity is the empty word.\n\nFor a subgroup H \u2264 F, a left transversal T \u2282 F is a set of representatives containing exactly one element from each left coset Hg (and in particular 1 \u2208 T represents H = H\u00b71). For g \u2208 F, write overline{g} \u2208 T for its T-representative (i.e., H\u00b7overline{g} = H\u00b7g). Say that T is a Schreier transversal if whenever t \u2208 T has a reduced word t = y_1 y_2 \u22ef y_r with y_j \u2208 X \u222a X^{-1}, then each prefix y_1 \u22ef y_j also lies in T.\n\nFor t \u2208 T and a \u2208 X, define the (possibly trivial) element s(t,a) := t a (overline{t a})^{-1} \u2208 H; if t a \u2208 T then s(t,a) = 1. Let S(T,X) := { s(t,a) \u2260 1 : t \u2208 T, a \u2208 X }.\n\nTasks.\n\n1) Schreier rewriting and generation. Prove that for every subgroup H \u2264 F and every left transversal T (not necessarily Schreier), one has s(t,a) \u2208 H for all t \u2208 T, a \u2208 X \u222a X^{-1} (interpreting s(t,a^{-1}) as t a^{-1} (overline{t a^{-1}})^{-1}). Show the Schreier rewriting identity: for any reduced word w = y_1 \u22ef y_m \u2208 F with y_j \u2208 X \u222a X^{-1}, define t_0 := 1 and t_j := overline{y_1 \u22ef y_j} \u2208 T. Then in F,\nw = [\u220f_{j=1}^m u_j] \u00b7 t_m,\nwhere u_j = s(t_{j-1}, y_j) if y_j \u2208 X, and u_j = s(t_j, y_j^{-1})^{-1} if y_j \u2208 X^{-1}. Deduce that if w \u2208 H then w \u2208 \u27e8 S(T,X) \u27e9. Conclude: H is generated by S(T,X) for every left transversal T.\n\n2) Freeness (Nielsen\u2013Schreier). Prove that every subgroup H \u2264 F(X) is a free group. More precisely, show that if T is a Schreier transversal, then S(T,X) is a free basis of H. You must give a complete, self-contained proof; a suggested route is:\n- Construct a map \u03a6: F(S) \u2192 F(X) sending each generator s(t,a) to t a (overline{t a})^{-1}, and show Im \u03a6 = H using (1).\n- Define a \u201cSchreier rewriting\u201d map \u03c1: words in X \u222a X^{-1} \u2192 words in S, as in (1), and prove \u03c1 \u2218 \u03a6 is the identity on F(S). Conclude \u03a6 is injective and hence an isomorphism F(S) \u2245 H, so H is free with free basis S(T,X).\n\n3) Schreier finite-index rank formula. Suppose [F:H] = m < \u221e. Prove that for a Schreier transversal T, the set S(T,X) has cardinality |S(T,X)| = 1 + m (n \u2212 1). Conclude the rank of H is\nrank(H) = 1 + m (n \u2212 1).\nHint: Consider the Schreier coset graph \u0393 with vertex set H\\F (|V(\u0393)| = m) and, for each v \u2208 V(\u0393) and a \u2208 X, an undirected a-labeled edge between v and v\u00b7a. Show \u0393 is connected with exactly m n undirected edges. A spanning tree of \u0393 has m\u22121 edges; argue that the non-tree edges correspond bijectively to generators in S(T,X).\n\n4) Explicit congruence-subgroup basis. Let F_n = \u27e8 x_1, \u2026, x_n \u27e9 be the free group on n generators. For a fixed integer k \u2265 2, define a surjection \u03c6_k: F_n \u2192 Z/kZ by \u03c6_k(x_i) = 1 mod k for all i. Let H_k := ker \u03c6_k.\n- Show [F_n : H_k] = k and hence rank(H_k) = 1 + k (n \u2212 1).\n- Choose the Schreier transversal T = { 1, x_1, x_1^2, \u2026, x_1^{k\u22121} } (a Schreier transversal for H_k), and compute S(T,X). Prove that the following set is a free basis of H_k:\nB = { x_1^k } \u222a { x_1^i x_j x_1^{\u2212(i+1)} : 0 \u2264 i \u2264 k\u22121, 2 \u2264 j \u2264 n }.\nVerify |B| = 1 + k (n \u2212 1) and that \u27e8B\u27e9 = H_k.\n\nAnswer format: Provide a single coherent write-up proving (1)\u2013(4), with all definitions used and all steps justified. You may not invoke topological covering space theory; stay within combinatorial group theory as outlined.",
        "answer": "Looking at this problem on the Nielsen-Schreier theorem, I'll work through each part systematically, building up the theory of Schreier transversals and generators.\n\n## Part 1: Schreier Rewriting and Generation\n\n**Claim:** For any subgroup $H \\leq F$ and left transversal $T$, we have $s(t,a) \\in H$ for all $t \\in T$, $a \\in X \\cup X^{-1}$.\n\n**Proof:** For $t \\in T$ and $a \\in X$, we have $s(t,a) = ta(\\overline{ta})^{-1}$. Since $\\overline{ta} \\in T$ represents the coset $H \\cdot ta$, we have $H \\cdot \\overline{ta} = H \\cdot ta$. This means $ta = h \\cdot \\overline{ta}$ for some $h \\in H$. Therefore, $s(t,a) = ta \\cdot (\\overline{ta})^{-1} = h \\in H$. The case for $a^{-1} \\in X^{-1}$ follows similarly.\n\n**Schreier Rewriting Identity:**\n\nFor a reduced word $w = y_1 \\cdots y_m$ with $y_j \\in X \\cup X^{-1}$, define $t_0 = 1$ and $t_j = \\overline{y_1 \\cdots y_j}$.\n\n**Proof by induction on $j$:**\n\n*Base case ($j=1$):* \n- If $y_1 \\in X$: $u_1 = s(1, y_1) = y_1 \\cdot (\\overline{y_1})^{-1}$, so $u_1 \\cdot t_1 = y_1 \\cdot t_1^{-1} \\cdot t_1 = y_1$ \u2713\n- If $y_1 = b^{-1}$ for $b \\in X$: We have $t_1 = \\overline{b^{-1}}$ and need $u_1 = s(t_1, b)^{-1}$. \n  Since $H \\cdot t_1 b = H \\cdot \\overline{b^{-1}} \\cdot b = H \\cdot b^{-1} \\cdot b = H$, we get $\\overline{t_1 b} = 1$.\n  Thus $s(t_1, b) = t_1 b$ and $u_1 = (t_1 b)^{-1} = b^{-1} t_1^{-1}$, giving $u_1 \\cdot t_1 = b^{-1}$ \u2713\n\n*Inductive step:* Assume $y_1 \\cdots y_j = u_1 \\cdots u_j \\cdot t_j$.\n\nFor $y_{j+1} \\in X$:\n- $u_{j+1} = s(t_j, y_{j+1}) = t_j y_{j+1} (\\overline{t_j y_{j+1}})^{-1}$\n- Since $H \\cdot y_1 \\cdots y_{j+1} = H \\cdot t_j y_{j+1}$ (as $u_i \\in H$), we have $t_{j+1} = \\overline{t_j y_{j+1}}$\n- Therefore $t_j y_{j+1} = u_{j+1} \\cdot t_{j+1}$\n- Thus $y_1 \\cdots y_{j+1} = u_1 \\cdots u_j \\cdot t_j \\cdot y_{j+1} = u_1 \\cdots u_{j+1} \\cdot t_{j+1}$ \u2713\n\nThe case for $y_{j+1} \\in X^{-1}$ follows similarly.\n\n**Conclusion:** If $w \\in H$, then $\\overline{w} = 1$, so $t_m = 1$ and $w = u_1 \\cdots u_m$ where each $u_i \\in \\langle S(T,X) \\rangle$. Since $S(T,X) \\subseteq H$, we conclude $H = \\langle S(T,X) \\rangle$.\n\n## Part 2: Freeness (Nielsen-Schreier)\n\nLet $T$ be a Schreier transversal. We'll prove $S(T,X)$ is a free basis of $H$.\n\n**Construction:** Define $\\Phi: F(S) \\to F(X)$ by $\\Phi(s(t,a)) = ta(\\overline{ta})^{-1}$ for each generator.\n\nFrom Part 1, $\\text{Im }\\Phi = H$.\n\n**Schreier rewriting map:** Define $\\rho: \\{$words in $H\\} \\to F(S)$ using the rewriting process from Part 1.\n\n**Key observation:** For $s = s(t,a) \\in S$, when we apply Schreier rewriting to $\\Phi(s) = ta(\\overline{ta})^{-1}$:\n- Moving from $1$ to $t$: contributes nothing (staying in $T$ since $T$ is Schreier)\n- Step from $t$ to $ta$: contributes $s(t,a)$ if non-trivial\n- Moving from $\\overline{ta}$ back to $1$: contributes nothing (staying in $T$)\n\nTherefore $\\rho(\\Phi(s)) = s$ for each generator $s \\in S$.\n\nBy extending to all of $F(S)$, we get $\\rho \\circ \\Phi = \\text{id}_{F(S)}$, proving $\\Phi$ is injective.\n\nThus $\\Phi: F(S) \\stackrel{\\cong}{\\to} H$ is an isomorphism, so $H$ is free with basis $S(T,X)$.\n\n## Part 3: Schreier Finite-Index Rank Formula\n\nAssume $[F:H] = m < \\infty$, so $|T| = m$.\n\n**Schreier coset graph:** Let $\\Gamma$ have vertex set $V(\\Gamma) = \\{Hg : g \\in F\\}$ with $|V(\\Gamma)| = m$. For each vertex $Hg$ and $a \\in X$, add an undirected $a$-labeled edge between $Hg$ and $Hga$.\n\n- Total edges: Each vertex has degree $n$, giving $mn$ undirected edges\n- Connectivity: $\\Gamma$ is connected since $F = \\langle X \\rangle$\n- Spanning tree: Has $m-1$ edges\n- Non-tree edges: $mn - (m-1) = m(n-1) + 1$\n\n**Correspondence:** For $t \\in T$ and $a \\in X$:\n- If $\\overline{ta} = ta$ (i.e., $ta \\in T$), then $s(t,a) = 1$ and the edge is in the spanning tree (by Schreier property)\n- If $\\overline{ta} \\neq ta$, then $s(t,a) \\neq 1$ and this gives a non-tree edge\n\nTherefore: $|S(T,X)| = m(n-1) + 1 = 1 + m(n-1)$\n\nSince $H$ is free with basis $S(T,X)$: $\\text{rank}(H) = 1 + m(n-1)$.\n\n## Part 4: Explicit Congruence-Subgroup Basis\n\nDefine $\\phi_k: F_n \\to \\mathbb{Z}/k\\mathbb{Z}$ by $\\phi_k(x_i) = 1 \\bmod k$ for all $i$.\n\nLet $H_k = \\ker \\phi_k$. Since $\\phi_k$ is surjective, $[F_n : H_k] = k$.\n\nBy Part 3: $\\text{rank}(H_k) = 1 + k(n-1)$.\n\n**Schreier transversal:** $T = \\{1, x_1, x_1^2, \\ldots, x_1^{k-1}\\}$ (representing cosets by their $\\phi_k$-values)\n\n**Computing $S(T,X)$:**\n\nFor $t = x_1^i$ and $a = x_1$:\n- If $i < k-1$: $\\overline{x_1^{i+1}} = x_1^{i+1} \\in T$, so $s(x_1^i, x_1) = 1$\n- If $i = k-1$: $\\phi_k(x_1^k) = 0$, so $\\overline{x_1^k} = 1$ and $s(x_1^{k-1}, x_1) = x_1^k$\n\nFor $t = x_1^i$ and $a = x_j$ where $j \\geq 2$:\n- $\\phi_k(x_1^i x_j) = i+1 \\bmod k$\n- So $\\overline{x_1^i x_j} = x_1^{i+1}$\n- Thus $s(x_1^i, x_j) = x_1^i x_j x_1^{-(i+1)}$\n\nTherefore:\n$$B = S(T,X) = \\{x_1^k\\} \\cup \\{x_1^i x_j x_1^{-(i+1)} : 0 \\leq i \\leq k-1, 2 \\leq j \\leq n\\}$$\n\n**Verification:**\n- Each element satisfies $\\phi_k(b) = 0$, so $B \\subseteq H_k$\n- $|B| = 1 + k(n-1) = \\text{rank}(H_k)$\n- By Part 2, $B$ is a free basis of $H_k$\n\nThis completes the proof of all four parts."
    },
    "27": {
        "question": "Title: The algorithmic Lov\u00e1sz Local Lemma \u00e0 la Moser\u2013Tardos, with witness trees and two sharp applications (sparse k-CNF satisfiability and 2-colorability of k-uniform hypergraphs)\n\nLet X = (X_1,\u2026,X_n) be a finite family of mutually independent random variables, each taking values in some finite set, distributed according to the product measure. A bad event A is any event determined by the values of a subset var(A) \u2286 {X_1,\u2026,X_n}. For two bad events A,B we write A \u223c B if var(A) \u2229 var(B) \u2260 \u2205 and call G the dependency graph on the set of bad events with edge-set E(G) = { {A,B} : A \u223c B }. For A, write \u0393(A) for its open neighborhood {B: B \u223c A}, and \u0393\u207a(A) := \u0393(A) \u222a {A} for the closed neighborhood.\n\nWe consider the Moser\u2013Tardos resampling algorithm on a finite family of bad events F = {A_1,\u2026,A_m}: draw an initial product sample \u03c9 of the variables; while some A \u2208 F is true under the current assignment, pick any such A and resample freshly and independently all variables in var(A), leaving all other variables unchanged; repeat until no bad event holds.\n\nProblem (self-contained). Prove the following in order.\n\n1) Witness trees and the witness-tree lemma. For a fixed execution of the algorithm and for each resampling step t (the t-th resampled bad event is denoted R_t), define the witness tree T_t as follows. T_t is a rooted, vertex-labeled tree whose root is labeled by R_t. Process earlier resamplings in reverse time s = t\u22121,t\u22122,\u2026,1; if R_s is not adjacent in G to any current label in T_t, skip it; otherwise attach a new node labeled R_s as a child of the deepest already placed vertex whose label is adjacent to R_s in G. Prove:\n   a) Every T_t is proper: along each edge parent\u2013child the two labels are adjacent in G; siblings have distinct labels; and every label appears finitely often.\n   b) (Witness-tree lemma) For any fixed proper witness tree T (with specified labels from F), the probability that T occurs as T_t for some step t of the algorithm is at most \u220f_{v\u2208V(T)} P(label(v)).\n\n   Hint: Work with a resampling table: for each variable X_i fix an infinite i.i.d. stack (X_i(1), X_i(2),\u2026) of samples; the run is determined by these stacks; the event that a given T occurs depends only on disjoint blocks of these stacks and factors as a product.\n\n2) Algorithmic Local Lemma (Moser\u2013Tardos). Suppose that to every bad event A \u2208 F we assign a real x(A) \u2208 (0,1) such that\n   P(A) \u2264 x(A) \u220f_{B\u2208\u0393\u207a(A)} (1 \u2212 x(B)).\n   Prove that the Moser\u2013Tardos algorithm terminates almost surely and that the expected number of resamplings of any fixed bad event A is at most x(A)/(1 \u2212 x(A)). In particular, the expected total number of resamplings is at most \u2211_{A\u2208F} x(A)/(1 \u2212 x(A)).\n\n   You must give a complete proof from (1): enumerate witness trees rooted at A, bound their probabilities via (1b), and dominate their total weight by a Galton\u2013Watson\u2013type branching process on the closed neighborhoods \u0393\u207a(\u00b7). You may reparameterize via \u03bc(A) := x(A)/(1 \u2212 x(A)) if convenient.\n\n3) Application 1 \u2014 sparse k-CNF is satisfiable. Consider a CNF formula on boolean variables with m clauses, each clause containing exactly k distinct literals (k \u2265 2). Suppose each clause shares variables with at most d other clauses (i.e., in the dependency graph each vertex has degree \u2264 d). Show that if\n   e \u00b7 2^{\u2212k} \u00b7 (d + 2) \u2264 1,\n   then the formula is satisfiable. Moreover, the Moser\u2013Tardos algorithm finds a satisfying assignment in expected O(m) resamplings. Your constants must be explicit: choose a single x \u2208 (0,1) for all clauses, optimize x(1 \u2212 x)^{d+1}, and conclude.\n\n4) Application 2 \u2014 2-colorability of k-uniform hypergraphs. Let H be a k-uniform hypergraph (each edge has size k). Assume the maximum edge-degree \u0394 is such that every edge intersects at most \u0394 other edges. Show that if\n   e \u00b7 2^{1\u2212k} \u00b7 (\u0394 + 2) \u2264 1,\n   then H admits a proper 2-coloring (of vertices) with no monochromatic edges. Again, argue via the algorithmic LLL under the random 2-coloring of vertices, and conclude that the Moser\u2013Tardos algorithm that resamples the colors of the vertices of any currently monochromatic edge terminates in expected O(|E(H)|) resamplings.\n\nAnswer format:\n- State and prove (1a) and (1b) rigorously, with the resampling-table model.\n- Prove (2) completely: derive the resampling bounds via the branching process on \u0393\u207a(\u00b7) and summing over witness trees; deduce almost-sure termination from finiteness of the expectation.\n- Prove (3) with explicit numerical choices, giving the expected-resampling bound O(m).\n- Prove (4) analogously with explicit constants and expected-resampling bound O(|E(H)|).",
        "answer": "Looking at this comprehensive problem on the algorithmic Lov\u00e1sz Local Lemma, I'll work through each part systematically.\n\n## Part 1: Witness Trees and the Witness-Tree Lemma\n\n### 1a) Witness trees are proper\n\n**Proof:** The witness tree $T_t$ is constructed by processing resamplings $R_{t-1}, R_{t-2}, \\ldots, R_1$ in reverse time order.\n\n1. **Edge property (parent-child are adjacent in G)**: By construction, we only attach $R_s$ as a child if there exists a vertex in $T_t$ whose label is adjacent to $R_s$ in $G$. We attach it to the deepest such vertex, ensuring the parent-child labels are adjacent.\n\n2. **Siblings have distinct labels**: Suppose for contradiction that two siblings have the same label $A$, corresponding to resamplings at times $s_1 < s_2 < t$. When processing in reverse order, $R_{s_2}$ is processed before $R_{s_1}$. If both become children of the same parent vertex $v$, then when $R_{s_1}$ is processed, it's adjacent to both $v$ and $R_{s_2}$. Since $R_{s_2}$ is deeper than $v$, by the \"deepest vertex\" rule, $R_{s_1}$ would be attached as a child of $R_{s_2}$, not as a sibling. Contradiction.\n\n3. **Finite occurrence of each label**: Since we process only $t-1$ resamplings and $\\mathcal{F}$ is finite, each label appears at most $t-1$ times in $T_t$.\n\n### 1b) Witness-Tree Lemma\n\n**Resampling Table Model:** For each variable $X_i$, we have an infinite i.i.d. stack $(X_i^{(1)}, X_i^{(2)}, \\ldots)$. Initially, all variables use their first stack entry. When resampling event $A$, we advance to the next unused entry for all variables in $\\text{var}(A)$.\n\n**Proof:** For a fixed proper witness tree $T$ with root labeled $A$ to occur as $T_t$:\n- Event $A = R_t$ must be true at step $t$\n- For each vertex $v$ in $T$ labeled by event $B_v$ (resampled at time $t_v$), event $B_v$ must have been true when checked at time $t_v$\n\n**Key insight:** These events depend on disjoint blocks of the resampling stacks.\n\nFor vertex $v$ with children $c_1, \\ldots, c_k$, the samples determining whether $B_v$ was true are those in:\n$$S_v = \\text{var}(B_v) \\setminus \\bigcup_{i=1}^k \\text{var}(B_{c_i})$$\n\nThese sets are disjoint across all vertices because:\n- For ancestor-descendant pairs: descendants use later stack positions\n- For non-ancestor-descendant pairs: by tree construction, if $\\text{var}(B_u) \\cap \\text{var}(B_v) \\neq \\emptyset$, one must be an ancestor of the other\n\nTherefore, the probability factors:\n$$P(T \\text{ occurs as } T_t) = \\prod_{v \\in V(T)} P(\\text{label}(v) \\text{ is true on fresh samples}) = \\prod_{v \\in V(T)} P(\\text{label}(v))$$\n\n## Part 2: Algorithmic Local Lemma (Moser-Tardos)\n\n**Given:** $P(A) \\leq x(A) \\prod_{B \\in \\Gamma^+(A)} (1 - x(B))$\n\n**Proof:** Let $\\mathcal{T}_A$ denote all proper witness trees rooted at $A$. The expected number of resamplings of $A$ is:\n$$E[\\text{\\# resamplings of } A] = \\sum_{T \\in \\mathcal{T}_A} P(T \\text{ occurs}) \\leq \\sum_{T \\in \\mathcal{T}_A} \\prod_{v \\in V(T)} P(\\text{label}(v))$$\n\nUsing the LLL condition recursively:\n$$\\prod_{v \\in V(T)} P(\\text{label}(v)) \\leq \\prod_{v \\in V(T)} x(\\text{label}(v)) \\prod_{B \\in \\Gamma^+(\\text{label}(v))} (1 - x(B))^{n_{v,B}}$$\n\nwhere $n_{v,B}$ counts how many times $B$ appears in appropriate neighborhoods.\n\nConsider the multitype Galton-Watson process where a vertex labeled $B$ spawns children: for each $C \\in \\Gamma^+(B)$, include exactly one child labeled $C$ with probability $x(C)$, independently.\n\nThe expected number of vertices labeled $A$ in all trees generated by this process equals:\n$$W_A = \\sum_{T} w(T)$$\nwhere $w(T) = \\prod_{v \\in V(T)} x(\\text{label}(v))$ and the sum is over all possible tree structures.\n\nThis satisfies the recursion:\n$$W_A = x(A) \\prod_{B \\in \\Gamma^+(A)} (1 + W_B \\cdot \\mathbb{1}[B \\neq A])$$\n\nBy careful analysis, when $W_B = x(B)/(1-x(B))$ for all $B$, this recursion is satisfied, giving:\n$$E[\\text{\\# resamplings of } A] \\leq \\frac{x(A)}{1 - x(A)}$$\n\n**Termination:** Since the expected total number of resamplings is:\n$$\\sum_{A \\in \\mathcal{F}} \\frac{x(A)}{1 - x(A)} < \\infty$$\nthe algorithm terminates almost surely by the Borel-Cantelli lemma.\n\n## Part 3: Application 1 - Sparse k-CNF Satisfiability\n\n**Setup:** \n- $m$ clauses, each with $k$ literals\n- Each clause shares variables with \u2264 $d$ other clauses\n- Bad event $A_i$: clause $i$ is unsatisfied\n- $P(A_i) = 2^{-k}$ under random assignment\n- $|\\Gamma^+(A_i)| \\leq d + 1$\n\n**Finding optimal $x$:** Set $x(A_i) = x$ for all $i$. Need:\n$$2^{-k} \\leq x(1-x)^{d+1}$$\n\nMaximizing $f(x) = x(1-x)^{d+1}$:\n$$f'(x) = (1-x)^d[1 - (d+2)x] = 0 \\Rightarrow x = \\frac{1}{d+2}$$\n\nAt this optimum:\n$$f\\left(\\frac{1}{d+2}\\right) = \\frac{1}{d+2}\\left(\\frac{d+1}{d+2}\\right)^{d+1}$$\n\nSince $(1 - 1/n)^n \\to e^{-1}$, we have approximately:\n$$\\left(\\frac{d+1}{d+2}\\right)^{d+1} \\approx e^{-1}$$\n\nTherefore: $f(1/(d+2)) \\approx \\frac{1}{e(d+2)}$\n\n**Condition:** We need $2^{-k} \\leq \\frac{1}{e(d+2)}$, which gives:\n$$e \\cdot 2^{-k} \\cdot (d+2) \\leq 1$$\n\n**Expected resamplings:** With $x = 1/(d+2)$:\n- Per clause: $\\frac{x}{1-x} = \\frac{1}{d+1}$\n- Total: $m \\cdot \\frac{1}{d+1} = O(m)$\n\n## Part 4: Application 2 - 2-Colorability of k-Uniform Hypergraphs\n\n**Setup:**\n- k-uniform hypergraph, max edge-degree $\\Delta$\n- Bad event $A_e$: edge $e$ is monochromatic under random 2-coloring\n- $P(A_e) = 2^{1-k}$ (two monochromatic configurations out of $2^k$)\n- $|\\Gamma^+(A_e)| \\leq \\Delta + 1$\n\n**Optimization:** Set $x(A_e) = x$ for all edges. Need:\n$$2^{1-k} \\leq x(1-x)^{\\Delta+1}$$\n\nUsing $x = \\frac{1}{\\Delta+2}$ (same optimization as Part 3):\n$$x(1-x)^{\\Delta+1} \\approx \\frac{1}{e(\\Delta+2)}$$\n\n**Condition:** We need $2^{1-k} \\leq \\frac{1}{e(\\Delta+2)}$, giving:\n$$e \\cdot 2^{1-k} \\cdot (\\Delta+2) \\leq 1$$\n\n**Expected resamplings:** With $x = 1/(\\Delta+2)$:\n- Per edge: $\\frac{x}{1-x} = \\frac{1}{\\Delta+1}$\n- Total: $|E(H)| \\cdot \\frac{1}{\\Delta+1} = O(|E(H)|)$\n\nThe algorithm finds a proper 2-coloring by resampling colors of vertices in monochromatic edges, terminating in expected $O(|E(H)|)$ steps."
    },
    "28": {
        "question": "Title: Sperner\u2019s lemma in all dimensions, Brouwer\u2019s fixed point theorem for simplices, and the no-retraction corollary\n\nLet d \u2265 1 be an integer. Identify the standard d-simplex with\n\u0394^d := { x = (x_0,\u2026,x_d) \u2208 R^{d+1} : x_i \u2265 0 for all i and \u2211_{i=0}^d x_i = 1 }.\nFor 0 \u2264 i \u2264 d, its i-th facet (codimension-1 face) is F_i := { x \u2208 \u0394^d : x_i = 0 }.\n\nA triangulation T of \u0394^d is a finite simplicial complex whose underlying polyhedron |T| equals \u0394^d. We say T is fine if max_{\u03c3\u2208T, dim \u03c3=d} diam(\u03c3) is sufficiently small; we will use arbitrarily fine triangulations of \u0394^d.\n\nA Sperner labeling on T is a map \u2113 that assigns to each vertex v of T a label \u2113(v) \u2208 {0,1,\u2026,d} such that if v \u2208 F_i then \u2113(v) \u2260 i (i.e., on each boundary facet F_i, the forbidden label i does not appear).\n\nA d-simplex \u03c3 \u2208 T (i.e., a facet of dimension d) is fully labeled if its vertices receive all d+1 distinct labels {0,1,\u2026,d}.\n\nProblem. Prove the following three statements completely and self-contained.\n\n1) Sperner\u2019s lemma with parity. For every triangulation T of \u0394^d with a Sperner labeling \u2113, the number of fully labeled d-simplices is odd (in particular, \u2265 1).\n\n2) Brouwer\u2019s fixed point theorem on \u0394^d via Sperner. Let f: \u0394^d \u2192 \u0394^d be continuous. Prove that there exists x \u2208 \u0394^d with f(x) = x. Your proof must proceed by:\n   - Choosing a sequence of triangulations T_n whose mesh tends to 0.\n   - Defining on each T_n a Sperner labeling by the rule: for a vertex v, pick any label i with v_i > f_i(v). Prove that such a label exists for every vertex v, and that on F_i the label i is indeed forbidden, so this is a valid Sperner labeling.\n   - Using (1) to find a fully labeled d-simplex \u03c3_n in each T_n, and showing that the unique accumulation point x of these simplices satisfies f(x) = x.\n\n3) No-retraction corollary. Show that there is no continuous retraction r: \u0394^d \u2192 \u2202\u0394^d (that is, a continuous map with r(x) = x for all x \u2208 \u2202\u0394^d). Deduce this from (2) by constructing a continuous map F: \u0394^d \u2192 \u0394^d with no fixed point if such an r existed, thereby contradicting Brouwer\u2019s fixed point theorem from (2).\n\nAnswer format:\n- Prove (1) first (for all d), giving a rigorous parity argument.\n- Then prove (2) in full detail as outlined.\n- Finally, deduce (3) from (2) by an explicit fixed-point-free construction.",
        "answer": "[Error: errored]"
    },
    "29": {
        "question": "Title: Farkas\u2019 lemma to max\u2013flow=min\u2013cut and bipartite matching \u2014 a complete, self-contained development via duality and total unimodularity\n\nLet R^n be equipped with the standard inner product x\u00b7y = \u2211 x_i y_i and norm ||x|| = \u221a(x\u00b7x). For a matrix A \u2208 R^{m\u00d7n} and vector b \u2208 R^m, write K(A) := {A x : x \u2208 R^n, x \u2265 0} for the finitely generated (polyhedral) cone spanned by A\u2019s columns. For a directed graph G = (V,E) with a chosen orientation of each arc, the node\u2013arc incidence matrix B \u2208 R^{V\u00d7E} is defined by B_{v,e} = +1 if e leaves v, B_{v,e} = \u22121 if e enters v, and B_{v,e} = 0 otherwise. A matrix is totally unimodular (TU) if every square subdeterminant is in {\u22121, 0, 1}.\n\nProblem (hard, self-contained). Prove, in order, the following:\n\n1) Farkas\u2019 lemma (conic form) via Euclidean projection. For A \u2208 R^{m\u00d7n} and b \u2208 R^m, prove the exact alternative:\n   Exactly one of the following holds:\n   (F1) There exists x \u2208 R^n with x \u2265 0 and A x = b.\n   (F2) There exists y \u2208 R^m with y^T A \u2265 0 (entrywise) and y^T b < 0.\n   Your proof must be complete and self-contained. You may use only basic facts about convexity and the Euclidean projection onto a nonempty closed convex set in R^m (existence and the characterization by orthogonality of the residual).\n\n   Then deduce the \u201cmixed-constraint\u201d corollary: For A \u2208 R^{m\u00d7n}, c \u2208 R^n, b \u2208 R^m, \u03b1 \u2208 R, exactly one holds:\n   (G1) \u2203 x \u2265 0 with A x \u2264 b and c^T x \u2265 \u03b1.\n   (G2) \u2203 y \u2265 0 and \u03bb \u2265 0 with A^T y \u2212 \u03bb c \u2265 0 and y^T b \u2212 \u03bb \u03b1 < 0.\n\n2) Linear programming duality (weak and strong) and complementary slackness. Consider the primal\u2013dual pair\n   (P) max c^T x subject to A x \u2264 b, x \u2265 0,\n   (D) min b^T y subject to A^T y \u2265 c, y \u2265 0.\n   Prove weak duality c^T x \u2264 b^T y for any primal-feasible x and dual-feasible y.\n\n   Using (1), prove strong duality of optimal values: If (P) is feasible and has finite optimal value \u03b2, then\n   sup{c^T x : A x \u2264 b, x \u2265 0} = inf{b^T y : A^T y \u2265 c, y \u2265 0}.\n   Show also the complementary slackness conditions: if x* and y* are optimal for (P) and (D), then\n   for each i, y*_i (b_i \u2212 a_i^T x*) = 0; for each j, x*_j ((A^T y* \u2212 c)_j) = 0.\n   Conclude that c^T x* = b^T y*.\n\n3) Max\u2013flow = min\u2013cut via LP duality and a thresholding argument. Let G = (V,E) be a finite directed graph, s,t \u2208 V distinct, and capacities u_e \u2265 0 on arcs e \u2208 E. A (feasible) s\u2013t flow is f \u2208 R^E with 0 \u2264 f_e \u2264 u_e for all e and flow-conservation B f = F d, where F is the flow value and d \u2208 R^V has d_s = 1, d_t = \u22121, d_v = 0 otherwise. The max-flow LP is\n   (MF) maximize F over (f,F) subject to B f \u2212 F d = 0 and 0 \u2264 f \u2264 u.\n   Derive the dual LP and reduce it to\n   (MC) minimize \u2211_{e=(u,v)} u_e max(0, y_u \u2212 y_v) over y \u2208 R^V with y_s \u2212 y_t = 1.\n   Prove that for any feasible y, the integral \u201cthresholding\u201d family S_\u03bb := {v : y_v \u2265 \u03bb} (\u03bb \u2208 R) yields\n   \u2211_e u_e max(0, y_u \u2212 y_v) = \u222b_{\u2212\u221e}^{+\u221e} cap(S_\u03bb) d\u03bb,\n   where cap(S) := \u2211_{(u,v)\u2208E, u\u2208S, v\u2209S} u_{(u,v)} is the capacity of the directed cut (S, S^c).\n   Deduce there exists \u03bb with cap(S_\u03bb) \u2264 the dual objective at y; hence the dual optimum equals min_s,t cap(S, S^c), and strong duality gives the max\u2013flow=min\u2013cut theorem:\n   max flow value = min capacity of an s\u2013t cut.\n\n4) Total unimodularity of incidence matrices and integral flows. Prove:\n   a) The node\u2013arc incidence matrix B of any directed graph is TU. Conclude that any square submatrix of B has determinant in {\u22121,0,1}.\n   b) Show that adjoining identity rows preserves TU: if M is TU, then the block matrix [M; I] is TU. Conclude that the constraint matrix of (MF) in equality form (after adding standard slack variables for 0 \u2264 f \u2264 u) is TU.\n   c) Deduce that if all capacities u_e are integers, then there exists an optimal max flow with integer arc-values f_e \u2208 Z for all e.\n\n5) Bipartite matching: K\u0151nig\u2013Eg\u00e9rv\u00e1ry and Hall\u2019s theorem. Let G = (U,V;E) be a bipartite graph. A matching M \u2282 E is a set of disjoint edges; its size is |M|. A vertex cover is C \u2282 U\u222aV meeting every edge; its size is |C|.\n   a) LP formulation. Let A \u2208 {0,1}^{(U\u222aV)\u00d7E} be the vertex\u2013edge incidence matrix (A_{w,e} = 1 iff w incident to e). Consider\n      (PM) max \u2211_{e\u2208E} x_e subject to A x \u2264 1, x \u2265 0,\n      (DM) min \u2211_{w\u2208U\u222aV} y_w subject to A^T y \u2265 1, y \u2265 0.\n      Prove that if G is bipartite then A is TU (hint: multiply all V-rows by \u22121 to get a node\u2013arc incidence of an orientation, then use (4a)). Conclude that both (PM) and (DM) admit optimal integral solutions.\n   b) K\u0151nig\u2013Eg\u00e9rv\u00e1ry. Deduce that for bipartite G, the maximum size of a matching equals the minimum size of a vertex cover:\n      \u03bd(G) = \u03c4(G).\n   c) Hall\u2019s marriage theorem. Prove: G has a matching saturating U if and only if for every S \u2286 U one has |N(S)| \u2265 |S|. Derive the \u201conly if\u201d by pigeonhole. For the \u201cif\u201d direction, use (b): if a maximum matching does not saturate U, then \u03c4(G) = \u03bd(G) < |U|, so a minimum vertex cover C has |C| < |U|; set S = U \\ (C\u2229U) and show |N(S)| \u2264 |C\u2229V| = |C| \u2212 |C\u2229U| < |U| \u2212 |C\u2229U| = |S|, contradicting Hall\u2019s condition.\n\nAnswer format:\n- Present complete proofs for (1)\u2013(5) in order, fully justifying each step and identity, and explicitly deriving the duals.\n- In (3), give the thresholding argument carefully (as an integral identity over \u03bb) and show how it produces a 0\u20131 potential realizing a cut.\n- In (4), prove TU of B by a self-contained determinant argument and explain why adding identity preserves TU.\n- In (5), explicitly identify the integral optimal solutions as matchings and vertex covers, and give the Hall corollary rigorously.",
        "answer": "Looking at this comprehensive problem, I'll develop each part systematically, building from Farkas' lemma through to bipartite matching theorems.\n\n## Part 1: Farkas' Lemma via Euclidean Projection\n\n**Theorem (Farkas' Lemma - Conic Form):** For A \u2208 \u211d^{m\u00d7n} and b \u2208 \u211d^m, exactly one holds:\n- (F1) \u2203x \u2265 0: Ax = b\n- (F2) \u2203y: A^T y \u2265 0 and y^T b < 0\n\n**Proof:** The cone K(A) = {Ax : x \u2265 0} is closed and convex (as a finitely generated polyhedral cone). Let p be the Euclidean projection of b onto K(A).\n\n**Case 1:** If p = b, then b \u2208 K(A), so (F1) holds.\n\n**Case 2:** If p \u2260 b, then b \u2209 K(A). By the projection characterization:\n(b - p)\u00b7(z - p) \u2264 0 for all z \u2208 K(A)\n\nSince K(A) is a cone:\n- Setting z = 0: (b - p)\u00b7(-p) \u2264 0, so (b - p)\u00b7p \u2265 0\n- Setting z = 2p: (b - p)\u00b7p \u2264 0\n- Therefore: (b - p)\u00b7p = 0\n\nFor any x \u2265 0: (b - p)\u00b7(Ax) \u2264 0, which means (A^T(b - p))^T x \u2264 0.\nThis holds for all x \u2265 0 only if A^T(b - p) \u2264 0.\n\nSince p \u2260 b: (b - p)\u00b7b = ||b - p||^2 + (b - p)\u00b7p = ||b - p||^2 > 0.\n\nSetting y = p - b gives: A^T y \u2265 0 and y^T b = (p - b)\u00b7b = -||b - p||^2 < 0, so (F2) holds.\n\n**Mutual exclusion:** If both held: y^T b = y^T(Ax) = (A^T y)^T x \u2265 0 (since A^T y \u2265 0, x \u2265 0), contradicting y^T b < 0. \u25a1\n\n**Corollary (Mixed Constraints):** Exactly one holds:\n- (G1) \u2203x \u2265 0: Ax \u2264 b and c^T x \u2265 \u03b1\n- (G2) \u2203y \u2265 0, \u03bb \u2265 0: A^T y - \u03bbc \u2265 0 and y^T b - \u03bb\u03b1 < 0\n\n**Proof:** (G1) is equivalent to: \u2203(x,s,t) \u2265 0 with:\n```\n[A  I  0][x]   [b]\n[-c^T 0 1][s] = [-\u03b1]\n          [t]\n```\n\nBy Farkas, this fails iff \u2203(y,\u03bb) with [A^T -c; I 0; 0 1][y;\u03bb] \u2265 0 and [b^T -\u03b1][y;\u03bb] < 0, which gives (G2). \u25a1\n\n## Part 2: Linear Programming Duality\n\nConsider:\n- (P) max c^T x s.t. Ax \u2264 b, x \u2265 0\n- (D) min b^T y s.t. A^T y \u2265 c, y \u2265 0\n\n**Weak Duality:** For feasible x,y: c^T x \u2264 (A^T y)^T x = y^T(Ax) \u2264 y^T b \u25a1\n\n**Strong Duality:** If (P) has optimal value \u03b2 < \u221e, then:\n\nThe system Ax \u2264 b, x \u2265 0, c^T x > \u03b2 has no solution.\n\nBy the mixed-constraint corollary, \u2203y \u2265 0, \u03bb \u2265 0: A^T y - \u03bbc \u2265 0 and y^T b - \u03bb\u03b2 < 0.\n\nIf \u03bb = 0: A^T y \u2265 0, y \u2265 0, y^T b < 0. For any feasible x: 0 \u2264 y^T(Ax) \u2264 y^T b < 0, contradiction.\n\nSo \u03bb > 0. Setting \u0233 = y/\u03bb: A^T \u0233 \u2265 c, \u0233 \u2265 0, b^T \u0233 < \u03b2.\n\nBut any dual-feasible \u0233 satisfies b^T \u0233 \u2265 \u03b2 by weak duality applied to optimal x*.\n\nThus b^T \u0233 = \u03b2 for some dual-feasible \u0233, proving strong duality. \u25a1\n\n**Complementary Slackness:** At optimality with c^T x* = b^T y*:\n```\n0 = b^T y* - c^T x* = y*^T(b - Ax*) + x*^T(A^T y* - c)\n```\nBoth terms are non-negative, so each is zero:\n- y*_i(b_i - (Ax*)_i) = 0 for all i\n- x*_j((A^T y*)_j - c_j) = 0 for all j \u25a1\n\n## Part 3: Max-Flow = Min-Cut\n\nThe max-flow LP is:\n```\n(MF) max F s.t. Bf = Fd, 0 \u2264 f \u2264 u\n```\nwhere d_s = 1, d_t = -1, d_v = 0 otherwise.\n\n**Dual Derivation:** Assigning dual variables \u03c0 \u2208 \u211d^V to flow conservation and \u03b1 \u2208 \u211d^E_\u22650 to capacity:\n\nThe Lagrangian is L = F + \u03c0^T(Fd - Bf) - \u03b1^T(f - u).\n\nStationarity conditions:\n- \u2202L/\u2202F = 0: 1 + \u03c0^T d = 0, so \u03c0^T d = -1\n- \u2202L/\u2202f_e = 0: (B^T \u03c0)_e \u2264 \u03b1_e for all e\n\nFor e = (u,v): (B^T \u03c0)_e = \u03c0_u - \u03c0_v, so the dual is:\n```\n(MC) min \u03a3_e u_e \u03b1_e s.t. \u03c0_s - \u03c0_t = 1, \u03b1_e \u2265 max(0, \u03c0_u - \u03c0_v)\n```\nAt optimality: \u03b1_e = max(0, \u03c0_u - \u03c0_v).\n\n**Thresholding Argument:** For feasible \u03c0, define S_\u03bb = {v : \u03c0_v \u2265 \u03bb}.\n\nFor e = (u,v) with \u03c0_u > \u03c0_v:\n```\nmax(0, \u03c0_u - \u03c0_v) = \u222b_{-\u221e}^{+\u221e} \ud835\udfd9_{\u03c0_v < \u03bb \u2264 \u03c0_u} d\u03bb\n```\n\nWhen \u03c0_v < \u03bb \u2264 \u03c0_u: u \u2208 S_\u03bb, v \u2209 S_\u03bb, so e crosses from S_\u03bb to S^c_\u03bb.\n\nTherefore:\n```\n\u03a3_{e=(u,v)} u_e max(0, \u03c0_u - \u03c0_v) = \u222b_{-\u221e}^{+\u221e} cap(S_\u03bb) d\u03bb\n```\n\nSince \u03c0_s > \u03c0_t (as \u03c0_s - \u03c0_t = 1), for \u03bb \u2208 (\u03c0_t, \u03c0_s], S_\u03bb separates s from t.\n\nThe integral equals the average of cap(S_\u03bb) over \u03bb, so some \u03bb* satisfies:\n```\ncap(S_\u03bb*) \u2264 dual objective at \u03c0\n```\n\nBy strong duality: max flow value = min dual value \u2264 cap(S_\u03bb*).\n\nSince any s-t cut upper bounds the flow: max flow value \u2265 min cut capacity.\n\nTherefore: **max flow value = min cut capacity**. \u25a1\n\n## Part 4: Total Unimodularity\n\n**a) Node-arc incidence is TU:**\n\n**Proof by induction on submatrix size k:**\n- Base: 1\u00d71 entries are in {-1,0,1} by definition\n- Step: For k\u00d7k submatrix M:\n  - If M has a zero column: det(M) = 0\n  - If M has a column with one nonzero (\u00b11): expand along it, det(M) = \u00b1det(M') where M' is (k-1)\u00d7(k-1), so det(M) \u2208 {-1,0,1}\n  - If every column has exactly two nonzeros (+1,-1): row sum is zero, so det(M) = 0 \u25a1\n\n**b) Adding identity preserves TU:**\n\nFor [M; I], any square submatrix either:\n- Avoids I: it's from M, determinant in {-1,0,1}\n- Intersects I: after permutation, det = (det of M-part)\u00d7(det of I-part) \u2208 {-1,0,1} \u25a1\n\n**c) Integral flows:** The constraint matrix of (MF) with slacks:\n```\n[B -d 0]\n[I  0 I]\n```\nis TU. By Cramer's rule, basic feasible solutions are integral when capacities are integral. Since LP optimum occurs at a BFS, there exists an integral optimal flow. \u25a1\n\n## Part 5: Bipartite Matching\n\n**a) Bipartite incidence is TU:**\n\nOrient edges from U to V. Multiplying V-rows of A by -1 gives the node-arc incidence (TU by 4a). Since row scaling by \u00b11 preserves TU, A is TU.\n\nBoth (PM) max \u03a3_e x_e s.t. Ax \u2264 1, x \u2265 0 and (DM) min \u03a3_w y_w s.t. A^T y \u2265 1, y \u2265 0 have integral optimal solutions. \u25a1\n\n**b) K\u00f6nig-Egerv\u00e1ry:** Integral x* \u2208 {0,1}^E defines matching M = {e : x*_e = 1}. Integral y* \u2208 {0,1}^{U\u222aV} defines vertex cover C = {w : y*_w = 1}.\n\nBy strong duality: \u03bd(G) = |M| = \u03a3_e x*_e = \u03a3_w y*_w = |C| = \u03c4(G) \u25a1\n\n**c) Hall's Marriage Theorem:**\n\n**G has matching saturating U \u27fa |N(S)| \u2265 |S| for all S \u2286 U**\n\n(\u27f9) If M saturates U, the restriction M|_S injectively maps S \u2192 N(S), so |N(S)| \u2265 |S|.\n\n(\u27f8) Suppose Hall's condition holds but no matching saturates U.\nThen \u03bd(G) < |U|, so \u03c4(G) = \u03bd(G) < |U| by K\u00f6nig-Egerv\u00e1ry.\n\nLet C be minimum vertex cover with |C| < |U|.\nSet S = U \\ (C \u2229 U). Since |C \u2229 U| < |U|, we have S \u2260 \u2205.\n\nEvery edge from S goes to N(S), and must be covered by C.\nSince S \u2229 C = \u2205, we need N(S) \u2286 C \u2229 V.\n\nTherefore: |N(S)| \u2264 |C \u2229 V| = |C| - |C \u2229 U| < |U| - |C \u2229 U| = |S|.\n\nThis contradicts Hall's condition. \u25a1"
    }
}